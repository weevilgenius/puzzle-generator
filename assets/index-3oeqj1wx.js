import{m as E,g as je}from"./mithril-B5C7A48-.js";import{r as pn}from"./webawesome-BNu9ozLj.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const gn={view:({attrs:a})=>E("a.github-corner",{href:a.link,"aria-label":"View source on GitHub",title:"View source on GitHub",target:"_blank"},E("svg",{width:80,height:80,viewBox:"0 0 250 250","aria-hidden":"true"},[E("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),E("path.octo-arm",{fill:"currentColor",style:"transform-origin: 130px 106px;",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"}),E("path.octo-body",{fill:"currentColor",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"})]))};class Lt{generators=new Map;register(e,n,i){this.generators.has(e)&&console.warn(`Generator "${e}" is already registered, overwriting`),this.generators.set(e,{factory:n,uiMetadata:i})}create(e,n,i){const s=this.generators.get(i.name);if(!s)throw new Error(`Unknown generator "${i.name}". Is it registered?`);return s.factory(e,n,i)}getAvailableGenerators(){return Array.from(this.generators.values()).sort((e,n)=>e.uiMetadata.sortHint-n.uiMetadata.sortHint).map(e=>({name:e.uiMetadata.name,displayName:e.uiMetadata.displayName}))}getUIMetadata(e){return this.generators.get(e)?.uiMetadata}getDefaultConfig(e,n,i){const s={name:e,width:n,height:i},r=this.getUIMetadata(e);if(r)for(const o of r.controls)s[o.name]=o.defaultValue;return s}}const xt=new Lt,vt=new Lt,bt=new Lt,et=new Lt;let mn=0;function qe(){return mn++}const{abs:ct,cos:B,sin:nt,acos:yn,atan2:ht,sqrt:K,pow:V}=Math;function ut(a){return a<0?-V(-a,1/3):V(a,1/3)}const Ve=Math.PI,Pt=2*Ve,Q=Ve/2,xn=1e-6,Gt=Number.MAX_SAFE_INTEGER||9007199254740991,Ot=Number.MIN_SAFE_INTEGER||-9007199254740991,vn={x:0,y:0,z:0},z={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(a,e){const n=e(a);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),K(i)},compute:function(a,e,n){if(a===0)return e[0].t=0,e[0];const i=e.length-1;if(a===1)return e[i].t=1,e[i];const s=1-a;let r=e;if(i===0)return e[0].t=a,e[0];if(i===1){const l={x:s*r[0].x+a*r[1].x,y:s*r[0].y+a*r[1].y,t:a};return n&&(l.z=s*r[0].z+a*r[1].z),l}if(i<4){let l=s*s,c=a*a,h,f,u,d=0;i===2?(r=[r[0],r[1],r[2],vn],h=l,f=s*a*2,u=c):i===3&&(h=l*s,f=l*a*3,u=s*c*3,d=a*c);const p={x:h*r[0].x+f*r[1].x+u*r[2].x+d*r[3].x,y:h*r[0].y+f*r[1].y+u*r[2].y+d*r[3].y,t:a};return n&&(p.z=h*r[0].z+f*r[1].z+u*r[2].z+d*r[3].z),p}const o=JSON.parse(JSON.stringify(e));for(;o.length>1;){for(let l=0;l<o.length-1;l++)o[l]={x:o[l].x+(o[l+1].x-o[l].x)*a,y:o[l].y+(o[l+1].y-o[l].y)*a},typeof o[l].z<"u"&&(o[l].z=o[l].z+(o[l+1].z-o[l].z)*a);o.splice(o.length-1,1)}return o[0].t=a,o[0]},computeWithRatios:function(a,e,n,i){const s=1-a,r=n,o=e;let l=r[0],c=r[1],h=r[2],f=r[3],u;if(l*=s,c*=a,o.length===2)return u=l+c,{x:(l*o[0].x+c*o[1].x)/u,y:(l*o[0].y+c*o[1].y)/u,z:i?(l*o[0].z+c*o[1].z)/u:!1,t:a};if(l*=s,c*=2*s,h*=a*a,o.length===3)return u=l+c+h,{x:(l*o[0].x+c*o[1].x+h*o[2].x)/u,y:(l*o[0].y+c*o[1].y+h*o[2].y)/u,z:i?(l*o[0].z+c*o[1].z+h*o[2].z)/u:!1,t:a};if(l*=s,c*=1.5*s,h*=3*s,f*=a*a*a,o.length===4)return u=l+c+h+f,{x:(l*o[0].x+c*o[1].x+h*o[2].x+f*o[3].x)/u,y:(l*o[0].y+c*o[1].y+h*o[2].y+f*o[3].y)/u,z:i?(l*o[0].z+c*o[1].z+h*o[2].z+f*o[3].z)/u:!1,t:a}},derive:function(a,e){const n=[];for(let i=a,s=i.length,r=s-1;s>1;s--,r--){const o=[];for(let l=0,c;l<r;l++)c={x:r*(i[l+1].x-i[l].x),y:r*(i[l+1].y-i[l].y)},e&&(c.z=r*(i[l+1].z-i[l].z)),o.push(c);n.push(o),i=o}return n},between:function(a,e,n){return e<=a&&a<=n||z.approximately(a,e)||z.approximately(a,n)},approximately:function(a,e,n){return ct(a-e)<=(n||xn)},length:function(a){const n=z.Tvalues.length;let i=0;for(let s=0,r;s<n;s++)r=.5*z.Tvalues[s]+.5,i+=z.Cvalues[s]*z.arcfn(r,a);return .5*i},map:function(a,e,n,i,s){const r=n-e,o=s-i,l=a-e,c=l/r;return i+o*c},lerp:function(a,e,n){const i={x:e.x+a*(n.x-e.x),y:e.y+a*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+a*(n.z-e.z)),i},pointToString:function(a){let e=a.x+"/"+a.y;return typeof a.z<"u"&&(e+="/"+a.z),e},pointsToString:function(a){return"["+a.map(z.pointToString).join(", ")+"]"},copy:function(a){return JSON.parse(JSON.stringify(a))},angle:function(a,e,n){const i=e.x-a.x,s=e.y-a.y,r=n.x-a.x,o=n.y-a.y,l=i*o-s*r,c=i*r+s*o;return ht(l,c)},round:function(a,e){const n=""+a,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(a,e){const n=a.x-e.x,i=a.y-e.y;return K(n*n+i*i)},closest:function(a,e){let n=V(2,63),i,s;return a.forEach(function(r,o){s=z.dist(e,r),s<n&&(n=s,i=o)}),{mdist:n,mpos:i}},abcratio:function(a,e){if(e!==2&&e!==3)return!1;if(typeof a>"u")a=.5;else if(a===0||a===1)return a;const n=V(a,e)+V(1-a,e),i=n-1;return ct(i/n)},projectionratio:function(a,e){if(e!==2&&e!==3)return!1;if(typeof a>"u")a=.5;else if(a===0||a===1)return a;const n=V(1-a,e),i=V(a,e)+n;return n/i},lli8:function(a,e,n,i,s,r,o,l){const c=(a*i-e*n)*(s-o)-(a-n)*(s*l-r*o),h=(a*i-e*n)*(r-l)-(e-i)*(s*l-r*o),f=(a-n)*(r-l)-(e-i)*(s-o);return f==0?!1:{x:c/f,y:h/f}},lli4:function(a,e,n,i){const s=a.x,r=a.y,o=e.x,l=e.y,c=n.x,h=n.y,f=i.x,u=i.y;return z.lli8(s,r,o,l,c,h,f,u)},lli:function(a,e){return z.lli4(a,a.c,e,e.c)},makeline:function(a,e){return new N(a.x,a.y,(a.x+e.x)/2,(a.y+e.y)/2,e.x,e.y)},findbbox:function(a){let e=Gt,n=Gt,i=Ot,s=Ot;return a.forEach(function(r){const o=r.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),s<o.y.max&&(s=o.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+s)/2,max:s,size:s-n}}},shapeintersections:function(a,e,n,i,s){if(!z.bboxoverlap(e,i))return[];const r=[],o=[a.startcap,a.forward,a.back,a.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(c){c.virtual||l.forEach(function(h){if(h.virtual)return;const f=c.intersects(h,s);f.length>0&&(f.c1=c,f.c2=h,f.s1=a,f.s2=n,r.push(f))})}),r},makeshape:function(a,e,n){const i=e.points.length,s=a.points.length,r=z.makeline(e.points[i-1],a.points[0]),o=z.makeline(a.points[s-1],e.points[0]),l={startcap:r,forward:a,back:e,endcap:o,bbox:z.findbbox([r,a,e,o])};return l.intersections=function(c){return z.shapeintersections(l,l.bbox,c,c.bbox,n)},l},getminmax:function(a,e,n){if(!n)return{min:0,max:0};let i=Gt,s=Ot,r,o;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,c=n.length;l<c;l++)r=n[l],o=a.get(r),o[e]<i&&(i=o[e]),o[e]>s&&(s=o[e]);return{min:i,mid:(i+s)/2,max:s,size:s-i}},align:function(a,e){const n=e.p1.x,i=e.p1.y,s=-ht(e.p2.y-i,e.p2.x-n),r=function(o){return{x:(o.x-n)*B(s)-(o.y-i)*nt(s),y:(o.x-n)*nt(s)+(o.y-i)*B(s)}};return a.map(r)},roots:function(a,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=a.length-1,i=z.align(a,e),s=function(M){return 0<=M&&M<=1};if(n===2){const M=i[0].y,P=i[1].y,w=i[2].y,T=M-2*P+w;if(T!==0){const k=-K(P*P-M*w),S=-M+P,D=-(k+S)/T,R=-(-k+S)/T;return[D,R].filter(s)}else if(P!==w&&T===0)return[(2*P-w)/(2*P-2*w)].filter(s);return[]}const r=i[0].y,o=i[1].y,l=i[2].y,c=i[3].y;let h=-r+3*o-3*l+c,f=3*r-6*o+3*l,u=-3*r+3*o,d=r;if(z.approximately(h,0)){if(z.approximately(f,0))return z.approximately(u,0)?[]:[-d/u].filter(s);const M=K(u*u-4*f*d),P=2*f;return[(M-u)/P,(-u-M)/P].filter(s)}f/=h,u/=h,d/=h;const p=(3*u-f*f)/3,m=p/3,g=(2*f*f*f-9*f*u+27*d)/27,x=g/2,y=x*x+m*m*m;let v,_,I,b,C;if(y<0){const M=-p/3,P=M*M*M,w=K(P),T=-g/(2*w),k=T<-1?-1:T>1?1:T,S=yn(k),D=ut(w),R=2*D;return I=R*B(S/3)-f/3,b=R*B((S+Pt)/3)-f/3,C=R*B((S+2*Pt)/3)-f/3,[I,b,C].filter(s)}else{if(y===0)return v=x<0?ut(-x):-ut(x),I=2*v-f/3,b=-v-f/3,[I,b].filter(s);{const M=K(y);return v=ut(-x+M),_=ut(x+M),[v-_-f/3].filter(s)}}},droots:function(a){if(a.length===3){const e=a[0],n=a[1],i=a[2],s=e-2*n+i;if(s!==0){const r=-K(n*n-e*i),o=-e+n,l=-(r+o)/s,c=-(-r+o)/s;return[l,c]}else if(n!==i&&s===0)return[(2*n-i)/(2*(n-i))];return[]}if(a.length===2){const e=a[0],n=a[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(a,e,n,i,s){let r,o,l,c,h=0,f=0;const u=z.compute(a,e),d=z.compute(a,n),p=u.x*u.x+u.y*u.y;if(i?(r=K(V(u.y*d.z-d.y*u.z,2)+V(u.z*d.x-d.z*u.x,2)+V(u.x*d.y-d.x*u.y,2)),o=V(p+u.z*u.z,3/2)):(r=u.x*d.y-u.y*d.x,o=V(p,3/2)),r===0||o===0)return{k:0,r:0};if(h=r/o,f=o/r,!s){const m=z.curvature(a-.001,e,n,i,!0).k,g=z.curvature(a+.001,e,n,i,!0).k;c=(g-h+(h-m))/2,l=(ct(g-h)+ct(h-m))/2}return{k:h,r:f,dk:c,adk:l}},inflections:function(a){if(a.length<4)return[];const e=z.align(a,{p1:a[0],p2:a.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,s=e[1].x*e[2].y,r=e[3].x*e[2].y,o=18*(-3*n+2*i+3*s-r),l=18*(3*n-i-3*s),c=18*(s-n);if(z.approximately(o,0)){if(!z.approximately(l,0)){let d=-c/l;if(0<=d&&d<=1)return[d]}return[]}const h=2*o;if(z.approximately(h,0))return[];const f=l*l-4*o*c;if(f<0)return[];const u=Math.sqrt(f);return[(u-l)/h,-(l+u)/h].filter(function(d){return 0<=d&&d<=1})},bboxoverlap:function(a,e){const n=["x","y"],i=n.length;for(let s=0,r,o,l,c;s<i;s++)if(r=n[s],o=a[r].mid,l=e[r].mid,c=(a[r].size+e[r].size)/2,ct(o-l)>=c)return!1;return!0},expandbox:function(a,e){e.x.min<a.x.min&&(a.x.min=e.x.min),e.y.min<a.y.min&&(a.y.min=e.y.min),e.z&&e.z.min<a.z.min&&(a.z.min=e.z.min),e.x.max>a.x.max&&(a.x.max=e.x.max),e.y.max>a.y.max&&(a.y.max=e.y.max),e.z&&e.z.max>a.z.max&&(a.z.max=e.z.max),a.x.mid=(a.x.min+a.x.max)/2,a.y.mid=(a.y.min+a.y.max)/2,a.z&&(a.z.mid=(a.z.min+a.z.max)/2),a.x.size=a.x.max-a.x.min,a.y.size=a.y.max-a.y.min,a.z&&(a.z.size=a.z.max-a.z.min)},pairiteration:function(a,e,n){const i=a.bbox(),s=e.bbox(),r=1e5,o=n||.5;if(i.x.size+i.y.size<o&&s.x.size+s.y.size<o)return[(r*(a._t1+a._t2)/2|0)/r+"/"+(r*(e._t1+e._t2)/2|0)/r];let l=a.split(.5),c=e.split(.5),h=[{left:l.left,right:c.left},{left:l.left,right:c.right},{left:l.right,right:c.right},{left:l.right,right:c.left}];h=h.filter(function(u){return z.bboxoverlap(u.left.bbox(),u.right.bbox())});let f=[];return h.length===0||(h.forEach(function(u){f=f.concat(z.pairiteration(u.left,u.right,o))}),f=f.filter(function(u,d){return f.indexOf(u)===d})),f},getccenter:function(a,e,n){const i=e.x-a.x,s=e.y-a.y,r=n.x-e.x,o=n.y-e.y,l=i*B(Q)-s*nt(Q),c=i*nt(Q)+s*B(Q),h=r*B(Q)-o*nt(Q),f=r*nt(Q)+o*B(Q),u=(a.x+e.x)/2,d=(a.y+e.y)/2,p=(e.x+n.x)/2,m=(e.y+n.y)/2,g=u+l,x=d+c,y=p+h,v=m+f,_=z.lli8(u,d,g,x,p,m,y,v),I=z.dist(_,a);let b=ht(a.y-_.y,a.x-_.x),C=ht(e.y-_.y,e.x-_.x),M=ht(n.y-_.y,n.x-_.x),P;return b<M?((b>C||C>M)&&(b+=Pt),b>M&&(P=M,M=b,b=P)):M<C&&C<b?(P=M,M=b,b=P):M+=Pt,_.s=b,_.e=M,_.r=I,_},numberSort:function(a,e){return a-e}};class mt{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return z.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)z.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new mt(n)}}const{abs:ft,min:de,max:pe,cos:bn,sin:wn,acos:_n,sqrt:dt}=Math,Pn=Math.PI;class N{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const p=[];n.forEach(function(m){["x","y","z"].forEach(function(g){typeof m[g]<"u"&&p.push(m[g])})}),n=p}let s=!1;const r=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(r!==6&&r!==8&&r!==9&&r!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!s&&(r===9||r===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let p=0,m=o?3:2;p<r;p+=m){var c={x:n[p],y:n[p+1]};o&&(c.z=n[p+2]),l.push(c)}const h=this.order=l.length-1,f=this.dims=["x","y"];o&&f.push("z"),this.dimlen=f.length;const u=z.align(l,{p1:l[0],p2:l[h]}),d=z.dist(l[0],l[h]);this._linear=u.reduce((p,m)=>p+ft(m.y),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,s){if(typeof s>"u"&&(s=.5),s===0)return new N(n,n,i);if(s===1)return new N(e,n,n);const r=N.getABC(2,e,n,i,s);return new N(e,r.A,i)}static cubicFromPoints(e,n,i,s,r){typeof s>"u"&&(s=.5);const o=N.getABC(3,e,n,i,s);typeof r>"u"&&(r=z.dist(n,o.C));const l=r*(1-s)/s,c=z.dist(e,i),h=(i.x-e.x)/c,f=(i.y-e.y)/c,u=r*h,d=r*f,p=l*h,m=l*f,g={x:n.x-u,y:n.y-d},x={x:n.x+p,y:n.y+m},y=o.A,v={x:y.x+(g.x-y.x)/(1-s),y:y.y+(g.y-y.y)/(1-s)},_={x:y.x+(x.x-y.x)/s,y:y.y+(x.y-y.y)/s},I={x:e.x+(v.x-e.x)/s,y:e.y+(v.y-e.y)/s},b={x:i.x+(_.x-i.x)/(1-s),y:i.y+(_.y-i.y)/(1-s)};return new N(e,I,b,i)}static getUtils(){return z}getUtils(){return N.getUtils()}static get PolyBezier(){return mt}valueOf(){return this.toString()}toString(){return z.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,s=["M",n,i,this.order===2?"Q":"C"];for(let r=1,o=e.length;r<o;r++)s.push(e[r].x),s.push(e[r].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=z.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=z.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return z.length(this.derivative.bind(this))}static getABC(e=2,n,i,s,r=.5){const o=z.projectionratio(r,e),l=1-o,c={x:o*n.x+l*s.x,y:o*n.y+l*s.y},h=z.abcratio(r,e);return{A:{x:i.x+(i.x-c.x)/h,y:i.y+(i.y-c.y)/h},B:i,C:c,S:n,E:s}}getABC(e,n){n=n||this.get(e);let i=this.points[0],s=this.points[this.order];return N.getABC(this.order,i,n,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,s;n<e;n++)s=n/(e-1),i=this.compute(s),i.t=s,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),s=[];for(let r=0,o,l=0;r<i.length;r++)o=i[r],z.dist(o,e)<n&&(s.push(o),l+=r/i.length);return s.length?t/=s.length:!1}project(e){const n=this.getLUT(),i=n.length-1,s=z.closest(n,e),r=s.mpos,o=(r-1)/i,l=(r+1)/i,c=.1/i;let h=s.mdist,f=o,u=f,d;h+=1;for(let p;f<l+c;f+=c)d=this.compute(f),p=z.dist(e,d),p<h&&(h=p,u=f);return u=u<0?0:u>1?1:u,d=this.compute(u),d.t=u,d.d=h,d}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?z.computeWithRatios(e,this.points,this.ratios,this._3d):z.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let s=1,r,o;s<i;s++)r=e[s],o=e[s-1],n[s]={x:(i-s)/i*r.x+s/i*o.x,y:(i-s)/i*r.y+s/i*o.y};return n[i]=e[i-1],new N(n)}derivative(e){return z.compute(e,this.dpoints[0],this._3d)}dderivative(e){return z.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new N(z.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return z.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return z.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=dt(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),s=dt(n.x*n.x+n.y*n.y+n.z*n.z),r=dt(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=s,n.y/=s,n.z/=s,i.x/=r,i.y/=r,i.z/=r;const o={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},l=dt(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=l,o.y/=l,o.z/=l;const c=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,i=[],s=[],r=0;for(s[r++]=n[0],s[r++]=n[1],s[r++]=n[2],this.order===3&&(s[r++]=n[3]);n.length>1;){i=[];for(let o=0,l,c=n.length-1;o<c;o++)l=z.lerp(e,n[o],n[o+1]),s[r++]=l,i.push(l);n=i}return s}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),s={left:this.order===2?new N([i[0],i[3],i[5]]):new N([i[0],i[4],i[7],i[9]]),right:this.order===2?new N([i[5],i[4],i[2]]):new N([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=z.map(0,0,1,this._t1,this._t2),s.left._t2=z.map(e,0,1,this._t1,this._t2),s.right._t1=z.map(e,0,1,this._t1,this._t2),s.right._t2=z.map(1,0,1,this._t1,this._t2),n?(n=z.map(n,e,1,0,1),s.right.split(n).left):s}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let s=function(o){return o[i]},r=this.dpoints[0].map(s);e[i]=z.droots(r),this.order===3&&(r=this.dpoints[1].map(s),e[i]=e[i].concat(z.droots(r))),e[i]=e[i].filter(function(o){return o>=0&&o<=1}),n=n.concat(e[i].sort(z.numberSort))}).bind(this)),e.values=n.sort(z.numberSort).filter(function(i,s){return n.indexOf(i)===s}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=z.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return z.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),s=this.normal(e),r={c:i,n:s,x:i.x+s.x*n,y:i.y+s.y*n};return this._3d&&(r.z=i.z+s.z*n),r}if(this._linear){const i=this.normal(0),s=this.points.map(function(r){const o={x:r.x+e*i.x,y:r.y+e*i.y};return r.z&&i.z&&(o.z=r.z+e*i.z),o});return[new N(s)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const s=z.angle(this.points[0],this.points[3],this.points[1]),r=z.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&r<0||s<0&&r>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),ft(_n(i))<Pn/3}reduce(){let e,n=0,i=0,s=.01,r,o=[],l=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)i=c[e],r=this.split(n,i),r._t1=n,r._t2=i,o.push(r),n=i;return o.forEach(function(h){for(n=0,i=0;i<=1;)for(i=n+s;i<=1+s;i+=s)if(r=h.split(n,i),!r.simple()){if(i-=s,ft(n-i)<s)return[];r=h.split(n,i),r._t1=z.map(n,0,1,h._t1,h._t2),r._t2=z.map(i,0,1,h._t1,h._t2),l.push(r),n=i;break}n<1&&(r=h.split(n,1),r._t1=z.map(n,0,1,h._t1,h._t2),r._t2=h._t2,l.push(r))}),l}translate(e,n,i){i=typeof i=="number"?i:n;const s=this.order;let r=this.points.map((o,l)=>(1-l/s)*n+l/s*i);return new N(this.points.map((o,l)=>({x:o.x+e.x*r[l],y:o.y+e.y*r[l]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const s=this.clockwise,r=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const o=i?i(0):e,l=i?i(1):e,c=[this.offset(0,10),this.offset(1,10)],h=[],f=z.lli4(c[0],c[0].c,c[1],c[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(u){const d=h[u*n]=z.copy(r[u*n]);d.x+=(u?l:o)*c[u].n.x,d.y+=(u?l:o)*c[u].n.y}),i?([0,1].forEach(function(u){if(!(n===2&&u)){var d=r[u+1],p={x:d.x-f.x,y:d.y-f.y},m=i?i((u+1)/n):e;i&&!s&&(m=-m);var g=dt(p.x*p.x+p.y*p.y);p.x/=g,p.y/=g,h[u+1]={x:d.x+m*p.x,y:d.y+m*p.y}}}),new N(h)):([0,1].forEach(u=>{if(n===2&&u)return;const d=h[u*n],p=this.derivative(u),m={x:d.x+p.x,y:d.y+p.y};h[u+1]=z.lli4(d,m,f,r[u+1])}),new N(h))}outline(e,n,i,s){if(n=n===void 0?e:n,this._linear){const b=this.normal(0),C=this.points[0],M=this.points[this.points.length-1];let P,w,T;i===void 0&&(i=e,s=n),P={x:C.x+b.x*e,y:C.y+b.y*e},T={x:M.x+b.x*i,y:M.y+b.y*i},w={x:(P.x+T.x)/2,y:(P.y+T.y)/2};const k=[P,w,T];P={x:C.x-b.x*n,y:C.y-b.y*n},T={x:M.x-b.x*s,y:M.y-b.y*s},w={x:(P.x+T.x)/2,y:(P.y+T.y)/2};const S=[T,w,P],D=z.makeline(S[2],k[0]),R=z.makeline(k[2],S[0]),$=[D,new N(k),R,new N(S)];return new mt($)}const r=this.reduce(),o=r.length,l=[];let c=[],h,f=0,u=this.length();const d=typeof i<"u"&&typeof s<"u";function p(b,C,M,P,w){return function(T){const k=P/M,S=(P+w)/M,D=C-b;return z.map(T,0,1,b+k*D,b+S*D)}}r.forEach(function(b){const C=b.length();d?(l.push(b.scale(p(e,i,u,f,C))),c.push(b.scale(p(-n,-s,u,f,C)))):(l.push(b.scale(e)),c.push(b.scale(-n))),f+=C}),c=c.map(function(b){return h=b.points,h[3]?b.points=[h[3],h[2],h[1],h[0]]:b.points=[h[2],h[1],h[0]],b}).reverse();const m=l[0].points[0],g=l[o-1].points[l[o-1].points.length-1],x=c[o-1].points[c[o-1].points.length-1],y=c[0].points[0],v=z.makeline(x,m),_=z.makeline(g,y),I=[v].concat(l).concat([_]).concat(c);return new mt(I)}outlineshapes(e,n,i){n=n||e;const s=this.outline(e,n).curves,r=[];for(let o=1,l=s.length;o<l/2;o++){const c=z.makeshape(s[o],s[l-o],i);c.startcap.virtual=o>1,c.endcap.virtual=o<l/2-1,r.push(c)}return r}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof N&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=de(e.p1.x,e.p2.x),i=de(e.p1.y,e.p2.y),s=pe(e.p1.x,e.p2.x),r=pe(e.p1.y,e.p2.y);return z.roots(this.points,e).filter(o=>{var l=this.get(o);return z.between(l.x,n,s)&&z.between(l.y,i,r)})}selfintersects(e){const n=this.reduce(),i=n.length-2,s=[];for(let r=0,o,l,c;r<i;r++)l=n.slice(r,r+1),c=n.slice(r+2),o=this.curveintersects(l,c,e),s.push(...o);return s}curveintersects(e,n,i){const s=[];e.forEach(function(o){n.forEach(function(l){o.overlaps(l)&&s.push({left:o,right:l})})});let r=[];return s.forEach(function(o){const l=z.pairiteration(o.left,o.right,i);l.length>0&&(r=r.concat(l))}),r}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,s){const r=(s-i)/4,o=this.get(i+r),l=this.get(s-r),c=z.dist(e,n),h=z.dist(e,o),f=z.dist(e,l);return ft(h-c)+ft(f-c)}_iterate(e,n){let i=0,s=1,r;do{r=0,s=1;let o=this.get(i),l,c,h,f,u=!1,d=!1,p,m=s,g=1;do if(d=u,f=h,m=(i+s)/2,l=this.get(m),c=this.get(s),h=z.getccenter(o,l,c),h.interval={start:i,end:s},u=this._error(h,o,i,s)<=e,p=d&&!u,p||(g=s),u){if(s>=1){if(h.interval.end=g=1,f=h,s>1){let y={x:h.x+h.r*bn(h.e),y:h.y+h.r*wn(h.e)};h.e+=z.angle({x:h.x,y:h.y},y,this.get(1))}break}s=s+(s-i)/2}else s=m;while(!p&&r++<100);if(r>=100)break;f=f||h,n.push(f),i=g}while(s<1);return n}}var Mn=(function(){function a(e,n){var i=[],s=!0,r=!1,o=void 0;try{for(var l=e[Symbol.iterator](),c;!(s=(c=l.next()).done)&&(i.push(c.value),!(n&&i.length===n));s=!0);}catch(h){r=!0,o=h}finally{try{!s&&l.return&&l.return()}finally{if(r)throw o}}return i}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return a(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),yt=Math.PI*2,Ft=function(e,n,i,s,r,o,l){var c=e.x,h=e.y;c*=n,h*=i;var f=s*c-r*h,u=r*c+s*h;return{x:f+o,y:u+l}},zn=function(e,n){var i=n===1.5707963267948966?.551915024494:n===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(n/4),s=Math.cos(e),r=Math.sin(e),o=Math.cos(e+n),l=Math.sin(e+n);return[{x:s-r*i,y:r+s*i},{x:o+l*i,y:l-o*i},{x:o,y:l}]},ge=function(e,n,i,s){var r=e*s-n*i<0?-1:1,o=e*i+n*s;return o>1&&(o=1),o<-1&&(o=-1),r*Math.acos(o)},En=function(e,n,i,s,r,o,l,c,h,f,u,d){var p=Math.pow(r,2),m=Math.pow(o,2),g=Math.pow(u,2),x=Math.pow(d,2),y=p*m-p*x-m*g;y<0&&(y=0),y/=p*x+m*g,y=Math.sqrt(y)*(l===c?-1:1);var v=y*r/o*d,_=y*-o/r*u,I=f*v-h*_+(e+i)/2,b=h*v+f*_+(n+s)/2,C=(u-v)/r,M=(d-_)/o,P=(-u-v)/r,w=(-d-_)/o,T=ge(1,0,C,M),k=ge(C,M,P,w);return c===0&&k>0&&(k-=yt),c===1&&k<0&&(k+=yt),[I,b,T,k]},Cn=function(e){var n=e.px,i=e.py,s=e.cx,r=e.cy,o=e.rx,l=e.ry,c=e.xAxisRotation,h=c===void 0?0:c,f=e.largeArcFlag,u=f===void 0?0:f,d=e.sweepFlag,p=d===void 0?0:d,m=[];if(o===0||l===0)return[];var g=Math.sin(h*yt/360),x=Math.cos(h*yt/360),y=x*(n-s)/2+g*(i-r)/2,v=-g*(n-s)/2+x*(i-r)/2;if(y===0&&v===0)return[];o=Math.abs(o),l=Math.abs(l);var _=Math.pow(y,2)/Math.pow(o,2)+Math.pow(v,2)/Math.pow(l,2);_>1&&(o*=Math.sqrt(_),l*=Math.sqrt(_));var I=En(n,i,s,r,o,l,u,p,g,x,y,v),b=Mn(I,4),C=b[0],M=b[1],P=b[2],w=b[3],T=Math.abs(w)/(yt/4);Math.abs(1-T)<1e-7&&(T=1);var k=Math.max(Math.ceil(T),1);w/=k;for(var S=0;S<k;S++)m.push(zn(P,w)),P+=w;return m.map(function(D){var R=Ft(D[0],o,l,x,g,C,M),$=R.x,A=R.y,L=Ft(D[1],o,l,x,g,C,M),O=L.x,G=L.y,H=Ft(D[2],o,l,x,g,C,M),lt=H.x,Nt=H.y;return{x1:$,y1:A,x2:O,y2:G,x:lt,y:Nt}})};function In(a,e){return a>e?1:a<e?-1:0}class ae{constructor(e=In,n=!1){this._compare=e,this._root=null,this._size=0,this._noDuplicates=!!n}rotateLeft(e){var n=e.right;n&&(e.right=n.left,n.left&&(n.left.parent=e),n.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=n:e.parent.right=n:this._root=n,n&&(n.left=e),e.parent=n}rotateRight(e){var n=e.left;n&&(e.left=n.right,n.right&&(n.right.parent=e),n.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=n:e.parent.right=n:this._root=n,n&&(n.right=e),e.parent=n}_splay(e){for(;e.parent;){var n=e.parent;n.parent?n.left===e&&n.parent.left===n?(this.rotateRight(n.parent),this.rotateRight(n)):n.right===e&&n.parent.right===n?(this.rotateLeft(n.parent),this.rotateLeft(n)):n.left===e&&n.parent.right===n?(this.rotateRight(n),this.rotateLeft(n)):(this.rotateLeft(n),this.rotateRight(n)):n.left===e?this.rotateRight(n):this.rotateLeft(n)}}splay(e){for(var n,i,s,r,o;e.parent;)n=e.parent,i=n.parent,i&&i.parent?(s=i.parent,s.left===i?s.left=e:s.right=e,e.parent=s):(e.parent=null,this._root=e),r=e.left,o=e.right,e===n.left?(i&&(i.left===n?(n.right?(i.left=n.right,i.left.parent=i):i.left=null,n.right=i,i.parent=n):(r?(i.right=r,r.parent=i):i.right=null,e.left=i,i.parent=e)),o?(n.left=o,o.parent=n):n.left=null,e.right=n,n.parent=e):(i&&(i.right===n?(n.left?(i.right=n.left,i.right.parent=i):i.right=null,n.left=i,i.parent=n):(o?(i.left=o,o.parent=i):i.left=null,e.right=i,i.parent=e)),r?(n.right=r,r.parent=n):n.right=null,e.left=n,n.parent=e)}replace(e,n){e.parent?e===e.parent.left?e.parent.left=n:e.parent.right=n:this._root=n,n&&(n.parent=e.parent)}minNode(e=this._root){if(e)for(;e.left;)e=e.left;return e}maxNode(e=this._root){if(e)for(;e.right;)e=e.right;return e}insert(e,n){var i=this._root,s=null,r=this._compare,o;if(this._noDuplicates)for(;i;){if(s=i,o=r(i.key,e),o===0)return;r(i.key,e)<0?i=i.right:i=i.left}else for(;i;)s=i,r(i.key,e)<0?i=i.right:i=i.left;return i={key:e,data:n,left:null,right:null,parent:s},s?r(s.key,i.key)<0?s.right=i:s.left=i:this._root=i,this.splay(i),this._size++,i}find(e){for(var n=this._root,i=this._compare;n;){var s=i(n.key,e);if(s<0)n=n.right;else if(s>0)n=n.left;else return n}return null}contains(e){for(var n=this._root,i=this._compare;n;){var s=i(e,n.key);if(s===0)return!0;s<0?n=n.left:n=n.right}return!1}remove(e){var n=this.find(e);if(!n)return!1;if(this.splay(n),!n.left)this.replace(n,n.right);else if(!n.right)this.replace(n,n.left);else{var i=this.minNode(n.right);i.parent!==n&&(this.replace(i,i.right),i.right=n.right,i.right.parent=i),this.replace(n,i),i.left=n.left,i.left.parent=i}return this._size--,!0}removeNode(e){if(!e)return!1;if(this.splay(e),!e.left)this.replace(e,e.right);else if(!e.right)this.replace(e,e.left);else{var n=this.minNode(e.right);n.parent!==e&&(this.replace(n,n.right),n.right=e.right,n.right.parent=n),this.replace(e,n),n.left=e.left,n.left.parent=n}return this._size--,!0}erase(e){var n=this.find(e);if(n){this.splay(n);var i=n.left,s=n.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),s&&(i?r.right=s:this._root=s,s.parent=r),this._size--}}pop(){var e=this._root,n=null;if(e){for(;e.left;)e=e.left;n={key:e.key,data:e.data},this.remove(e.key)}return n}next(e){var n=e;if(n)if(n.right)for(n=n.right;n&&n.left;)n=n.left;else for(n=e.parent;n&&n.right===e;)e=n,n=n.parent;return n}prev(e){var n=e;if(n)if(n.left)for(n=n.left;n&&n.right;)n=n.right;else for(n=e.parent;n&&n.left===e;)e=n,n=n.parent;return n}forEach(e){for(var n=this._root,i=[],s=!1,r=0;!s;)n?(i.push(n),n=n.left):i.length>0?(n=i.pop(),e(n,r++),n=n.right):s=!0;return this}range(e,n,i,s){const r=[],o=this._compare;let l=this._root,c;for(;r.length!==0||l;)if(l)r.push(l),l=l.left;else{if(l=r.pop(),c=o(l.key,n),c>0)break;if(o(l.key,e)>=0&&i.call(s,l))return this;l=l.right}return this}keys(){for(var e=this._root,n=[],i=[],s=!1;!s;)e?(n.push(e),e=e.left):n.length>0?(e=n.pop(),i.push(e.key),e=e.right):s=!0;return i}values(){for(var e=this._root,n=[],i=[],s=!1;!s;)e?(n.push(e),e=e.left):n.length>0?(e=n.pop(),i.push(e.data),e=e.right):s=!0;return i}at(e){for(var n=this._root,i=[],s=!1,r=0;!s;)if(n)i.push(n),n=n.left;else if(i.length>0){if(n=i.pop(),r===e)return n;r++,n=n.right}else s=!0;return null}load(e=[],n=[],i=!1){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const s=e.length;return i&&ee(e,n,0,s-1,this._compare),this._root=te(null,e,n,0,s),this._size=s,this}min(){var e=this.minNode(this._root);return e?e.key:null}max(){var e=this.maxNode(this._root);return e?e.key:null}isEmpty(){return this._root===null}get size(){return this._size}static createTree(e,n,i,s,r){return new ae(i,r).load(e,n,s)}}function te(a,e,n,i,s){const r=s-i;if(r>0){const o=i+Math.floor(r/2),l=e[o],c=n[o],h={key:l,data:c,parent:a};return h.left=te(h,e,n,i,o),h.right=te(h,e,n,o+1,s),h}return null}function ee(a,e,n,i,s){if(n>=i)return;const r=a[n+i>>1];let o=n-1,l=i+1;for(;;){do o++;while(s(a[o],r)<0);do l--;while(s(a[l],r)>0);if(o>=l)break;let c=a[o];a[o]=a[l],a[l]=c,c=e[o],e[o]=e[l],e[l]=c}ee(a,e,n,l,s),ee(a,e,l+1,i,s)}const He=0,We=1,Be=2,Xe=3,kt=0,ne=1,St=2,Ye=3;function pt(a,e,n){e===null?(a.inOut=!1,a.otherInOut=!0):(a.isSubject===e.isSubject?(a.inOut=!e.inOut,a.otherInOut=e.otherInOut):(a.inOut=!e.otherInOut,a.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(a.prevInResult=!me(e,n)||e.isVertical()?e.prevInResult:e)),me(a,n)?a.resultTransition=Tn(a,n):a.resultTransition=0}function me(a,e){switch(a.type){case He:switch(e){case kt:return!a.otherInOut;case ne:return a.otherInOut;case St:return a.isSubject&&a.otherInOut||!a.isSubject&&!a.otherInOut;case Ye:return!0}break;case Be:return e===kt||e===ne;case Xe:return e===St;case We:return!1}return!1}function Tn(a,e){let n=!a.inOut,i=!a.otherInOut,s;switch(e){case kt:s=n&&i;break;case ne:s=n||i;break;case Ye:s=n^i;break;case St:a.isSubject?s=n&&!i:s=i&&!n;break}return s?1:-1}class at{constructor(e,n,i,s,r){this.left=n,this.point=e,this.otherEvent=i,this.isSubject=s,this.type=r||He,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0}isBelow(e){const n=this.point,i=this.otherEvent.point;return this.left?(n[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(n[1]-e[1])>0:(i[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(i[1]-e[1])>0}isAbove(e){return!this.isBelow(e)}isVertical(){return this.point[0]===this.otherEvent.point[0]}get inResult(){return this.resultTransition!==0}clone(){const e=new at(this.point,this.left,this.otherEvent,this.isSubject,this.type);return e.contourId=this.contourId,e.resultTransition=this.resultTransition,e.prevInResult=this.prevInResult,e.isExteriorRing=this.isExteriorRing,e.inOut=this.inOut,e.otherInOut=this.otherInOut,e}}function W(a,e){return a[0]===e[0]?a[1]===e[1]:!1}const X=11102230246251565e-32,F=134217729,kn=(3+8*X)*X;function Ut(a,e,n,i,s){let r,o,l,c,h=e[0],f=i[0],u=0,d=0;f>h==f>-h?(r=h,h=e[++u]):(r=f,f=i[++d]);let p=0;if(u<a&&d<n)for(f>h==f>-h?(o=h+r,l=r-(o-h),h=e[++u]):(o=f+r,l=r-(o-f),f=i[++d]),r=o,l!==0&&(s[p++]=l);u<a&&d<n;)f>h==f>-h?(o=r+h,c=o-r,l=r-(o-c)+(h-c),h=e[++u]):(o=r+f,c=o-r,l=r-(o-c)+(f-c),f=i[++d]),r=o,l!==0&&(s[p++]=l);for(;u<a;)o=r+h,c=o-r,l=r-(o-c)+(h-c),h=e[++u],r=o,l!==0&&(s[p++]=l);for(;d<n;)o=r+f,c=o-r,l=r-(o-c)+(f-c),f=i[++d],r=o,l!==0&&(s[p++]=l);return(r!==0||p===0)&&(s[p++]=r),p}function Sn(a,e){let n=e[0];for(let i=1;i<a;i++)n+=e[i];return n}function wt(a){return new Float64Array(a)}const Dn=(3+16*X)*X,An=(2+12*X)*X,Rn=(9+64*X)*X*X,it=wt(4),ye=wt(8),xe=wt(12),ve=wt(16),j=wt(4);function $n(a,e,n,i,s,r,o){let l,c,h,f,u,d,p,m,g,x,y,v,_,I,b,C,M,P;const w=a-s,T=n-s,k=e-r,S=i-r;I=w*S,d=F*w,p=d-(d-w),m=w-p,d=F*S,g=d-(d-S),x=S-g,b=m*x-(I-p*g-m*g-p*x),C=k*T,d=F*k,p=d-(d-k),m=k-p,d=F*T,g=d-(d-T),x=T-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,it[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,it[1]=_-(y+u)+(u-C),P=v+y,u=P-v,it[2]=v-(P-u)+(y-u),it[3]=P;let D=Sn(4,it),R=An*o;if(D>=R||-D>=R||(u=a-w,l=a-(w+u)+(u-s),u=n-T,h=n-(T+u)+(u-s),u=e-k,c=e-(k+u)+(u-r),u=i-S,f=i-(S+u)+(u-r),l===0&&c===0&&h===0&&f===0)||(R=Rn*o+kn*Math.abs(D),D+=w*f+S*l-(k*h+T*c),D>=R||-D>=R))return D;I=l*S,d=F*l,p=d-(d-l),m=l-p,d=F*S,g=d-(d-S),x=S-g,b=m*x-(I-p*g-m*g-p*x),C=c*T,d=F*c,p=d-(d-c),m=c-p,d=F*T,g=d-(d-T),x=T-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,j[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,j[1]=_-(y+u)+(u-C),P=v+y,u=P-v,j[2]=v-(P-u)+(y-u),j[3]=P;const $=Ut(4,it,4,j,ye);I=w*f,d=F*w,p=d-(d-w),m=w-p,d=F*f,g=d-(d-f),x=f-g,b=m*x-(I-p*g-m*g-p*x),C=k*h,d=F*k,p=d-(d-k),m=k-p,d=F*h,g=d-(d-h),x=h-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,j[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,j[1]=_-(y+u)+(u-C),P=v+y,u=P-v,j[2]=v-(P-u)+(y-u),j[3]=P;const A=Ut($,ye,4,j,xe);I=l*f,d=F*l,p=d-(d-l),m=l-p,d=F*f,g=d-(d-f),x=f-g,b=m*x-(I-p*g-m*g-p*x),C=c*h,d=F*c,p=d-(d-c),m=c-p,d=F*h,g=d-(d-h),x=h-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,j[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,j[1]=_-(y+u)+(u-C),P=v+y,u=P-v,j[2]=v-(P-u)+(y-u),j[3]=P;const L=Ut(A,xe,4,j,ve);return ve[L-1]}function Ln(a,e,n,i,s,r){const o=(e-r)*(n-s),l=(a-s)*(i-r),c=o-l;if(o===0||l===0||o>0!=l>0)return c;const h=Math.abs(o+l);return Math.abs(c)>=Dn*h?c:-$n(a,e,n,i,s,r,h)}function ie(a,e,n){const i=Ln(a[0],a[1],e[0],e[1],n[0],n[1]);return i>0?-1:i<0?1:0}function Z(a,e){const n=a.point,i=e.point;return n[0]>i[0]?1:n[0]<i[0]?-1:n[1]!==i[1]?n[1]>i[1]?1:-1:Nn(a,e,n)}function Nn(a,e,n,i){return a.left!==e.left?a.left?1:-1:ie(n,a.otherEvent.point,e.otherEvent.point)!==0?a.isBelow(e.otherEvent.point)?-1:1:!a.isSubject&&e.isSubject?1:-1}function J(a,e,n){const i=new at(e,!1,a,a.isSubject),s=new at(e,!0,a.otherEvent,a.isSubject);return W(a.point,a.otherEvent.point)&&console.warn("what is that, a collapsed segment?",a),i.contourId=s.contourId=a.contourId,Z(s,a.otherEvent)>0&&(a.otherEvent.left=!0,s.left=!1),a.otherEvent.otherEvent=s,a.otherEvent=i,n.push(s),n.push(i),n}function Mt(a,e){return a[0]*e[1]-a[1]*e[0]}function jt(a,e){return a[0]*e[0]+a[1]*e[1]}function Gn(a,e,n,i,s){const r=[e[0]-a[0],e[1]-a[1]],o=[i[0]-n[0],i[1]-n[1]];function l(x,y,v){return[x[0]+y*v[0],x[1]+y*v[1]]}const c=[n[0]-a[0],n[1]-a[1]];let h=Mt(r,o),f=h*h;const u=jt(r,r);if(f>0){const x=Mt(c,o)/h;if(x<0||x>1)return null;const y=Mt(c,r)/h;return y<0||y>1?null:x===0||x===1?[l(a,x,r)]:y===0||y===1?[l(n,y,o)]:[l(a,x,r)]}if(h=Mt(c,r),f=h*h,f>0)return null;const d=jt(r,c)/u,p=d+jt(r,o)/u,m=Math.min(d,p),g=Math.max(d,p);return m<=1&&g>=0?m===1?[l(a,m>0?m:0,r)]:g===0?[l(a,g<1?g:1,r)]:[l(a,m>0?m:0,r),l(a,g<1?g:1,r)]:null}function qt(a,e,n){const i=Gn(a.point,a.otherEvent.point,e.point,e.otherEvent.point),s=i?i.length:0;if(s===0||s===1&&(W(a.point,e.point)||W(a.otherEvent.point,e.otherEvent.point))||s===2&&a.isSubject===e.isSubject)return 0;if(s===1)return!W(a.point,i[0])&&!W(a.otherEvent.point,i[0])&&J(a,i[0],n),!W(e.point,i[0])&&!W(e.otherEvent.point,i[0])&&J(e,i[0],n),1;const r=[];let o=!1,l=!1;return W(a.point,e.point)?o=!0:Z(a,e)===1?r.push(e,a):r.push(a,e),W(a.otherEvent.point,e.otherEvent.point)?l=!0:Z(a.otherEvent,e.otherEvent)===1?r.push(e.otherEvent,a.otherEvent):r.push(a.otherEvent,e.otherEvent),o&&l||o?(e.type=We,a.type=e.inOut===a.inOut?Be:Xe,o&&!l&&J(r[1].otherEvent,r[0].point,n),2):l?(J(r[0],r[1].point,n),3):r[0]!==r[3].otherEvent?(J(r[0],r[1].point,n),J(r[1],r[2].point,n),3):(J(r[0],r[1].point,n),J(r[3].otherEvent,r[2].point,n),3)}function On(a,e){if(a===e)return 0;if(ie(a.point,a.otherEvent.point,e.point)!==0||ie(a.point,a.otherEvent.point,e.otherEvent.point)!==0)return W(a.point,e.point)?a.isBelow(e.otherEvent.point)?-1:1:a.point[0]===e.point[0]?a.point[1]<e.point[1]?-1:1:Z(a,e)===1?e.isAbove(a.point)?-1:1:a.isBelow(e.point)?-1:1;if(a.isSubject===e.isSubject){let n=a.point,i=e.point;if(n[0]===i[0]&&n[1]===i[1])return n=a.otherEvent.point,i=e.otherEvent.point,n[0]===i[0]&&n[1]===i[1]?0:a.contourId>e.contourId?1:-1}else return a.isSubject?-1:1;return Z(a,e)===1?1:-1}function Fn(a,e,n,i,s,r){const o=new ae(On),l=[],c=Math.min(i[2],s[2]);let h,f,u;for(;a.length!==0;){let d=a.pop();if(l.push(d),d.point[0]>c||r===St)break;if(d.left){f=h=o.insert(d),u=o.minNode(),h!==u?h=o.prev(h):h=null,f=o.next(f);const p=h?h.key:null;let m;if(pt(d,p,r),f&&qt(d,f.key,a)===2&&(pt(d,p,r),pt(f.key,d,r)),h&&qt(h.key,d,a)===2){let g=h;g!==u?g=o.prev(g):g=null,m=g?g.key:null,pt(p,m,r),pt(d,p,r)}}else d=d.otherEvent,f=h=o.find(d),h&&f&&(h!==u?h=o.prev(h):h=null,f=o.next(f),o.remove(d),f&&h&&qt(h.key,f.key,a))}return l}class Un{constructor(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null}isExterior(){return this.holeOf==null}}function jn(a){let e,n,i,s;const r=[];for(n=0,i=a.length;n<i;n++)e=a[n],(e.left&&e.inResult||!e.left&&e.otherEvent.inResult)&&r.push(e);let o=!1;for(;!o;)for(o=!0,n=0,i=r.length;n<i;n++)n+1<i&&Z(r[n],r[n+1])===1&&(s=r[n],r[n]=r[n+1],r[n+1]=s,o=!1);for(n=0,i=r.length;n<i;n++)e=r[n],e.otherPos=n;for(n=0,i=r.length;n<i;n++)e=r[n],e.left||(s=e.otherPos,e.otherPos=e.otherEvent.otherPos,e.otherEvent.otherPos=s);return r}function qn(a,e,n,i){let s=a+1,r=e[a].point,o;const l=e.length;for(s<l&&(o=e[s].point);s<l&&o[0]===r[0]&&o[1]===r[1];){if(n[s])s++;else return s;s<l&&(o=e[s].point)}for(s=a-1;n[s]&&s>i;)s--;return s}function Vn(a,e,n){const i=new Un;if(a.prevInResult!=null){const s=a.prevInResult,r=s.outputContourId;if(s.resultTransition>0){const l=e[r];if(l.holeOf!=null){const c=l.holeOf;e[c].holeIds.push(n),i.holeOf=c,i.depth=e[r].depth}else e[r].holeIds.push(n),i.holeOf=r,i.depth=e[r].depth+1}else i.holeOf=null,i.depth=e[r].depth}else i.holeOf=null,i.depth=0;return i}function Hn(a){let e,n;const i=jn(a),s={},r=[];for(e=0,n=i.length;e<n;e++){if(s[e])continue;const o=r.length,l=Vn(i[e],r,o),c=d=>{s[d]=!0,d<i.length&&i[d]&&(i[d].outputContourId=o)};let h=e,f=e;const u=i[e].point;for(l.points.push(u);c(h),h=i[h].otherPos,c(h),l.points.push(i[h].point),h=qn(h,i,s,f),!(h==f||h>=i.length||!i[h]););r.push(l)}return r}var zt={exports:{}},be;function Wn(){if(be)return zt.exports;be=1,zt.exports=a,zt.exports.default=a;function a(n,i){if(!(this instanceof a))return new a(n,i);if(this.data=n||[],this.length=this.data.length,this.compare=i||e,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)}function e(n,i){return n<i?-1:n>i?1:0}return a.prototype={push:function(n){this.data.push(n),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var n=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),n}},peek:function(){return this.data[0]},_up:function(n){for(var i=this.data,s=this.compare,r=i[n];n>0;){var o=n-1>>1,l=i[o];if(s(r,l)>=0)break;i[n]=l,n=o}i[n]=r},_down:function(n){for(var i=this.data,s=this.compare,r=this.length>>1,o=i[n];n<r;){var l=(n<<1)+1,c=l+1,h=i[l];if(c<this.length&&s(i[c],h)<0&&(l=c,h=i[c]),s(h,o)>=0)break;i[n]=h,n=l}i[n]=o}},zt.exports}var Bn=Wn();const Xn=je(Bn),we=Math.max,_e=Math.min;let Et=0;function Pe(a,e,n,i,s,r){let o,l,c,h,f,u;for(o=0,l=a.length-1;o<l;o++){if(c=a[o],h=a[o+1],f=new at(c,!1,void 0,e),u=new at(h,!1,f,e),f.otherEvent=u,c[0]===h[0]&&c[1]===h[1])continue;f.contourId=u.contourId=n,r||(f.isExteriorRing=!1,u.isExteriorRing=!1),Z(f,u)>0?u.left=!0:f.left=!0;const d=c[0],p=c[1];s[0]=_e(s[0],d),s[1]=_e(s[1],p),s[2]=we(s[2],d),s[3]=we(s[3],p),i.push(f),i.push(u)}}function Yn(a,e,n,i,s){const r=new Xn(null,Z);let o,l,c,h,f,u;for(c=0,h=a.length;c<h;c++)for(o=a[c],f=0,u=o.length;f<u;f++)l=f===0,l&&Et++,Pe(o[f],!0,Et,r,n,l);for(c=0,h=e.length;c<h;c++)for(o=e[c],f=0,u=o.length;f<u;f++)l=f===0,l&&Et++,Pe(o[f],!1,Et,r,i,l);return r}const Dt=[];function Kn(a,e,n){let i=null;return a.length*e.length===0&&(i=Dt),i}function Qn(a,e,n,i,s){let r=null;return(n[0]>i[2]||i[0]>n[2]||n[1]>i[3]||i[1]>n[3])&&(r=Dt),r}function Jn(a,e,n){typeof a[0][0][0]=="number"&&(a=[a]),typeof e[0][0][0]=="number"&&(e=[e]);let i=Kn(a,e);if(i)return i===Dt?null:i;const s=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],o=Yn(a,e,s,r);if(i=Qn(a,e,s,r),i)return i===Dt?null:i;const l=Fn(o,a,e,s,r,n),c=Hn(l),h=[];for(let f=0;f<c.length;f++){let u=c[f];if(u.isExterior()){let d=[u.points];for(let p=0;p<u.holeIds.length;p++){let m=u.holeIds[p];d.push(c[m].points)}h.push(d)}}return h}function Zn(a,e){return Jn(a,e,kt)}function ti(a,e){const n=a[0]-e[0],i=a[1]-e[1];return n*n+i*i}function ei(a){return{vertices:a.vertices,pieces:Array.from(a.pieces.entries()),edges:Array.from(a.edges.entries()),halfEdges:Array.from(a.halfEdges.entries()),boundary:a.boundary,borderPath:a.borderPath}}function Ke(a,e){let[n,i]=a,[s,r]=a;const o=l=>{n=Math.min(n,l[0]),i=Math.min(i,l[1]),s=Math.max(s,l[0]),r=Math.max(r,l[1])};for(const l of e)l.type==="line"?o(l.p):(o(l.p1),o(l.p2),o(l.p3));return[n,i,s,r]}function Qe(a,e){let n=1/0,i=1/0,s=-1/0,r=-1/0;const o=a.halfEdge;let l=e.halfEdges.get(o);if(!l)return a.bounds;const c=h=>{n=Math.min(n,h[0]),i=Math.min(i,h[1]),s=Math.max(s,h[0]),r=Math.max(r,h[1])};do{if(c(l.origin),l.segments){const h=Ke(l.origin,l.segments);c([h[0],h[1]]),c([h[2],h[3]])}l=e.halfEdges.get(l.next)}while(l&&l.id!==o);return[n,i,s,r]}const Me=100,ni=Me*Me;function ii(a,e){let n=-1,i=ni;for(let s=0;s<a.vertices.length;s++){const r=ti(a.vertices[s],e);r<i&&(i=r,n=s)}return n===-1?null:n}function re(a){if(a.length===0)return[0,0,0,0];let e=a[0][0],n=a[0][1],i=e,s=n;for(let r=1;r<a.length;r++){const o=a[r];e=Math.min(e,o[0]),n=Math.min(n,o[1]),i=Math.max(i,o[0]),s=Math.max(s,o[1])}return[e,n,i,s]}function ri(a,e){return Math.abs(a[0]-e[0])<1e-6&&Math.abs(a[1]-e[1])<1e-6}function Je(a,e,n,i){if(!a.tabs)return;const s=e.halfEdges.get(a.heLeft),r=e.halfEdges.get(a.heRight),o=s.origin,l=r.origin,c=[];let h=o;a.tabs.sort((f,u)=>f.position-u.position);for(const f of a.tabs){const u=f.position-f.size/2,d=[o[0]+(l[0]-o[0])*u,o[1]+(l[1]-o[1])*u];Math.hypot(d[0]-h[0],d[1]-h[1])>1e-6&&c.push({type:"line",p:d});const p=[o[0]+(l[0]-o[0])*(u+f.size),o[1]+(l[1]-o[1])*(u+f.size)],m=n.createTabSegments(d,p,f,i);c.push(...m),h=p}Math.hypot(l[0]-h[0],l[1]-h[1])>1e-6&&c.push({type:"line",p:l}),s.segments=c,r.segments=si(c,o),a.bounds=Ke(o,c)}function si(a,e){const n=[];for(let i=a.length-1;i>=0;i--){const s=a[i];let r=e;if(i>0){const o=a[i-1];r=o.type==="line"?o.p:o.p3}s.type==="line"?n.push({type:"line",p:r}):n.push({type:"bezier",p1:s.p2,p2:s.p1,p3:r})}return n}function oi(a,e){const{p:n,radii:i,rotation:s,largeArc:r,sweep:o}=e,[l,c]=a,[h,f]=n,[u,d]=i;return Cn({px:l,py:c,cx:h,cy:f,rx:u,ry:d,xAxisRotation:s,largeArcFlag:r?1:0,sweepFlag:o?1:0}).map(g=>({type:"bezier",p1:[g.x1,g.y1],p2:[g.x2,g.y2],p3:[g.x,g.y]}))}function Ze(a){const e=[];let n=[];if(a.length===0||a[0].type!=="move")return[];let i=[0,0];for(const s of a)switch(s.type){case"move":n.length>0&&e.push(n),i=s.p,n=[i];break;case"line":n.push(s.p),i=s.p;break;case"bezier":{const{p1:r,p2:o,p3:l}=s,h=new N([...i,...r,...o,...l]).getLUT(100);n.push(...h.slice(1).map(f=>[f.x,f.y])),i=l;break}case"arc":{const r=oi(i,s);let o=i;for(const l of r){const h=new N([...o,...l.p1,...l.p2,...l.p3]).getLUT(100);n.push(...h.slice(1).map(f=>[f.x,f.y])),o=l.p3}i=s.p;break}}return n.length>0&&e.push(n),e}function le(a,e){if(e.length>0&&e[0].type!=="move")throw new Error("Boundary path must start with a 'move' command.");const n=Ze(e);let i=0;for(const s of n)ci(a,s)&&i++;return i%2===1}function ai(a){return Array.isArray(a[0])&&Array.isArray(a[0][0])&&typeof a[0][0][0]=="number"}function li(a,e){const n=[a.map(r=>[r[0],r[1]])],i=[e.map(r=>[r[0],r[1]])],s=Zn(n,i);return!s||s.length===0?null:ai(s)?s:s.map(r=>r[0].map(o=>[o[0],o[1]]))}function ci(a,e){const[n,i]=a;let s=!1;for(let r=0,o=e.length-1;r<e.length;o=r++){const[l,c]=e[r],[h,f]=e[o];c>i!=f>i&&n<(h-l)*(i-c)/(f-c)+l&&(s=!s)}return s}function hi(a,e,n){const i=[];for(const r of a)n.vertices.find(o=>ri(o,r))||n.vertices.push(r);for(const r of a){const o={id:qe(),origin:r,twin:-1,next:-1,prev:-1,piece:e};i.push(o)}const s=i.length;for(let r=0;r<s;r++){const o=(r+1)%s,l=(r+s-1)%s;i[r].next=i[o].id,i[r].prev=i[l].id}return i.forEach(r=>n.halfEdges.set(r.id,r)),i}function tn(a,e,n,i){const s=(o,l)=>`${o[0]},${o[1]}-${l[0]},${l[1]}`,r=a.length;for(let o=0;o<r;o++){const l=a[o],c=l.origin,h=e.halfEdges.get(l.next).origin,f=s(h,c),u=n.get(f),d=qe();let p;if(u!==void 0){const m=e.halfEdges.get(u);l.twin=m.id,m.twin=l.id,p={id:d,heLeft:m.id,heRight:l.id,bounds:re([c,h])},n.delete(f)}else{const m=s(c,h);if(n.set(m,l.id),i(c,h))p={id:d,heLeft:l.id,heRight:-1,bounds:re([c,h])},e.boundary.push(d);else continue}e.edges.set(d,p)}}function en(a){return function(){let e=a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}}async function ze(a){const{bounds:e,pieceSize:n,border:i}=a,{pointConfig:s,pieceConfig:r,placementConfig:o,tabConfig:l}=a;console.log(`rebuilding puzzle with dimensions ${e.width}x${e.height}, piece size ${n}`);const c=xt.create(i,e,s),h=vt.create(i,e,r),f=bt.create(i,e,o),u=et.create(i,e,l),d=a.seed??new Date().getTime(),p=en(d),m=c.generatePoints({width:e.width,height:e.height,pieceSize:n,random:p,border:i});console.log(`Generated ${m.length} points`);const g=h.generatePieces(m,{random:p,pieceSize:n,border:i,bounds:e});console.log(`Generated ${g.pieces.size} pieces`),f.placeTabs({topology:g,random:p});for(const y of g.edges.values())y.heRight!==-1&&y.tabs&&y.tabs.length>0&&Je(y,g,u,p);return{created:new Date().toISOString(),seed:d,width:e.width,height:e.height,pieceSize:n,pointConfig:s,pieceConfig:r,placementConfig:o,tabConfig:l,vertices:g.vertices,boundary:g.boundary,borderPath:g.borderPath,pieces:g.pieces,edges:g.edges,halfEdges:g.halfEdges}}function Vt(a,e,n,i){const s=e.getContext("2d");if(!s){console.error("Could not get 2D context from canvas");return}s.clearRect(0,0,e.width,e.height);{s.strokeStyle=n,s.lineWidth=1,s.beginPath();for(const r of a.edges.values()){const o=a.halfEdges.get(r.heLeft);if(o)if(s.moveTo(o.origin[0],o.origin[1]),o.segments&&o.segments.length>0)for(const l of o.segments)switch(l.type){case"bezier":s.bezierCurveTo(l.p1[0],l.p1[1],l.p2[0],l.p2[1],l.p3[0],l.p3[1]);break;case"line":s.lineTo(l.p[0],l.p[1]);break}else{let l;o.twin!==-1?l=a.halfEdges.get(o.twin).origin:l=a.halfEdges.get(o.next).origin,s.lineTo(l[0],l[1])}}s.stroke()}if(a.problems&&a.problems.length>0){s.lineWidth=2,s.strokeStyle="red";for(const r of a.problems){const[o,l]=r;s.beginPath(),s.arc(o,l,8,0,2*Math.PI),s.stroke()}}if(i){s.fillStyle=i;for(const r of a.pieces.values()){const[o,l]=r.site;s.beginPath(),s.arc(o,l,3,0,2*Math.PI),s.fill()}}}function se(a,e){return[{type:"move",p:[0,0]},{type:"line",p:[a,0]},{type:"line",p:[a,e]},{type:"line",p:[0,e]},{type:"line",p:[0,0]}]}function ui(a){const e=a/2,n=e;return[{type:"move",p:[0,n]},{type:"arc",p:[a,n],radii:[e,e],rotation:0,largeArc:!1,sweep:!0},{type:"arc",p:[0,n],radii:[e,e],rotation:0,largeArc:!1,sweep:!0}]}function fi(a,e){const n=a/2,i=e/2;return[{type:"move",p:[0,i]},{type:"arc",p:[a,i],radii:[n,i],rotation:0,largeArc:!1,sweep:!0},{type:"arc",p:[0,i],radii:[n,i],rotation:0,largeArc:!1,sweep:!0}]}function di(a,e,n){const i=Math.min(a,e)/2,s=Math.min(n,i);return[{type:"move",p:[s,0]},{type:"line",p:[a-s,0]},{type:"arc",p:[a,s],radii:[s,s],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[a,e-s]},{type:"arc",p:[a-s,e],radii:[s,s],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[s,e]},{type:"arc",p:[0,e-s],radii:[s,s],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[0,s]},{type:"arc",p:[s,0],radii:[s,s],rotation:0,largeArc:!1,sweep:!0}]}function pi(a,e,n){if(e<0||e>=a.vertices.length){console.warn("moveVertex called with invalid vertex index:",e);return}const i=a.vertices[e];a.vertices[e]=n;const s=[];for(const l of a.halfEdges.values())l.origin[0]===i[0]&&l.origin[1]===i[1]&&s.push(l);const r=new Set,o=[n[0]-i[0],n[1]-i[1]];for(const l of s){l.origin=n,r.add(l.piece);const c=a.halfEdges.get(l.prev);if(c?.segments){const h=c.segments[c.segments.length-1];h.type==="line"?h.p=n:(h.p3=n,h.p1=[h.p1[0]+o[0],h.p1[1]+o[1]],h.p2=[h.p2[0]+o[0],h.p2[1]+o[1]]),r.add(c.piece)}}gi(a,e);for(const l of r){const c=a.pieces.get(l);c&&(c.bounds=Qe(c,a))}}function gi(a,e){const{seed:n,width:i,height:s,placementConfig:r,tabConfig:o}=a,l=en(n),c=se(i,s),h={width:i,height:s},f=bt.create(c,h,r),u=et.create(c,h,o),d=new Set,p=a.vertices[e],m=new Map;for(const x of a.edges.values())m.set(x.heLeft,x),x.heRight!==-1&&m.set(x.heRight,x);for(const x of a.halfEdges.values()){const y=a.halfEdges.get(x.next)?.origin;if(x.origin===p||y===p){const I=m.get(x.id);I&&d.add(I)}}f.updateTabPlacements(Array.from(d),{topology:a,random:l});const g=new Set;for(const x of d)if(x.heRight!==-1){const v=a.halfEdges.get(x.heLeft);v&&(v.segments=void 0,g.add(a.pieces.get(v.piece)));const _=a.halfEdges.get(x.heRight);_&&(_.segments=void 0,g.add(a.pieces.get(_.piece))),Je(x,a,u,l)}for(const x of g)x.bounds=Qe(x,a)}const mi=()=>{const a={canvas:null,isDragging:!1,draggedVertexId:-1},e=r=>{if(!a.canvas)return[0,0];const o=a.canvas.getBoundingClientRect();if(r instanceof TouchEvent){if(r.changedTouches.length>0){const l=r.changedTouches[0];return[l.clientX-o.left,l.clientY-o.top]}}else return[r.clientX-o.left,r.clientY-o.top];return[0,0]},n=(r,o)=>{if(r.redraw=!1,r instanceof TouchEvent&&r.touches.length>1){a.isDragging=!1,a.draggedVertexId=-1;return}if(r instanceof MouseEvent&&r.button!==0)return;const l=e(r),c=ii(o.puzzle,l);c!==null&&(a.draggedVertexId=c)},i=(r,o)=>{if(r.redraw=!1,a.draggedVertexId<0)return;a.isDragging=!0,r.preventDefault();const l=e(r);pi(o.puzzle,a.draggedVertexId,l),Vt(o.puzzle,a.canvas,o.color)},s=(r,o)=>{r.redraw=!1,!(a.draggedVertexId<0)&&(r.preventDefault(),a.isDragging&&o.onPuzzleChanged(o.puzzle),a.isDragging=!1,a.draggedVertexId=-1)};return{oncreate:({dom:r,attrs:o})=>{if(a.canvas=r.querySelector("canvas.puzzle"),!a.canvas){console.log("couldn't get canvas element");return}o.isDirty||Vt(o.puzzle,a.canvas,o.color,o.pointColor)},onupdate:({attrs:r})=>{if(!a.canvas){console.log("couldn't get canvas element");return}r.isDirty||Vt(r.puzzle,a.canvas,r.color,r.pointColor)},view:({attrs:r})=>E(".puzzle-stack",[E("img.background",{width:r.width,height:r.height,src:r.imageUrl}),E("canvas.puzzle",{width:r.width,height:r.height,style:{width:`${r.width}px`,height:`${r.height}px`,touchAction:"manipulation"},onmousedown:o=>n(o,r),onmousemove:o=>i(o,r),onmouseup:o=>s(o,r),onmouseleave:o=>s(o,r),ontouchstart:o=>n(o,r),ontouchmove:o=>i(o,r),ontouchend:o=>s(o,r),ontouchcancel:o=>s(o,r)})])}};function yi(a,e,n,i="black"){const r=[];for(const c of a.edges.values()){const h=a.halfEdges.get(c.heLeft);if(h)if(r.push(`M ${h.origin[0].toFixed(3)} ${h.origin[1].toFixed(3)}`),h.segments)for(const f of h.segments)switch(f.type){case"bezier":r.push(`C ${f.p1[0].toFixed(3)} ${f.p1[1].toFixed(3)}, ${f.p2[0].toFixed(3)} ${f.p2[1].toFixed(3)}, ${f.p3[0].toFixed(3)} ${f.p3[1].toFixed(3)}`);break;case"line":r.push(`L ${f.p[0].toFixed(3)} ${f.p[1].toFixed(3)}`);break}else{let f;h.twin!==-1?f=a.halfEdges.get(h.twin).origin:f=a.halfEdges.get(h.next).origin,r.push(`L ${f[0].toFixed(3)} ${f[1].toFixed(3)}`)}}const o=r.join(" ");return`
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg
  width="${e}"
  height="${n}"
  viewBox="0 0 ${e} ${n}"
  xmlns="http://www.w3.org/2000/svg"
  version="1.1"
>
  <path
    d="${o}"
    fill="none"
    stroke="${i}"
    stroke-width="1"
    vector-effect="non-scaling-stroke"
  />
</svg>`.trim().replace(/\r\n/g,`
`)}function xi(a,e="puzzle.svg"){const n=new Blob([a],{type:"image/svg+xml"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=e,s.hidden=!0,document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout(()=>URL.revokeObjectURL(i),100)}const vi={view:({attrs:a})=>E("wa-button.download-svg",{size:"small",onclick:()=>{const e=yi(a.puzzle,a.width,a.height,a.color);xi(e,a.filename??"puzzle.svg")}},"Download SVG")},bi={view:({attrs:a})=>{const e=a.progressPercent!==void 0&&a.progressPercent<100,n=!e&&a.problems!==void 0&&a.problems==0,i=!e&&a.problems!==void 0&&a.problems>0;return E(".geometry-check-indicator",[E(".label","Geometry Check:"),E("wa-tooltip",{for:"check-geometry-now"},"Check geometry now"),E("wa-button#check-geometry-now",{variant:"neutral",appearance:"plain",size:"small",disabled:e,onclick:s=>{s.redraw=!1,a.onCheckRequested?.()}},E("wa-icon",{library:"material",name:"editor_choice",label:"Check geometry now"})),E("wa-tooltip",{for:"auto-check-geometry"},"Check geometry after every change"),E("wa-checkbox#auto-check-geometry",{checked:a.autoCheck,disabled:e,size:"small",onchange:s=>{s.redraw=!1;const r=s.target;a.onAutocheckChanged?.(r.checked)}},"auto check"),e&&E("wa-progress-bar",{label:"Geometry check progress",value:a.progressPercent??0}),n&&E("wa-badge",{variant:"success",pill:!0},"OK"),i&&E("wa-badge",{variant:"danger",pill:!0},`${a.problems} issue${a.problems===1?"":"s"}`)])}};function wi(a,e,n=800){if(a<=n)return{width:a,height:e};const i=e/a;return{width:n,height:Math.round(n*i)}}const _i=()=>{const a={inputElement:void 0};return{view:({attrs:e})=>[E("wa-button.upload-button",{size:"small",disabled:e.disabled===!0,onclick:()=>{a.inputElement&&a.inputElement.click()}},e.label??"Upload Image"),E("input[type=file]",{style:{display:"none"},accept:"image/*",oncreate:({dom:n})=>{a.inputElement=n},onchange:n=>{if(n.redraw=!1,a.inputElement){const i=a.inputElement.files?.[0];i?.type.startsWith("image/")&&createImageBitmap(i).then(s=>{const{width:r,height:o}=wi(s.width,s.height),l=URL.createObjectURL(i);s.close(),e.onUpload(l,i.name,r,o)}).catch(s=>{console.error("could not create a bitmap image: ",s)})}}})]}},nn=()=>({view:({attrs:a})=>E("wa-checkbox.boolean-input",{hint:a.config.helpText,disabled:a.disabled,checked:a.value,onchange:e=>{const i=e.target.checked;a.onChange(i)}},a.config.label)}),Tt=()=>({view:({attrs:a})=>E("wa-input.number-input",{label:a.config.label,hint:a.config.helpText,type:"number",inputmode:"numeric",size:"small",disabled:a.disabled,value:a.value,min:a.config.min,max:a.config.max,onchange:e=>{const n=e.target,i=parseFloat(n.value??"");a.onChange(isNaN(i)?void 0:i)}})}),Pi=()=>({view:({attrs:a})=>E("wa-slider.range-input",{label:a.config.label,hint:a.config.helpText,disabled:a.disabled,value:a.value,min:a.config.min,max:a.config.max,step:a.config.step,"with-tooltip":!0,onchange:e=>{const i=e.target.value;a.onChange(isNaN(i)?void 0:i)}})}),Mi=()=>({view:({attrs:a})=>E("wa-input.string-input",{label:a.config.label,hint:a.config.helpText,type:"text",inputmode:"text",size:"small",disabled:a.disabled,value:a.value,onchange:e=>{const i=e.target.value??"";a.onChange(i.length>0?i:void 0)}})}),zi=()=>({view:({attrs:a})=>{const e=a.registry.getAvailableGenerators();return E(".generator-picker",E("wa-tab-group",{active:a.generator,"onwa-tab-show":n=>{const i=n.detail.name;a.generator!==i&&a.onGeneratorChange(i)}},[...e.map(n=>{const i=a.registry.getUIMetadata(n.name),s=E("wa-tab",{panel:n.name},n.displayName),r=E("wa-tab-panel",{name:n.name},E(".controls",[i?.description?E("p",i.description):null,...i?.controls.map(o=>{switch(o.type){case"range":return E(Pi,{config:o,value:a.config?.[o.name]??o.defaultValue,onChange:l=>{a.onConfigChange(o.name,l)}});case"boolean":return E(nn,{config:o,value:(a.config?.[o.name]??o.defaultValue)===!0,onChange:l=>{a.onConfigChange(o.name,l)}});case"number":return E(Tt,{config:o,value:a.config?.[o.name]??o.defaultValue,onChange:l=>{a.onConfigChange(o.name,l)}});case"string":return E(Mi,{config:o,value:a.config?.[o.name]??o.defaultValue,onChange:l=>{a.onConfigChange(o.name,l)}})}})??[],!i?.description&&i?.controls.length==0?E("p","No controls for this strategy."):null]));return[s,r]})]))}}),Ee=[["Square","1:1",1],["Classic Photo","5:4",5/4],["Standard Photo","4:3",4/3],["35mm/DSLR","3:2",3/2],["Widescreen","16:9",16/9],["UltraWide","21:9",21/9],["Panorama","2:1",2/1],["Instagram Portrait","4:5",4/5],["Classic Portrait","3:4",3/4],["DSLR Portrait","2:3",2/3],["Phone Portrait","9:16",9/16],["Tall Poster","9:21",9/21],["Tall Panorama","1:2",1/2]],Ei={view:({attrs:a})=>{const e=!Ee.some(([,,i])=>i===a.ratio),n=Ee.map(([i,s,r])=>E("wa-option",{value:String(r)},`${i} [${s}]`));return e&&n.unshift(E("wa-option",{value:"custom"},"Custom")),E(".aspect-ratio-picker",[E("wa-select",{label:"Aspect Ratio",size:"small",disabled:a.disabled,value:e?"custom":String(a.ratio),onchange:i=>{i.redraw=!1;const r=i.target.value;r&&r!=="custom"&&a.onChange(Number(r))}},n),E("wa-slider",{min:.25,max:4,step:.01,"with-tooltip":!0,size:"small",disabled:a.disabled,value:a.ratio,onchange:i=>{i.redraw=!1;const s=i.target;a.onChange(s.value)}})])}},Ce={view:({attrs:a})=>E("wa-color-picker",{label:a.label,value:a.color,size:a.size??"medium",format:"rgb",onchange:e=>{e.redraw=!1;const n=e.target;a.onUpdate(n.value??"")}})},Ci=[["rectangle","Rectangle"],["circle","Circle"],["ellipse","Ellipse"],["rounded-rect","Rounded Rectangle"]],Ii={view:({attrs:a})=>{const e=Ci.map(([n,i])=>E("wa-option",{value:n},i));return E("wa-select",{label:"Border Shape",size:"small",disabled:a.disabled,value:a.shape,onchange:n=>{n.redraw=!1;const s=n.target.value;s&&a.onChange(s)}},e)}};var Ht,Ie;function rn(){if(Ie)return Ht;Ie=1;function a(n){var i=n.length,s=1,r=new Array(i),o;for(o=i;o>0;o--)r[o-1]=s,s=s*n[o-1];return{stride:r,data:new Uint32Array(s)}}function e(n){var i=n.length,s=1,r=new Array(i),o=[],l,c;for(l=i;l>0;l--)r[l-1]=s,s=s*n[l-1];for(c=0;c<s;c++)o.push([]);return{stride:r,data:o}}return Ht={integer:a,array:e},Ht}var Wt,Te;function sn(){if(Te)return Wt;Te=1,Wt=a;function a(e,n){var i=new Array(e),s=Math.floor(e/2)<<1,r=0,o,l,c,h,f;for(f=0;f<s;f+=2)o=-2*Math.log(n()),l=Math.sqrt(o),c=2*Math.PI*n(),r+=o,i[f]=l*Math.cos(c),i[f+1]=l*Math.sin(c);if(e%2){var u=Math.sqrt(-2*Math.log(n()))*Math.cos(2*Math.PI*n());i[e-1]=u,r+=Math.pow(u,2)}for(h=1/Math.sqrt(r),f=0;f<e;++f)i[f]*=h;return i}return Wt}var Bt,ke;function Ti(){return ke||(ke=1,Bt=function(e,n){e=e||1,n=n||2;for(var i=e*2+1,s=Math.pow(i,n)-1,r=new Array(s),o=0;o<s;o++)for(var l=r[o]=new Array(n),c=o<s/2?o:o+1,h=1;h<=n;h++){var f=c%Math.pow(i,h);l[h-1]=f/Math.pow(i,h-1)-e,c-=f}return r}),Bt}var Xt,Se;function on(){if(Se)return Xt;Se=1;var a=Ti();function e(s){var r=a(2,s),o=[],l;for(r=r.filter(function(c){for(var h=0,f=0;f<s;f++)h+=Math.pow(Math.max(0,Math.abs(c[f])-1),2);return h<s}),l=0;l<s;l++)o.push(0);return r.push(o),r.sort(function(c,h){var f=0,u=0,d;for(d=0;d<s;d++)f+=Math.pow(c[d],2),u+=Math.pow(h[d],2);return f<u?-1:f>u?1:0}),r}var n={};function i(s){return n[s]||(n[s]=e(s)),n[s]}return Xt=i,Xt}var Yt,De;function ki(){if(De)return Yt;De=1;var a=rn().integer,e=sn(),n=on();function i(r,o){for(var l=0,c=0;c<r.length;c++)l+=Math.pow(r[c]-o[c],2);return l}function s(r,o){if(typeof r.distanceFunction=="function")throw new Error("PoissonDiskSampling: Tried to instantiate the fixed density implementation with a distanceFunction");this.shape=r.shape,this.minDistance=r.minDistance,this.maxDistance=r.maxDistance||r.minDistance*2,this.maxTries=Math.ceil(Math.max(1,r.tries||30)),this.rng=o||Math.random;for(var l=0,c=0;c<this.shape.length;c++)l=Math.max(l,this.shape[c]);var h=Math.max(1,l/128|0),f=1e-14*h;this.dimension=this.shape.length,this.squaredMinDistance=this.minDistance*this.minDistance,this.minDistancePlusEpsilon=this.minDistance+f,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.minDistance/Math.sqrt(this.dimension),this.neighbourhood=n(this.dimension),this.currentPoint=null,this.processList=[],this.samplePoints=[],this.gridShape=[];for(var c=0;c<this.dimension;c++)this.gridShape.push(Math.ceil(this.shape[c]/this.cellSize));this.grid=a(this.gridShape)}return s.prototype.shape=null,s.prototype.dimension=null,s.prototype.minDistance=null,s.prototype.maxDistance=null,s.prototype.minDistancePlusEpsilon=null,s.prototype.squaredMinDistance=null,s.prototype.deltaDistance=null,s.prototype.cellSize=null,s.prototype.maxTries=null,s.prototype.rng=null,s.prototype.neighbourhood=null,s.prototype.currentPoint=null,s.prototype.processList=null,s.prototype.samplePoints=null,s.prototype.gridShape=null,s.prototype.grid=null,s.prototype.addRandomPoint=function(){for(var r=new Array(this.dimension),o=0;o<this.dimension;o++)r[o]=this.rng()*this.shape[o];return this.directAddPoint(r)},s.prototype.addPoint=function(r){var o,l=!0;if(r.length===this.dimension)for(o=0;o<this.dimension&&l;o++)l=r[o]>=0&&r[o]<this.shape[o];else l=!1;return l?this.directAddPoint(r):null},s.prototype.directAddPoint=function(r){var o=0,l=this.grid.stride,c;for(this.processList.push(r),this.samplePoints.push(r),c=0;c<this.dimension;c++)o+=(r[c]/this.cellSize|0)*l[c];return this.grid.data[o]=this.samplePoints.length,r},s.prototype.inNeighbourhood=function(r){var o=this.dimension,l=this.grid.stride,c,h,f,u,d;for(c=0;c<this.neighbourhood.length;c++){for(h=0,f=0;f<o;f++){if(u=(r[f]/this.cellSize|0)+this.neighbourhood[c][f],u<0||u>=this.gridShape[f]){h=-1;break}h+=u*l[f]}if(h!==-1&&this.grid.data[h]!==0&&(d=this.samplePoints[this.grid.data[h]-1],i(r,d)<this.squaredMinDistance))return!0}return!1},s.prototype.next=function(){for(var r,o,l,c,h,f,u;this.processList.length>0;){for(this.currentPoint===null&&(this.currentPoint=this.processList.shift()),c=this.currentPoint,r=0;r<this.maxTries;r++){for(f=!0,l=this.minDistancePlusEpsilon+this.deltaDistance*this.rng(),this.dimension===2?(o=this.rng()*Math.PI*2,h=[Math.cos(o),Math.sin(o)]):h=e(this.dimension,this.rng),u=0;f&&u<this.dimension;u++)h[u]=c[u]+h[u]*l,f=h[u]>=0&&h[u]<this.shape[u];if(f&&!this.inNeighbourhood(h))return this.directAddPoint(h)}r===this.maxTries&&(this.currentPoint=null)}return null},s.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},s.prototype.getAllPoints=function(){return this.samplePoints},s.prototype.getAllPointsWithDistance=function(){throw new Error("PoissonDiskSampling: getAllPointsWithDistance() is not available in fixed-density implementation")},s.prototype.reset=function(){var r=this.grid.data,o=0;for(o=0;o<r.length;o++)r[o]=0;this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Yt=s,Yt}var Kt,Ae;function Si(){if(Ae)return Kt;Ae=1;var a=rn().array,e=sn(),n=on();function i(r,o){for(var l=0,c=0;c<r.length;c++)l+=Math.pow(r[c]-o[c],2);return Math.sqrt(l)}function s(r,o){if(typeof r.distanceFunction!="function")throw new Error("PoissonDiskSampling: Tried to instantiate the variable density implementation without a distanceFunction");this.shape=r.shape,this.minDistance=r.minDistance,this.maxDistance=r.maxDistance||r.minDistance*2,this.maxTries=Math.ceil(Math.max(1,r.tries||30)),this.distanceFunction=r.distanceFunction,this.bias=Math.max(0,Math.min(1,r.bias||0)),this.rng=o||Math.random;for(var l=0,c=0;c<this.shape.length;c++)l=Math.max(l,this.shape[c]);var h=Math.max(1,l/128|0),f=1e-14*h;this.dimension=this.shape.length,this.minDistancePlusEpsilon=this.minDistance+f,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.maxDistance/Math.sqrt(this.dimension),this.neighbourhood=n(this.dimension),this.currentPoint=null,this.currentDistance=0,this.processList=[],this.samplePoints=[],this.sampleDistance=[],this.gridShape=[];for(var c=0;c<this.dimension;c++)this.gridShape.push(Math.ceil(this.shape[c]/this.cellSize));this.grid=a(this.gridShape)}return s.prototype.shape=null,s.prototype.dimension=null,s.prototype.minDistance=null,s.prototype.maxDistance=null,s.prototype.minDistancePlusEpsilon=null,s.prototype.deltaDistance=null,s.prototype.cellSize=null,s.prototype.maxTries=null,s.prototype.distanceFunction=null,s.prototype.bias=null,s.prototype.rng=null,s.prototype.neighbourhood=null,s.prototype.currentPoint=null,s.prototype.currentDistance=null,s.prototype.processList=null,s.prototype.samplePoints=null,s.prototype.sampleDistance=null,s.prototype.gridShape=null,s.prototype.grid=null,s.prototype.addRandomPoint=function(){for(var r=new Array(this.dimension),o=0;o<this.dimension;o++)r[o]=this.rng()*this.shape[o];return this.directAddPoint(r)},s.prototype.addPoint=function(r){var o,l=!0;if(r.length===this.dimension)for(o=0;o<this.dimension&&l;o++)l=r[o]>=0&&r[o]<this.shape[o];else l=!1;return l?this.directAddPoint(r):null},s.prototype.directAddPoint=function(r){var o=0,l=this.grid.stride,c=this.samplePoints.length,h;for(this.processList.push(c),this.samplePoints.push(r),this.sampleDistance.push(this.distanceFunction(r)),h=0;h<this.dimension;h++)o+=(r[h]/this.cellSize|0)*l[h];return this.grid.data[o].push(c),r},s.prototype.inNeighbourhood=function(r){var o=this.dimension,l=this.grid.stride,c,h,f,u,d,p,m=this.distanceFunction(r);for(c=0;c<this.neighbourhood.length;c++){for(h=0,f=0;f<o;f++){if(u=(r[f]/this.cellSize|0)+this.neighbourhood[c][f],u<0||u>=this.gridShape[f]){h=-1;break}h+=u*l[f]}if(h!==-1&&this.grid.data[h].length>0)for(var g=0;g<this.grid.data[h].length;g++){d=this.samplePoints[this.grid.data[h][g]],p=this.sampleDistance[this.grid.data[h][g]];var x=Math.min(p,m),y=Math.max(p,m),v=x+(y-x)*this.bias;if(i(r,d)<this.minDistance+this.deltaDistance*v)return!0}}return!1},s.prototype.next=function(){for(var r,o,l,c,h,f,u,d;this.processList.length>0;){if(this.currentPoint===null){var p=this.processList.shift();this.currentPoint=this.samplePoints[p],this.currentDistance=this.sampleDistance[p]}for(c=this.currentPoint,h=this.currentDistance,r=0;r<this.maxTries;r++){for(u=!0,l=this.minDistancePlusEpsilon+this.deltaDistance*(h+(1-h)*this.bias),this.dimension===2?(o=this.rng()*Math.PI*2,f=[Math.cos(o),Math.sin(o)]):f=e(this.dimension,this.rng),d=0;u&&d<this.dimension;d++)f[d]=c[d]+f[d]*l,u=f[d]>=0&&f[d]<this.shape[d];if(u&&!this.inNeighbourhood(f))return this.directAddPoint(f)}r===this.maxTries&&(this.currentPoint=null)}return null},s.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},s.prototype.getAllPoints=function(){return this.samplePoints},s.prototype.getAllPointsWithDistance=function(){var r=new Array(this.samplePoints.length),o=0,l=0,c;for(o=0;o<this.samplePoints.length;o++){for(c=new Array(this.dimension+1),l=0;l<this.dimension;l++)c[l]=this.samplePoints[o][l];c[this.dimension]=this.sampleDistance[o],r[o]=c}return r},s.prototype.reset=function(){var r=this.grid.data,o=0;for(o=0;o<r.length;o++)r[o]=[];this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Kt=s,Kt}var Qt,Re;function Di(){if(Re)return Qt;Re=1;var a=ki(),e=Si();function n(i,s){this.shape=i.shape,typeof i.distanceFunction=="function"?this.implementation=new e(i,s):this.implementation=new a(i,s)}return n.prototype.implementation=null,n.prototype.addRandomPoint=function(){return this.implementation.addRandomPoint()},n.prototype.addPoint=function(i){return this.implementation.addPoint(i)},n.prototype.next=function(){return this.implementation.next()},n.prototype.fill=function(){return this.implementation.fill()},n.prototype.getAllPoints=function(){return this.implementation.getAllPoints()},n.prototype.getAllPointsWithDistance=function(){return this.implementation.getAllPointsWithDistance()},n.prototype.reset=function(){this.implementation.reset()},Qt=n,Qt}var Ai=Di();const Ri=je(Ai),ce="PoissonPointGenerator",$i={name:ce,displayName:"Poisson",description:"Generate seed points using Poisson disk sampling. The algorithm produces points that are tightly-packed, but no closer to each other than a specified minimum distance (the piece size), resulting in a natural, organic look.",sortHint:1,controls:[]},Li=(a,e,n)=>({generatePoints(s){const{width:r,height:o,pieceSize:l,random:c,border:h}=s;return new Ri({shape:[r,o],minDistance:l,tries:20},c).fill().filter(p=>le(p,h))}});xt.register(ce,Li,$i);const Y=11102230246251565e-32,U=134217729,Ni=(3+8*Y)*Y;function Jt(a,e,n,i,s){let r,o,l,c,h=e[0],f=i[0],u=0,d=0;f>h==f>-h?(r=h,h=e[++u]):(r=f,f=i[++d]);let p=0;if(u<a&&d<n)for(f>h==f>-h?(o=h+r,l=r-(o-h),h=e[++u]):(o=f+r,l=r-(o-f),f=i[++d]),r=o,l!==0&&(s[p++]=l);u<a&&d<n;)f>h==f>-h?(o=r+h,c=o-r,l=r-(o-c)+(h-c),h=e[++u]):(o=r+f,c=o-r,l=r-(o-c)+(f-c),f=i[++d]),r=o,l!==0&&(s[p++]=l);for(;u<a;)o=r+h,c=o-r,l=r-(o-c)+(h-c),h=e[++u],r=o,l!==0&&(s[p++]=l);for(;d<n;)o=r+f,c=o-r,l=r-(o-c)+(f-c),f=i[++d],r=o,l!==0&&(s[p++]=l);return(r!==0||p===0)&&(s[p++]=r),p}function Gi(a,e){let n=e[0];for(let i=1;i<a;i++)n+=e[i];return n}function _t(a){return new Float64Array(a)}const Oi=(3+16*Y)*Y,Fi=(2+12*Y)*Y,Ui=(9+64*Y)*Y*Y,rt=_t(4),$e=_t(8),Le=_t(12),Ne=_t(16),q=_t(4);function ji(a,e,n,i,s,r,o){let l,c,h,f,u,d,p,m,g,x,y,v,_,I,b,C,M,P;const w=a-s,T=n-s,k=e-r,S=i-r;I=w*S,d=U*w,p=d-(d-w),m=w-p,d=U*S,g=d-(d-S),x=S-g,b=m*x-(I-p*g-m*g-p*x),C=k*T,d=U*k,p=d-(d-k),m=k-p,d=U*T,g=d-(d-T),x=T-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,rt[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,rt[1]=_-(y+u)+(u-C),P=v+y,u=P-v,rt[2]=v-(P-u)+(y-u),rt[3]=P;let D=Gi(4,rt),R=Fi*o;if(D>=R||-D>=R||(u=a-w,l=a-(w+u)+(u-s),u=n-T,h=n-(T+u)+(u-s),u=e-k,c=e-(k+u)+(u-r),u=i-S,f=i-(S+u)+(u-r),l===0&&c===0&&h===0&&f===0)||(R=Ui*o+Ni*Math.abs(D),D+=w*f+S*l-(k*h+T*c),D>=R||-D>=R))return D;I=l*S,d=U*l,p=d-(d-l),m=l-p,d=U*S,g=d-(d-S),x=S-g,b=m*x-(I-p*g-m*g-p*x),C=c*T,d=U*c,p=d-(d-c),m=c-p,d=U*T,g=d-(d-T),x=T-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,q[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,q[1]=_-(y+u)+(u-C),P=v+y,u=P-v,q[2]=v-(P-u)+(y-u),q[3]=P;const $=Jt(4,rt,4,q,$e);I=w*f,d=U*w,p=d-(d-w),m=w-p,d=U*f,g=d-(d-f),x=f-g,b=m*x-(I-p*g-m*g-p*x),C=k*h,d=U*k,p=d-(d-k),m=k-p,d=U*h,g=d-(d-h),x=h-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,q[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,q[1]=_-(y+u)+(u-C),P=v+y,u=P-v,q[2]=v-(P-u)+(y-u),q[3]=P;const A=Jt($,$e,4,q,Le);I=l*f,d=U*l,p=d-(d-l),m=l-p,d=U*f,g=d-(d-f),x=f-g,b=m*x-(I-p*g-m*g-p*x),C=c*h,d=U*c,p=d-(d-c),m=c-p,d=U*h,g=d-(d-h),x=h-g,M=m*x-(C-p*g-m*g-p*x),y=b-M,u=b-y,q[0]=b-(y+u)+(u-M),v=I+y,u=v-I,_=I-(v-u)+(y-u),y=_-C,u=_-y,q[1]=_-(y+u)+(u-C),P=v+y,u=P-v,q[2]=v-(P-u)+(y-u),q[3]=P;const L=Jt(A,Le,4,q,Ne);return Ne[L-1]}function Ct(a,e,n,i,s,r){const o=(e-r)*(n-s),l=(a-s)*(i-r),c=o-l,h=Math.abs(o+l);return Math.abs(c)>=Oi*h?c:-ji(a,e,n,i,s,r,h)}const Ge=Math.pow(2,-52),It=new Uint32Array(512);class At{static from(e,n=Bi,i=Xi){const s=e.length,r=new Float64Array(s*2);for(let o=0;o<s;o++){const l=e[o];r[2*o]=n(l),r[2*o+1]=i(l)}return new At(r)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:i,_hullTri:s,_hullHash:r}=this,o=e.length>>1;let l=1/0,c=1/0,h=-1/0,f=-1/0;for(let w=0;w<o;w++){const T=e[2*w],k=e[2*w+1];T<l&&(l=T),k<c&&(c=k),T>h&&(h=T),k>f&&(f=k),this._ids[w]=w}const u=(l+h)/2,d=(c+f)/2;let p,m,g;for(let w=0,T=1/0;w<o;w++){const k=Zt(u,d,e[2*w],e[2*w+1]);k<T&&(p=w,T=k)}const x=e[2*p],y=e[2*p+1];for(let w=0,T=1/0;w<o;w++){if(w===p)continue;const k=Zt(x,y,e[2*w],e[2*w+1]);k<T&&k>0&&(m=w,T=k)}let v=e[2*m],_=e[2*m+1],I=1/0;for(let w=0;w<o;w++){if(w===p||w===m)continue;const T=Hi(x,y,v,_,e[2*w],e[2*w+1]);T<I&&(g=w,I=T)}let b=e[2*g],C=e[2*g+1];if(I===1/0){for(let k=0;k<o;k++)this._dists[k]=e[2*k]-e[0]||e[2*k+1]-e[1];ot(this._ids,this._dists,0,o-1);const w=new Uint32Array(o);let T=0;for(let k=0,S=-1/0;k<o;k++){const D=this._ids[k],R=this._dists[D];R>S&&(w[T++]=D,S=R)}this.hull=w.subarray(0,T),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Ct(x,y,v,_,b,C)<0){const w=m,T=v,k=_;m=g,v=b,_=C,g=w,b=T,C=k}const M=Wi(x,y,v,_,b,C);this._cx=M.x,this._cy=M.y;for(let w=0;w<o;w++)this._dists[w]=Zt(e[2*w],e[2*w+1],M.x,M.y);ot(this._ids,this._dists,0,o-1),this._hullStart=p;let P=3;i[p]=n[g]=m,i[m]=n[p]=g,i[g]=n[m]=p,s[p]=0,s[m]=1,s[g]=2,r.fill(-1),r[this._hashKey(x,y)]=p,r[this._hashKey(v,_)]=m,r[this._hashKey(b,C)]=g,this.trianglesLen=0,this._addTriangle(p,m,g,-1,-1,-1);for(let w=0,T,k;w<this._ids.length;w++){const S=this._ids[w],D=e[2*S],R=e[2*S+1];if(w>0&&Math.abs(D-T)<=Ge&&Math.abs(R-k)<=Ge||(T=D,k=R,S===p||S===m||S===g))continue;let $=0;for(let H=0,lt=this._hashKey(D,R);H<this._hashSize&&($=r[(lt+H)%this._hashSize],!($!==-1&&$!==i[$]));H++);$=n[$];let A=$,L;for(;L=i[A],Ct(D,R,e[2*A],e[2*A+1],e[2*L],e[2*L+1])>=0;)if(A=L,A===$){A=-1;break}if(A===-1)continue;let O=this._addTriangle(A,S,i[A],-1,-1,s[A]);s[S]=this._legalize(O+2),s[A]=O,P++;let G=i[A];for(;L=i[G],Ct(D,R,e[2*G],e[2*G+1],e[2*L],e[2*L+1])<0;)O=this._addTriangle(G,S,L,s[S],-1,s[G]),s[S]=this._legalize(O+2),i[G]=G,P--,G=L;if(A===$)for(;L=n[A],Ct(D,R,e[2*L],e[2*L+1],e[2*A],e[2*A+1])<0;)O=this._addTriangle(L,S,A,-1,s[A],s[L]),this._legalize(O+2),s[L]=O,i[A]=A,P--,A=L;this._hullStart=n[S]=A,i[A]=n[G]=S,i[S]=G,r[this._hashKey(D,R)]=S,r[this._hashKey(e[2*A],e[2*A+1])]=A}this.hull=new Uint32Array(P);for(let w=0,T=this._hullStart;w<P;w++)this.hull[w]=T,T=i[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(qi(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:i,coords:s}=this;let r=0,o=0;for(;;){const l=i[e],c=e-e%3;if(o=c+(e+2)%3,l===-1){if(r===0)break;e=It[--r];continue}const h=l-l%3,f=c+(e+1)%3,u=h+(l+2)%3,d=n[o],p=n[e],m=n[f],g=n[u];if(Vi(s[2*d],s[2*d+1],s[2*p],s[2*p+1],s[2*m],s[2*m+1],s[2*g],s[2*g+1])){n[e]=g,n[l]=d;const y=i[u];if(y===-1){let _=this._hullStart;do{if(this._hullTri[_]===u){this._hullTri[_]=e;break}_=this._hullPrev[_]}while(_!==this._hullStart)}this._link(e,y),this._link(l,i[o]),this._link(o,u);const v=h+(l+1)%3;r<It.length&&(It[r++]=v)}else{if(r===0)break;e=It[--r]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,i,s,r,o){const l=this.trianglesLen;return this._triangles[l]=e,this._triangles[l+1]=n,this._triangles[l+2]=i,this._link(l,s),this._link(l+1,r),this._link(l+2,o),this.trianglesLen+=3,l}}function qi(a,e){const n=a/(Math.abs(a)+Math.abs(e));return(e>0?3-n:1+n)/4}function Zt(a,e,n,i){const s=a-n,r=e-i;return s*s+r*r}function Vi(a,e,n,i,s,r,o,l){const c=a-o,h=e-l,f=n-o,u=i-l,d=s-o,p=r-l,m=c*c+h*h,g=f*f+u*u,x=d*d+p*p;return c*(u*x-g*p)-h*(f*x-g*d)+m*(f*p-u*d)<0}function Hi(a,e,n,i,s,r){const o=n-a,l=i-e,c=s-a,h=r-e,f=o*o+l*l,u=c*c+h*h,d=.5/(o*h-l*c),p=(h*f-l*u)*d,m=(o*u-c*f)*d;return p*p+m*m}function Wi(a,e,n,i,s,r){const o=n-a,l=i-e,c=s-a,h=r-e,f=o*o+l*l,u=c*c+h*h,d=.5/(o*h-l*c),p=a+(h*f-l*u)*d,m=e+(o*u-c*f)*d;return{x:p,y:m}}function ot(a,e,n,i){if(i-n<=20)for(let s=n+1;s<=i;s++){const r=a[s],o=e[r];let l=s-1;for(;l>=n&&e[a[l]]>o;)a[l+1]=a[l--];a[l+1]=r}else{const s=n+i>>1;let r=n+1,o=i;gt(a,s,r),e[a[n]]>e[a[i]]&&gt(a,n,i),e[a[r]]>e[a[i]]&&gt(a,r,i),e[a[n]]>e[a[r]]&&gt(a,n,r);const l=a[r],c=e[l];for(;;){do r++;while(e[a[r]]<c);do o--;while(e[a[o]]>c);if(o<r)break;gt(a,r,o)}a[n+1]=a[o],a[o]=l,i-r+1>=o-n?(ot(a,e,r,i),ot(a,e,n,o-1)):(ot(a,e,n,o-1),ot(a,e,r,i))}}function gt(a,e,n){const i=a[e];a[e]=a[n],a[n]=i}function Bi(a){return a[0]}function Xi(a){return a[1]}const Oe=1e-6;class tt{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,i){e=+e,n=+n,i=+i;const s=e+i,r=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${r}`:(Math.abs(this._x1-s)>Oe||Math.abs(this._y1-r)>Oe)&&(this._+="L"+s+","+r),i&&(this._+=`A${i},${i},0,1,1,${e-i},${n}A${i},${i},0,1,1,${this._x1=s},${this._y1=r}`)}rect(e,n,i,s){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+i}v${+s}h${-i}Z`}value(){return this._||null}}class oe{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class Yi{constructor(e,[n,i,s,r]=[0,0,960,500]){if(!((s=+s)>=(n=+n))||!((r=+r)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=s,this.xmin=n,this.ymax=r,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:i},vectors:s}=this;let r,o;const l=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,x=0,y=i.length,v,_;g<y;g+=3,x+=2){const I=i[g]*2,b=i[g+1]*2,C=i[g+2]*2,M=e[I],P=e[I+1],w=e[b],T=e[b+1],k=e[C],S=e[C+1],D=w-M,R=T-P,$=k-M,A=S-P,L=(D*A-R*$)*2;if(Math.abs(L)<1e-9){if(r===void 0){r=o=0;for(const G of n)r+=e[G*2],o+=e[G*2+1];r/=n.length,o/=n.length}const O=1e9*Math.sign((r-M)*A-(o-P)*$);v=(M+k)/2-O*A,_=(P+S)/2+O*$}else{const O=1/L,G=D*D+R*R,H=$*$+A*A;v=M+(A*G-R*H)*O,_=P+(D*H-$*G)*O}l[x]=v,l[x+1]=_}let c=n[n.length-1],h,f=c*4,u,d=e[2*c],p,m=e[2*c+1];s.fill(0);for(let g=0;g<n.length;++g)c=n[g],h=f,u=d,p=m,f=c*4,d=e[2*c],m=e[2*c+1],s[h+2]=s[f]=p-m,s[h+3]=s[f+1]=d-u}render(e){const n=e==null?e=new tt:void 0,{delaunay:{halfedges:i,inedges:s,hull:r},circumcenters:o,vectors:l}=this;if(r.length<=1)return null;for(let f=0,u=i.length;f<u;++f){const d=i[f];if(d<f)continue;const p=Math.floor(f/3)*2,m=Math.floor(d/3)*2,g=o[p],x=o[p+1],y=o[m],v=o[m+1];this._renderSegment(g,x,y,v,e)}let c,h=r[r.length-1];for(let f=0;f<r.length;++f){c=h,h=r[f];const u=Math.floor(s[h]/3)*2,d=o[u],p=o[u+1],m=c*4,g=this._project(d,p,l[m+2],l[m+3]);g&&this._renderSegment(d,p,g[0],g[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new tt:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const i=n==null?n=new tt:void 0,s=this._clip(e);if(s===null||!s.length)return;n.moveTo(s[0],s[1]);let r=s.length;for(;s[0]===s[r-2]&&s[1]===s[r-1]&&r>1;)r-=2;for(let o=2;o<r;o+=2)(s[o]!==s[o-2]||s[o+1]!==s[o-1])&&n.lineTo(s[o],s[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,i=e.length/2;n<i;++n){const s=this.cellPolygon(n);s&&(s.index=n,yield s)}}cellPolygon(e){const n=new oe;return this.renderCell(e,n),n.value()}_renderSegment(e,n,i,s,r){let o;const l=this._regioncode(e,n),c=this._regioncode(i,s);l===0&&c===0?(r.moveTo(e,n),r.lineTo(i,s)):(o=this._clipSegment(e,n,i,s,l,c))&&(r.moveTo(o[0],o[1]),r.lineTo(o[2],o[3]))}contains(e,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(e,n,i)===e}*neighbors(e){const n=this._clip(e);if(n)for(const i of this.delaunay.neighbors(e)){const s=this._clip(i);if(s){t:for(let r=0,o=n.length;r<o;r+=2)for(let l=0,c=s.length;l<c;l+=2)if(n[r]===s[l]&&n[r+1]===s[l+1]&&n[(r+2)%o]===s[(l+c-2)%c]&&n[(r+3)%o]===s[(l+c-1)%c]){yield i;break t}}}}_cell(e){const{circumcenters:n,delaunay:{inedges:i,halfedges:s,triangles:r}}=this,o=i[e];if(o===-1)return null;const l=[];let c=o;do{const h=Math.floor(c/3);if(l.push(n[h*2],n[h*2+1]),c=c%3===2?c-2:c+1,r[c]!==e)break;c=s[c]}while(c!==o&&c!==-1);return l}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:i}=this,s=e*4;return this._simplify(i[s]||i[s+1]?this._clipInfinite(e,n,i[s],i[s+1],i[s+2],i[s+3]):this._clipFinite(e,n))}_clipFinite(e,n){const i=n.length;let s=null,r,o,l=n[i-2],c=n[i-1],h,f=this._regioncode(l,c),u,d=0;for(let p=0;p<i;p+=2)if(r=l,o=c,l=n[p],c=n[p+1],h=f,f=this._regioncode(l,c),h===0&&f===0)u=d,d=0,s?s.push(l,c):s=[l,c];else{let m,g,x,y,v;if(h===0){if((m=this._clipSegment(r,o,l,c,h,f))===null)continue;[g,x,y,v]=m}else{if((m=this._clipSegment(l,c,r,o,f,h))===null)continue;[y,v,g,x]=m,u=d,d=this._edgecode(g,x),u&&d&&this._edge(e,u,d,s,s.length),s?s.push(g,x):s=[g,x]}u=d,d=this._edgecode(y,v),u&&d&&this._edge(e,u,d,s,s.length),s?s.push(y,v):s=[y,v]}if(s)u=d,d=this._edgecode(s[0],s[1]),u&&d&&this._edge(e,u,d,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(e,n,i,s,r,o){const l=r<o;for(l&&([e,n,i,s,r,o]=[i,s,e,n,o,r]);;){if(r===0&&o===0)return l?[i,s,e,n]:[e,n,i,s];if(r&o)return null;let c,h,f=r||o;f&8?(c=e+(i-e)*(this.ymax-n)/(s-n),h=this.ymax):f&4?(c=e+(i-e)*(this.ymin-n)/(s-n),h=this.ymin):f&2?(h=n+(s-n)*(this.xmax-e)/(i-e),c=this.xmax):(h=n+(s-n)*(this.xmin-e)/(i-e),c=this.xmin),r?(e=c,n=h,r=this._regioncode(e,n)):(i=c,s=h,o=this._regioncode(i,s))}}_clipInfinite(e,n,i,s,r,o){let l=Array.from(n),c;if((c=this._project(l[0],l[1],i,s))&&l.unshift(c[0],c[1]),(c=this._project(l[l.length-2],l[l.length-1],r,o))&&l.push(c[0],c[1]),l=this._clipFinite(e,l))for(let h=0,f=l.length,u,d=this._edgecode(l[f-2],l[f-1]);h<f;h+=2)u=d,d=this._edgecode(l[h],l[h+1]),u&&d&&(h=this._edge(e,u,d,l,h),f=l.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(e,n,i,s,r){for(;n!==i;){let o,l;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,l=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,l=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,l=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,l=this.ymin;break}(s[r]!==o||s[r+1]!==l)&&this.contains(e,o,l)&&(s.splice(r,0,o,l),r+=2)}return r}_project(e,n,i,s){let r=1/0,o,l,c;if(s<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/s)<r&&(c=this.ymin,l=e+(r=o)*i)}else if(s>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/s)<r&&(c=this.ymax,l=e+(r=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<r&&(l=this.xmax,c=n+(r=o)*s)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<r&&(l=this.xmin,c=n+(r=o)*s)}return[l,c]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let n=0;n<e.length;n+=2){const i=(n+2)%e.length,s=(n+4)%e.length;(e[n]===e[i]&&e[i]===e[s]||e[n+1]===e[i+1]&&e[i+1]===e[s+1])&&(e.splice(i,2),n-=2)}e.length||(e=null)}return e}}const Ki=2*Math.PI,st=Math.pow;function Qi(a){return a[0]}function Ji(a){return a[1]}function Zi(a){const{triangles:e,coords:n}=a;for(let i=0;i<e.length;i+=3){const s=2*e[i],r=2*e[i+1],o=2*e[i+2];if((n[o]-n[s])*(n[r+1]-n[s+1])-(n[r]-n[s])*(n[o+1]-n[s+1])>1e-10)return!1}return!0}function tr(a,e,n){return[a+Math.sin(a+e)*n,e+Math.cos(a-e)*n]}class he{static from(e,n=Qi,i=Ji,s){return new he("length"in e?er(e,n,i,s):Float64Array.from(nr(e,n,i,s)))}constructor(e){this._delaunator=new At(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&Zi(e)){this.collinear=Int32Array.from({length:n.length/2},(d,p)=>p).sort((d,p)=>n[2*d]-n[2*p]||n[2*d+1]-n[2*p+1]);const c=this.collinear[0],h=this.collinear[this.collinear.length-1],f=[n[2*c],n[2*c+1],n[2*h],n[2*h+1]],u=1e-8*Math.hypot(f[3]-f[1],f[2]-f[0]);for(let d=0,p=n.length/2;d<p;++d){const m=tr(n[2*d],n[2*d+1],u);n[2*d]=m[0],n[2*d+1]=m[1]}this._delaunator=new At(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let c=0,h=i.length;c<h;++c){const f=r[c%3===2?c-2:c+1];(i[c]===-1||o[f]===-1)&&(o[f]=c)}for(let c=0,h=s.length;c<h;++c)l[s[c]]=c;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],o[s[0]]=1,s.length===2&&(o[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]))}voronoi(e){return new Yi(this,e)}*neighbors(e){const{inedges:n,hull:i,_hullIndex:s,halfedges:r,triangles:o,collinear:l}=this;if(l){const u=l.indexOf(e);u>0&&(yield l[u-1]),u<l.length-1&&(yield l[u+1]);return}const c=n[e];if(c===-1)return;let h=c,f=-1;do{if(yield f=o[h],h=h%3===2?h-2:h+1,o[h]!==e)return;if(h=r[h],h===-1){const u=i[(s[e]+1)%i.length];u!==f&&(yield u);return}}while(h!==c)}find(e,n,i=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const s=i;let r;for(;(r=this._step(i,e,n))>=0&&r!==i&&r!==s;)i=r;return r}_step(e,n,i){const{inedges:s,hull:r,_hullIndex:o,halfedges:l,triangles:c,points:h}=this;if(s[e]===-1||!h.length)return(e+1)%(h.length>>1);let f=e,u=st(n-h[e*2],2)+st(i-h[e*2+1],2);const d=s[e];let p=d;do{let m=c[p];const g=st(n-h[m*2],2)+st(i-h[m*2+1],2);if(g<u&&(u=g,f=m),p=p%3===2?p-2:p+1,c[p]!==e)break;if(p=l[p],p===-1){if(p=r[(o[e]+1)%r.length],p!==m&&st(n-h[p*2],2)+st(i-h[p*2+1],2)<u)return p;break}}while(p!==d);return f}render(e){const n=e==null?e=new tt:void 0,{points:i,halfedges:s,triangles:r}=this;for(let o=0,l=s.length;o<l;++o){const c=s[o];if(c<o)continue;const h=r[o]*2,f=r[c]*2;e.moveTo(i[h],i[h+1]),e.lineTo(i[f],i[f+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n){n===void 0&&(!e||typeof e.moveTo!="function")&&(n=e,e=null),n=n==null?2:+n;const i=e==null?e=new tt:void 0,{points:s}=this;for(let r=0,o=s.length;r<o;r+=2){const l=s[r],c=s[r+1];e.moveTo(l+n,c),e.arc(l,c,n,0,Ki)}return i&&i.value()}renderHull(e){const n=e==null?e=new tt:void 0,{hull:i,points:s}=this,r=i[0]*2,o=i.length;e.moveTo(s[r],s[r+1]);for(let l=1;l<o;++l){const c=2*i[l];e.lineTo(s[c],s[c+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new oe;return this.renderHull(e),e.value()}renderTriangle(e,n){const i=n==null?n=new tt:void 0,{points:s,triangles:r}=this,o=r[e*=3]*2,l=r[e+1]*2,c=r[e+2]*2;return n.moveTo(s[o],s[o+1]),n.lineTo(s[l],s[l+1]),n.lineTo(s[c],s[c+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,i=e.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new oe;return this.renderTriangle(e,n),n.value()}}function er(a,e,n,i){const s=a.length,r=new Float64Array(s*2);for(let o=0;o<s;++o){const l=a[o];r[o*2]=e.call(i,l,o,a),r[o*2+1]=n.call(i,l,o,a)}return r}function*nr(a,e,n,i){let s=0;for(const r of a)yield e.call(i,r,s,a),yield n.call(i,r,s,a),++s}function an(a){return{originalBorder:a,flattenedPolygon:Ze(a)[0]}}function ir(a){if(a.length===0)return[0,0];const e=a.reduce((n,i)=>[n[0]+i[0],n[1]+i[1]],[0,0]);return[e[0]/a.length,e[1]/a.length]}function ln(a,e,n){const i={id:a,site:ir(e),halfEdge:-1,bounds:re(e)},s=hi(e,a,n);return s.length>0&&(i.halfEdge=s[0].id),i}function cn(a,e){const i=a.map(r=>le(r,e.originalBorder)).filter(Boolean).length;return i===0?null:i===a.length?a:li(a,e.flattenedPolygon)?.[0]??null}const ue="VoronoiPieceGenerator",rr={name:ue,displayName:"Voronoi",description:"Construct pieces by building a Voronoi diagram from the seed points. Each piece consists of all area of the plane closer to its seed point than any other seed point. In practice, this creates irregular polygons with 3-8 sides.",sortHint:1,controls:[]};function sr(a){return`${a[0].toPrecision(7)},${a[1].toPrecision(7)}`}function Fe(a,e){const i=e.flattenedPolygon;for(let s=0;s<i.length;s++){const r=i[s],o=i[(s+1)%i.length];if(or(a,r,o)<.001)return!0}return!1}function or(a,e,n){const[i,s]=a,[r,o]=e,[l,c]=n,h=l-r,f=c-o,u=h*h+f*f;if(u===0)return Math.hypot(i-r,s-o);let d=((i-r)*h+(s-o)*f)/u;d=Math.max(0,Math.min(1,d));const p=r+d*h,m=o+d*f;return Math.hypot(i-p,s-m)}const ar=(a,e,n)=>{const{width:i,height:s}=e,r=an(a);return{generatePieces(l,c){const{border:h}=c;console.log(`VoronoiPieceGenerator using dimensions ${i}x${s}`);const u=he.from(l).voronoi([0,0,i,s]),d={vertices:[],pieces:new Map,edges:new Map,halfEdges:new Map,boundary:[],borderPath:h},p=new Map;let m=0;for(let x=0;x<l.length;x++){const y=l[x],v=u.cellPolygon(x);if(!v)continue;const _=cn(v,r);if(!_)continue;const I=m++,b=ln(I,_,d);b.site=y,d.pieces.set(I,b);const C=[];let M=b.halfEdge;if(M!==-1){const P=M;do{const w=d.halfEdges.get(M);C.push(w),M=w.next}while(M!==P)}tn(C,d,p,(P,w)=>Fe(P,r)&&Fe(w,r))}const g=new Map;for(const x of d.halfEdges.values()){const y=sr(x.origin);g.has(y)||g.set(y,x.origin)}return d.vertices=Array.from(g.values()),d}}};vt.register(ue,ar,rr);const Rt="SimpleTabPlacementStrategy",lr={name:Rt,displayName:"Simple",description:"Creates a single tab in the center of each edge with a random orientation.",sortHint:1,controls:[{type:"range",name:"tabSize",label:"Tab Size",optional:!0,min:.01,max:1,step:.01,defaultValue:.5,helpText:"The width of the tab as a fraction of the edge length"},{type:"number",name:"minEdgeLength",label:"Minimum Edge Length",optional:!0,defaultValue:15,helpText:"Edges shorter than this value will not have a tab"},{type:"number",name:"maxTabSize",label:"Maximum Tab Size",helpText:"Maximum width of a generated tab"}]};function Ue(a,e,n,i){if(a.tabs=void 0,!(a.heRight!==-1))return;const r=e.halfEdges.get(a.heLeft),o=e.halfEdges.get(a.heRight);if(!r||!o)return;const l=r.origin,c=o.origin,h=Math.hypot(c[0]-l[0],c[1]-l[1]);if(h>=n.minEdgeLength){let f=n.tabSize;n.maxTabSize&&h*f>n.maxTabSize&&(f=n.maxTabSize/h);const u={position:.5,size:f,convex:i()>.5};a.tabs=[u]}}const cr=(a,e,n)=>{const{tabSize:i=.5,minEdgeLength:s=0,maxTabSize:r}=n,o={tabSize:i,minEdgeLength:s,maxTabSize:r};return{placeTabs(l){const{topology:c,random:h}=l;for(const f of c.edges.values())Ue(f,c,o,h)},updateTabPlacements(l,c){const{topology:h,random:f}=c;for(const u of l)Ue(u,h,o,f)}}};bt.register(Rt,cr,lr);const fe="TraditionalTabGenerator",hr={name:fe,displayName:"Traditional",description:"Creates a traditional rounded tab for each (internal) piece edge.",sortHint:1,controls:[{type:"range",name:"jitter",label:"Randomness",defaultValue:8,min:0,max:100,step:1,helpText:"Adds randomness to the tab shape. 0 means completely uniform tabs"},{type:"range",name:"heightToWidthRatio",label:"Tab Height",defaultValue:50,min:5,max:100,step:5,helpText:"The height of the tab as a percent of its width"}]};function ur(a,e,n,i,s,r=!1){const o=e[0]-a[0],l=e[1]-a[1],c=Math.hypot(o,l);if(c===0)return console.warn("Edge has zero length"),[];const h=[o/c,l/c],f=[-h[1],h[0]],u=(S,D)=>[a[0]+(h[0]*S+f[0]*D)*c,a[1]+(h[1]*S+f[1]*D)*c],d=n/100,p=()=>(s()*2-1)*d,m=p(),g=p(),x=p(),y=p(),v=p(),_=.1625,I=r?-1:1,b=i,C=b/3,P=[[0,0],[.2,m*C],[.5+g+y,I*(-C+x*b)],[.5-_+g,I*(C+x*b)],[.5-2*_+g-y,I*(b+x*b)],[.5+2*_+g-y,I*(b+x*b)],[.5+_+g,I*(C+x*b)],[.5+g+y,I*(-C+x*b)],[.8,v*C],[1,0]].map(([S,D])=>u(S,D)),w={type:"bezier",p1:P[1],p2:P[2],p3:P[3]},T={type:"bezier",p1:P[4],p2:P[5],p3:P[6]},k={type:"bezier",p1:P[7],p2:P[8],p3:P[9]};return[w,T,k]}const fr=(a,e,n)=>{const{jitter:i=8,heightToWidthRatio:s=50}=n;return{createTabSegments(o,l,c,h){const f=!c.convex;return ur(o,l,i,s/100,h,f)}}};et.register(fe,fr,hr);function dr(a){return new Worker("/puzzle-generator/assets/CheckGeometryWorker-oLMqduM_.js",{name:a?.name})}function pr(a,e){return new Promise((n,i)=>{const s=new dr;s.onmessage=o=>{const l=o.data;switch(l.type){case"progress":e?.(l.processed,l.total);break;case"done":n(l.results),s.terminate();break;case"error":i(new Error(l.message)),s.terminate();break}},s.onerror=o=>{i(new Error(o.message)),s.terminate()};const r={topology:ei(a)};s.postMessage(r)})}const hn="GridJitterPointGenerator",gr={name:hn,displayName:"Grid",description:"Generate seed points using a grid with optional random jitter. Has a uniform, regular look, especially with low randomness values.",sortHint:2,controls:[{type:"range",name:"jitter",label:"Randomness",min:0,max:100,step:5,defaultValue:50,helpText:"Amount of jitter to apply to each grid point (0 to 100%)"}]},mr=(a,e,n)=>{const{jitter:i=50}=n;return{generatePoints(r){const{width:o,height:l,pieceSize:c,random:h,border:f}=r,u=[];for(let d=0;d<o;d+=c)for(let p=0;p<l;p+=c){const m=[d+c/2,p+c/2];i>0&&(m[0]+=(h()-.5)*(i/100)*c,m[1]+=(h()-.5)*(i/100)*c),le(m,f)&&u.push(m)}return u}}};xt.register(hn,mr,gr);const un="RectangularPieceGenerator",yr={name:un,displayName:"Rectangular",description:"Construct pieces from a regular grid. All pieces have 4 sides and are the same size (except when the border is irregular). This generator ignores seed points.",sortHint:2,controls:[]},xr=(a,e,n)=>{const{width:i,height:s}=e,r=an(a);return{generatePieces(l,c){const{pieceSize:h,border:f}=c,u={vertices:[],pieces:new Map,edges:new Map,halfEdges:new Map,boundary:[],borderPath:f},d=Math.ceil(i/h),p=Math.ceil(s/h),m=Math.round(i/d),g=Math.round(s/p),x=[];for(let v=0;v<=p;v++){const _=[];for(let I=0;I<=d;I++){const b=I*m,C=v*g;_.push([b,C])}x.push(_)}u.vertices=x.flat();const y=new Map;for(let v=0;v<p;v++)for(let _=0;_<d;_++){const I=v*d+_,b=x[v][_],C=x[v][_+1],M=x[v+1][_],P=x[v+1][_+1],T=cn([b,C,P,M],r);if(!T)continue;const k=ln(I,T,u);u.pieces.set(I,k);const S=[];let D=k.halfEdge;if(D!==-1){const R=D;do{const $=u.halfEdges.get(D);S.push($),D=$.next}while(D!==R)}tn(S,u,y,(R,$)=>{const A=(lt,Nt)=>Math.abs(lt-Nt)<1e-6,L=A(R[1],b[1])&&A($[1],b[1]),O=A(R[0],C[0])&&A($[0],C[0]),G=A(R[1],M[1])&&A($[1],M[1]),H=A(R[0],b[0])&&A($[0],b[0]);return!(L||O||G||H)})}return u}}};vt.register(un,xr,yr);const fn="NullTabGenerator",vr={name:fn,displayName:"None",description:"Do not generate tabs. All pieces have straight edges.",sortHint:3,controls:[]},br=(a,e,n)=>({createTabSegments(s,r,o,l){return[]}});et.register(fn,br,vr);const dn="TriangleTabGenerator",wr={name:dn,displayName:"Triangle",description:"Creates a simple triangle between each (internal) piece edge.",sortHint:2,controls:[]},_r=(a,e,n)=>({createTabSegments(s,r,o,l){const c=[r[0]-s[0],r[1]-s[1]],h=Math.hypot(c[0],c[1]);if(h<1e-6)return[];const f=[c[0]/h,c[1]/h],u=[-f[1],f[0]],d=[s[0]+c[0]/2,s[1]+c[1]/2],p=o.convex?1:-1,m=h*o.size*p,g=[d[0]+u[0]*m,d[1]+u[1]*m],x=[];return x.push({type:"line",p:s}),x.push({type:"line",p:g}),x.push({type:"line",p:r}),x}});et.register(dn,_r,wr);let $t=!1;function Pr(){const a=window.matchMedia("(prefers-color-scheme: dark)");function e(){a.matches?(document.documentElement.classList.add("wa-dark"),$t=!0):(document.documentElement.classList.remove("wa-dark"),$t=!1)}e(),a.addEventListener("change",e)}Pr();const Mr=()=>{const n=ce,i=ue,s=fe,r={seed:new Date().getTime()%10240,canvasWidth:800,canvasHeight:600,aspectRatio:800/600,distance:40,color:$t?"#DDDDDD":"#333333",drawPoints:!1,pointColor:$t?"#FF0000":"#0000FF",borderShape:"rectangle",borderCornerRadius:50,geometryProblems:{autoCheck:!1,problems:void 0,progress:void 0},dirty:!0,generators:{point:{label:"Seed Points",registry:xt,name:n,config:xt.getDefaultConfig(n,800,600)},piece:{label:"Piece Generation",registry:vt,name:i,config:vt.getDefaultConfig(i,800,600)},placement:{label:"Tab Placement",registry:bt,name:Rt,config:bt.getDefaultConfig(Rt,800,600)},tab:{label:"Tabs",registry:et,name:s,config:et.getDefaultConfig(s,800,600)}},puzzle:void 0,backgroundImageUrl:void 0,backgroundImageName:""};function o(){const{canvasWidth:c,canvasHeight:h,borderShape:f,borderCornerRadius:u}=r;switch(f){case"rectangle":return se(c,h);case"circle":return ui(Math.min(c,h));case"ellipse":return fi(c,h);case"rounded-rect":return di(c,h,u);default:return se(c,h)}}function l(){r.puzzle&&(r.geometryProblems.progress=0,E.redraw(),pr(r.puzzle,(c,h)=>{r.geometryProblems.progress=c/h*100,E.redraw()}).then(c=>{r.geometryProblems.problems=c.length,r.geometryProblems.progress=void 0,r.puzzle&&(r.puzzle.problems=c),E.redraw()}).catch(c=>{r.geometryProblems.progress=void 0,console.error(c),E.redraw()}))}return{oncreate:()=>{ze({bounds:{width:r.canvasWidth,height:r.canvasHeight},border:o(),pieceSize:r.distance,pointConfig:r.generators.point.config,pieceConfig:r.generators.piece.config,placementConfig:r.generators.placement.config,tabConfig:r.generators.tab.config,seed:r.seed}).then(c=>{r.puzzle=c,E.redraw(),r.geometryProblems.autoCheck&&l()}).catch(c=>{console.error(c)})},onupdate:()=>{r.dirty&&(r.dirty=!1,ze({bounds:{width:r.canvasWidth,height:r.canvasHeight},border:o(),pieceSize:r.distance,pointConfig:r.generators.point.config,pieceConfig:r.generators.piece.config,placementConfig:r.generators.placement.config,tabConfig:r.generators.tab.config,seed:r.seed}).then(c=>{r.geometryProblems.problems=void 0,r.geometryProblems.progress=void 0,r.puzzle=c,E.redraw(),r.geometryProblems.autoCheck&&l()}).catch(c=>{console.error(c)}))},onremove:()=>{r.backgroundImageUrl&&(URL.revokeObjectURL(r.backgroundImageUrl),r.backgroundImageUrl=void 0)},view:()=>E(".page",[E(gn,{link:"https://github.com/weevilgenius/puzzle-generator"}),E("h1","Puzzle Generator"),E(".container",[r.puzzle&&E(".puzzle-stack",[E(mi,{width:r.canvasWidth,height:r.canvasHeight,color:r.color,imageUrl:r.backgroundImageUrl,puzzle:r.puzzle,isDirty:r.dirty,pointColor:r.drawPoints?r.pointColor:void 0,onPuzzleChanged:c=>{r.puzzle=c,E.redraw()}}),E(".actions",[E(vi,{puzzle:r.puzzle,width:r.canvasWidth,height:r.canvasHeight,color:r.color}),E(bi,{autoCheck:r.geometryProblems.autoCheck,problems:r.geometryProblems.problems,progressPercent:r.geometryProblems.progress,onCheckRequested:()=>{r.dirty||l(),E.redraw()},onAutocheckChanged:c=>{c!==r.geometryProblems.autoCheck&&(r.geometryProblems.autoCheck=c,E.redraw())}})])]),E(".controls",[E(".background-image",[E(_i,{label:"Background Image",onUpload:(c,h,f,u)=>{r.backgroundImageUrl&&URL.revokeObjectURL(r.backgroundImageUrl),r.canvasWidth=f,r.canvasHeight=u,r.aspectRatio=f/u,r.backgroundImageUrl=c,r.backgroundImageName=h,r.dirty=!0,E.redraw()}}),E("span.background-image-label",r.backgroundImageName)]),E(Ei,{ratio:r.aspectRatio,disabled:r.backgroundImageUrl!==void 0,onChange:c=>{r.aspectRatio=c,r.canvasWidth=r.canvasHeight*c,r.dirty=!0,E.redraw()}}),E(Ii,{shape:r.borderShape,disabled:r.backgroundImageUrl!==void 0,onChange:c=>{r.borderShape=c,r.dirty=!0,E.redraw()}}),r.borderShape==="rounded-rect"&&E(Tt,{config:{name:"cornerRadius",label:"Corner Radius",type:"number"},value:r.borderCornerRadius,onChange:c=>{r.borderCornerRadius=c??50,r.dirty=!0,E.redraw()}}),E(Tt,{config:{name:"seed",label:"Seed",type:"number"},value:r.seed,onChange:c=>{r.seed=c??0,r.dirty=!0,E.redraw()}}),E(Tt,{config:{name:"pieceSize",label:"Piece size",type:"number"},value:r.distance,onChange:c=>{r.distance=c??0,r.dirty=!0,E.redraw()}}),E(Ce,{label:"Piece color",color:r.color,size:"small",onUpdate:c=>{r.color=c,E.redraw()}}),E(".draw-points",[E(nn,{config:{name:"drawPoints",label:"Draw seed points",type:"boolean"},value:r.drawPoints,onChange:c=>{r.drawPoints=c,E.redraw()}}),r.drawPoints&&E(Ce,{label:"Seed points color",color:r.pointColor,size:"small",onUpdate:c=>{r.pointColor=c,E.redraw()}})]),...Object.entries(r.generators).map(([c,h])=>E("label",[h.label+":",E(zi,{generator:h.name,registry:h.registry,config:h.config,onGeneratorChange:f=>{f!=h.name&&(console.log(`${c} generator changed to ${f}`),h.name=f,r.generators[c].config=h.registry.getDefaultConfig(f,r.canvasWidth,r.canvasHeight),r.dirty=!0,E.redraw())},onConfigChange:(f,u)=>{console.log(`${c} generator config "${f}" changed to ${String(u)}`),h.config[f]=u,r.dirty=!0,E.redraw()}})]))])])])}};pn("material",{resolver:a=>{const e=a.match(/^(.*?)(_(rounded|sharp))?$/);return e?`https://cdn.jsdelivr.net/npm/@material-symbols/svg-400@0.32.0/${e[3]??"outlined"}/${e[1]}.svg`:""},mutator:a=>a.setAttribute("fill","currentColor")});E.mount(document.body,Mr);
//# sourceMappingURL=index-3oeqj1wx.js.map
