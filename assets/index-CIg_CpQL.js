import{m as oe,g as Ga,a as Gr}from"./mithril-CdZ0BR3D.js";import{r as ja}from"./webawesome-7D1rN-GI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const o of f)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(f){const o={};return f.integrity&&(o.integrity=f.integrity),f.referrerPolicy&&(o.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?o.credentials="include":f.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(f){if(f.ep)return;f.ep=!0;const o=a(f);fetch(f.href,o)}})();const Wa={view:({attrs:u})=>oe("a.github-corner",{href:u.link,"aria-label":"View source on GitHub",title:"View source on GitHub",target:"_blank"},oe("svg",{width:80,height:80,viewBox:"0 0 250 250","aria-hidden":"true"},[oe("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),oe("path.octo-arm",{fill:"currentColor",style:"transform-origin: 130px 106px;",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"}),oe("path.octo-body",{fill:"currentColor",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"})]))},Za={view:()=>{const u=oe.route.get();return oe("nav.navigation",[oe("div.nav-links",oe("wa-radio-group",{orientation:"horizontal",value:u,onchange:s=>{s.redraw=!1;const a=s.target;oe.route.set(String(a.value))}},[oe("wa-radio",{appearance:"button",value:"/puzzle"},"Puzzle Generator"),oe("wa-radio",{appearance:"button",value:"/test"},"Test Harness")]))])}},cs=50,fs=5,Xa=fs*fs,Ka="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function Ya(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wn={exports:{}};const Qa={},$a=Object.freeze(Object.defineProperty({__proto__:null,default:Qa},Symbol.toStringTag,{value:"Module"})),ds=Ga($a);var fn={exports:{}},Ja=fn.exports,ps;function eo(){return ps||(ps=1,(function(u,s){(function(a,l){l(s)})(Ja,(function(a){var l=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],f=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],o="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",d="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",_={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},b="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",S={5:b,"5module":b+" export import",6:b+" const class extends export import super"},z=/^in(stanceof)?$/,M=new RegExp("["+d+"]"),H=new RegExp("["+d+o+"]");function L(n,p){for(var k=65536,F=0;F<p.length;F+=2){if(k+=p[F],k>n)return!1;if(k+=p[F+1],k>=n)return!0}return!1}function Q(n,p){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&M.test(String.fromCharCode(n)):p===!1?!1:L(n,f)}function X(n,p){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&H.test(String.fromCharCode(n)):p===!1?!1:L(n,f)||L(n,l)}var te=function(p,k){k===void 0&&(k={}),this.label=p,this.keyword=k.keyword,this.beforeExpr=!!k.beforeExpr,this.startsExpr=!!k.startsExpr,this.isLoop=!!k.isLoop,this.isAssign=!!k.isAssign,this.prefix=!!k.prefix,this.postfix=!!k.postfix,this.binop=k.binop||null,this.updateContext=null};function $(n,p){return new te(n,{beforeExpr:!0,binop:p})}var pe={beforeExpr:!0},re={startsExpr:!0},_e={};function he(n,p){return p===void 0&&(p={}),p.keyword=n,_e[n]=new te(n,p)}var T={num:new te("num",re),regexp:new te("regexp",re),string:new te("string",re),name:new te("name",re),privateId:new te("privateId",re),eof:new te("eof"),bracketL:new te("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new te("]"),braceL:new te("{",{beforeExpr:!0,startsExpr:!0}),braceR:new te("}"),parenL:new te("(",{beforeExpr:!0,startsExpr:!0}),parenR:new te(")"),comma:new te(",",pe),semi:new te(";",pe),colon:new te(":",pe),dot:new te("."),question:new te("?",pe),questionDot:new te("?."),arrow:new te("=>",pe),template:new te("template"),invalidTemplate:new te("invalidTemplate"),ellipsis:new te("...",pe),backQuote:new te("`",re),dollarBraceL:new te("${",{beforeExpr:!0,startsExpr:!0}),eq:new te("=",{beforeExpr:!0,isAssign:!0}),assign:new te("_=",{beforeExpr:!0,isAssign:!0}),incDec:new te("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new te("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:$("||",1),logicalAND:$("&&",2),bitwiseOR:$("|",3),bitwiseXOR:$("^",4),bitwiseAND:$("&",5),equality:$("==/!=/===/!==",6),relational:$("</>/<=/>=",7),bitShift:$("<</>>/>>>",8),plusMin:new te("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:$("%",10),star:$("*",10),slash:$("/",10),starstar:new te("**",{beforeExpr:!0}),coalesce:$("??",1),_break:he("break"),_case:he("case",pe),_catch:he("catch"),_continue:he("continue"),_debugger:he("debugger"),_default:he("default",pe),_do:he("do",{isLoop:!0,beforeExpr:!0}),_else:he("else",pe),_finally:he("finally"),_for:he("for",{isLoop:!0}),_function:he("function",re),_if:he("if"),_return:he("return",pe),_switch:he("switch"),_throw:he("throw",pe),_try:he("try"),_var:he("var"),_const:he("const"),_while:he("while",{isLoop:!0}),_with:he("with"),_new:he("new",{beforeExpr:!0,startsExpr:!0}),_this:he("this",re),_super:he("super",re),_class:he("class",re),_extends:he("extends",pe),_export:he("export"),_import:he("import",re),_null:he("null",re),_true:he("true",re),_false:he("false",re),_in:he("in",{beforeExpr:!0,binop:7}),_instanceof:he("instanceof",{beforeExpr:!0,binop:7}),_typeof:he("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:he("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:he("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ve=/\r\n?|\n|\u2028|\u2029/,xe=new RegExp(ve.source,"g");function de(n){return n===10||n===13||n===8232||n===8233}function Se(n,p,k){k===void 0&&(k=n.length);for(var F=p;F<k;F++){var W=n.charCodeAt(F);if(de(W))return F<k-1&&W===13&&n.charCodeAt(F+1)===10?F+2:F+1}return-1}var Ie=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ce=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ze=Object.prototype,Pe=ze.hasOwnProperty,et=ze.toString,ge=Object.hasOwn||(function(n,p){return Pe.call(n,p)}),Ye=Array.isArray||(function(n){return et.call(n)==="[object Array]"}),st=Object.create(null);function Fe(n){return st[n]||(st[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function it(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var Kt=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Bt=function(p,k){this.line=p,this.column=k};Bt.prototype.offset=function(p){return new Bt(this.line,this.column+p)};var Yt=function(p,k,F){this.start=k,this.end=F,p.sourceFile!==null&&(this.source=p.sourceFile)};function Wi(n,p){for(var k=1,F=0;;){var W=Se(n,F,p);if(W<0)return new Bt(k,p-F);++k,F=W}}var dt={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},vi=!1;function Zi(n){var p={};for(var k in dt)p[k]=n&&ge(n,k)?n[k]:dt[k];if(p.ecmaVersion==="latest"?p.ecmaVersion=1e8:p.ecmaVersion==null?(!vi&&typeof console=="object"&&console.warn&&(vi=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),p.ecmaVersion=11):p.ecmaVersion>=2015&&(p.ecmaVersion-=2009),p.allowReserved==null&&(p.allowReserved=p.ecmaVersion<5),(!n||n.allowHashBang==null)&&(p.allowHashBang=p.ecmaVersion>=14),Ye(p.onToken)){var F=p.onToken;p.onToken=function(W){return F.push(W)}}return Ye(p.onComment)&&(p.onComment=Xi(p,p.onComment)),p}function Xi(n,p){return function(k,F,W,ue,ce,ke){var Oe={type:k?"Block":"Line",value:F,start:W,end:ue};n.locations&&(Oe.loc=new Yt(this,ce,ke)),n.ranges&&(Oe.range=[W,ue]),p.push(Oe)}}var at=1,ut=2,ht=4,In=8,oi=16,kn=32,_i=64,En=128,Jt=256,yi=512,Oi=at|ut|Jt;function zi(n,p){return ut|(n?ht:0)|(p?In:0)}var pt=0,xi=1,nt=2,Ki=3,Qe=4,e=5,i=function(p,k,F){this.options=p=Zi(p),this.sourceFile=p.sourceFile,this.keywords=Fe(S[p.ecmaVersion>=6?6:p.sourceType==="module"?"5module":5]);var W="";p.allowReserved!==!0&&(W=_[p.ecmaVersion>=6?6:p.ecmaVersion===5?5:3],p.sourceType==="module"&&(W+=" await")),this.reservedWords=Fe(W);var ue=(W?W+" ":"")+_.strict;this.reservedWordsStrict=Fe(ue),this.reservedWordsStrictBind=Fe(ue+" "+_.strictBind),this.input=String(k),this.containsEsc=!1,F?(this.pos=F,this.lineStart=this.input.lastIndexOf(`
`,F-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ve).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=p.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&p.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(at),this.regexpState=null,this.privateNameStack=[]},r={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};i.prototype.parse=function(){var p=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(p)},r.inFunction.get=function(){return(this.currentVarScope().flags&ut)>0},r.inGenerator.get=function(){return(this.currentVarScope().flags&In)>0},r.inAsync.get=function(){return(this.currentVarScope().flags&ht)>0},r.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var p=this.scopeStack[n],k=p.flags;if(k&(Jt|yi))return!1;if(k&ut)return(k&ht)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},r.allowSuper.get=function(){var n=this.currentThisScope(),p=n.flags;return(p&_i)>0||this.options.allowSuperOutsideMethod},r.allowDirectSuper.get=function(){return(this.currentThisScope().flags&En)>0},r.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},r.allowNewDotTarget.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var p=this.scopeStack[n],k=p.flags;if(k&(Jt|yi)||k&ut&&!(k&oi))return!0}return!1},r.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Jt)>0},i.extend=function(){for(var p=[],k=arguments.length;k--;)p[k]=arguments[k];for(var F=this,W=0;W<p.length;W++)F=p[W](F);return F},i.parse=function(p,k){return new this(k,p).parse()},i.parseExpressionAt=function(p,k,F){var W=new this(F,p,k);return W.nextToken(),W.parseExpression()},i.tokenizer=function(p,k){return new this(k,p)},Object.defineProperties(i.prototype,r);var h=i.prototype,c=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;h.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){Ce.lastIndex=n,n+=Ce.exec(this.input)[0].length;var p=c.exec(this.input.slice(n));if(!p)return!1;if((p[1]||p[2])==="use strict"){Ce.lastIndex=n+p[0].length;var k=Ce.exec(this.input),F=k.index+k[0].length,W=this.input.charAt(F);return W===";"||W==="}"||ve.test(k[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(W)||W==="!"&&this.input.charAt(F+1)==="=")}n+=p[0].length,Ce.lastIndex=n,n+=Ce.exec(this.input)[0].length,this.input[n]===";"&&n++}},h.eat=function(n){return this.type===n?(this.next(),!0):!1},h.isContextual=function(n){return this.type===T.name&&this.value===n&&!this.containsEsc},h.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1},h.expectContextual=function(n){this.eatContextual(n)||this.unexpected()},h.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||ve.test(this.input.slice(this.lastTokEnd,this.start))},h.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},h.semicolon=function(){!this.eat(T.semi)&&!this.insertSemicolon()&&this.unexpected()},h.afterTrailingComma=function(n,p){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),p||this.next(),!0},h.expect=function(n){this.eat(n)||this.unexpected()},h.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var g=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};h.checkPatternErrors=function(n,p){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var k=p?n.parenthesizedAssign:n.parenthesizedBind;k>-1&&this.raiseRecoverable(k,p?"Assigning to rvalue":"Parenthesized pattern")}},h.checkExpressionErrors=function(n,p){if(!n)return!1;var k=n.shorthandAssign,F=n.doubleProto;if(!p)return k>=0||F>=0;k>=0&&this.raise(k,"Shorthand property assignments are valid only in destructuring patterns"),F>=0&&this.raiseRecoverable(F,"Redefinition of __proto__ property")},h.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},h.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var m=i.prototype;m.parseTopLevel=function(n){var p=Object.create(null);for(n.body||(n.body=[]);this.type!==T.eof;){var k=this.parseStatement(null,!0,p);n.body.push(k)}if(this.inModule)for(var F=0,W=Object.keys(this.undefinedExports);F<W.length;F+=1){var ue=W[F];this.raiseRecoverable(this.undefinedExports[ue].start,"Export '"+ue+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var v={kind:"loop"},y={kind:"switch"};m.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ce.lastIndex=this.pos;var p=Ce.exec(this.input),k=this.pos+p[0].length,F=this.input.charCodeAt(k);if(F===91||F===92)return!0;if(n)return!1;if(F===123||F>55295&&F<56320)return!0;if(Q(F,!0)){for(var W=k+1;X(F=this.input.charCodeAt(W),!0);)++W;if(F===92||F>55295&&F<56320)return!0;var ue=this.input.slice(k,W);if(!z.test(ue))return!0}return!1},m.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ce.lastIndex=this.pos;var n=Ce.exec(this.input),p=this.pos+n[0].length,k;return!ve.test(this.input.slice(this.pos,p))&&this.input.slice(p,p+8)==="function"&&(p+8===this.input.length||!(X(k=this.input.charCodeAt(p+8))||k>55295&&k<56320))},m.isUsingKeyword=function(n,p){if(this.options.ecmaVersion<17||!this.isContextual(n?"await":"using"))return!1;Ce.lastIndex=this.pos;var k=Ce.exec(this.input),F=this.pos+k[0].length;if(ve.test(this.input.slice(this.pos,F)))return!1;if(n){var W=F+5,ue;if(this.input.slice(F,W)!=="using"||W===this.input.length||X(ue=this.input.charCodeAt(W))||ue>55295&&ue<56320)return!1;Ce.lastIndex=W;var ce=Ce.exec(this.input);if(ce&&ve.test(this.input.slice(W,W+ce[0].length)))return!1}if(p){var ke=F+2,Oe;if(this.input.slice(F,ke)==="of"&&(ke===this.input.length||!X(Oe=this.input.charCodeAt(ke))&&!(Oe>55295&&Oe<56320)))return!1}var Ge=this.input.charCodeAt(F);return Q(Ge,!0)||Ge===92},m.isAwaitUsing=function(n){return this.isUsingKeyword(!0,n)},m.isUsing=function(n){return this.isUsingKeyword(!1,n)},m.parseStatement=function(n,p,k){var F=this.type,W=this.startNode(),ue;switch(this.isLet(n)&&(F=T._var,ue="let"),F){case T._break:case T._continue:return this.parseBreakContinueStatement(W,F.keyword);case T._debugger:return this.parseDebuggerStatement(W);case T._do:return this.parseDoStatement(W);case T._for:return this.parseForStatement(W);case T._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(W,!1,!n);case T._class:return n&&this.unexpected(),this.parseClass(W,!0);case T._if:return this.parseIfStatement(W);case T._return:return this.parseReturnStatement(W);case T._switch:return this.parseSwitchStatement(W);case T._throw:return this.parseThrowStatement(W);case T._try:return this.parseTryStatement(W);case T._const:case T._var:return ue=ue||this.value,n&&ue!=="var"&&this.unexpected(),this.parseVarStatement(W,ue);case T._while:return this.parseWhileStatement(W);case T._with:return this.parseWithStatement(W);case T.braceL:return this.parseBlock(!0,W);case T.semi:return this.parseEmptyStatement(W);case T._export:case T._import:if(this.options.ecmaVersion>10&&F===T._import){Ce.lastIndex=this.pos;var ce=Ce.exec(this.input),ke=this.pos+ce[0].length,Oe=this.input.charCodeAt(ke);if(Oe===40||Oe===46)return this.parseExpressionStatement(W,this.parseExpression())}return this.options.allowImportExportEverywhere||(p||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),F===T._import?this.parseImport(W):this.parseExport(W,k);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(W,!0,!n);var Ge=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(Ge)return p&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),Ge==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(W,!1,Ge),this.semicolon(),this.finishNode(W,"VariableDeclaration");var $e=this.value,ot=this.parseExpression();return F===T.name&&ot.type==="Identifier"&&this.eat(T.colon)?this.parseLabeledStatement(W,$e,ot,n):this.parseExpressionStatement(W,ot)}},m.parseBreakContinueStatement=function(n,p){var k=p==="break";this.next(),this.eat(T.semi)||this.insertSemicolon()?n.label=null:this.type!==T.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var F=0;F<this.labels.length;++F){var W=this.labels[F];if((n.label==null||W.name===n.label.name)&&(W.kind!=null&&(k||W.kind==="loop")||n.label&&k))break}return F===this.labels.length&&this.raise(n.start,"Unsyntactic "+p),this.finishNode(n,k?"BreakStatement":"ContinueStatement")},m.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")},m.parseDoStatement=function(n){return this.next(),this.labels.push(v),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")},m.parseForStatement=function(n){this.next();var p=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(v),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return p>-1&&this.unexpected(p),this.parseFor(n,null);var k=this.isLet();if(this.type===T._var||this.type===T._const||k){var F=this.startNode(),W=k?"let":this.value;return this.next(),this.parseVar(F,!0,W),this.finishNode(F,"VariableDeclaration"),this.parseForAfterInit(n,F,p)}var ue=this.isContextual("let"),ce=!1,ke=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(ke){var Oe=this.startNode();return this.next(),ke==="await using"&&this.next(),this.parseVar(Oe,!0,ke),this.finishNode(Oe,"VariableDeclaration"),this.parseForAfterInit(n,Oe,p)}var Ge=this.containsEsc,$e=new g,ot=this.start,St=p>-1?this.parseExprSubscripts($e,"await"):this.parseExpression(!0,$e);return this.type===T._in||(ce=this.options.ecmaVersion>=6&&this.isContextual("of"))?(p>-1?(this.type===T._in&&this.unexpected(p),n.await=!0):ce&&this.options.ecmaVersion>=8&&(St.start===ot&&!Ge&&St.type==="Identifier"&&St.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),ue&&ce&&this.raise(St.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(St,!1,$e),this.checkLValPattern(St),this.parseForIn(n,St)):(this.checkExpressionErrors($e,!0),p>-1&&this.unexpected(p),this.parseFor(n,St))},m.parseForAfterInit=function(n,p,k){return(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&p.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===T._in?k>-1&&this.unexpected(k):n.await=k>-1),this.parseForIn(n,p)):(k>-1&&this.unexpected(k),this.parseFor(n,p))},m.parseFunctionStatement=function(n,p,k){return this.next(),this.parseFunction(n,E|(k?0:A),!1,p)},m.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")},m.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")},m.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(T.braceL),this.labels.push(y),this.enterScope(0);for(var p,k=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var F=this.type===T._case;p&&this.finishNode(p,"SwitchCase"),n.cases.push(p=this.startNode()),p.consequent=[],this.next(),F?p.test=this.parseExpression():(k&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),k=!0,p.test=null),this.expect(T.colon)}else p||this.unexpected(),p.consequent.push(this.parseStatement(null));return this.exitScope(),p&&this.finishNode(p,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")},m.parseThrowStatement=function(n){return this.next(),ve.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var x=[];m.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),p=n.type==="Identifier";return this.enterScope(p?kn:0),this.checkLValPattern(n,p?Qe:nt),this.expect(T.parenR),n},m.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===T._catch){var p=this.startNode();this.next(),this.eat(T.parenL)?p.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),p.param=null,this.enterScope(0)),p.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(p,"CatchClause")}return n.finalizer=this.eat(T._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")},m.parseVarStatement=function(n,p,k){return this.next(),this.parseVar(n,!1,p,k),this.semicolon(),this.finishNode(n,"VariableDeclaration")},m.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(v),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")},m.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")},m.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")},m.parseLabeledStatement=function(n,p,k,F){for(var W=0,ue=this.labels;W<ue.length;W+=1){var ce=ue[W];ce.name===p&&this.raise(k.start,"Label '"+p+"' is already declared")}for(var ke=this.type.isLoop?"loop":this.type===T._switch?"switch":null,Oe=this.labels.length-1;Oe>=0;Oe--){var Ge=this.labels[Oe];if(Ge.statementStart===n.start)Ge.statementStart=this.start,Ge.kind=ke;else break}return this.labels.push({name:p,kind:ke,statementStart:this.start}),n.body=this.parseStatement(F?F.indexOf("label")===-1?F+"label":F:"label"),this.labels.pop(),n.label=k,this.finishNode(n,"LabeledStatement")},m.parseExpressionStatement=function(n,p){return n.expression=p,this.semicolon(),this.finishNode(n,"ExpressionStatement")},m.parseBlock=function(n,p,k){for(n===void 0&&(n=!0),p===void 0&&(p=this.startNode()),p.body=[],this.expect(T.braceL),n&&this.enterScope(0);this.type!==T.braceR;){var F=this.parseStatement(null);p.body.push(F)}return k&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(p,"BlockStatement")},m.parseFor=function(n,p){return n.init=p,this.expect(T.semi),n.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),n.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")},m.parseForIn=function(n,p){var k=this.type===T._in;return this.next(),p.type==="VariableDeclaration"&&p.declarations[0].init!=null&&(!k||this.options.ecmaVersion<8||this.strict||p.kind!=="var"||p.declarations[0].id.type!=="Identifier")&&this.raise(p.start,(k?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=p,n.right=k?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,k?"ForInStatement":"ForOfStatement")},m.parseVar=function(n,p,k,F){for(n.declarations=[],n.kind=k;;){var W=this.startNode();if(this.parseVarId(W,k),this.eat(T.eq)?W.init=this.parseMaybeAssign(p):!F&&k==="const"&&!(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!F&&(k==="using"||k==="await using")&&this.options.ecmaVersion>=17&&this.type!==T._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+k+" declaration"):!F&&W.id.type!=="Identifier"&&!(p&&(this.type===T._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):W.init=null,n.declarations.push(this.finishNode(W,"VariableDeclarator")),!this.eat(T.comma))break}return n},m.parseVarId=function(n,p){n.id=p==="using"||p==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(n.id,p==="var"?xi:nt,!1)};var E=1,A=2,P=4;m.parseFunction=function(n,p,k,F,W){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!F)&&(this.type===T.star&&p&A&&this.unexpected(),n.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(n.async=!!F),p&E&&(n.id=p&P&&this.type!==T.name?null:this.parseIdent(),n.id&&!(p&A)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?xi:nt:Ki));var ue=this.yieldPos,ce=this.awaitPos,ke=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(zi(n.async,n.generator)),p&E||(n.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,k,!1,W),this.yieldPos=ue,this.awaitPos=ce,this.awaitIdentPos=ke,this.finishNode(n,p&E?"FunctionDeclaration":"FunctionExpression")},m.parseFunctionParams=function(n){this.expect(T.parenL),n.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},m.parseClass=function(n,p){this.next();var k=this.strict;this.strict=!0,this.parseClassId(n,p),this.parseClassSuper(n);var F=this.enterClassBody(),W=this.startNode(),ue=!1;for(W.body=[],this.expect(T.braceL);this.type!==T.braceR;){var ce=this.parseClassElement(n.superClass!==null);ce&&(W.body.push(ce),ce.type==="MethodDefinition"&&ce.kind==="constructor"?(ue&&this.raiseRecoverable(ce.start,"Duplicate constructor in the same class"),ue=!0):ce.key&&ce.key.type==="PrivateIdentifier"&&C(F,ce)&&this.raiseRecoverable(ce.key.start,"Identifier '#"+ce.key.name+"' has already been declared"))}return this.strict=k,this.next(),n.body=this.finishNode(W,"ClassBody"),this.exitClassBody(),this.finishNode(n,p?"ClassDeclaration":"ClassExpression")},m.parseClassElement=function(n){if(this.eat(T.semi))return null;var p=this.options.ecmaVersion,k=this.startNode(),F="",W=!1,ue=!1,ce="method",ke=!1;if(this.eatContextual("static")){if(p>=13&&this.eat(T.braceL))return this.parseClassStaticBlock(k),k;this.isClassElementNameStart()||this.type===T.star?ke=!0:F="static"}if(k.static=ke,!F&&p>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===T.star)&&!this.canInsertSemicolon()?ue=!0:F="async"),!F&&(p>=9||!ue)&&this.eat(T.star)&&(W=!0),!F&&!ue&&!W){var Oe=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?ce=Oe:F=Oe)}if(F?(k.computed=!1,k.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),k.key.name=F,this.finishNode(k.key,"Identifier")):this.parseClassElementName(k),p<13||this.type===T.parenL||ce!=="method"||W||ue){var Ge=!k.static&&B(k,"constructor"),$e=Ge&&n;Ge&&ce!=="method"&&this.raise(k.key.start,"Constructor can't have get/set modifier"),k.kind=Ge?"constructor":ce,this.parseClassMethod(k,W,ue,$e)}else this.parseClassField(k);return k},m.isClassElementNameStart=function(){return this.type===T.name||this.type===T.privateId||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword},m.parseClassElementName=function(n){this.type===T.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)},m.parseClassMethod=function(n,p,k,F){var W=n.key;n.kind==="constructor"?(p&&this.raise(W.start,"Constructor can't be a generator"),k&&this.raise(W.start,"Constructor can't be an async method")):n.static&&B(n,"prototype")&&this.raise(W.start,"Classes may not have a static property named prototype");var ue=n.value=this.parseMethod(p,k,F);return n.kind==="get"&&ue.params.length!==0&&this.raiseRecoverable(ue.start,"getter should have no params"),n.kind==="set"&&ue.params.length!==1&&this.raiseRecoverable(ue.start,"setter should have exactly one param"),n.kind==="set"&&ue.params[0].type==="RestElement"&&this.raiseRecoverable(ue.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")},m.parseClassField=function(n){return B(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&B(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(T.eq)?(this.enterScope(yi|_i),n.value=this.parseMaybeAssign(),this.exitScope()):n.value=null,this.semicolon(),this.finishNode(n,"PropertyDefinition")},m.parseClassStaticBlock=function(n){n.body=[];var p=this.labels;for(this.labels=[],this.enterScope(Jt|_i);this.type!==T.braceR;){var k=this.parseStatement(null);n.body.push(k)}return this.next(),this.exitScope(),this.labels=p,this.finishNode(n,"StaticBlock")},m.parseClassId=function(n,p){this.type===T.name?(n.id=this.parseIdent(),p&&this.checkLValSimple(n.id,nt,!1)):(p===!0&&this.unexpected(),n.id=null)},m.parseClassSuper=function(n){n.superClass=this.eat(T._extends)?this.parseExprSubscripts(null,!1):null},m.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared},m.exitClassBody=function(){var n=this.privateNameStack.pop(),p=n.declared,k=n.used;if(this.options.checkPrivateFields)for(var F=this.privateNameStack.length,W=F===0?null:this.privateNameStack[F-1],ue=0;ue<k.length;++ue){var ce=k[ue];ge(p,ce.name)||(W?W.used.push(ce):this.raiseRecoverable(ce.start,"Private field '#"+ce.name+"' must be declared in an enclosing class"))}};function C(n,p){var k=p.key.name,F=n[k],W="true";return p.type==="MethodDefinition"&&(p.kind==="get"||p.kind==="set")&&(W=(p.static?"s":"i")+p.kind),F==="iget"&&W==="iset"||F==="iset"&&W==="iget"||F==="sget"&&W==="sset"||F==="sset"&&W==="sget"?(n[k]="true",!1):F?!0:(n[k]=W,!1)}function B(n,p){var k=n.computed,F=n.key;return!k&&(F.type==="Identifier"&&F.name===p||F.type==="Literal"&&F.value===p)}m.parseExportAllDeclaration=function(n,p){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(p,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==T.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")},m.parseExport=function(n,p){if(this.next(),this.eat(T.star))return this.parseExportAllDeclaration(n,p);if(this.eat(T._default))return this.checkExport(p,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(p,n.declaration.declarations):this.checkExport(p,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[]);else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(p),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var k=0,F=n.specifiers;k<F.length;k+=1){var W=F[k];this.checkUnreserved(W.local),this.checkLocalExport(W.local),W.local.type==="Literal"&&this.raise(W.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[])}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")},m.parseExportDeclaration=function(n){return this.parseStatement(null)},m.parseExportDefaultDeclaration=function(){var n;if(this.type===T._function||(n=this.isAsyncFunction())){var p=this.startNode();return this.next(),n&&this.next(),this.parseFunction(p,E|P,!1,n)}else if(this.type===T._class){var k=this.startNode();return this.parseClass(k,"nullableID")}else{var F=this.parseMaybeAssign();return this.semicolon(),F}},m.checkExport=function(n,p,k){n&&(typeof p!="string"&&(p=p.type==="Identifier"?p.name:p.value),ge(n,p)&&this.raiseRecoverable(k,"Duplicate export '"+p+"'"),n[p]=!0)},m.checkPatternExport=function(n,p){var k=p.type;if(k==="Identifier")this.checkExport(n,p,p.start);else if(k==="ObjectPattern")for(var F=0,W=p.properties;F<W.length;F+=1){var ue=W[F];this.checkPatternExport(n,ue)}else if(k==="ArrayPattern")for(var ce=0,ke=p.elements;ce<ke.length;ce+=1){var Oe=ke[ce];Oe&&this.checkPatternExport(n,Oe)}else k==="Property"?this.checkPatternExport(n,p.value):k==="AssignmentPattern"?this.checkPatternExport(n,p.left):k==="RestElement"&&this.checkPatternExport(n,p.argument)},m.checkVariableExport=function(n,p){if(n)for(var k=0,F=p;k<F.length;k+=1){var W=F[k];this.checkPatternExport(n,W.id)}},m.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},m.parseExportSpecifier=function(n){var p=this.startNode();return p.local=this.parseModuleExportName(),p.exported=this.eatContextual("as")?this.parseModuleExportName():p.local,this.checkExport(n,p.exported,p.exported.start),this.finishNode(p,"ExportSpecifier")},m.parseExportSpecifiers=function(n){var p=[],k=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(k)k=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;p.push(this.parseExportSpecifier(n))}return p},m.parseImport=function(n){return this.next(),this.type===T.string?(n.specifiers=x,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")},m.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,nt),this.finishNode(n,"ImportSpecifier")},m.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,nt),this.finishNode(n,"ImportDefaultSpecifier")},m.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,nt),this.finishNode(n,"ImportNamespaceSpecifier")},m.parseImportSpecifiers=function(){var n=[],p=!0;if(this.type===T.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(T.comma)))return n;if(this.type===T.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(T.braceL);!this.eat(T.braceR);){if(p)p=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;n.push(this.parseImportSpecifier())}return n},m.parseWithClause=function(){var n=[];if(!this.eat(T._with))return n;this.expect(T.braceL);for(var p={},k=!0;!this.eat(T.braceR);){if(k)k=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var F=this.parseImportAttribute(),W=F.key.type==="Identifier"?F.key.name:F.key.value;ge(p,W)&&this.raiseRecoverable(F.key.start,"Duplicate attribute key '"+W+"'"),p[W]=!0,n.push(F)}return n},m.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(T.colon),this.type!==T.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")},m.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===T.string){var n=this.parseLiteral(this.value);return Kt.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)},m.adaptDirectivePrologue=function(n){for(var p=0;p<n.length&&this.isDirectiveCandidate(n[p]);++p)n[p].directive=n[p].expression.raw.slice(1,-1)},m.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var O=i.prototype;O.toAssignable=function(n,p,k){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",k&&this.checkPatternErrors(k,!0);for(var F=0,W=n.properties;F<W.length;F+=1){var ue=W[F];this.toAssignable(ue,p),ue.type==="RestElement"&&(ue.argument.type==="ArrayPattern"||ue.argument.type==="ObjectPattern")&&this.raise(ue.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,p);break;case"ArrayExpression":n.type="ArrayPattern",k&&this.checkPatternErrors(k,!0),this.toAssignableList(n.elements,p);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,p),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,p);break;case"ParenthesizedExpression":this.toAssignable(n.expression,p,k);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!p)break;default:this.raise(n.start,"Assigning to rvalue")}else k&&this.checkPatternErrors(k,!0);return n},O.toAssignableList=function(n,p){for(var k=n.length,F=0;F<k;F++){var W=n[F];W&&this.toAssignable(W,p)}if(k){var ue=n[k-1];this.options.ecmaVersion===6&&p&&ue&&ue.type==="RestElement"&&ue.argument.type!=="Identifier"&&this.unexpected(ue.argument.start)}return n},O.parseSpread=function(n){var p=this.startNode();return this.next(),p.argument=this.parseMaybeAssign(!1,n),this.finishNode(p,"SpreadElement")},O.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==T.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")},O.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()},O.parseBindingList=function(n,p,k,F){for(var W=[],ue=!0;!this.eat(n);)if(ue?ue=!1:this.expect(T.comma),p&&this.type===T.comma)W.push(null);else{if(k&&this.afterTrailingComma(n))break;if(this.type===T.ellipsis){var ce=this.parseRestBinding();this.parseBindingListItem(ce),W.push(ce),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else W.push(this.parseAssignableListItem(F))}return W},O.parseAssignableListItem=function(n){var p=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(p),p},O.parseBindingListItem=function(n){return n},O.parseMaybeDefault=function(n,p,k){if(k=k||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return k;var F=this.startNodeAt(n,p);return F.left=k,F.right=this.parseMaybeAssign(),this.finishNode(F,"AssignmentPattern")},O.checkLValSimple=function(n,p,k){p===void 0&&(p=pt);var F=p!==pt;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(F?"Binding ":"Assigning to ")+n.name+" in strict mode"),F&&(p===nt&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),k&&(ge(k,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),k[n.name]=!0),p!==e&&this.declareName(n.name,p,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":F&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return F&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,p,k);default:this.raise(n.start,(F?"Binding":"Assigning to")+" rvalue")}},O.checkLValPattern=function(n,p,k){switch(p===void 0&&(p=pt),n.type){case"ObjectPattern":for(var F=0,W=n.properties;F<W.length;F+=1){var ue=W[F];this.checkLValInnerPattern(ue,p,k)}break;case"ArrayPattern":for(var ce=0,ke=n.elements;ce<ke.length;ce+=1){var Oe=ke[ce];Oe&&this.checkLValInnerPattern(Oe,p,k)}break;default:this.checkLValSimple(n,p,k)}},O.checkLValInnerPattern=function(n,p,k){switch(p===void 0&&(p=pt),n.type){case"Property":this.checkLValInnerPattern(n.value,p,k);break;case"AssignmentPattern":this.checkLValPattern(n.left,p,k);break;case"RestElement":this.checkLValPattern(n.argument,p,k);break;default:this.checkLValPattern(n,p,k)}};var V=function(p,k,F,W,ue){this.token=p,this.isExpr=!!k,this.preserveSpace=!!F,this.override=W,this.generator=!!ue},I={b_stat:new V("{",!1),b_expr:new V("{",!0),b_tmpl:new V("${",!1),p_stat:new V("(",!1),p_expr:new V("(",!0),q_tmpl:new V("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new V("function",!1),f_expr:new V("function",!0),f_expr_gen:new V("function",!0,!1,null,!0),f_gen:new V("function",!1,!1,null,!0)},R=i.prototype;R.initialContext=function(){return[I.b_stat]},R.curContext=function(){return this.context[this.context.length-1]},R.braceIsBlock=function(n){var p=this.curContext();return p===I.f_expr||p===I.f_stat?!0:n===T.colon&&(p===I.b_stat||p===I.b_expr)?!p.isExpr:n===T._return||n===T.name&&this.exprAllowed?ve.test(this.input.slice(this.lastTokEnd,this.start)):n===T._else||n===T.semi||n===T.eof||n===T.parenR||n===T.arrow?!0:n===T.braceL?p===I.b_stat:n===T._var||n===T._const||n===T.name?!1:!this.exprAllowed},R.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var p=this.context[n];if(p.token==="function")return p.generator}return!1},R.updateContext=function(n){var p,k=this.type;k.keyword&&n===T.dot?this.exprAllowed=!1:(p=k.updateContext)?p.call(this,n):this.exprAllowed=k.beforeExpr},R.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)},T.parenR.updateContext=T.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===I.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr},T.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?I.b_stat:I.b_expr),this.exprAllowed=!0},T.dollarBraceL.updateContext=function(){this.context.push(I.b_tmpl),this.exprAllowed=!0},T.parenL.updateContext=function(n){var p=n===T._if||n===T._for||n===T._with||n===T._while;this.context.push(p?I.p_stat:I.p_expr),this.exprAllowed=!0},T.incDec.updateContext=function(){},T._function.updateContext=T._class.updateContext=function(n){n.beforeExpr&&n!==T._else&&!(n===T.semi&&this.curContext()!==I.p_stat)&&!(n===T._return&&ve.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===T.colon||n===T.braceL)&&this.curContext()===I.b_stat)?this.context.push(I.f_expr):this.context.push(I.f_stat),this.exprAllowed=!1},T.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},T.backQuote.updateContext=function(){this.curContext()===I.q_tmpl?this.context.pop():this.context.push(I.q_tmpl),this.exprAllowed=!1},T.star.updateContext=function(n){if(n===T._function){var p=this.context.length-1;this.context[p]===I.f_expr?this.context[p]=I.f_expr_gen:this.context[p]=I.f_gen}this.exprAllowed=!0},T.name.updateContext=function(n){var p=!1;this.options.ecmaVersion>=6&&n!==T.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(p=!0),this.exprAllowed=p};var w=i.prototype;w.checkPropClash=function(n,p,k){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var F=n.key,W;switch(F.type){case"Identifier":W=F.name;break;case"Literal":W=String(F.value);break;default:return}var ue=n.kind;if(this.options.ecmaVersion>=6){W==="__proto__"&&ue==="init"&&(p.proto&&(k?k.doubleProto<0&&(k.doubleProto=F.start):this.raiseRecoverable(F.start,"Redefinition of __proto__ property")),p.proto=!0);return}W="$"+W;var ce=p[W];if(ce){var ke;ue==="init"?ke=this.strict&&ce.init||ce.get||ce.set:ke=ce.init||ce[ue],ke&&this.raiseRecoverable(F.start,"Redefinition of property")}else ce=p[W]={init:!1,get:!1,set:!1};ce[ue]=!0}},w.parseExpression=function(n,p){var k=this.start,F=this.startLoc,W=this.parseMaybeAssign(n,p);if(this.type===T.comma){var ue=this.startNodeAt(k,F);for(ue.expressions=[W];this.eat(T.comma);)ue.expressions.push(this.parseMaybeAssign(n,p));return this.finishNode(ue,"SequenceExpression")}return W},w.parseMaybeAssign=function(n,p,k){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var F=!1,W=-1,ue=-1,ce=-1;p?(W=p.parenthesizedAssign,ue=p.trailingComma,ce=p.doubleProto,p.parenthesizedAssign=p.trailingComma=-1):(p=new g,F=!0);var ke=this.start,Oe=this.startLoc;(this.type===T.parenL||this.type===T.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var Ge=this.parseMaybeConditional(n,p);if(k&&(Ge=k.call(this,Ge,ke,Oe)),this.type.isAssign){var $e=this.startNodeAt(ke,Oe);return $e.operator=this.value,this.type===T.eq&&(Ge=this.toAssignable(Ge,!1,p)),F||(p.parenthesizedAssign=p.trailingComma=p.doubleProto=-1),p.shorthandAssign>=Ge.start&&(p.shorthandAssign=-1),this.type===T.eq?this.checkLValPattern(Ge):this.checkLValSimple(Ge),$e.left=Ge,this.next(),$e.right=this.parseMaybeAssign(n),ce>-1&&(p.doubleProto=ce),this.finishNode($e,"AssignmentExpression")}else F&&this.checkExpressionErrors(p,!0);return W>-1&&(p.parenthesizedAssign=W),ue>-1&&(p.trailingComma=ue),Ge},w.parseMaybeConditional=function(n,p){var k=this.start,F=this.startLoc,W=this.parseExprOps(n,p);if(this.checkExpressionErrors(p))return W;if(this.eat(T.question)){var ue=this.startNodeAt(k,F);return ue.test=W,ue.consequent=this.parseMaybeAssign(),this.expect(T.colon),ue.alternate=this.parseMaybeAssign(n),this.finishNode(ue,"ConditionalExpression")}return W},w.parseExprOps=function(n,p){var k=this.start,F=this.startLoc,W=this.parseMaybeUnary(p,!1,!1,n);return this.checkExpressionErrors(p)||W.start===k&&W.type==="ArrowFunctionExpression"?W:this.parseExprOp(W,k,F,-1,n)},w.parseExprOp=function(n,p,k,F,W){var ue=this.type.binop;if(ue!=null&&(!W||this.type!==T._in)&&ue>F){var ce=this.type===T.logicalOR||this.type===T.logicalAND,ke=this.type===T.coalesce;ke&&(ue=T.logicalAND.binop);var Oe=this.value;this.next();var Ge=this.start,$e=this.startLoc,ot=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,W),Ge,$e,ue,W),St=this.buildBinary(p,k,n,ot,Oe,ce||ke);return(ce&&this.type===T.coalesce||ke&&(this.type===T.logicalOR||this.type===T.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(St,p,k,F,W)}return n},w.buildBinary=function(n,p,k,F,W,ue){F.type==="PrivateIdentifier"&&this.raise(F.start,"Private identifier can only be left side of binary expression");var ce=this.startNodeAt(n,p);return ce.left=k,ce.operator=W,ce.right=F,this.finishNode(ce,ue?"LogicalExpression":"BinaryExpression")},w.parseMaybeUnary=function(n,p,k,F){var W=this.start,ue=this.startLoc,ce;if(this.isContextual("await")&&this.canAwait)ce=this.parseAwait(F),p=!0;else if(this.type.prefix){var ke=this.startNode(),Oe=this.type===T.incDec;ke.operator=this.value,ke.prefix=!0,this.next(),ke.argument=this.parseMaybeUnary(null,!0,Oe,F),this.checkExpressionErrors(n,!0),Oe?this.checkLValSimple(ke.argument):this.strict&&ke.operator==="delete"&&N(ke.argument)?this.raiseRecoverable(ke.start,"Deleting local variable in strict mode"):ke.operator==="delete"&&U(ke.argument)?this.raiseRecoverable(ke.start,"Private fields can not be deleted"):p=!0,ce=this.finishNode(ke,Oe?"UpdateExpression":"UnaryExpression")}else if(!p&&this.type===T.privateId)(F||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),ce=this.parsePrivateIdent(),this.type!==T._in&&this.unexpected();else{if(ce=this.parseExprSubscripts(n,F),this.checkExpressionErrors(n))return ce;for(;this.type.postfix&&!this.canInsertSemicolon();){var Ge=this.startNodeAt(W,ue);Ge.operator=this.value,Ge.prefix=!1,Ge.argument=ce,this.checkLValSimple(ce),this.next(),ce=this.finishNode(Ge,"UpdateExpression")}}if(!k&&this.eat(T.starstar))if(p)this.unexpected(this.lastTokStart);else return this.buildBinary(W,ue,ce,this.parseMaybeUnary(null,!1,!1,F),"**",!1);else return ce};function N(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&N(n.expression)}function U(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&U(n.expression)||n.type==="ParenthesizedExpression"&&U(n.expression)}w.parseExprSubscripts=function(n,p){var k=this.start,F=this.startLoc,W=this.parseExprAtom(n,p);if(W.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return W;var ue=this.parseSubscripts(W,k,F,!1,p);return n&&ue.type==="MemberExpression"&&(n.parenthesizedAssign>=ue.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=ue.start&&(n.parenthesizedBind=-1),n.trailingComma>=ue.start&&(n.trailingComma=-1)),ue},w.parseSubscripts=function(n,p,k,F,W){for(var ue=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,ce=!1;;){var ke=this.parseSubscript(n,p,k,F,ue,ce,W);if(ke.optional&&(ce=!0),ke===n||ke.type==="ArrowFunctionExpression"){if(ce){var Oe=this.startNodeAt(p,k);Oe.expression=ke,ke=this.finishNode(Oe,"ChainExpression")}return ke}n=ke}},w.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(T.arrow)},w.parseSubscriptAsyncArrow=function(n,p,k,F){return this.parseArrowExpression(this.startNodeAt(n,p),k,!0,F)},w.parseSubscript=function(n,p,k,F,W,ue,ce){var ke=this.options.ecmaVersion>=11,Oe=ke&&this.eat(T.questionDot);F&&Oe&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Ge=this.eat(T.bracketL);if(Ge||Oe&&this.type!==T.parenL&&this.type!==T.backQuote||this.eat(T.dot)){var $e=this.startNodeAt(p,k);$e.object=n,Ge?($e.property=this.parseExpression(),this.expect(T.bracketR)):this.type===T.privateId&&n.type!=="Super"?$e.property=this.parsePrivateIdent():$e.property=this.parseIdent(this.options.allowReserved!=="never"),$e.computed=!!Ge,ke&&($e.optional=Oe),n=this.finishNode($e,"MemberExpression")}else if(!F&&this.eat(T.parenL)){var ot=new g,St=this.yieldPos,Si=this.awaitPos,ii=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Qt=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,ot);if(W&&!Oe&&this.shouldParseAsyncArrow())return this.checkPatternErrors(ot,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=St,this.awaitPos=Si,this.awaitIdentPos=ii,this.parseSubscriptAsyncArrow(p,k,Qt,ce);this.checkExpressionErrors(ot,!0),this.yieldPos=St||this.yieldPos,this.awaitPos=Si||this.awaitPos,this.awaitIdentPos=ii||this.awaitIdentPos;var hi=this.startNodeAt(p,k);hi.callee=n,hi.arguments=Qt,ke&&(hi.optional=Oe),n=this.finishNode(hi,"CallExpression")}else if(this.type===T.backQuote){(Oe||ue)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var li=this.startNodeAt(p,k);li.tag=n,li.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(li,"TaggedTemplateExpression")}return n},w.parseExprAtom=function(n,p,k){this.type===T.slash&&this.readRegexp();var F,W=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),F=this.startNode(),this.next(),this.type===T.parenL&&!this.allowDirectSuper&&this.raise(F.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(F,"Super");case T._this:return F=this.startNode(),this.next(),this.finishNode(F,"ThisExpression");case T.name:var ue=this.start,ce=this.startLoc,ke=this.containsEsc,Oe=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!ke&&Oe.name==="async"&&!this.canInsertSemicolon()&&this.eat(T._function))return this.overrideContext(I.f_expr),this.parseFunction(this.startNodeAt(ue,ce),0,!1,!0,p);if(W&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(ue,ce),[Oe],!1,p);if(this.options.ecmaVersion>=8&&Oe.name==="async"&&this.type===T.name&&!ke&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return Oe=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(T.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(ue,ce),[Oe],!0,p)}return Oe;case T.regexp:var Ge=this.value;return F=this.parseLiteral(Ge.value),F.regex={pattern:Ge.pattern,flags:Ge.flags},F;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return F=this.startNode(),F.value=this.type===T._null?null:this.type===T._true,F.raw=this.type.keyword,this.next(),this.finishNode(F,"Literal");case T.parenL:var $e=this.start,ot=this.parseParenAndDistinguishExpression(W,p);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(ot)&&(n.parenthesizedAssign=$e),n.parenthesizedBind<0&&(n.parenthesizedBind=$e)),ot;case T.bracketL:return F=this.startNode(),this.next(),F.elements=this.parseExprList(T.bracketR,!0,!0,n),this.finishNode(F,"ArrayExpression");case T.braceL:return this.overrideContext(I.b_expr),this.parseObj(!1,n);case T._function:return F=this.startNode(),this.next(),this.parseFunction(F,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport(k):this.unexpected();default:return this.parseExprAtomDefault()}},w.parseExprAtomDefault=function(){this.unexpected()},w.parseExprImport=function(n){var p=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===T.parenL&&!n)return this.parseDynamicImport(p);if(this.type===T.dot){var k=this.startNodeAt(p.start,p.loc&&p.loc.start);return k.name="import",p.meta=this.finishNode(k,"Identifier"),this.parseImportMeta(p)}else this.unexpected()},w.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(T.parenR)?n.options=null:(this.expect(T.comma),this.afterTrailingComma(T.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(T.parenR)||(this.expect(T.comma),this.afterTrailingComma(T.parenR)||this.unexpected())));else if(!this.eat(T.parenR)){var p=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(p,"Trailing comma is not allowed in import()"):this.unexpected(p)}return this.finishNode(n,"ImportExpression")},w.parseImportMeta=function(n){this.next();var p=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),p&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")},w.parseLiteral=function(n){var p=this.startNode();return p.value=n,p.raw=this.input.slice(this.start,this.end),p.raw.charCodeAt(p.raw.length-1)===110&&(p.bigint=p.value!=null?p.value.toString():p.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(p,"Literal")},w.parseParenExpression=function(){this.expect(T.parenL);var n=this.parseExpression();return this.expect(T.parenR),n},w.shouldParseArrow=function(n){return!this.canInsertSemicolon()},w.parseParenAndDistinguishExpression=function(n,p){var k=this.start,F=this.startLoc,W,ue=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var ce=this.start,ke=this.startLoc,Oe=[],Ge=!0,$e=!1,ot=new g,St=this.yieldPos,Si=this.awaitPos,ii;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;)if(Ge?Ge=!1:this.expect(T.comma),ue&&this.afterTrailingComma(T.parenR,!0)){$e=!0;break}else if(this.type===T.ellipsis){ii=this.start,Oe.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else Oe.push(this.parseMaybeAssign(!1,ot,this.parseParenItem));var Qt=this.lastTokEnd,hi=this.lastTokEndLoc;if(this.expect(T.parenR),n&&this.shouldParseArrow(Oe)&&this.eat(T.arrow))return this.checkPatternErrors(ot,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=St,this.awaitPos=Si,this.parseParenArrowList(k,F,Oe,p);(!Oe.length||$e)&&this.unexpected(this.lastTokStart),ii&&this.unexpected(ii),this.checkExpressionErrors(ot,!0),this.yieldPos=St||this.yieldPos,this.awaitPos=Si||this.awaitPos,Oe.length>1?(W=this.startNodeAt(ce,ke),W.expressions=Oe,this.finishNodeAt(W,"SequenceExpression",Qt,hi)):W=Oe[0]}else W=this.parseParenExpression();if(this.options.preserveParens){var li=this.startNodeAt(k,F);return li.expression=W,this.finishNode(li,"ParenthesizedExpression")}else return W},w.parseParenItem=function(n){return n},w.parseParenArrowList=function(n,p,k,F){return this.parseArrowExpression(this.startNodeAt(n,p),k,!1,F)};var q=[];w.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===T.dot){var p=this.startNodeAt(n.start,n.loc&&n.loc.start);p.name="new",n.meta=this.finishNode(p,"Identifier"),this.next();var k=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),k&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var F=this.start,W=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),F,W,!0,!1),this.eat(T.parenL)?n.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):n.arguments=q,this.finishNode(n,"NewExpression")},w.parseTemplateElement=function(n){var p=n.isTagged,k=this.startNode();return this.type===T.invalidTemplate?(p||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),k.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):k.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),k.tail=this.type===T.backQuote,this.finishNode(k,"TemplateElement")},w.parseTemplate=function(n){n===void 0&&(n={});var p=n.isTagged;p===void 0&&(p=!1);var k=this.startNode();this.next(),k.expressions=[];var F=this.parseTemplateElement({isTagged:p});for(k.quasis=[F];!F.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),k.expressions.push(this.parseExpression()),this.expect(T.braceR),k.quasis.push(F=this.parseTemplateElement({isTagged:p}));return this.next(),this.finishNode(k,"TemplateLiteral")},w.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!ve.test(this.input.slice(this.lastTokEnd,this.start))},w.parseObj=function(n,p){var k=this.startNode(),F=!0,W={};for(k.properties=[],this.next();!this.eat(T.braceR);){if(F)F=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var ue=this.parseProperty(n,p);n||this.checkPropClash(ue,W,p),k.properties.push(ue)}return this.finishNode(k,n?"ObjectPattern":"ObjectExpression")},w.parseProperty=function(n,p){var k=this.startNode(),F,W,ue,ce;if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return n?(k.argument=this.parseIdent(!1),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(k,"RestElement")):(k.argument=this.parseMaybeAssign(!1,p),this.type===T.comma&&p&&p.trailingComma<0&&(p.trailingComma=this.start),this.finishNode(k,"SpreadElement"));this.options.ecmaVersion>=6&&(k.method=!1,k.shorthand=!1,(n||p)&&(ue=this.start,ce=this.startLoc),n||(F=this.eat(T.star)));var ke=this.containsEsc;return this.parsePropertyName(k),!n&&!ke&&this.options.ecmaVersion>=8&&!F&&this.isAsyncProp(k)?(W=!0,F=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(k)):W=!1,this.parsePropertyValue(k,n,F,W,ue,ce,p,ke),this.finishNode(k,"Property")},w.parseGetterSetter=function(n){var p=n.key.name;this.parsePropertyName(n),n.value=this.parseMethod(!1),n.kind=p;var k=n.kind==="get"?0:1;if(n.value.params.length!==k){var F=n.value.start;n.kind==="get"?this.raiseRecoverable(F,"getter should have no params"):this.raiseRecoverable(F,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")},w.parsePropertyValue=function(n,p,k,F,W,ue,ce,ke){(k||F)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon)?(n.value=p?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,ce),n.kind="init"):this.options.ecmaVersion>=6&&this.type===T.parenL?(p&&this.unexpected(),n.method=!0,n.value=this.parseMethod(k,F),n.kind="init"):!p&&!ke&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==T.comma&&this.type!==T.braceR&&this.type!==T.eq?((k||F)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((k||F)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=W),p?n.value=this.parseMaybeDefault(W,ue,this.copyNode(n.key)):this.type===T.eq&&ce?(ce.shorthandAssign<0&&(ce.shorthandAssign=this.start),n.value=this.parseMaybeDefault(W,ue,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.kind="init",n.shorthand=!0):this.unexpected()},w.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(T.bracketR),n.key;n.computed=!1}return n.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},w.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)},w.parseMethod=function(n,p,k){var F=this.startNode(),W=this.yieldPos,ue=this.awaitPos,ce=this.awaitIdentPos;return this.initFunction(F),this.options.ecmaVersion>=6&&(F.generator=n),this.options.ecmaVersion>=8&&(F.async=!!p),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(zi(p,F.generator)|_i|(k?En:0)),this.expect(T.parenL),F.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(F,!1,!0,!1),this.yieldPos=W,this.awaitPos=ue,this.awaitIdentPos=ce,this.finishNode(F,"FunctionExpression")},w.parseArrowExpression=function(n,p,k,F){var W=this.yieldPos,ue=this.awaitPos,ce=this.awaitIdentPos;return this.enterScope(zi(k,!1)|oi),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!k),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(p,!0),this.parseFunctionBody(n,!0,!1,F),this.yieldPos=W,this.awaitPos=ue,this.awaitIdentPos=ce,this.finishNode(n,"ArrowFunctionExpression")},w.parseFunctionBody=function(n,p,k,F){var W=p&&this.type!==T.braceL,ue=this.strict,ce=!1;if(W)n.body=this.parseMaybeAssign(F),n.expression=!0,this.checkParams(n,!1);else{var ke=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!ue||ke)&&(ce=this.strictDirective(this.end),ce&&ke&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Oe=this.labels;this.labels=[],ce&&(this.strict=!0),this.checkParams(n,!ue&&!ce&&!p&&!k&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,e),n.body=this.parseBlock(!1,void 0,ce&&!ue),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=Oe}this.exitScope()},w.isSimpleParamList=function(n){for(var p=0,k=n;p<k.length;p+=1){var F=k[p];if(F.type!=="Identifier")return!1}return!0},w.checkParams=function(n,p){for(var k=Object.create(null),F=0,W=n.params;F<W.length;F+=1){var ue=W[F];this.checkLValInnerPattern(ue,xi,p?null:k)}},w.parseExprList=function(n,p,k,F){for(var W=[],ue=!0;!this.eat(n);){if(ue)ue=!1;else if(this.expect(T.comma),p&&this.afterTrailingComma(n))break;var ce=void 0;k&&this.type===T.comma?ce=null:this.type===T.ellipsis?(ce=this.parseSpread(F),F&&this.type===T.comma&&F.trailingComma<0&&(F.trailingComma=this.start)):ce=this.parseMaybeAssign(!1,F),W.push(ce)}return W},w.checkUnreserved=function(n){var p=n.start,k=n.end,F=n.name;if(this.inGenerator&&F==="yield"&&this.raiseRecoverable(p,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&F==="await"&&this.raiseRecoverable(p,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Oi)&&F==="arguments"&&this.raiseRecoverable(p,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(F==="arguments"||F==="await")&&this.raise(p,"Cannot use "+F+" in class static initialization block"),this.keywords.test(F)&&this.raise(p,"Unexpected keyword '"+F+"'"),!(this.options.ecmaVersion<6&&this.input.slice(p,k).indexOf("\\")!==-1)){var W=this.strict?this.reservedWordsStrict:this.reservedWords;W.test(F)&&(!this.inAsync&&F==="await"&&this.raiseRecoverable(p,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(p,"The keyword '"+F+"' is reserved"))}},w.parseIdent=function(n){var p=this.parseIdentNode();return this.next(!!n),this.finishNode(p,"Identifier"),n||(this.checkUnreserved(p),p.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=p.start)),p},w.parseIdentNode=function(){var n=this.startNode();return this.type===T.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=T.name):this.unexpected(),n},w.parsePrivateIdent=function(){var n=this.startNode();return this.type===T.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n},w.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var p=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(p.delegate=!1,p.argument=null):(p.delegate=this.eat(T.star),p.argument=this.parseMaybeAssign(n)),this.finishNode(p,"YieldExpression")},w.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var p=this.startNode();return this.next(),p.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(p,"AwaitExpression")};var D=i.prototype;D.raise=function(n,p){var k=Wi(this.input,n);p+=" ("+k.line+":"+k.column+")",this.sourceFile&&(p+=" in "+this.sourceFile);var F=new SyntaxError(p);throw F.pos=n,F.loc=k,F.raisedAt=this.pos,F},D.raiseRecoverable=D.raise,D.curPosition=function(){if(this.options.locations)return new Bt(this.curLine,this.pos-this.lineStart)};var G=i.prototype,Z=function(p){this.flags=p,this.var=[],this.lexical=[],this.functions=[]};G.enterScope=function(n){this.scopeStack.push(new Z(n))},G.exitScope=function(){this.scopeStack.pop()},G.treatFunctionsAsVarInScope=function(n){return n.flags&ut||!this.inModule&&n.flags&at},G.declareName=function(n,p,k){var F=!1;if(p===nt){var W=this.currentScope();F=W.lexical.indexOf(n)>-1||W.functions.indexOf(n)>-1||W.var.indexOf(n)>-1,W.lexical.push(n),this.inModule&&W.flags&at&&delete this.undefinedExports[n]}else if(p===Qe){var ue=this.currentScope();ue.lexical.push(n)}else if(p===Ki){var ce=this.currentScope();this.treatFunctionsAsVar?F=ce.lexical.indexOf(n)>-1:F=ce.lexical.indexOf(n)>-1||ce.var.indexOf(n)>-1,ce.functions.push(n)}else for(var ke=this.scopeStack.length-1;ke>=0;--ke){var Oe=this.scopeStack[ke];if(Oe.lexical.indexOf(n)>-1&&!(Oe.flags&kn&&Oe.lexical[0]===n)||!this.treatFunctionsAsVarInScope(Oe)&&Oe.functions.indexOf(n)>-1){F=!0;break}if(Oe.var.push(n),this.inModule&&Oe.flags&at&&delete this.undefinedExports[n],Oe.flags&Oi)break}F&&this.raiseRecoverable(k,"Identifier '"+n+"' has already been declared")},G.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)},G.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},G.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var p=this.scopeStack[n];if(p.flags&(Oi|yi|Jt))return p}},G.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var p=this.scopeStack[n];if(p.flags&(Oi|yi|Jt)&&!(p.flags&oi))return p}};var K=function(p,k,F){this.type="",this.start=k,this.end=0,p.options.locations&&(this.loc=new Yt(p,F)),p.options.directSourceFile&&(this.sourceFile=p.options.directSourceFile),p.options.ranges&&(this.range=[k,0])},ee=i.prototype;ee.startNode=function(){return new K(this,this.start,this.startLoc)},ee.startNodeAt=function(n,p){return new K(this,n,p)};function j(n,p,k,F){return n.type=p,n.end=k,this.options.locations&&(n.loc.end=F),this.options.ranges&&(n.range[1]=k),n}ee.finishNode=function(n,p){return j.call(this,n,p,this.lastTokEnd,this.lastTokEndLoc)},ee.finishNodeAt=function(n,p,k,F){return j.call(this,n,p,k,F)},ee.copyNode=function(n){var p=new K(this,n.start,this.startLoc);for(var k in n)p[k]=n[k];return p};var J="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",ie="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",se=ie+" Extended_Pictographic",ae=se,le=ae+" EBase EComp EMod EPres ExtPict",we=le,Ee=we,Me={9:ie,10:se,11:ae,12:le,13:we,14:Ee},Ne="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",me={9:"",10:"",11:"",12:"",13:"",14:Ne},ye="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Le="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",De=Le+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Re=De+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ue=Re+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Be=Ue+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",je=Be+" "+J,Ke={9:Le,10:De,11:Re,12:Ue,13:Be,14:je},qe={};function _t(n){var p=qe[n]={binary:Fe(Me[n]+" "+ye),binaryOfStrings:Fe(me[n]),nonBinary:{General_Category:Fe(ye),Script:Fe(Ke[n])}};p.nonBinary.Script_Extensions=p.nonBinary.Script,p.nonBinary.gc=p.nonBinary.General_Category,p.nonBinary.sc=p.nonBinary.Script,p.nonBinary.scx=p.nonBinary.Script_Extensions}for(var gt=0,bt=[9,10,11,12,13,14];gt<bt.length;gt+=1){var mt=bt[gt];_t(mt)}var Ae=i.prototype,lt=function(p,k){this.parent=p,this.base=k||this};lt.prototype.separatedFrom=function(p){for(var k=this;k;k=k.parent)for(var F=p;F;F=F.parent)if(k.base===F.base&&k!==F)return!0;return!1},lt.prototype.sibling=function(){return new lt(this.parent,this.base)};var ct=function(p){this.parser=p,this.validFlags="gim"+(p.options.ecmaVersion>=6?"uy":"")+(p.options.ecmaVersion>=9?"s":"")+(p.options.ecmaVersion>=13?"d":"")+(p.options.ecmaVersion>=15?"v":""),this.unicodeProperties=qe[p.options.ecmaVersion>=14?14:p.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};ct.prototype.reset=function(p,k,F){var W=F.indexOf("v")!==-1,ue=F.indexOf("u")!==-1;this.start=p|0,this.source=k+"",this.flags=F,W&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=ue&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=ue&&this.parser.options.ecmaVersion>=9)},ct.prototype.raise=function(p){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+p)},ct.prototype.at=function(p,k){k===void 0&&(k=!1);var F=this.source,W=F.length;if(p>=W)return-1;var ue=F.charCodeAt(p);if(!(k||this.switchU)||ue<=55295||ue>=57344||p+1>=W)return ue;var ce=F.charCodeAt(p+1);return ce>=56320&&ce<=57343?(ue<<10)+ce-56613888:ue},ct.prototype.nextIndex=function(p,k){k===void 0&&(k=!1);var F=this.source,W=F.length;if(p>=W)return W;var ue=F.charCodeAt(p),ce;return!(k||this.switchU)||ue<=55295||ue>=57344||p+1>=W||(ce=F.charCodeAt(p+1))<56320||ce>57343?p+1:p+2},ct.prototype.current=function(p){return p===void 0&&(p=!1),this.at(this.pos,p)},ct.prototype.lookahead=function(p){return p===void 0&&(p=!1),this.at(this.nextIndex(this.pos,p),p)},ct.prototype.advance=function(p){p===void 0&&(p=!1),this.pos=this.nextIndex(this.pos,p)},ct.prototype.eat=function(p,k){return k===void 0&&(k=!1),this.current(k)===p?(this.advance(k),!0):!1},ct.prototype.eatChars=function(p,k){k===void 0&&(k=!1);for(var F=this.pos,W=0,ue=p;W<ue.length;W+=1){var ce=ue[W],ke=this.at(F,k);if(ke===-1||ke!==ce)return!1;F=this.nextIndex(F,k)}return this.pos=F,!0},Ae.validateRegExpFlags=function(n){for(var p=n.validFlags,k=n.flags,F=!1,W=!1,ue=0;ue<k.length;ue++){var ce=k.charAt(ue);p.indexOf(ce)===-1&&this.raise(n.start,"Invalid regular expression flag"),k.indexOf(ce,ue+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),ce==="u"&&(F=!0),ce==="v"&&(W=!0)}this.options.ecmaVersion>=15&&F&&W&&this.raise(n.start,"Invalid regular expression flag")};function yt(n){for(var p in n)return!0;return!1}Ae.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&yt(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))},Ae.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var p=0,k=n.backReferenceNames;p<k.length;p+=1){var F=k[p];n.groupNames[F]||n.raise("Invalid named capture referenced")}},Ae.regexp_disjunction=function(n){var p=this.options.ecmaVersion>=16;for(p&&(n.branchID=new lt(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)p&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);p&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")},Ae.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););},Ae.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1},Ae.regexp_eatAssertion=function(n){var p=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=p}if(n.eat(40)&&n.eat(63)){var k=!1;if(this.options.ecmaVersion>=9&&(k=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!k,!0}return n.pos=p,!1},Ae.regexp_eatQuantifier=function(n,p){return p===void 0&&(p=!1),this.regexp_eatQuantifierPrefix(n,p)?(n.eat(63),!0):!1},Ae.regexp_eatQuantifierPrefix=function(n,p){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,p)},Ae.regexp_eatBracedQuantifier=function(n,p){var k=n.pos;if(n.eat(123)){var F=0,W=-1;if(this.regexp_eatDecimalDigits(n)&&(F=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(W=n.lastIntValue),n.eat(125)))return W!==-1&&W<F&&!p&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!p&&n.raise("Incomplete quantifier"),n.pos=k}return!1},Ae.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)},Ae.regexp_eatReverseSolidusAtomEscape=function(n){var p=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=p}return!1},Ae.regexp_eatUncapturingGroup=function(n){var p=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var k=this.regexp_eatModifiers(n),F=n.eat(45);if(k||F){for(var W=0;W<k.length;W++){var ue=k.charAt(W);k.indexOf(ue,W+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(F){var ce=this.regexp_eatModifiers(n);!k&&!ce&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var ke=0;ke<ce.length;ke++){var Oe=ce.charAt(ke);(ce.indexOf(Oe,ke+1)>-1||k.indexOf(Oe)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=p}return!1},Ae.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1},Ae.regexp_eatModifiers=function(n){for(var p="",k=0;(k=n.current())!==-1&&Nt(k);)p+=it(k),n.advance();return p};function Nt(n){return n===105||n===109||n===115}Ae.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)},Ae.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1},Ae.regexp_eatSyntaxCharacter=function(n){var p=n.current();return Gt(p)?(n.lastIntValue=p,n.advance(),!0):!1};function Gt(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}Ae.regexp_eatPatternCharacters=function(n){for(var p=n.pos,k=0;(k=n.current())!==-1&&!Gt(k);)n.advance();return n.pos!==p},Ae.regexp_eatExtendedPatternCharacter=function(n){var p=n.current();return p!==-1&&p!==36&&!(p>=40&&p<=43)&&p!==46&&p!==63&&p!==91&&p!==94&&p!==124?(n.advance(),!0):!1},Ae.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var p=this.options.ecmaVersion>=16,k=n.groupNames[n.lastStringValue];if(k)if(p)for(var F=0,W=k;F<W.length;F+=1){var ue=W[F];ue.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");p?(k||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}},Ae.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1},Ae.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=it(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=it(n.lastIntValue);return!0}return!1},Ae.regexp_eatRegExpIdentifierStart=function(n){var p=n.pos,k=this.options.ecmaVersion>=11,F=n.current(k);return n.advance(k),F===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,k)&&(F=n.lastIntValue),Rt(F)?(n.lastIntValue=F,!0):(n.pos=p,!1)};function Rt(n){return Q(n,!0)||n===36||n===95}Ae.regexp_eatRegExpIdentifierPart=function(n){var p=n.pos,k=this.options.ecmaVersion>=11,F=n.current(k);return n.advance(k),F===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,k)&&(F=n.lastIntValue),Dt(F)?(n.lastIntValue=F,!0):(n.pos=p,!1)};function Dt(n){return X(n,!0)||n===36||n===95||n===8204||n===8205}Ae.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)},Ae.regexp_eatBackReference=function(n){var p=n.pos;if(this.regexp_eatDecimalEscape(n)){var k=n.lastIntValue;if(n.switchU)return k>n.maxBackReference&&(n.maxBackReference=k),!0;if(k<=n.numCapturingParens)return!0;n.pos=p}return!1},Ae.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1},Ae.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)},Ae.regexp_eatCControlLetter=function(n){var p=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=p}return!1},Ae.regexp_eatZero=function(n){return n.current()===48&&!ui(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1},Ae.regexp_eatControlEscape=function(n){var p=n.current();return p===116?(n.lastIntValue=9,n.advance(),!0):p===110?(n.lastIntValue=10,n.advance(),!0):p===118?(n.lastIntValue=11,n.advance(),!0):p===102?(n.lastIntValue=12,n.advance(),!0):p===114?(n.lastIntValue=13,n.advance(),!0):!1},Ae.regexp_eatControlLetter=function(n){var p=n.current();return It(p)?(n.lastIntValue=p%32,n.advance(),!0):!1};function It(n){return n>=65&&n<=90||n>=97&&n<=122}Ae.regexp_eatRegExpUnicodeEscapeSequence=function(n,p){p===void 0&&(p=!1);var k=n.pos,F=p||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var W=n.lastIntValue;if(F&&W>=55296&&W<=56319){var ue=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var ce=n.lastIntValue;if(ce>=56320&&ce<=57343)return n.lastIntValue=(W-55296)*1024+(ce-56320)+65536,!0}n.pos=ue,n.lastIntValue=W}return!0}if(F&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&Lt(n.lastIntValue))return!0;F&&n.raise("Invalid unicode escape"),n.pos=k}return!1};function Lt(n){return n>=0&&n<=1114111}Ae.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var p=n.current();return p!==99&&(!n.switchN||p!==107)?(n.lastIntValue=p,n.advance(),!0):!1},Ae.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var p=n.current();if(p>=49&&p<=57){do n.lastIntValue=10*n.lastIntValue+(p-48),n.advance();while((p=n.current())>=48&&p<=57);return!0}return!1};var jt=0,xt=1,kt=2;Ae.regexp_eatCharacterClassEscape=function(n){var p=n.current();if(An(p))return n.lastIntValue=-1,n.advance(),xt;var k=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((k=p===80)||p===112)){n.lastIntValue=-1,n.advance();var F;if(n.eat(123)&&(F=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return k&&F===kt&&n.raise("Invalid property name"),F;n.raise("Invalid property name")}return jt};function An(n){return n===100||n===68||n===115||n===83||n===119||n===87}Ae.regexp_eatUnicodePropertyValueExpression=function(n){var p=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var k=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var F=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,k,F),xt}}if(n.pos=p,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var W=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,W)}return jt},Ae.regexp_validateUnicodePropertyNameAndValue=function(n,p,k){ge(n.unicodeProperties.nonBinary,p)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[p].test(k)||n.raise("Invalid property value")},Ae.regexp_validateUnicodePropertyNameOrValue=function(n,p){if(n.unicodeProperties.binary.test(p))return xt;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(p))return kt;n.raise("Invalid property name")},Ae.regexp_eatUnicodePropertyName=function(n){var p=0;for(n.lastStringValue="";Yi(p=n.current());)n.lastStringValue+=it(p),n.advance();return n.lastStringValue!==""};function Yi(n){return It(n)||n===95}Ae.regexp_eatUnicodePropertyValue=function(n){var p=0;for(n.lastStringValue="";Tn(p=n.current());)n.lastStringValue+=it(p),n.advance();return n.lastStringValue!==""};function Tn(n){return Yi(n)||ui(n)}Ae.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)},Ae.regexp_eatCharacterClass=function(n){if(n.eat(91)){var p=n.eat(94),k=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),p&&k===kt&&n.raise("Negated character class may contain strings"),!0}return!1},Ae.regexp_classContents=function(n){return n.current()===93?xt:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),xt)},Ae.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var p=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var k=n.lastIntValue;n.switchU&&(p===-1||k===-1)&&n.raise("Invalid character class"),p!==-1&&k!==-1&&p>k&&n.raise("Range out of order in character class")}}},Ae.regexp_eatClassAtom=function(n){var p=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var k=n.current();(k===99||ei(k))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=p}var F=n.current();return F!==93?(n.lastIntValue=F,n.advance(),!0):!1},Ae.regexp_eatClassEscape=function(n){var p=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=p}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)},Ae.regexp_classSetExpression=function(n){var p=xt,k;if(!this.regexp_eatClassSetRange(n))if(k=this.regexp_eatClassSetOperand(n)){k===kt&&(p=kt);for(var F=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(k=this.regexp_eatClassSetOperand(n))){k!==kt&&(p=xt);continue}n.raise("Invalid character in character class")}if(F!==n.pos)return p;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(F!==n.pos)return p}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(k=this.regexp_eatClassSetOperand(n),!k)return p;k===kt&&(p=kt)}},Ae.regexp_eatClassSetRange=function(n){var p=n.pos;if(this.regexp_eatClassSetCharacter(n)){var k=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var F=n.lastIntValue;return k!==-1&&F!==-1&&k>F&&n.raise("Range out of order in character class"),!0}n.pos=p}return!1},Ae.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?xt:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)},Ae.regexp_eatNestedClass=function(n){var p=n.pos;if(n.eat(91)){var k=n.eat(94),F=this.regexp_classContents(n);if(n.eat(93))return k&&F===kt&&n.raise("Negated character class may contain strings"),F;n.pos=p}if(n.eat(92)){var W=this.regexp_eatCharacterClassEscape(n);if(W)return W;n.pos=p}return null},Ae.regexp_eatClassStringDisjunction=function(n){var p=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var k=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return k}else n.raise("Invalid escape");n.pos=p}return null},Ae.regexp_classStringDisjunctionContents=function(n){for(var p=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===kt&&(p=kt);return p},Ae.regexp_classString=function(n){for(var p=0;this.regexp_eatClassSetCharacter(n);)p++;return p===1?xt:kt},Ae.regexp_eatClassSetCharacter=function(n){var p=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=p,!1);var k=n.current();return k<0||k===n.lookahead()&&Mn(k)||Ln(k)?!1:(n.advance(),n.lastIntValue=k,!0)};function Mn(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function Ln(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}Ae.regexp_eatClassSetReservedPunctuator=function(n){var p=n.current();return Ni(p)?(n.lastIntValue=p,n.advance(),!0):!1};function Ni(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}Ae.regexp_eatClassControlLetter=function(n){var p=n.current();return ui(p)||p===95?(n.lastIntValue=p%32,n.advance(),!0):!1},Ae.regexp_eatHexEscapeSequence=function(n){var p=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=p}return!1},Ae.regexp_eatDecimalDigits=function(n){var p=n.pos,k=0;for(n.lastIntValue=0;ui(k=n.current());)n.lastIntValue=10*n.lastIntValue+(k-48),n.advance();return n.pos!==p};function ui(n){return n>=48&&n<=57}Ae.regexp_eatHexDigits=function(n){var p=n.pos,k=0;for(n.lastIntValue=0;bi(k=n.current());)n.lastIntValue=16*n.lastIntValue+wi(k),n.advance();return n.pos!==p};function bi(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function wi(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}Ae.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var p=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var k=n.lastIntValue;p<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=p*64+k*8+n.lastIntValue:n.lastIntValue=p*8+k}else n.lastIntValue=p;return!0}return!1},Ae.regexp_eatOctalDigit=function(n){var p=n.current();return ei(p)?(n.lastIntValue=p-48,n.advance(),!0):(n.lastIntValue=0,!1)};function ei(n){return n>=48&&n<=55}Ae.regexp_eatFixedHexDigits=function(n,p){var k=n.pos;n.lastIntValue=0;for(var F=0;F<p;++F){var W=n.current();if(!bi(W))return n.pos=k,!1;n.lastIntValue=16*n.lastIntValue+wi(W),n.advance()}return!0};var Ut=function(p){this.type=p.type,this.value=p.value,this.start=p.start,this.end=p.end,p.options.locations&&(this.loc=new Yt(p,p.startLoc,p.endLoc)),p.options.ranges&&(this.range=[p.start,p.end])},Ze=i.prototype;Ze.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ut(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Ze.getToken=function(){return this.next(),new Ut(this)},typeof Symbol<"u"&&(Ze[Symbol.iterator]=function(){var n=this;return{next:function(){var p=n.getToken();return{done:p.type===T.eof,value:p}}}}),Ze.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(T.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())},Ze.readToken=function(n){return Q(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)},Ze.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var p=this.input.charCodeAt(this.pos+1);return p<=56319||p>=57344?n:(n<<10)+p-56613888},Ze.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),p=this.pos,k=this.input.indexOf("*/",this.pos+=2);if(k===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=k+2,this.options.locations)for(var F=void 0,W=p;(F=Se(this.input,W,this.pos))>-1;)++this.curLine,W=this.lineStart=F;this.options.onComment&&this.options.onComment(!0,this.input.slice(p+2,k),p,this.pos,n,this.curPosition())},Ze.skipLineComment=function(n){for(var p=this.pos,k=this.options.onComment&&this.curPosition(),F=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!de(F);)F=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(p+n,this.pos),p,this.pos,k,this.curPosition())},Ze.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&Ie.test(String.fromCharCode(n)))++this.pos;else break e}}},Ze.finishToken=function(n,p){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var k=this.type;this.type=n,this.value=p,this.updateContext(k)},Ze.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var p=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&p===46?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))},Ze.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(T.assign,2):this.finishOp(T.slash,1)},Ze.readToken_mult_modulo_exp=function(n){var p=this.input.charCodeAt(this.pos+1),k=1,F=n===42?T.star:T.modulo;return this.options.ecmaVersion>=7&&n===42&&p===42&&(++k,F=T.starstar,p=this.input.charCodeAt(this.pos+2)),p===61?this.finishOp(T.assign,k+1):this.finishOp(F,k)},Ze.readToken_pipe_amp=function(n){var p=this.input.charCodeAt(this.pos+1);if(p===n){if(this.options.ecmaVersion>=12){var k=this.input.charCodeAt(this.pos+2);if(k===61)return this.finishOp(T.assign,3)}return this.finishOp(n===124?T.logicalOR:T.logicalAND,2)}return p===61?this.finishOp(T.assign,2):this.finishOp(n===124?T.bitwiseOR:T.bitwiseAND,1)},Ze.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)},Ze.readToken_plus_min=function(n){var p=this.input.charCodeAt(this.pos+1);return p===n?p===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ve.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(T.incDec,2):p===61?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)},Ze.readToken_lt_gt=function(n){var p=this.input.charCodeAt(this.pos+1),k=1;return p===n?(k=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+k)===61?this.finishOp(T.assign,k+1):this.finishOp(T.bitShift,k)):p===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(p===61&&(k=2),this.finishOp(T.relational,k))},Ze.readToken_eq_excl=function(n){var p=this.input.charCodeAt(this.pos+1);return p===61?this.finishOp(T.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&p===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(n===61?T.eq:T.prefix,1)},Ze.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var p=this.input.charCodeAt(this.pos+1);if(p===46){var k=this.input.charCodeAt(this.pos+2);if(k<48||k>57)return this.finishOp(T.questionDot,2)}if(p===63){if(n>=12){var F=this.input.charCodeAt(this.pos+2);if(F===61)return this.finishOp(T.assign,3)}return this.finishOp(T.coalesce,2)}}return this.finishOp(T.question,1)},Ze.readToken_numberSign=function(){var n=this.options.ecmaVersion,p=35;if(n>=13&&(++this.pos,p=this.fullCharCodeAtPos(),Q(p,!0)||p===92))return this.finishToken(T.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+it(p)+"'")},Ze.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var p=this.input.charCodeAt(this.pos+1);if(p===120||p===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(p===111||p===79)return this.readRadixNumber(8);if(p===98||p===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(T.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+it(n)+"'")},Ze.finishOp=function(n,p){var k=this.input.slice(this.pos,this.pos+p);return this.pos+=p,this.finishToken(n,k)},Ze.readRegexp=function(){for(var n,p,k=this.pos;;){this.pos>=this.input.length&&this.raise(k,"Unterminated regular expression");var F=this.input.charAt(this.pos);if(ve.test(F)&&this.raise(k,"Unterminated regular expression"),n)n=!1;else{if(F==="[")p=!0;else if(F==="]"&&p)p=!1;else if(F==="/"&&!p)break;n=F==="\\"}++this.pos}var W=this.input.slice(k,this.pos);++this.pos;var ue=this.pos,ce=this.readWord1();this.containsEsc&&this.unexpected(ue);var ke=this.regexpState||(this.regexpState=new ct(this));ke.reset(k,W,ce),this.validateRegExpFlags(ke),this.validateRegExpPattern(ke);var Oe=null;try{Oe=new RegExp(W,ce)}catch{}return this.finishToken(T.regexp,{pattern:W,flags:ce,value:Oe})},Ze.readInt=function(n,p,k){for(var F=this.options.ecmaVersion>=12&&p===void 0,W=k&&this.input.charCodeAt(this.pos)===48,ue=this.pos,ce=0,ke=0,Oe=0,Ge=p??1/0;Oe<Ge;++Oe,++this.pos){var $e=this.input.charCodeAt(this.pos),ot=void 0;if(F&&$e===95){W&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),ke===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Oe===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),ke=$e;continue}if($e>=97?ot=$e-97+10:$e>=65?ot=$e-65+10:$e>=48&&$e<=57?ot=$e-48:ot=1/0,ot>=n)break;ke=$e,ce=ce*n+ot}return F&&ke===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===ue||p!=null&&this.pos-ue!==p?null:ce};function Vt(n,p){return p?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function qt(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}Ze.readRadixNumber=function(n){var p=this.pos;this.pos+=2;var k=this.readInt(n);return k==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(k=qt(this.input.slice(p,this.pos)),++this.pos):Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,k)},Ze.readNumber=function(n){var p=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(p,"Invalid number");var k=this.pos-p>=2&&this.input.charCodeAt(p)===48;k&&this.strict&&this.raise(p,"Invalid number");var F=this.input.charCodeAt(this.pos);if(!k&&!n&&this.options.ecmaVersion>=11&&F===110){var W=qt(this.input.slice(p,this.pos));return++this.pos,Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,W)}k&&/[89]/.test(this.input.slice(p,this.pos))&&(k=!1),F===46&&!k&&(++this.pos,this.readInt(10),F=this.input.charCodeAt(this.pos)),(F===69||F===101)&&!k&&(F=this.input.charCodeAt(++this.pos),(F===43||F===45)&&++this.pos,this.readInt(10)===null&&this.raise(p,"Invalid number")),Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var ue=Vt(this.input.slice(p,this.pos),k);return this.finishToken(T.num,ue)},Ze.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),p;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var k=++this.pos;p=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,p>1114111&&this.invalidStringToken(k,"Code point out of bounds")}else p=this.readHexChar(4);return p},Ze.readString=function(n){for(var p="",k=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var F=this.input.charCodeAt(this.pos);if(F===n)break;F===92?(p+=this.input.slice(k,this.pos),p+=this.readEscapedChar(!1),k=this.pos):F===8232||F===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(de(F)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return p+=this.input.slice(k,this.pos++),this.finishToken(T.string,p)};var Ft={};Ze.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===Ft)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1},Ze.invalidStringToken=function(n,p){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ft;this.raise(n,p)},Ze.readTmplToken=function(){for(var n="",p=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var k=this.input.charCodeAt(this.pos);if(k===96||k===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===T.template||this.type===T.invalidTemplate)?k===36?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote)):(n+=this.input.slice(p,this.pos),this.finishToken(T.template,n));if(k===92)n+=this.input.slice(p,this.pos),n+=this.readEscapedChar(!0),p=this.pos;else if(de(k)){switch(n+=this.input.slice(p,this.pos),++this.pos,k){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(k);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),p=this.pos}else++this.pos}},Ze.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},Ze.readEscapedChar=function(n){var p=this.input.charCodeAt(++this.pos);switch(++this.pos,p){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return it(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var k=this.pos-1;this.invalidStringToken(k,"Invalid escape sequence in template string")}default:if(p>=48&&p<=55){var F=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],W=parseInt(F,8);return W>255&&(F=F.slice(0,-1),W=parseInt(F,8)),this.pos+=F.length-1,p=this.input.charCodeAt(this.pos),(F!=="0"||p===56||p===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-F.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(W)}return de(p)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(p)}},Ze.readHexChar=function(n){var p=this.pos,k=this.readInt(16,n);return k===null&&this.invalidStringToken(p,"Bad character escape sequence"),k},Ze.readWord1=function(){this.containsEsc=!1;for(var n="",p=!0,k=this.pos,F=this.options.ecmaVersion>=6;this.pos<this.input.length;){var W=this.fullCharCodeAtPos();if(X(W,F))this.pos+=W<=65535?1:2;else if(W===92){this.containsEsc=!0,n+=this.input.slice(k,this.pos);var ue=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var ce=this.readCodePoint();(p?Q:X)(ce,F)||this.invalidStringToken(ue,"Invalid Unicode escape"),n+=it(ce),k=this.pos}else break;p=!1}return n+this.input.slice(k,this.pos)},Ze.readWord=function(){var n=this.readWord1(),p=T.name;return this.keywords.test(n)&&(p=_e[n]),this.finishToken(p,n)};var ti="8.15.0";i.acorn={Parser:i,version:ti,defaultOptions:dt,Position:Bt,SourceLocation:Yt,getLineInfo:Wi,Node:K,TokenType:te,tokTypes:T,keywordTypes:_e,TokContext:V,tokContexts:I,isIdentifierChar:X,isIdentifierStart:Q,Token:Ut,isNewLine:de,lineBreak:ve,lineBreakG:xe,nonASCIIwhitespace:Ie};function Qi(n,p){return i.parse(n,p)}function $i(n,p,k){return i.parseExpressionAt(n,p,k)}function Ji(n,p){return i.tokenizer(n,p)}a.Node=K,a.Parser=i,a.Position=Bt,a.SourceLocation=Yt,a.TokContext=V,a.Token=Ut,a.TokenType=te,a.defaultOptions=dt,a.getLineInfo=Wi,a.isIdentifierChar=X,a.isIdentifierStart=Q,a.isNewLine=de,a.keywordTypes=_e,a.lineBreak=ve,a.lineBreakG=xe,a.nonASCIIwhitespace=Ie,a.parse=Qi,a.parseExpressionAt=$i,a.tokContexts=I,a.tokTypes=T,a.tokenizer=Ji,a.version=ti}))})(fn,fn.exports)),fn.exports}/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var to=Wn.exports,gs;function io(){return gs||(gs=1,(function(u){(function(s,a){s=s||ds;var l=s.window,f=s.document,o=new function(){var e=/^(statics|enumerable|beans|preserve)$/,i=[],r=i.slice,h=Object.create,c=Object.getOwnPropertyDescriptor,g=Object.defineProperty,m=i.forEach||function(P,C){for(var B=0,O=this.length;B<O;B++)P.call(C,this[B],B,this)},v=function(P,C){for(var B in this)this.hasOwnProperty(B)&&P.call(C,this[B],B,this)},y=Object.assign||function(P){for(var C=1,B=arguments.length;C<B;C++){var O=arguments[C];for(var V in O)O.hasOwnProperty(V)&&(P[V]=O[V])}return P},x=function(P,C,B){if(P){var O=c(P,"length");(O&&typeof O.value=="number"?m:v).call(P,C,B=B||P)}return B};function E(P,C,B,O,V){var I={};function R(D,G){G=G||(G=c(C,D))&&(G.get?G:G.value),typeof G=="string"&&G[0]==="#"&&(G=P[G.substring(1)]||G);var Z=typeof G=="function",K=G,ee=V||Z&&!G.base?G&&G.get?D in P:P[D]:null,j;(!V||!ee)&&(Z&&ee&&(G.base=ee),Z&&O!==!1&&(j=D.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(I[j[3].toLowerCase()+j[4]]=j[2]),(!K||Z||!K.get||typeof K.get!="function"||!A.isPlainObject(K))&&(K={value:K,writable:!0}),(c(P,D)||{configurable:!0}).configurable&&(K.configurable=!0,K.enumerable=B??!j),g(P,D,K))}if(C){for(var w in C)C.hasOwnProperty(w)&&!e.test(w)&&R(w);for(var w in I){var N=I[w],U=P["set"+N],q=P["get"+N]||U&&P["is"+N];q&&(O===!0||q.length===0)&&R(w,{get:q,set:U})}}return P}function A(){for(var P=0,C=arguments.length;P<C;P++){var B=arguments[P];B&&y(this,B)}return this}return E(A,{inject:function(P){if(P){var C=P.statics===!0?P:P.statics,B=P.beans,O=P.preserve;C!==P&&E(this.prototype,P,P.enumerable,B,O),E(this,C,null,B,O)}for(var V=1,I=arguments.length;V<I;V++)this.inject(arguments[V]);return this},extend:function(){for(var P=this,C,B,O=0,V,I=arguments.length;O<I&&!(C&&B);O++)V=arguments[O],C=C||V.initialize,B=B||V.prototype;return C=C||function(){P.apply(this,arguments)},B=C.prototype=B||h(this.prototype),g(B,"constructor",{value:C,writable:!0,configurable:!0}),E(C,this),arguments.length&&this.inject.apply(C,arguments),C.base=P,C}}).inject({enumerable:!1,initialize:A,set:A,inject:function(){for(var P=0,C=arguments.length;P<C;P++){var B=arguments[P];B&&E(this,B,B.enumerable,B.beans,B.preserve)}return this},extend:function(){var P=h(this);return P.inject.apply(P,arguments)},each:function(P,C){return x(this,P,C)},clone:function(){return new this.constructor(this)},statics:{set:y,each:x,create:h,define:g,describe:c,clone:function(P){return y(new P.constructor,P)},isPlainObject:function(P){var C=P!=null&&P.constructor;return C&&(C===Object||C===A||C.name==="Object")},pick:function(P,C){return P!==a?P:C},slice:function(P,C,B){return r.call(P,C,B)}}})};u.exports=o,o.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+o.each(this,function(e,i){if(!/^_/.test(i)){var r=typeof e;this.push(i+": "+(r==="number"?z.instance.number(e):r==="string"?"'"+e+"'":e))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(e){return o.importJSON(e,this)},exportJSON:function(e){return o.exportJSON(this,e)},toJSON:function(){return o.serialize(this)},set:function(e,i){return e&&o.filter(this,e,i,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function e(){var i=e.base.apply(this,arguments),r=i.prototype._class;return r&&!o.exports[r]&&(o.exports[r]=i),i},equals:function(e,i){if(e===i)return!0;if(e&&e.equals)return e.equals(i);if(i&&i.equals)return i.equals(e);if(e&&i&&typeof e=="object"&&typeof i=="object"){if(Array.isArray(e)&&Array.isArray(i)){var r=e.length;if(r!==i.length)return!1;for(;r--;)if(!o.equals(e[r],i[r]))return!1}else{var h=Object.keys(e),r=h.length;if(r!==Object.keys(i).length)return!1;for(;r--;){var c=h[r];if(!(i.hasOwnProperty(c)&&o.equals(e[c],i[c])))return!1}}return!0}return!1},read:function(e,i,r,h){if(this===o){var c=this.peek(e,i);return e.__index++,c}var g=this.prototype,m=g._readIndex,v=i||m&&e.__index||0,y=e.length,x=e[v];if(h=h||y-v,x instanceof this||r&&r.readNull&&x==null&&h<=1)return m&&(e.__index=v+1),x&&r&&r.clone?x.clone():x;if(x=o.create(g),m&&(x.__read=!0),x=x.initialize.apply(x,v>0||v+h<y?o.slice(e,v,v+h):e)||x,m){e.__index=v+x.__read;var E=x.__filtered;E&&(e.__filtered=E,x.__filtered=a),x.__read=a}return x},peek:function(e,i){return e[e.__index=i||e.__index||0]},remain:function(e){return e.length-(e.__index||0)},readList:function(e,i,r,h){for(var c=[],g,m=i||0,v=h?m+h:e.length,y=m;y<v;y++)c.push(Array.isArray(g=e[y])?this.read(g,0,r):this.read(e,y,r,1));return c},readNamed:function(e,i,r,h,c){var g=this.getNamed(e,i),m=g!==a;if(m){var v=e.__filtered;if(!v){var y=this.getSource(e);v=e.__filtered=o.create(y),v.__unfiltered=y}v[i]=a}return this.read(m?[g]:e,r,h,c)},readSupported:function(e,i){var r=this.getSource(e),h=this,c=!1;return r&&Object.keys(r).forEach(function(g){if(g in i){var m=h.readNamed(e,g);m!==a&&(i[g]=m),c=!0}}),c},getSource:function(e){var i=e.__source;if(i===a){var r=e.length===1&&e[0];i=e.__source=r&&o.isPlainObject(r)?r:null}return i},getNamed:function(e,i){var r=this.getSource(e);if(r)return i?r[i]:e.__filtered||r},hasNamed:function(e,i){return!!this.getNamed(e,i)},filter:function(e,i,r,h){var c;function g(E){if(!(r&&E in r)&&!(c&&E in c)){var A=i[E];A!==a&&(e[E]=A)}}if(h){for(var m={},v=0,y,x=h.length;v<x;v++)(y=h[v])in i&&(g(y),m[y]=!0);c=m}return Object.keys(i.__unfiltered||i).forEach(g),e},isPlainValue:function(e,i){return o.isPlainObject(e)||Array.isArray(e)||i&&typeof e=="string"},serialize:function(e,i,r,h){i=i||{};var c=!h,g;if(c&&(i.formatter=new z(i.precision),h={length:0,definitions:{},references:{},add:function(A,P){var C="#"+A._id,B=this.references[C];if(!B){this.length++;var O=P.call(A),V=A._class;V&&O[0]!==V&&O.unshift(V),this.definitions[C]=O,B=this.references[C]=[C]}return B}}),e&&e._serialize){g=e._serialize(i,h);var m=e._class;m&&!e._compactSerialize&&(c||!r)&&g[0]!==m&&g.unshift(m)}else if(Array.isArray(e)){g=[];for(var v=0,y=e.length;v<y;v++)g[v]=o.serialize(e[v],i,r,h)}else if(o.isPlainObject(e)){g={};for(var x=Object.keys(e),v=0,y=x.length;v<y;v++){var E=x[v];g[E]=o.serialize(e[E],i,r,h)}}else typeof e=="number"?g=i.formatter.number(e,i.precision):g=e;return c&&h.length>0?[["dictionary",h.definitions],g]:g},deserialize:function(e,i,r,h,c){var g=e,m=!r,v=m&&e&&e.length&&e[0][0]==="dictionary";if(r=r||{},Array.isArray(e)){var y=e[0],x=y==="dictionary";if(e.length==1&&/^#/.test(y))return r.dictionary[y];y=o.exports[y],g=[];for(var E=y?1:0,A=e.length;E<A;E++)g.push(o.deserialize(e[E],i,r,x,v));if(y){var P=g;i?g=i(y,P,m||c):g=new y(P)}}else if(o.isPlainObject(e)){g={},h&&(r.dictionary=g);for(var C in e)g[C]=o.deserialize(e[C],i,r)}return v?g[1]:g},exportJSON:function(e,i){var r=o.serialize(e,i);return i&&i.asString==!1?r:JSON.stringify(r)},importJSON:function(e,i){return o.deserialize(typeof e=="string"?JSON.parse(e):e,function(r,h,c){var g=c&&i&&i.constructor===r,m=g?i:o.create(r.prototype);if(h.length===1&&m instanceof T&&(g||!(m instanceof xe))){var v=h[0];o.isPlainObject(v)&&(v.insert=!1,g&&(h=h.concat([T.INSERT])))}return(g?m.set:r).apply(m,h),g&&(i=null),m})},push:function(e,i){var r=i.length;if(r<4096)e.push.apply(e,i);else{var h=e.length;e.length+=r;for(var c=0;c<r;c++)e[h+c]=i[c]}return e},splice:function(e,i,r,h){var c=i&&i.length,g=r===a;r=g?e.length:r,r>e.length&&(r=e.length);for(var m=0;m<c;m++)i[m]._index=r+m;if(g)return o.push(e,i),[];var v=[r,h];i&&o.push(v,i);for(var y=e.splice.apply(e,v),m=0,x=y.length;m<x;m++)y[m]._index=a;for(var m=r+c,x=e.length;m<x;m++)e[m]._index=m;return y},capitalize:function(e){return e.replace(/\b[a-z]/g,function(i){return i.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(i,r){return r.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var d={on:function(e,i){if(typeof e!="string")o.each(e,function(g,m){this.on(m,g)},this);else{var r=this._eventTypes,h=r&&r[e],c=this._callbacks=this._callbacks||{};c=c[e]=c[e]||[],c.indexOf(i)===-1&&(c.push(i),h&&h.install&&c.length===1&&h.install.call(this,e))}return this},off:function(e,i){if(typeof e!="string"){o.each(e,function(m,v){this.off(v,m)},this);return}var r=this._eventTypes,h=r&&r[e],c=this._callbacks&&this._callbacks[e],g;return c&&(!i||(g=c.indexOf(i))!==-1&&c.length===1?(h&&h.uninstall&&h.uninstall.call(this,e),delete this._callbacks[e]):g!==-1&&c.splice(g,1)),this},once:function(e,i){return this.on(e,function r(){i.apply(this,arguments),this.off(e,r)})},emit:function(e,i){var r=this._callbacks&&this._callbacks[e];if(!r)return!1;var h=o.slice(arguments,1),c=i&&i.target&&!i.currentTarget;r=r.slice(),c&&(i.currentTarget=this);for(var g=0,m=r.length;g<m;g++)if(r[g].apply(this,h)==!1){i&&i.stop&&i.stop();break}return c&&delete i.currentTarget,!0},responds:function(e){return!!(this._callbacks&&this._callbacks[e])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(e){var i=this._eventTypes,r=this._callbacks,h=e?"install":"uninstall";if(i){for(var c in r)if(r[c].length>0){var g=i[c],m=g&&g[h];m&&m.call(this,c)}}},statics:{inject:function e(i){var r=i._events;if(r){var h={};o.each(r,function(c,g){var m=typeof c=="string",v=m?c:g,y=o.capitalize(v),x=v.substring(2).toLowerCase();h[x]=m?{}:c,v="_"+v,i["get"+y]=function(){return this[v]},i["set"+y]=function(E){var A=this[v];A&&this.off(x,A),E&&this.on(x,E),this[v]=E}}),i._eventTypes=h}return e.base.apply(this,arguments)}}},_=o.extend({_class:"PaperScope",initialize:function e(){Qe=this,this.settings=new o({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=e._id++,e._scopes[this._id]=this;var i=e.prototype;if(!this.support){var r=pt.getContext(1,1)||{};i.support={nativeDash:"setLineDash"in r||"mozDash"in r,nativeBlendModes:xi.nativeModes},pt.release(r)}if(!this.agent){var h=s.navigator.userAgent.toLowerCase(),c=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(h)||[])[0],g=c==="darwin"?"mac":c,m=i.agent=i.browser={platform:g};g&&(m[g]=!0),h.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(v,y,x,E,A){if(!m.chrome){var P=y==="opera"?E:/^(node|trident)$/.test(y)?A:x;m.version=P,m.versionNumber=parseFloat(P),y={trident:"msie",jsdom:"node"}[y]||y,m.name=y,m[y]=!0}}),m.chrome&&delete m.webkit,m.atom&&delete m.chrome}},version:"0.12.18",getView:function(){var e=this.project;return e&&e._view},getPaper:function(){return this},execute:function(e,i){var r=Qe.PaperScript.execute(e,this,i);return ht.updateFocus(),r},install:function(e){var i=this;o.each(["project","view","tool"],function(h){o.define(e,h,{configurable:!0,get:function(){return i[h]}})});for(var r in this)!/^_/.test(r)&&this[r]&&(e[r]=this[r])},setup:function(e){return Qe=this,this.project=new he(e),this},createCanvas:function(e,i){return pt.getCanvas(e,i)},activate:function(){Qe=this},clear:function(){for(var e=this.projects,i=this.tools,r=e.length-1;r>=0;r--)e[r].remove();for(var r=i.length-1;r>=0;r--)i[r].remove()},remove:function(){this.clear(),delete _._scopes[this._id]},statics:new function(){function e(i){return i+="Attribute",function(r,h){return r[i](h)||r[i]("data-paper-"+h)}}return{_scopes:{},_id:0,get:function(i){return this._scopes[i]||null},getAttribute:e("get"),hasAttribute:e("has")}}}),b=o.extend(d,{initialize:function(e){this._scope=Qe,this._index=this._scope[this._list].push(this)-1,(e||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var e=this._scope[this._reference];return e&&e!==this&&e.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",e),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(o.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),S={findItemBoundsCollisions:function(e,i,r){function h(m){for(var v=new Array(m.length),y=0;y<m.length;y++){var x=m[y].getBounds();v[y]=[x.left,x.top,x.right,x.bottom]}return v}var c=h(e),g=!i||i===e?c:h(i);return this.findBoundsCollisions(c,g,r||0)},findCurveBoundsCollisions:function(e,i,r,h){function c(P){for(var C=Math.min,B=Math.max,O=new Array(P.length),V=0;V<P.length;V++){var I=P[V];O[V]=[C(I[0],I[2],I[4],I[6]),C(I[1],I[3],I[5],I[7]),B(I[0],I[2],I[4],I[6]),B(I[1],I[3],I[5],I[7])]}return O}var g=c(e),m=!i||i===e?g:c(i);if(h){for(var v=this.findBoundsCollisions(g,m,r||0,!1,!0),y=this.findBoundsCollisions(g,m,r||0,!0,!0),x=[],E=0,A=v.length;E<A;E++)x[E]={hor:v[E],ver:y[E]};return x}return this.findBoundsCollisions(g,m,r||0)},findBoundsCollisions:function(e,i,r,h,c){var g=!i||e===i,m=g?e:e.concat(i),v=e.length,y=m.length;function x(Ee,Me,Ne){for(var me=0,ye=Ee.length;me<ye;){var Le=ye+me>>>1;m[Ee[Le]][Me]<Ne?me=Le+1:ye=Le}return me-1}for(var E=h?1:0,A=E+2,P=h?0:1,C=P+2,B=new Array(y),O=0;O<y;O++)B[O]=O;B.sort(function(Ee,Me){return m[Ee][E]-m[Me][E]});for(var V=[],I=new Array(v),O=0;O<y;O++){var R=B[O],w=m[R],N=g?R:R-v,U=R<v,q=g||!U,D=U?[]:null;if(V.length){var G=x(V,A,w[E]-r)+1;if(V.splice(0,G),g&&c){D=D.concat(V);for(var Z=0;Z<V.length;Z++){var K=V[Z];I[K].push(N)}}else for(var ee=w[C],j=w[P],Z=0;Z<V.length;Z++){var K=V[Z],J=m[K],ie=K<v,se=g||K>=v;(c||(U&&se||q&&ie)&&ee>=J[P]-r&&j<=J[C]+r)&&(U&&se&&D.push(g?K:K-v),q&&ie&&I[K].push(N))}}if(U&&(e===i&&D.push(R),I[R]=D),V.length){var ae=w[A],le=x(V,A,ae);V.splice(le+1,0,R)}else V.push(R)}for(var O=0;O<I.length;O++){var we=I[O];we&&we.sort(function(Me,Ne){return Me-Ne})}return I}},z=o.extend({initialize:function(e){this.precision=o.pick(e,5),this.multiplier=Math.pow(10,this.precision)},number:function(e){return this.precision<16?Math.round(e*this.multiplier)/this.multiplier:e},pair:function(e,i,r){return this.number(e)+(r||",")+this.number(i)},point:function(e,i){return this.number(e.x)+(i||",")+this.number(e.y)},size:function(e,i){return this.number(e.width)+(i||",")+this.number(e.height)},rectangle:function(e,i){return this.point(e,i)+(i||",")+this.size(e,i)}});z.instance=new z;var M=new function(){var e=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],i=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],r=Math.abs,h=Math.sqrt,c=Math.pow,g=Math.log2||function(A){return Math.log(A)*Math.LOG2E},m=1e-12,v=112e-18;function y(A,P,C){return A<P?P:A>C?C:A}function x(A,P,C){function B(G){var Z=G*134217729,K=G-Z,ee=K+Z,j=G-ee;return[ee,j]}var O=P*P-A*C,V=P*P+A*C;if(r(O)*3<V){var I=B(A),R=B(P),w=B(C),N=P*P,U=R[0]*R[0]-N+2*R[0]*R[1]+R[1]*R[1],q=A*C,D=I[0]*w[0]-q+I[0]*w[1]+I[1]*w[0]+I[1]*w[1];O=N-q+(U-D)}return O}function E(){var A=Math.max.apply(Math,arguments);return A&&(A<1e-8||A>1e8)?c(2,-Math.round(g(A))):0}return{EPSILON:m,MACHINE_EPSILON:v,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(h(2)-1)/3,isZero:function(A){return A>=-m&&A<=m},isMachineZero:function(A){return A>=-v&&A<=v},clamp:y,integrate:function(A,P,C,B){for(var O=e[B-2],V=i[B-2],I=(C-P)*.5,R=I+P,w=0,N=B+1>>1,U=B&1?V[w++]*A(R):0;w<N;){var q=I*O[w];U+=V[w++]*(A(R+q)+A(R-q))}return I*U},findRoot:function(A,P,C,B,O,V,I){for(var R=0;R<V;R++){var w=A(C),N=w/P(C),U=C-N;if(r(N)<I){C=U;break}w>0?(O=C,C=U<=B?(B+O)*.5:U):(B=C,C=U>=O?(B+O)*.5:U)}return y(C,B,O)},solveQuadratic:function(A,P,C,B,O,V){var I,R=1/0;if(r(A)<m){if(r(P)<m)return r(C)<m?-1:0;I=-C/P}else{P*=-.5;var w=x(A,P,C);if(w&&r(w)<v){var N=E(r(A),r(P),r(C));N&&(A*=N,P*=N,C*=N,w=x(A,P,C))}if(w>=-v){var U=w<0?0:h(w),q=P+(P<0?-U:U);q===0?(I=C/A,R=-I):(I=q/A,R=C/q)}}var D=0,G=O==null,Z=O-m,K=V+m;return isFinite(I)&&(G||I>Z&&I<K)&&(B[D++]=G?I:y(I,O,V)),R!==I&&isFinite(R)&&(G||R>Z&&R<K)&&(B[D++]=G?R:y(R,O,V)),D},solveCubic:function(A,P,C,B,O,V,I){var R=E(r(A),r(P),r(C),r(B)),w,N,U,q,D;R&&(A*=R,P*=R,C*=R,B*=R);function G(le){w=le;var we=A*w;N=we+P,U=N*w+C,q=(we+N)*w+U,D=U*w+B}if(r(A)<m)A=P,N=C,U=B,w=1/0;else if(r(B)<m)N=P,U=C,w=0;else{G(-(P/A)/3);var Z=D/A,K=c(r(Z),1/3),ee=Z<0?-1:1,j=-q/A,J=j>0?1.324717957244746*Math.max(K,h(j)):K,ie=w-ee*J;if(ie!==w){do G(ie),ie=q===0?w:w-D/q/(1+v);while(ee*ie>ee*w);r(A)*w*w>r(B/w)&&(U=-B/w,N=(U-C)/w)}}var se=M.solveQuadratic(A,N,U,O,V,I),ae=V==null;return isFinite(w)&&(se===0||se>0&&w!==O[0]&&w!==O[1])&&(ae||w>V-m&&w<I+m)&&(O[se++]=ae?w:y(w,V,I)),se}}},H={_id:1,_pools:{},get:function(e){if(e){var i=this._pools[e];return i||(i=this._pools[e]={_id:1}),i._id++}else return this._id++}},L=o.extend({_class:"Point",_readIndex:!0,initialize:function(i,r){var h=typeof i,c=this.__read,g=0;if(h==="number"){var m=typeof r=="number";this._set(i,m?r:i),c&&(g=m?2:1)}else if(h==="undefined"||i===null)this._set(0,0),c&&(g=i===null?1:0);else{var v=h==="string"?i.split(/[\s,]+/)||[]:i;g=1,Array.isArray(v)?this._set(+v[0],+(v.length>1?v[1]:v[0])):"x"in v?this._set(v.x||0,v.y||0):"width"in v?this._set(v.width||0,v.height||0):"angle"in v?(this._set(v.length||0,0),this.setAngle(v.angle||0)):(this._set(0,0),g=0)}return c&&(this.__read=g),this},set:"#initialize",_set:function(e,i){return this.x=e,this.y=i,this},equals:function(e){return this===e||e&&(this.x===e.x&&this.y===e.y||Array.isArray(e)&&this.x===e[0]&&this.y===e[1])||!1},clone:function(){return new L(this.x,this.y)},toString:function(){var e=z.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+" }"},_serialize:function(e){var i=e.formatter;return[i.number(this.x),i.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(e){if(this.isZero()){var i=this._angle||0;this._set(Math.cos(i)*e,Math.sin(i)*e)}else{var r=e/this.getLength();M.isZero(r)&&this.getAngle(),this._set(this.x*r,this.y*r)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(e){this.setAngleInRadians.call(this,e*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var e=L.read(arguments),i=this.getLength()*e.getLength();if(M.isZero(i))return NaN;var r=this.dot(e)/i;return Math.acos(r<-1?-1:r>1?1:r)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(e){if(this._angle=e,!this.isZero()){var i=this.getLength();this._set(Math.cos(e)*i,Math.sin(e)*i)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var e=L.read(arguments);return Math.atan2(this.cross(e),this.dot(e))*180/Math.PI},getDistance:function(){var e=arguments,i=L.read(e),r=i.x-this.x,h=i.y-this.y,c=r*r+h*h,g=o.read(e);return g?c:Math.sqrt(c)},normalize:function(e){e===a&&(e=1);var i=this.getLength(),r=i!==0?e/i:0,h=new L(this.x*r,this.y*r);return r>=0&&(h._angle=this._angle),h},rotate:function(e,i){if(e===0)return this.clone();e=e*Math.PI/180;var r=i?this.subtract(i):this,h=Math.sin(e),c=Math.cos(e);return r=new L(r.x*c-r.y*h,r.x*h+r.y*c),i?r.add(i):r},transform:function(e){return e?e._transformPoint(this):this},add:function(){var e=L.read(arguments);return new L(this.x+e.x,this.y+e.y)},subtract:function(){var e=L.read(arguments);return new L(this.x-e.x,this.y-e.y)},multiply:function(){var e=L.read(arguments);return new L(this.x*e.x,this.y*e.y)},divide:function(){var e=L.read(arguments);return new L(this.x/e.x,this.y/e.y)},modulo:function(){var e=L.read(arguments);return new L(this.x%e.x,this.y%e.y)},negate:function(){return new L(-this.x,-this.y)},isInside:function(){return $.read(arguments).contains(this)},isClose:function(){var e=arguments,i=L.read(e),r=o.read(e);return this.getDistance(i)<=r},isCollinear:function(){var e=L.read(arguments);return L.isCollinear(this.x,this.y,e.x,e.y)},isColinear:"#isCollinear",isOrthogonal:function(){var e=L.read(arguments);return L.isOrthogonal(this.x,this.y,e.x,e.y)},isZero:function(){var e=M.isZero;return e(this.x)&&e(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(e){return this.x*(e>1&&e<4?-1:1)>=0&&this.y*(e>2?-1:1)>=0},dot:function(){var e=L.read(arguments);return this.x*e.x+this.y*e.y},cross:function(){var e=L.read(arguments);return this.x*e.y-this.y*e.x},project:function(){var e=L.read(arguments),i=e.isZero()?0:this.dot(e)/e.dot(e);return new L(e.x*i,e.y*i)},statics:{min:function(){var e=arguments,i=L.read(e),r=L.read(e);return new L(Math.min(i.x,r.x),Math.min(i.y,r.y))},max:function(){var e=arguments,i=L.read(e),r=L.read(e);return new L(Math.max(i.x,r.x),Math.max(i.y,r.y))},random:function(){return new L(Math.random(),Math.random())},isCollinear:function(e,i,r,h){return Math.abs(e*h-i*r)<=Math.sqrt((e*e+i*i)*(r*r+h*h))*1e-8},isOrthogonal:function(e,i,r,h){return Math.abs(e*r+i*h)<=Math.sqrt((e*e+i*i)*(r*r+h*h))*1e-8}}},o.each(["round","ceil","floor","abs"],function(e){var i=Math[e];this[e]=function(){return new L(i(this.x),i(this.y))}},{})),Q=L.extend({initialize:function(i,r,h,c){this._x=i,this._y=r,this._owner=h,this._setter=c},_set:function(e,i,r){return this._x=e,this._y=i,r||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),X=o.extend({_class:"Size",_readIndex:!0,initialize:function(i,r){var h=typeof i,c=this.__read,g=0;if(h==="number"){var m=typeof r=="number";this._set(i,m?r:i),c&&(g=m?2:1)}else if(h==="undefined"||i===null)this._set(0,0),c&&(g=i===null?1:0);else{var v=h==="string"?i.split(/[\s,]+/)||[]:i;g=1,Array.isArray(v)?this._set(+v[0],+(v.length>1?v[1]:v[0])):"width"in v?this._set(v.width||0,v.height||0):"x"in v?this._set(v.x||0,v.y||0):(this._set(0,0),g=0)}return c&&(this.__read=g),this},set:"#initialize",_set:function(e,i){return this.width=e,this.height=i,this},equals:function(e){return e===this||e&&(this.width===e.width&&this.height===e.height||Array.isArray(e)&&this.width===e[0]&&this.height===e[1])||!1},clone:function(){return new X(this.width,this.height)},toString:function(){var e=z.instance;return"{ width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var i=e.formatter;return[i.number(this.width),i.number(this.height)]},add:function(){var e=X.read(arguments);return new X(this.width+e.width,this.height+e.height)},subtract:function(){var e=X.read(arguments);return new X(this.width-e.width,this.height-e.height)},multiply:function(){var e=X.read(arguments);return new X(this.width*e.width,this.height*e.height)},divide:function(){var e=X.read(arguments);return new X(this.width/e.width,this.height/e.height)},modulo:function(){var e=X.read(arguments);return new X(this.width%e.width,this.height%e.height)},negate:function(){return new X(-this.width,-this.height)},isZero:function(){var e=M.isZero;return e(this.width)&&e(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(e,i){return new X(Math.min(e.width,i.width),Math.min(e.height,i.height))},max:function(e,i){return new X(Math.max(e.width,i.width),Math.max(e.height,i.height))},random:function(){return new X(Math.random(),Math.random())}}},o.each(["round","ceil","floor","abs"],function(e){var i=Math[e];this[e]=function(){return new X(i(this.width),i(this.height))}},{})),te=X.extend({initialize:function(i,r,h,c){this._width=i,this._height=r,this._owner=h,this._setter=c},_set:function(e,i,r){return this._width=e,this._height=i,r||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(e){this._width=e,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e,this._owner[this._setter](this)}}),$=o.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(i,r,h,c){var g=arguments,m=typeof i,v;if(m==="number"?(this._set(i,r,h,c),v=4):m==="undefined"||i===null?(this._set(0,0,0,0),v=i===null?1:0):g.length===1&&(Array.isArray(i)?(this._set.apply(this,i),v=1):i.x!==a||i.width!==a?(this._set(i.x||0,i.y||0,i.width||0,i.height||0),v=1):i.from===a&&i.to===a&&(this._set(0,0,0,0),o.readSupported(g,this)&&(v=1))),v===a){var y=L.readNamed(g,"from"),x=o.peek(g),E=y.x,A=y.y,P,C;if(x&&x.x!==a||o.hasNamed(g,"to")){var B=L.readNamed(g,"to");P=B.x-E,C=B.y-A,P<0&&(E=B.x,P=-P),C<0&&(A=B.y,C=-C)}else{var O=X.read(g);P=O.width,C=O.height}this._set(E,A,P,C),v=g.__index}var V=g.__filtered;return V&&(this.__filtered=V),this.__read&&(this.__read=v),this},set:"#initialize",_set:function(e,i,r,h){return this.x=e,this.y=i,this.width=r,this.height=h,this},clone:function(){return new $(this.x,this.y,this.width,this.height)},equals:function(e){var i=o.isPlainValue(e)?$.read(arguments):e;return i===this||i&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height||!1},toString:function(){var e=z.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+", width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var i=e.formatter;return[i.number(this.x),i.number(this.y),i.number(this.width),i.number(this.height)]},getPoint:function(e){var i=e?L:Q;return new i(this.x,this.y,this,"setPoint")},setPoint:function(){var e=L.read(arguments);this.x=e.x,this.y=e.y},getSize:function(e){var i=e?X:te;return new i(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var e=X.read(arguments),i=this._sx,r=this._sy,h=e.width,c=e.height;i&&(this.x+=(this.width-h)*i),r&&(this.y+=(this.height-c)*r),this.width=h,this.height=c,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(e){if(!this._fw){var i=e-this.x;this.width-=this._sx===.5?i*2:i}this.x=e,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(e){if(!this._fh){var i=e-this.y;this.height-=this._sy===.5?i*2:i}this.y=e,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(e){if(!this._fw){var i=e-this.x;this.width=this._sx===.5?i*2:i}this.x=e-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(e){if(!this._fh){var i=e-this.y;this.height=this._sy===.5?i*2:i}this.y=e-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(e){this._fw||this._sx===.5?this.x=e-this.width/2:(this._sx&&(this.x+=(e-this.x)*2*this._sx),this.width=(e-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(e){this._fh||this._sy===.5?this.y=e-this.height/2:(this._sy&&(this.y+=(e-this.y)*2*this._sy),this.height=(e-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(e){var i=e?L:Q;return new i(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var e=L.read(arguments);return this.setCenterX(e.x),this.setCenterY(e.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(e){return e&&e.width!==a||(Array.isArray(e)?e:arguments).length===4?this._containsRectangle($.read(arguments)):this._containsPoint(L.read(arguments))},_containsPoint:function(e){var i=e.x,r=e.y;return i>=this.x&&r>=this.y&&i<=this.x+this.width&&r<=this.y+this.height},_containsRectangle:function(e){var i=e.x,r=e.y;return i>=this.x&&r>=this.y&&i+e.width<=this.x+this.width&&r+e.height<=this.y+this.height},intersects:function(){var e=$.read(arguments),i=o.read(arguments)||0;return e.x+e.width>this.x-i&&e.y+e.height>this.y-i&&e.x<this.x+this.width+i&&e.y<this.y+this.height+i},intersect:function(){var e=$.read(arguments),i=Math.max(this.x,e.x),r=Math.max(this.y,e.y),h=Math.min(this.x+this.width,e.x+e.width),c=Math.min(this.y+this.height,e.y+e.height);return new $(i,r,h-i,c-r)},unite:function(){var e=$.read(arguments),i=Math.min(this.x,e.x),r=Math.min(this.y,e.y),h=Math.max(this.x+this.width,e.x+e.width),c=Math.max(this.y+this.height,e.y+e.height);return new $(i,r,h-i,c-r)},include:function(){var e=L.read(arguments),i=Math.min(this.x,e.x),r=Math.min(this.y,e.y),h=Math.max(this.x+this.width,e.x),c=Math.max(this.y+this.height,e.y);return new $(i,r,h-i,c-r)},expand:function(){var e=X.read(arguments),i=e.width,r=e.height;return new $(this.x-i/2,this.y-r/2,this.width+i,this.height+r)},scale:function(e,i){return this.expand(this.width*e-this.width,this.height*(i===a?e:i)-this.height)}},o.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,i){var r=e.join(""),h=/^[RL]/.test(r);i>=4&&(e[1]+=h?"Y":"X");var c=e[h?0:1],g=e[h?1:0],m="get"+c,v="get"+g,y="set"+c,x="set"+g,E="get"+r,A="set"+r;this[E]=function(P){var C=P?L:Q;return new C(this[m](),this[v](),this,A)},this[A]=function(){var P=L.read(arguments);this[y](P.x),this[x](P.y)}},{beans:!0})),pe=$.extend({initialize:function(i,r,h,c,g,m){this._set(i,r,h,c,!0),this._owner=g,this._setter=m},_set:function(e,i,r,h,c){return this._x=e,this._y=i,this._width=r,this._height=h,c||this._owner[this._setter](this),this}},new function(){var e=$.prototype;return o.each(["x","y","width","height"],function(i){var r=o.capitalize(i),h="_"+i;this["get"+r]=function(){return this[h]},this["set"+r]=function(c){this[h]=c,this._dontNotify||this._owner[this._setter](this)}},o.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(i){var r="set"+i;this[r]=function(){this._dontNotify=!0,e[r].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(i){var r=this._owner;r._changeSelection&&r._changeSelection(2,i)}}))}),re=o.extend({_class:"Matrix",initialize:function e(i,r){var h=arguments,c=h.length,g=!0;if(c>=6?this._set.apply(this,h):c===1||c===2?i instanceof e?this._set(i._a,i._b,i._c,i._d,i._tx,i._ty,r):Array.isArray(i)?this._set.apply(this,r?i.concat([r]):i):g=!1:c?g=!1:this.reset(),!g)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(e,i,r,h,c,g,m){return this._a=e,this._b=i,this._c=r,this._d=h,this._tx=c,this._ty=g,m||this._changed(),this},_serialize:function(e,i){return o.serialize(this.getValues(),e,!0,i)},_changed:function(){var e=this._owner;e&&(e._applyMatrix?e.transform(null,!0):e._changed(25))},clone:function(){return new re(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(e){return e===this||e&&this._a===e._a&&this._b===e._b&&this._c===e._c&&this._d===e._d&&this._tx===e._tx&&this._ty===e._ty},toString:function(){var e=z.instance;return"[["+[e.number(this._a),e.number(this._c),e.number(this._tx)].join(", ")+"], ["+[e.number(this._b),e.number(this._d),e.number(this._ty)].join(", ")+"]]"},reset:function(e){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,e||this._changed(),this},apply:function(e,i){var r=this._owner;return r?(r.transform(null,o.pick(e,!0),i),this.isIdentity()):!1},translate:function(){var e=L.read(arguments),i=e.x,r=e.y;return this._tx+=i*this._a+r*this._c,this._ty+=i*this._b+r*this._d,this._changed(),this},scale:function(){var e=arguments,i=L.read(e),r=L.read(e,0,{readNull:!0});return r&&this.translate(r),this._a*=i.x,this._b*=i.x,this._c*=i.y,this._d*=i.y,r&&this.translate(r.negate()),this._changed(),this},rotate:function(e){e*=Math.PI/180;var i=L.read(arguments,1),r=i.x,h=i.y,c=Math.cos(e),g=Math.sin(e),m=r-r*c+h*g,v=h-r*g-h*c,y=this._a,x=this._b,E=this._c,A=this._d;return this._a=c*y+g*E,this._b=c*x+g*A,this._c=-g*y+c*E,this._d=-g*x+c*A,this._tx+=m*y+v*E,this._ty+=m*x+v*A,this._changed(),this},shear:function(){var e=arguments,i=L.read(e),r=L.read(e,0,{readNull:!0});r&&this.translate(r);var h=this._a,c=this._b;return this._a+=i.y*this._c,this._b+=i.y*this._d,this._c+=i.x*h,this._d+=i.x*c,r&&this.translate(r.negate()),this._changed(),this},skew:function(){var e=arguments,i=L.read(e),r=L.read(e,0,{readNull:!0}),h=Math.PI/180,c=new L(Math.tan(i.x*h),Math.tan(i.y*h));return this.shear(c,r)},append:function(e,i){if(e){var r=this._a,h=this._b,c=this._c,g=this._d,m=e._a,v=e._c,y=e._b,x=e._d,E=e._tx,A=e._ty;this._a=m*r+y*c,this._c=v*r+x*c,this._b=m*h+y*g,this._d=v*h+x*g,this._tx+=E*r+A*c,this._ty+=E*h+A*g,i||this._changed()}return this},prepend:function(e,i){if(e){var r=this._a,h=this._b,c=this._c,g=this._d,m=this._tx,v=this._ty,y=e._a,x=e._c,E=e._b,A=e._d,P=e._tx,C=e._ty;this._a=y*r+x*h,this._c=y*c+x*g,this._b=E*r+A*h,this._d=E*c+A*g,this._tx=y*m+x*v+P,this._ty=E*m+A*v+C,i||this._changed()}return this},appended:function(e){return this.clone().append(e)},prepended:function(e){return this.clone().prepend(e)},invert:function(){var e=this._a,i=this._b,r=this._c,h=this._d,c=this._tx,g=this._ty,m=e*h-i*r,v=null;return m&&!isNaN(m)&&isFinite(c)&&isFinite(g)&&(this._a=h/m,this._b=-i/m,this._c=-r/m,this._d=e/m,this._tx=(r*g-h*c)/m,this._ty=(i*c-e*g)/m,v=this),v},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new re(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var e=this._a*this._d-this._c*this._b;return e&&!isNaN(e)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(e,i,r){return arguments.length<3?this._transformPoint(L.read(arguments)):this._transformCoordinates(e,i,r)},_transformPoint:function(e,i,r){var h=e.x,c=e.y;return i||(i=new L),i._set(h*this._a+c*this._c+this._tx,h*this._b+c*this._d+this._ty,r)},_transformCoordinates:function(e,i,r){for(var h=0,c=2*r;h<c;h+=2){var g=e[h],m=e[h+1];i[h]=g*this._a+m*this._c+this._tx,i[h+1]=g*this._b+m*this._d+this._ty}return i},_transformCorners:function(e){var i=e.x,r=e.y,h=i+e.width,c=r+e.height,g=[i,r,h,r,h,c,i,c];return this._transformCoordinates(g,g,4)},_transformBounds:function(e,i,r){for(var h=this._transformCorners(e),c=h.slice(0,2),g=c.slice(),m=2;m<8;m++){var v=h[m],y=m&1;v<c[y]?c[y]=v:v>g[y]&&(g[y]=v)}return i||(i=new $),i._set(c[0],c[1],g[0]-c[0],g[1]-c[1],r)},inverseTransform:function(){return this._inverseTransform(L.read(arguments))},_inverseTransform:function(e,i,r){var h=this._a,c=this._b,g=this._c,m=this._d,v=this._tx,y=this._ty,x=h*m-c*g,E=null;if(x&&!isNaN(x)&&isFinite(v)&&isFinite(y)){var A=e.x-this._tx,P=e.y-this._ty;i||(i=new L),E=i._set((A*m-P*g)/x,(P*h-A*c)/x,r)}return E},decompose:function(){var e=this._a,i=this._b,r=this._c,h=this._d,c=e*h-i*r,g=Math.sqrt,m=Math.atan2,v=180/Math.PI,y,x,E;if(e!==0||i!==0){var A=g(e*e+i*i);y=Math.acos(e/A)*(i>0?1:-1),x=[A,c/A],E=[m(e*r+i*h,A*A),0]}else if(r!==0||h!==0){var P=g(r*r+h*h);y=Math.asin(r/P)*(h>0?1:-1),x=[c/P,P],E=[0,m(e*r+i*h,P*P)]}else y=0,E=x=[0,0];return{translation:this.getTranslation(),rotation:y*v,scaling:new L(x),skewing:new L(E[0]*v,E[1]*v)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new L(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(e){this.isIdentity()||e.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},o.each(["a","b","c","d","tx","ty"],function(e){var i=o.capitalize(e),r="_"+e;this["get"+i]=function(){return this[r]},this["set"+i]=function(h){this[r]=h,this._changed()}},{})),_e=o.extend({_class:"Line",initialize:function(i,r,h,c,g){var m=!1;arguments.length>=4?(this._px=i,this._py=r,this._vx=h,this._vy=c,m=g):(this._px=i.x,this._py=i.y,this._vx=r.x,this._vy=r.y,m=h),m||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new L(this._px,this._py)},getVector:function(){return new L(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(e,i){return _e.intersect(this._px,this._py,this._vx,this._vy,e._px,e._py,e._vx,e._vy,!0,i)},getSide:function(e,i){return _e.getSide(this._px,this._py,this._vx,this._vy,e.x,e.y,!0,i)},getDistance:function(e){return Math.abs(this.getSignedDistance(e))},getSignedDistance:function(e){return _e.getSignedDistance(this._px,this._py,this._vx,this._vy,e.x,e.y,!0)},isCollinear:function(e){return L.isCollinear(this._vx,this._vy,e._vx,e._vy)},isOrthogonal:function(e){return L.isOrthogonal(this._vx,this._vy,e._vx,e._vy)},statics:{intersect:function(e,i,r,h,c,g,m,v,y,x){y||(r-=e,h-=i,m-=c,v-=g);var E=r*v-h*m;if(!M.isMachineZero(E)){var A=e-c,P=i-g,C=(m*P-v*A)/E,B=(r*P-h*A)/E,O=1e-12,V=-O,I=1+O;if(x||V<C&&C<I&&V<B&&B<I)return x||(C=C<=0?0:C>=1?1:C),new L(e+C*r,i+C*h)}},getSide:function(e,i,r,h,c,g,m,v){m||(r-=e,h-=i);var y=c-e,x=g-i,E=y*h-x*r;return!v&&M.isMachineZero(E)&&(E=(y*r+y*r)/(r*r+h*h),E>=0&&E<=1&&(E=0)),E<0?-1:E>0?1:0},getSignedDistance:function(e,i,r,h,c,g,m){return m||(r-=e,h-=i),r===0?h>0?c-e:e-c:h===0?r<0?g-i:i-g:((c-e)*h-(g-i)*r)/(h>r?h*Math.sqrt(1+r*r/(h*h)):r*Math.sqrt(1+h*h/(r*r)))},getDistance:function(e,i,r,h,c,g,m){return Math.abs(_e.getSignedDistance(e,i,r,h,c,g,m))}}}),he=b.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(i){b.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Xi(null,null,this),this._view=ht.create(this,i||pt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(e,i){return o.serialize(this._children,e,!0,i)},_changed:function(e,i){if(e&1){var r=this._view;r&&(r._needsUpdate=!0,!r._requested&&r._autoUpdate&&r.requestUpdate())}var h=this._changes;if(h&&i){var c=this._changesById,g=i._id,m=c[g];m?m.flags|=e:h.push(c[g]={item:i,flags:e})}},clear:function(){for(var e=this._children,i=e.length-1;i>=0;i--)e[i].remove()},isEmpty:function(){return!this._children.length},remove:function e(){return e.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.set(e)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new xe({project:this,insert:!0})},getSymbolDefinitions:function(){var e=[],i={};return this.getItems({class:Ie,match:function(r){var h=r._definition,c=h._id;return i[c]||(i[c]=!0,e.push(h)),!1}}),e},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var e=this._selectionItems,i=[];for(var r in e){var h=e[r],c=h._selection;c&1&&h.isInserted()?i.push(h):c||this._updateSelection(h)}return i},_updateSelection:function(e){var i=e._id,r=this._selectionItems;e._selection?r[i]!==e&&(this._selectionCount++,r[i]=e):r[i]===e&&(this._selectionCount--,delete r[i])},selectAll:function(){for(var e=this._children,i=0,r=e.length;i<r;i++)e[i].setFullySelected(!0)},deselectAll:function(){var e=this._selectionItems;for(var i in e)e[i].setFullySelected(!1)},addLayer:function(e){return this.insertLayer(a,e)},insertLayer:function(e,i){if(i instanceof xe){i._remove(!1,!0),o.splice(this._children,[i],e,0),i._setProject(this,!0);var r=i._name;r&&i.setName(r),this._changes&&i._changed(5),this._activeLayer||(this._activeLayer=i)}else i=null;return i},_insertItem:function(e,i,r){return i=this.insertLayer(e,i)||(this._activeLayer||this._insertItem(a,new xe(T.NO_INSERT),!0)).insertChild(e,i),r&&i.activate&&i.activate(),i},getItems:function(e){return T._getItems(this,e)},getItem:function(e){return T._getItems(this,e,null,null,!0)[0]||null},importJSON:function(e){this.activate();var i=this._activeLayer;return o.importJSON(e,i&&i.isEmpty()&&i)},removeOn:function(e){var i=this._removeSets;if(i){e==="mouseup"&&(i.mousedrag=null);var r=i[e];if(r){for(var h in r){var c=r[h];for(var g in i){var m=i[g];m&&m!=r&&delete m[c._id]}c.remove()}i[e]=null}}},draw:function(e,i,r){this._updateVersion++,e.save(),i.applyToContext(e);for(var h=this._children,c=new o({offset:new L(0,0),pixelRatio:r,viewMatrix:i.isIdentity()?null:i,matrices:[new re],updateMatrix:!0}),g=0,m=h.length;g<m;g++)h[g].draw(e,c);if(e.restore(),this._selectionCount>0){e.save(),e.strokeWidth=1;var v=this._selectionItems,y=this._scope.settings.handleSize,x=this._updateVersion;for(var E in v)v[E]._drawSelection(e,i,y,v,x);e.restore()}}}),T=o.extend(d,{statics:{extend:function e(i){return i._serializeFields&&(i._serializeFields=o.set({},this.prototype._serializeFields,i._serializeFields)),e.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new re,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var e=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return o.each(e,function(i){this._events[i]={install:function(r){this.getView()._countItemEvent(r,1)},uninstall:function(r){this.getView()._countItemEvent(r,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:e}})},{initialize:function(){},_initialize:function(e,i){var r=e&&o.isPlainObject(e),h=r&&e.internal===!0,c=this._matrix=new re,g=r&&e.project||Qe.project,m=Qe.settings;return this._id=h?null:H.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&m.applyMatrix,i&&c.translate(i),c._owner=this,this._style=new Xi(g._currentStyle,this,g),h||r&&e.insert==!1||!m.insertItems&&!(r&&e.insert==!0)?this._setProject(g):(r&&e.parent||g)._insertItem(a,this,!0),r&&e!==T.NO_INSERT&&e!==T.INSERT&&this.set(e,{internal:!0,insert:!0,project:!0,parent:!0}),r},_serialize:function(e,i){var r={},h=this;function c(g){for(var m in g){var v=h[m];o.equals(v,m==="leading"?g.fontSize*1.2:g[m])||(r[m]=o.serialize(v,e,m!=="data",i))}}return c(this._serializeFields),this instanceof ve||c(this._style._defaults),[this._class,r]},_changed:function(e){var i=this._symbol,r=this._parent||i,h=this._project;e&8&&(this._bounds=this._position=this._decomposed=a),e&16&&(this._globalMatrix=a),r&&e&72&&T._clearBoundsCache(r),e&2&&T._clearBoundsCache(this),h&&h._changed(e,this),i&&i._changed(e)},getId:function(){return this._id},getName:function(){return this._name},setName:function(e){if(this._name&&this._removeNamed(),e===+e+"")throw new Error("Names consisting only of numbers are not supported.");var i=this._getOwner();if(e&&i){var r=i._children,h=i._namedChildren;(h[e]=h[e]||[]).push(this),e in r||(r[e]=this)}this._name=e||a,this._changed(256)},getStyle:function(){return this._style},setStyle:function(e){this.getStyle().set(e)}},o.each(["locked","visible","blendMode","opacity","guide"],function(e){var i=o.capitalize(e),r="_"+e,h={locked:256,visible:265};this["get"+i]=function(){return this[r]},this["set"+i]=function(c){c!=this[r]&&(this[r]=c,this._changed(h[e]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(e){if(e!==this._selection){this._selection=e;var i=this._project;i&&(i._updateSelection(this),this._changed(257))}},_changeSelection:function(e,i){var r=this._selection;this.setSelection(i?r|e:r&~e)},isSelected:function(){if(this._selectChildren){for(var e=this._children,i=0,r=e.length;i<r;i++)if(e[i].isSelected())return!0}return!!(this._selection&1)},setSelected:function(e){if(this._selectChildren)for(var i=this._children,r=0,h=i.length;r<h;r++)i[r].setSelected(e);this._changeSelection(1,e)},isFullySelected:function(){var e=this._children,i=!!(this._selection&1);if(e&&i){for(var r=0,h=e.length;r<h;r++)if(!e[r].isFullySelected())return!1;return!0}return i},setFullySelected:function(e){var i=this._children;if(i)for(var r=0,h=i.length;r<h;r++)i[r].setFullySelected(e);this._changeSelection(1,e)},isClipMask:function(){return this._clipMask},setClipMask:function(e){this._clipMask!=(e=!!e)&&(this._clipMask=e,e&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(e){this._data=e},getPosition:function(e){var i=e?L:Q,r=this._position||(this._position=this._getPositionFromBounds());return new i(r.x,r.y,this,"setPosition")},setPosition:function(){this.translate(L.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(e){return this._pivot?this._matrix._transformPoint(this._pivot):(e||this.getBounds()).getCenter(!0)},getPivot:function(){var e=this._pivot;return e?new Q(e.x,e.y,this,"setPivot"):null},setPivot:function(){this._pivot=L.read(arguments,0,{clone:!0,readNull:!0}),this._position=a}},o.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(e,i){this[i]=function(r){return this.getBounds(r,e)}},{beans:!0,getBounds:function(e,i){var r=i||e instanceof re,h=o.set({},r?i:e,this._boundsOptions);(!h.stroke||this.getStrokeScaling())&&(h.cacheItem=this);var c=this._getCachedBounds(r&&e,h).rect;return arguments.length?c:new pe(c.x,c.y,c.width,c.height,this,"setBounds")},setBounds:function(){var e=$.read(arguments),i=this.getBounds(),r=this._matrix,h=new re,c=e.getCenter();h.translate(c),(e.width!=i.width||e.height!=i.height)&&(r.isInvertible()||(r.set(r._backup||new re().translate(r.getTranslation())),i=this.getBounds()),h.scale(i.width!==0?e.width/i.width:0,i.height!==0?e.height/i.height:0)),c=i.getCenter(),h.translate(-c.x,-c.y),this.transform(h)},_getBounds:function(e,i){var r=this._children;return!r||!r.length?new $:(T._updateBoundsCache(this,i.cacheItem),T._getBounds(r,e,i))},_getBoundsCacheKey:function(e,i){return[e.stroke?1:0,e.handle?1:0,i?1:0].join("")},_getCachedBounds:function(e,i,r){e=e&&e._orNullIfIdentity();var h=i.internal&&!r,c=i.cacheItem,g=h?null:this._matrix._orNullIfIdentity(),m=c&&(!e||e.equals(g))&&this._getBoundsCacheKey(i,h),v=this._bounds;if(T._updateBoundsCache(this._parent||this._symbol,c),m&&v&&m in v){var y=v[m];return{rect:y.rect.clone(),nonscaling:y.nonscaling}}var x=this._getBounds(e||g,i),E=x.rect||x,A=this._style,P=x.nonscaling||A.hasStroke()&&!A.getStrokeScaling();if(m){v||(this._bounds=v={});var y=v[m]={rect:E.clone(),nonscaling:P,internal:h}}return{rect:E,nonscaling:P}},_getStrokeMatrix:function(e,i){var r=this.getStrokeScaling()?null:i&&i.internal?this:this._parent||this._symbol&&this._symbol._item,h=r?r.getViewMatrix().invert():e;return h&&h._shiftless()},statics:{_updateBoundsCache:function(e,i){if(e&&i){var r=i._id,h=e._boundsCache=e._boundsCache||{ids:{},list:[]};h.ids[r]||(h.list.push(i),h.ids[r]=i)}},_clearBoundsCache:function(e){var i=e._boundsCache;if(i){e._bounds=e._position=e._boundsCache=a;for(var r=0,h=i.list,c=h.length;r<c;r++){var g=h[r];g!==e&&(g._bounds=g._position=a,g._boundsCache&&T._clearBoundsCache(g))}}},_getBounds:function(e,i,r){var h=1/0,c=-h,g=h,m=c,v=!1;r=r||{};for(var y=0,x=e.length;y<x;y++){var E=e[y];if(E._visible&&!E.isEmpty(!0)){var A=E._getCachedBounds(i&&i.appended(E._matrix),r,!0),P=A.rect;h=Math.min(P.x,h),g=Math.min(P.y,g),c=Math.max(P.x+P.width,c),m=Math.max(P.y+P.height,m),A.nonscaling&&(v=!0)}}return{rect:isFinite(h)?new $(h,g,c-h,m-g):new $,nonscaling:v}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var e=this._decompose();return e?e.rotation:0},setRotation:function(e){var i=this.getRotation();if(i!=null&&e!=null){var r=this._decomposed;this.rotate(e-i),r&&(r.rotation=e,this._decomposed=r)}},getScaling:function(){var e=this._decompose(),i=e&&e.scaling;return new Q(i?i.x:1,i?i.y:1,this,"setScaling")},setScaling:function(){var e=this.getScaling(),i=L.read(arguments,0,{clone:!0,readNull:!0});if(e&&i&&!e.equals(i)){var r=this.getRotation(),h=this._decomposed,c=new re,g=M.isZero;if(g(e.x)||g(e.y))c.translate(h.translation),r&&c.rotate(r),c.scale(i.x,i.y),this._matrix.set(c);else{var m=this.getPosition(!0);c.translate(m),r&&c.rotate(r),c.scale(i.x/e.x,i.y/e.y),r&&c.rotate(-r),c.translate(m.negate()),this.transform(c)}h&&(h.scaling=i,this._decomposed=h)}},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},getGlobalMatrix:function(e){var i=this._globalMatrix;if(i)for(var r=this._parent,h=[];r;){if(!r._globalMatrix){i=null;for(var c=0,g=h.length;c<g;c++)h[c]._globalMatrix=null;break}h.push(r),r=r._parent}if(!i){i=this._globalMatrix=this._matrix.clone();var r=this._parent;r&&i.prepend(r.getGlobalMatrix(!0))}return e?i:i.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(e){(this._applyMatrix=this._canApplyMatrix&&!!e)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(e,i){if(this._project!==e){this._project&&this._installEvents(!1),this._project=e;for(var r=this._children,h=0,c=r&&r.length;h<c;h++)r[h]._setProject(e);i=!0}i&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function e(i){e.base.call(this,i);for(var r=this._children,h=0,c=r&&r.length;h<c;h++)r[h]._installEvents(i)},getLayer:function(){for(var e=this;e=e._parent;)if(e instanceof xe)return e;return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(e){this.removeChildren(),this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var e=this._getOwner();return e&&e._children[this._index+1]||null},getPreviousSibling:function(){var e=this._getOwner();return e&&e._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(e){var i=this._parent,r=i&&i._children;r&&i.insertChildren(e in r?e:a,[this])},equals:function(e){return e===this||e&&this._class===e._class&&this._style.equals(e._style)&&this._matrix.equals(e._matrix)&&this._locked===e._locked&&this._visible===e._visible&&this._blendMode===e._blendMode&&this._opacity===e._opacity&&this._clipMask===e._clipMask&&this._guide===e._guide&&this._equals(e)||!1},_equals:function(e){return o.equals(this._children,e._children)},clone:function(e){var i=new this.constructor(T.NO_INSERT),r=this._children,h=o.pick(e?e.insert:a,e===a||e===!0),c=o.pick(e?e.deep:a,!0);r&&i.copyAttributes(this),(!r||c)&&i.copyContent(this),r||i.copyAttributes(this),h&&i.insertAbove(this);var g=this._name,m=this._parent;if(g&&m){for(var r=m._children,v=g,y=1;r[g];)g=v+" "+y++;g!==v&&i.setName(g)}return i},copyContent:function(e){for(var i=e._children,r=0,h=i&&i.length;r<h;r++)this.addChild(i[r].clone(!1),!0)},copyAttributes:function(e,i){this.setStyle(e._style);for(var r=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],h=0,c=r.length;h<c;h++){var g=r[h];e.hasOwnProperty(g)&&(this[g]=e[g])}i||this._matrix.set(e._matrix,!0),this.setApplyMatrix(e._applyMatrix),this.setPivot(e._pivot),this.setSelection(e._selection);var m=e._data,v=e._name;this._data=m?o.clone(m):null,v&&this.setName(v)},rasterize:function(e,i){var r,h,c;o.isPlainObject(e)?(r=e.resolution,h=e.insert,c=e.raster):(r=e,h=i),c||(c=new Se(T.NO_INSERT));var g=this.getStrokeBounds(),m=(r||this.getView().getResolution())/72,v=g.getTopLeft().floor(),y=g.getBottomRight().ceil(),x=new X(y.subtract(v)),E=x.multiply(m);if(c.setSize(E,!0),!E.isZero()){var A=c.getContext(!0),P=new re().scale(m).translate(v.negate());A.save(),P.applyToContext(A),this.draw(A,new o({matrices:[P]})),A.restore()}return c._matrix.set(new re().translate(v.add(x.divide(2))).scale(1/m)),(h===a||h)&&c.insertAbove(this),c},contains:function(){var e=this._matrix;return e.isInvertible()&&!!this._contains(e._inverseTransform(L.read(arguments)))},_contains:function(e){var i=this._children;if(i){for(var r=i.length-1;r>=0;r--)if(i[r].contains(e))return!0;return!1}return e.isInside(this.getInternalBounds())},isInside:function(){return $.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Fe.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(e,i){return e instanceof T?this._asPathItem().getIntersections(e._asPathItem(),null,i,!0).length>0:!1}},new function(){function e(){var h=arguments;return this._hitTest(L.read(h),ze.getOptions(h))}function i(){var h=arguments,c=L.read(h),g=ze.getOptions(h),m=[];return this._hitTest(c,new o({all:m},g)),m}function r(h,c,g,m){var v=this._children;if(v)for(var y=v.length-1;y>=0;y--){var x=v[y],E=x!==m&&x._hitTest(h,c,g);if(E&&!c.all)return E}return null}return he.inject({hitTest:e,hitTestAll:i,_hitTest:r}),{hitTest:e,hitTestAll:i,_hitTestChildren:r}},{_hitTest:function(e,i,r){if(this._locked||!this._visible||this._guide&&!i.guides||this.isEmpty())return null;var h=this._matrix,c=r?r.appended(h):this.getGlobalMatrix().prepend(this.getView()._matrix),g=Math.max(i.tolerance,1e-12),m=i._tolerancePadding=new X(Fe._getStrokePadding(g,h._shiftless().invert()));if(e=h._inverseTransform(e),!e||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(m.multiply(2))._containsPoint(e))return null;var v=!(i.guides&&!this._guide||i.selected&&!this.isSelected()||i.type&&i.type!==o.hyphenate(this._class)||i.class&&!(this instanceof i.class)),y=i.match,x=this,E,A;function P(w){return w&&y&&!y(w)&&(w=null),w&&i.all&&i.all.push(w),w}function C(w,N){var U=N?E["get"+N]():x.getPosition();if(e.subtract(U).divide(m).length<=1)return new ze(w,x,{name:N?o.hyphenate(N):w,point:U})}var B=i.position,O=i.center,V=i.bounds;if(v&&this._parent&&(B||O||V)){if((O||V)&&(E=this.getInternalBounds()),A=B&&C("position")||O&&C("center","Center"),!A&&V)for(var I=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],R=0;R<8&&!A;R++)A=C("bounds",I[R]);A=P(A)}return A||(A=this._hitTestChildren(e,i,c)||v&&P(this._hitTestSelf(e,i,c,this.getStrokeScaling()?null:c._shiftless().invert()))||null),A&&A.point&&(A.point=h.transform(A.point)),A},_hitTestSelf:function(e,i){if(i.fill&&this.hasFill()&&this._contains(e))return new ze("fill",this)},matches:function(e,i){function r(m,v){for(var y in m)if(m.hasOwnProperty(y)){var x=m[y],E=v[y];if(o.isPlainObject(x)&&o.isPlainObject(E)){if(!r(x,E))return!1}else if(!o.equals(x,E))return!1}return!0}var h=typeof e;if(h==="object"){for(var c in e)if(e.hasOwnProperty(c)&&!this.matches(c,e[c]))return!1;return!0}else{if(h==="function")return e(this);if(e==="match")return i(this);var g=/^(empty|editable)$/.test(e)?this["is"+o.capitalize(e)]():e==="type"?o.hyphenate(this._class):this[e];if(e==="class"){if(typeof i=="function")return this instanceof i;g=this._class}if(typeof i=="function")return!!i(g);if(i){if(i.test)return i.test(g);if(o.isPlainObject(i))return r(i,g)}return o.equals(g,i)}},getItems:function(e){return T._getItems(this,e,this._matrix)},getItem:function(e){return T._getItems(this,e,this._matrix,null,!0)[0]||null},statics:{_getItems:function e(i,r,h,c,g){if(!c){var m=typeof r=="object"&&r,v=m&&m.overlapping,y=m&&m.inside,x=v||y,P=x&&$.read([x]);c={items:[],recursive:m&&m.recursive!==!1,inside:!!y,overlapping:!!v,rect:P,path:v&&new Fe.Rectangle({rectangle:P,insert:!1})},m&&(r=o.filter({},r,{recursive:!0,inside:!0,overlapping:!0}))}var E=i._children,A=c.items,P=c.rect;h=P&&(h||new re);for(var C=0,B=E&&E.length;C<B;C++){var O=E[C],V=h&&h.appended(O._matrix),I=!0;if(P){var x=O.getBounds(V);if(!P.intersects(x))continue;P.contains(x)||c.overlapping&&(x.contains(P)||c.path.intersects(O,V))||(I=!1)}if(I&&O.matches(r)&&(A.push(O),g)||(c.recursive!==!1&&e(O,r,V,c,g),g&&A.length>0))break}return A}}},{importJSON:function(e){var i=o.importJSON(e,this);return i!==this?this.addChild(i):i},addChild:function(e){return this.insertChild(a,e)},insertChild:function(e,i){var r=i?this.insertChildren(e,[i]):null;return r&&r[0]},addChildren:function(e){return this.insertChildren(this._children.length,e)},insertChildren:function(e,i){var r=this._children;if(r&&i&&i.length>0){i=o.slice(i);for(var h={},c=i.length-1;c>=0;c--){var g=i[c],m=g&&g._id;!g||h[m]?i.splice(c,1):(g._remove(!1,!0),h[m]=!0)}o.splice(r,i,e,0);for(var v=this._project,y=v._changes,c=0,x=i.length;c<x;c++){var g=i[c],E=g._name;g._parent=this,g._setProject(v,!0),E&&g.setName(E),y&&g._changed(5)}this._changed(11)}else i=null;return i},_insertItem:"#insertChild",_insertAt:function(e,i){var r=e&&e._getOwner(),h=e!==this&&r?this:null;return h&&(h._remove(!1,!0),r._insertItem(e._index+i,h)),h},insertAbove:function(e){return this._insertAt(e,1)},insertBelow:function(e){return this._insertAt(e,0)},sendToBack:function(){var e=this._getOwner();return e?e._insertItem(0,this):null},bringToFront:function(){var e=this._getOwner();return e?e._insertItem(a,this):null},appendTop:"#addChild",appendBottom:function(e){return this.insertChild(0,e)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(e){return e._insertItem(a,this)},copyTo:function(e){return this.clone(!1).addTo(e)},reduce:function(e){var i=this._children;if(i&&i.length===1){var r=i[0].reduce(e);return this._parent?(r.insertAbove(this),this.remove()):r.remove(),r}return this},_removeNamed:function(){var e=this._getOwner();if(e){var i=e._children,r=e._namedChildren,h=this._name,c=r[h],g=c?c.indexOf(this):-1;g!==-1&&(i[h]==this&&delete i[h],c.splice(g,1),c.length?i[h]=c[0]:delete r[h])}},_remove:function(e,i){var r=this._getOwner(),h=this._project,c=this._index;return this._style&&this._style._dispose(),r?(this._name&&this._removeNamed(),c!=null&&(h._activeLayer===this&&(h._activeLayer=this.getNextSibling()||this.getPreviousSibling()),o.splice(r._children,null,c,1)),this._installEvents(!1),e&&h._changes&&this._changed(5),i&&r._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(e){var i=e&&e.insertBelow(this);return i&&this.remove(),i},removeChildren:function(e,i){if(!this._children)return null;e=e||0,i=o.pick(i,this._children.length);for(var r=o.splice(this._children,null,e,i-e),h=r.length-1;h>=0;h--)r[h]._remove(!0,!1);return r.length>0&&this._changed(11),r},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,i=this._children.length;e<i;e++)this._children[e]._index=e;this._changed(11)}},isEmpty:function(e){var i=this._children,r=i?i.length:0;if(e){for(var h=0;h<r;h++)if(!i[h].isEmpty(e))return!1;return!0}return!r},isEditable:function(){for(var e=this;e;){if(!e._visible||e._locked)return!1;e=e._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(e){function i(m){var v=[];do v.unshift(m);while(m=m._parent);return v}for(var r=i(this),h=i(e),c=0,g=Math.min(r.length,h.length);c<g;c++)if(r[c]!=h[c])return r[c]._index<h[c]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(e){return this._getOrder(e)===-1},isBelow:function(e){return this._getOrder(e)===1},isParent:function(e){return this._parent===e},isChild:function(e){return e&&e._parent===this},isDescendant:function(e){for(var i=this;i=i._parent;)if(i===e)return!0;return!1},isAncestor:function(e){return e?e.isDescendant(this):!1},isSibling:function(e){return this._parent===e._parent},isGroupedWith:function(e){for(var i=this._parent;i;){if(i._parent&&/^(Group|Layer|CompoundPath)$/.test(i._class)&&e.isDescendant(i))return!0;i=i._parent}return!1}},o.each(["rotate","scale","shear","skew"],function(e){var i=e==="rotate";this[e]=function(){var r=arguments,h=(i?o:L).read(r),c=L.read(r,0,{readNull:!0});return this.transform(new re()[e](h,c||this.getPosition(!0)))}},{translate:function(){var e=new re;return this.transform(e.translate.apply(e,arguments))},transform:function(e,i,r){var h=this._matrix,c=e&&!e.isIdentity(),g=r&&this._canApplyMatrix||this._applyMatrix&&(c||!h.isIdentity()||i&&this._children);if(!c&&!g)return this;if(c){!e.isInvertible()&&h.isInvertible()&&(h._backup=h.getValues()),h.prepend(e,!0);var m=this._style,v=m.getFillColor(!0),y=m.getStrokeColor(!0);v&&v.transform(e),y&&y.transform(e)}if(g&&(g=this._transformContent(h,i,r))){var x=this._pivot;x&&h._transformPoint(x,x,!0),h.reset(!0),r&&this._canApplyMatrix&&(this._applyMatrix=!0)}var E=this._bounds,A=this._position;(c||g)&&this._changed(25);var P=c&&E&&e.decompose();if(P&&P.skewing.isZero()&&P.rotation%90===0){for(var C in E){var B=E[C];if(B.nonscaling)delete E[C];else if(g||!B.internal){var O=B.rect;e._transformBounds(O,O)}}this._bounds=E;var V=E[this._getBoundsCacheKey(this._boundsOptions||{})];V&&(this._position=this._getPositionFromBounds(V.rect))}else c&&A&&this._pivot&&(this._position=e._transformPoint(A,A));return this},_transformContent:function(e,i,r){var h=this._children;if(h){for(var c=0,g=h.length;c<g;c++)h[c].transform(e,i,r);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(L.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(L.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(L.read(arguments))},localToParent:function(){return this._matrix._transformPoint(L.read(arguments))},fitBounds:function(e,i){e=$.read(arguments);var r=this.getBounds(),h=r.height/r.width,c=e.height/e.width,g=(i?h>c:h<c)?e.width/r.width:e.height/r.height,m=new $(new L,new X(r.width*g,r.height*g));m.setCenter(e.getCenter()),this.setBounds(m)}}),{_setStyles:function(e,i,r){var h=this._style,c=this._matrix;if(h.hasFill()&&(e.fillStyle=h.getFillColor().toCanvasStyle(e,c)),h.hasStroke()){e.strokeStyle=h.getStrokeColor().toCanvasStyle(e,c),e.lineWidth=h.getStrokeWidth();var g=h.getStrokeJoin(),m=h.getStrokeCap(),v=h.getMiterLimit();if(g&&(e.lineJoin=g),m&&(e.lineCap=m),v&&(e.miterLimit=v),Qe.support.nativeDash){var y=h.getDashArray(),x=h.getDashOffset();y&&y.length&&("setLineDash"in e?(e.setLineDash(y),e.lineDashOffset=x):(e.mozDash=y,e.mozDashOffset=x))}}if(h.hasShadow()){var E=i.pixelRatio||1,A=r._shiftless().prepend(new re().scale(E,E)),P=A.transform(new L(h.getShadowBlur(),0)),C=A.transform(this.getShadowOffset());e.shadowColor=h.getShadowColor().toCanvasStyle(e),e.shadowBlur=P.getLength(),e.shadowOffsetX=C.x,e.shadowOffsetY=C.y}},draw:function(e,i,r){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var h=i.matrices,c=i.viewMatrix,g=this._matrix,m=h[h.length-1].appended(g);if(m.isInvertible()){c=c?c.appended(m):m,h.push(m),i.updateMatrix&&(this._globalMatrix=m);var v=this._blendMode,y=M.clamp(this._opacity,0,1),x=v==="normal",E=xi.nativeModes[v],A=x&&y===1||i.dontStart||i.clip||(E||x&&y<1)&&this._canComposite(),P=i.pixelRatio||1,C,B,O;if(!A){var V=this.getStrokeBounds(c);if(!V.width||!V.height){h.pop();return}O=i.offset,B=i.offset=V.getTopLeft().floor(),C=e,e=pt.getContext(V.getSize().ceil().add(1).multiply(P)),P!==1&&e.scale(P,P)}e.save();var I=r?r.appended(g):this._canScaleStroke&&!this.getStrokeScaling(!0)&&c,R=!A&&i.clipItem,w=!I||R;if(A?(e.globalAlpha=y,E&&(e.globalCompositeOperation=v)):w&&e.translate(-B.x,-B.y),w&&(A?g:c).applyToContext(e),R&&i.clipItem.draw(e,i.extend({clip:!0})),I){e.setTransform(P,0,0,P,0,0);var N=i.offset;N&&e.translate(-N.x,-N.y)}this._draw(e,i,c,I),e.restore(),h.pop(),i.clip&&!i.dontFinish&&e.clip(this.getFillRule()),A||(xi.process(v,e,C,y,B.subtract(O).multiply(P)),pt.release(e),i.offset=O)}}},_isUpdated:function(e){var i=this._parent;if(i instanceof it)return i._isUpdated(e);var r=this._updateVersion===e;return!r&&i&&i._visible&&i._isUpdated(e)&&(this._updateVersion=e,r=!0),r},_drawSelection:function(e,i,r,h,c){var g=this._selection,m=g&1,v=g&2||m&&this._selectBounds,y=g&4;if(this._drawSelected||(m=!1),(m||v||y)&&this._isUpdated(c)){var x,E=this.getSelectedColor(!0)||(x=this.getLayer())&&x.getSelectedColor(!0),A=i.appended(this.getGlobalMatrix(!0)),P=r/2;if(e.strokeStyle=e.fillStyle=E?E.toCanvasStyle(e):"#009dec",m&&this._drawSelected(e,A,h),y){var C=this.getPosition(!0),B=this._parent,O=B?B.localToGlobal(C):C,V=O.x,I=O.y;e.beginPath(),e.arc(V,I,P,0,Math.PI*2,!0),e.stroke();for(var R=[[0,-1],[1,0],[0,1],[-1,0]],w=P,N=r+1,U=0;U<4;U++){var q=R[U],D=q[0],G=q[1];e.moveTo(V+D*w,I+G*w),e.lineTo(V+D*N,I+G*N),e.stroke()}}if(v){var Z=A._transformCorners(this.getInternalBounds());e.beginPath();for(var U=0;U<8;U++)e[U?"lineTo":"moveTo"](Z[U],Z[++U]);e.closePath(),e.stroke();for(var U=0;U<8;U++)e.fillRect(Z[U]-P,Z[++U]-P,r,r)}}},_canComposite:function(){return!1}},o.each(["down","drag","up","move"],function(e){this["removeOn"+o.capitalize(e)]=function(){var i={};return i[e]=!0,this.removeOn(i)}},{removeOn:function(e){for(var i in e)if(e[i]){var r="mouse"+i,h=this._project,c=h._removeSets=h._removeSets||{};c[r]=c[r]||{},c[r][this._id]=this}return this}}),{tween:function(e,i,r){r||(r=i,i=e,e=null,r||(r=i,i=null));var h=r&&r.easing,c=r&&r.start,g=r!=null&&(typeof r=="number"?r:r.duration),m=new Oi(this,e,i,g,h,c);function v(y){m._handleFrame(y.time*1e3),m.running||this.off("frame",v)}return g&&this.on("frame",v),m},tweenTo:function(e,i){return this.tween(null,e,i)},tweenFrom:function(e,i){return this.tween(e,null,i)}}),ve=T.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(i){this._children=[],this._namedChildren={},this._initialize(i)||this.addChildren(Array.isArray(i)?i:arguments)},_changed:function e(i){e.base.call(this,i),i&2050&&(this._clipItem=a)},_getClipItem:function(){var e=this._clipItem;if(e===a){e=null;for(var i=this._children,r=0,h=i.length;r<h;r++)if(i[r]._clipMask){e=i[r];break}this._clipItem=e}return e},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var i=this.getFirstChild();i&&i.setClipMask(e)},_getBounds:function e(i,r){var h=this._getClipItem();return h?h._getCachedBounds(h._matrix.prepended(i),o.set({},r,{stroke:!1})):e.base.call(this,i,r)},_hitTestChildren:function e(i,r,h){var c=this._getClipItem();return(!c||c.contains(i))&&e.base.call(this,i,r,h,c)},_draw:function(e,i){var r=i.clip,h=!r&&this._getClipItem();i=i.extend({clipItem:h,clip:!1}),r?(e.beginPath(),i.dontStart=i.dontFinish=!0):h&&h.draw(e,i.extend({clip:!0}));for(var c=this._children,g=0,m=c.length;g<m;g++){var v=c[g];v!==h&&v.draw(e,i)}}}),xe=ve.extend({_class:"Layer",initialize:function(){ve.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function e(){return this._parent?e.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),de=T.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(i,r){this._initialize(i,r)},_equals:function(e){return this._type===e._type&&this._size.equals(e._size)&&o.equals(this._radius,e._radius)},copyContent:function(e){this.setType(e._type),this.setSize(e._size),this.setRadius(e._radius)},getType:function(){return this._type},setType:function(e){this._type=e},getShape:"#getType",setShape:"#setType",getSize:function(){var e=this._size;return new te(e.width,e.height,this,"setSize")},setSize:function(){var e=X.read(arguments);if(!this._size)this._size=e.clone();else if(!this._size.equals(e)){var i=this._type,r=e.width,h=e.height;i==="rectangle"?this._radius.set(X.min(this._radius,e.divide(2).abs())):i==="circle"?(r=h=(r+h)/2,this._radius=r/2):i==="ellipse"&&this._radius._set(r/2,h/2),this._size._set(r,h),this._changed(9)}},getRadius:function(){var e=this._radius;return this._type==="circle"?e:new te(e.width,e.height,this,"setRadius")},setRadius:function(e){var i=this._type;if(i==="circle"){if(e===this._radius)return;var r=e*2;this._radius=e,this._size._set(r,r)}else if(e=X.read(arguments),!this._radius)this._radius=e.clone();else{if(this._radius.equals(e))return;if(this._radius.set(e),i==="rectangle"){var r=X.max(this._size,e.multiply(2));this._size.set(r)}else i==="ellipse"&&this._size._set(e.width*2,e.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(e){var i=new Fe[o.capitalize(this._type)]({center:new L,size:this._size,radius:this._radius,insert:!1});return i.copyAttributes(this),Qe.settings.applyMatrix&&i.setApplyMatrix(!0),(e===a||e)&&i.insertAbove(this),i},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(e,i,r,h){var c=this._style,g=c.hasFill(),m=c.hasStroke(),v=i.dontFinish||i.clip,y=!h;if(g||m||v){var x=this._type,E=this._radius,A=x==="circle";if(i.dontStart||e.beginPath(),y&&A)e.arc(0,0,E,0,Math.PI*2,!0);else{var P=A?E:E.width,C=A?E:E.height,B=this._size,O=B.width,V=B.height;if(y&&x==="rectangle"&&P===0&&C===0)e.rect(-O/2,-V/2,O,V);else{var I=O/2,R=V/2,w=1-.5522847498307936,N=P*w,U=C*w,q=[-I,-R+C,-I,-R+U,-I+N,-R,-I+P,-R,I-P,-R,I-N,-R,I,-R+U,I,-R+C,I,R-C,I,R-U,I-N,R,I-P,R,-I+P,R,-I+N,R,-I,R-U,-I,R-C];h&&h.transform(q,q,32),e.moveTo(q[0],q[1]),e.bezierCurveTo(q[2],q[3],q[4],q[5],q[6],q[7]),I!==P&&e.lineTo(q[8],q[9]),e.bezierCurveTo(q[10],q[11],q[12],q[13],q[14],q[15]),R!==C&&e.lineTo(q[16],q[17]),e.bezierCurveTo(q[18],q[19],q[20],q[21],q[22],q[23]),I!==P&&e.lineTo(q[24],q[25]),e.bezierCurveTo(q[26],q[27],q[28],q[29],q[30],q[31])}}e.closePath()}!v&&(g||m)&&(this._setStyles(e,i,r),g&&(e.fill(c.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),m&&e.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(e,i){var r=new $(this._size).setCenter(0,0),h=this._style,c=i.stroke&&h.hasStroke()&&h.getStrokeWidth();return e&&(r=e._transformBounds(r)),c?r.expand(Fe._getStrokePadding(c,this._getStrokeMatrix(e,i))):r}},new function(){function e(r,h,c){var g=r._radius;if(!g.isZero())for(var m=r._size.divide(2),v=1;v<=4;v++){var y=new L(v>1&&v<4?-1:1,v>2?-1:1),x=y.multiply(m),E=x.subtract(y.multiply(g)),A=new $(c?x.add(y.multiply(c)):x,E);if(A.contains(h))return{point:E,quadrant:v}}}function i(r,h,c,g){var m=r.divide(h);return(!g||m.isInQuadrant(g))&&m.subtract(m.normalize()).multiply(h).divide(c).length<=1}return{_contains:function r(h){if(this._type==="rectangle"){var c=e(this,h);return c?h.subtract(c.point).divide(this._radius).getLength()<=1:r.base.call(this,h)}else return h.divide(this.size).getLength()<=.5},_hitTestSelf:function r(h,c,g,m){var v=!1,y=this._style,x=c.stroke&&y.hasStroke(),E=c.fill&&y.hasFill();if(x||E){var A=this._type,P=this._radius,C=x?y.getStrokeWidth()/2:0,B=c._tolerancePadding.add(Fe._getStrokePadding(C,!y.getStrokeScaling()&&m));if(A==="rectangle"){var O=B.multiply(2),V=e(this,h,O);if(V)v=i(h.subtract(V.point),P,B,V.quadrant);else{var I=new $(this._size).setCenter(0,0),R=I.expand(O),w=I.expand(O.negate());v=R._containsPoint(h)&&!w._containsPoint(h)}}else v=i(h,P,B)}return v?new ze(x?"stroke":"fill",this):r.base.apply(this,arguments)}}},{statics:new function(){function e(i,r,h,c,g){var m=o.create(de.prototype);return m._type=i,m._size=h,m._radius=c,m._initialize(o.getNamed(g),r),m}return{Circle:function(){var i=arguments,r=L.readNamed(i,"center"),h=o.readNamed(i,"radius");return e("circle",r,new X(h*2),h,i)},Rectangle:function(){var i=arguments,r=$.readNamed(i,"rectangle"),h=X.min(X.readNamed(i,"radius"),r.getSize(!0).divide(2));return e("rectangle",r.getCenter(!0),r.getSize(!0),h,i)},Ellipse:function(){var i=arguments,r=de._readEllipse(i),h=r.radius;return e("ellipse",r.center,h.multiply(2),h,i)},_readEllipse:function(i){var r,h;if(o.hasNamed(i,"radius"))r=L.readNamed(i,"center"),h=X.readNamed(i,"radius");else{var c=$.readNamed(i,"rectangle");r=c.getCenter(!0),h=c.getSize(!0).divide(2)}return{center:r,radius:h}}}}}),Se=T.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(i,r){if(!this._initialize(i,r!==a&&L.read(arguments))){var h,c=typeof i,g=c==="string"?f.getElementById(i):c==="object"?i:null;if(g&&g!==T.NO_INSERT){if(g.getContext||g.naturalHeight!=null)h=g;else if(g){var m=X.read(arguments);m.isZero()||(h=pt.getCanvas(m))}}h?this.setImage(h):this.setSource(i)}this._size||(this._size=new X,this._loaded=!1)},_equals:function(e){return this.getSource()===e.getSource()},copyContent:function(e){var i=e._image,r=e._canvas;if(i)this._setImage(i);else if(r){var h=pt.getCanvas(e._size);h.getContext("2d").drawImage(r,0,0),this._setImage(h)}this._crossOrigin=e._crossOrigin},getSize:function(){var e=this._size;return new te(e?e.width:0,e?e.height:0,this,"setSize")},setSize:function(e,i){var r=X.read(arguments);if(r.equals(this._size))i&&this.clear();else if(r.width>0&&r.height>0){var h=!i&&this.getElement();this._setImage(pt.getCanvas(r)),h&&this.getContext(!0).drawImage(h,0,0,r.width,r.height)}else this._canvas&&pt.release(this._canvas),this._size=r.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(e){this.setSize(e,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(e){this.setSize(this.getWidth(),e)},getLoaded:function(){return this._loaded},isEmpty:function(){var e=this._size;return!e||e.width===0&&e.height===0},getResolution:function(){var e=this._matrix,i=new L(0,0).transform(e),r=new L(1,0).transform(e).subtract(i),h=new L(0,1).transform(e).subtract(i);return new X(72/r.getLength(),72/h.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(e){var i=this;function r(h){var c=i.getView(),g=h&&h.type||"load";c&&i.responds(g)&&(Qe=c._scope,i.emit(g,new oi(h)))}this._setImage(e),this._loaded?setTimeout(r,0):e&&ut.add(e,{load:function(h){i._setImage(e),r(h)},error:r})},_setImage:function(e){this._canvas&&pt.release(this._canvas),e&&e.getContext?(this._image=null,this._canvas=e,this._loaded=!0):(this._image=e,this._canvas=null,this._loaded=!!(e&&e.src&&e.complete)),this._size=new X(e?e.naturalWidth||e.width:0,e?e.naturalHeight||e.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var e=pt.getContext(this._size);try{this._image&&e.drawImage(this._image,0,0),this._canvas=e.canvas}catch{pt.release(e)}}return this._canvas},setCanvas:"#setImage",getContext:function(e){return this._context||(this._context=this.getCanvas().getContext("2d")),e&&(this._image=null,this._changed(1025)),this._context},setContext:function(e){this._context=e},getSource:function(){var e=this._image;return e&&e.src||this.toDataURL()},setSource:function(e){var i=new s.Image,r=this._crossOrigin;r&&(i.crossOrigin=r),e&&(i.src=e),this.setImage(i)},getCrossOrigin:function(){var e=this._image;return e&&e.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(e){this._crossOrigin=e;var i=this._image;i&&(i.crossOrigin=e)},getSmoothing:function(){return this._smoothing},setSmoothing:function(e){this._smoothing=typeof e=="string"?e:e?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var e=$.read(arguments),i=pt.getContext(e.getSize());return i.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height),i.canvas},getSubRaster:function(){var e=$.read(arguments),i=new Se(T.NO_INSERT);return i._setImage(this.getSubCanvas(e)),i.translate(e.getCenter().subtract(this.getSize().divide(2))),i._matrix.prepend(this._matrix),i.insertAbove(this),i},toDataURL:function(){var e=this._image,i=e&&e.src;if(/^data:/.test(i))return i;var r=this.getCanvas();return r?r.toDataURL.apply(r,arguments):null},drawImage:function(e){var i=L.read(arguments,1);this.getContext(!0).drawImage(e,i.x,i.y)},getAverageColor:function(e){var i,r;if(e?e instanceof st?(r=e,i=e.getBounds()):typeof e=="object"&&("width"in e?i=new $(e):"x"in e&&(i=new $(e.x-.5,e.y-.5,1,1))):i=this.getBounds(),!i)return null;var h=32,c=Math.min(i.width,h),g=Math.min(i.height,h),m=Se._sampleContext;m?m.clearRect(0,0,h+1,h+1):m=Se._sampleContext=pt.getContext(new X(h)),m.save();var v=new re().scale(c/i.width,g/i.height).translate(-i.x,-i.y);v.applyToContext(m),r&&r.draw(m,new o({clip:!0,matrices:[v]})),this._matrix.applyToContext(m);var y=this.getElement(),x=this._size;y&&m.drawImage(y,-x.width/2,-x.height/2),m.restore();for(var E=m.getImageData(.5,.5,Math.ceil(c),Math.ceil(g)).data,A=[0,0,0],P=0,C=0,B=E.length;C<B;C+=4){var O=E[C+3];P+=O,O/=255,A[0]+=E[C]*O,A[1]+=E[C+1]*O,A[2]+=E[C+2]*O}for(var C=0;C<3;C++)A[C]/=P;return P?dt.read(A):null},getPixel:function(){var e=L.read(arguments),i=this.getContext().getImageData(e.x,e.y,1,1).data;return new dt("rgb",[i[0]/255,i[1]/255,i[2]/255],i[3]/255)},setPixel:function(){var e=arguments,i=L.read(e),r=dt.read(e),h=r._convert("rgb"),c=r._alpha,g=this.getContext(!0),m=g.createImageData(1,1),v=m.data;v[0]=h[0]*255,v[1]=h[1]*255,v[2]=h[2]*255,v[3]=c!=null?c*255:255,g.putImageData(m,i.x,i.y)},clear:function(){var e=this._size;this.getContext(!0).clearRect(0,0,e.width+1,e.height+1)},createImageData:function(){var e=X.read(arguments);return this.getContext().createImageData(e.width,e.height)},getImageData:function(){var e=$.read(arguments);return e.isEmpty()&&(e=new $(this._size)),this.getContext().getImageData(e.x,e.y,e.width,e.height)},putImageData:function(e){var i=L.read(arguments,1);this.getContext(!0).putImageData(e,i.x,i.y)},setImageData:function(e){this.setSize(e),this.getContext(!0).putImageData(e,0,0)},_getBounds:function(e,i){var r=new $(this._size).setCenter(0,0);return e?e._transformBounds(r):r},_hitTestSelf:function(e){if(this._contains(e)){var i=this;return new ze("pixel",i,{offset:e.add(i._size.divide(2)).round(),color:{get:function(){return i.getPixel(this.offset)}}})}},_draw:function(e,i,r){var h=this.getElement();if(h&&h.width>0&&h.height>0){e.globalAlpha=M.clamp(this._opacity,0,1),this._setStyles(e,i,r);var c=this._smoothing,g=c==="off";at.setPrefixed(e,g?"imageSmoothingEnabled":"imageSmoothingQuality",g?!1:c),e.drawImage(h,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ie=T.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(i,r){this._initialize(i,r!==a&&L.read(arguments,1))||this.setDefinition(i instanceof Ce?i:new Ce(i))},_equals:function(e){return this._definition===e._definition},copyContent:function(e){this.setDefinition(e._definition)},getDefinition:function(){return this._definition},setDefinition:function(e){this._definition=e,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(e,i){var r=this._definition._item;return r._getCachedBounds(r._matrix.prepended(e),i)},_hitTestSelf:function(e,i,r){var h=i.extend({all:!1}),c=this._definition._item._hitTest(e,h,r);return c&&(c.item=this),c},_draw:function(e,i){this._definition._item.draw(e,i)}}),Ce=o.extend({_class:"SymbolDefinition",initialize:function(i,r){this._id=H.get(),this.project=Qe.project,i&&this.setItem(i,r)},_serialize:function(e,i){return i.add(this,function(){return o.serialize([this._class,this._item],e,!1,i)})},_changed:function(e){e&8&&T._clearBoundsCache(this),e&1&&this.project._changed(e)},getItem:function(){return this._item},setItem:function(e,i){e._symbol&&(e=e.clone()),this._item&&(this._item._symbol=null),this._item=e,e.remove(),e.setSelected(!1),i||e.setPosition(new L),e._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(e){return new Ie(this,e)},clone:function(){return new Ce(this._item.clone(!1))},equals:function(e){return e===this||e&&this._item.equals(e._item)||!1}}),ze=o.extend({_class:"HitResult",initialize:function(i,r,h){this.type=i,this.item=r,h&&this.inject(h)},statics:{getOptions:function(e){var i=e&&o.read(e);return new o({type:null,tolerance:Qe.settings.hitTolerance,fill:!i,stroke:!i,segments:!i,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},i)}}}),Pe=o.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(i,r,h,c,g,m){var v=arguments.length,y,x,E,A;v>0&&(i==null||typeof i=="object"?v===1&&i&&"point"in i?(y=i.point,x=i.handleIn,E=i.handleOut,A=i.selection):(y=i,x=r,E=h,A=c):(y=[i,r],x=h!==a?[h,c]:null,E=g!==a?[g,m]:null)),new et(y,this,"_point"),new et(x,this,"_handleIn"),new et(E,this,"_handleOut"),A&&this.setSelection(A)},_serialize:function(e,i){var r=this._point,h=this._selection,c=h||this.hasHandles()?[r,this._handleIn,this._handleOut]:r;return h&&c.push(h),o.serialize(c,e,!0,i)},_changed:function(e){var i=this._path;if(i){var r=i._curves,h=this._index,c;r&&((!e||e===this._point||e===this._handleIn)&&(c=h>0?r[h-1]:i._closed?r[r.length-1]:null)&&c._changed(),(!e||e===this._point||e===this._handleOut)&&(c=r[h])&&c._changed()),i._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(L.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(L.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(L.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var e=this._handleIn,i=this._handleOut;return!e.isZero()&&!i.isZero()&&e.isCollinear(i)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(e){var i=this._selection,r=this._path;this._selection=e=e||0,r&&e!==i&&(r._updateSelection(this,i,e),r._changed(257))},_changeSelection:function(e,i){var r=this._selection;this.setSelection(i?r|e:r&~e)},isSelected:function(){return!!(this._selection&7)},setSelected:function(e){this._changeSelection(7,e)},getIndex:function(){return this._index!==a?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var e=this._path,i=this._index;return e?(i>0&&!e._closed&&i===e._segments.length-1&&i--,e.getCurves()[i]||null):null},getLocation:function(){var e=this.getCurve();return e?new Ye(e,this===e._segment1?0:1):null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},smooth:function(e,i,r){var h=e||{},c=h.type,g=h.factor,m=this.getPrevious(),v=this.getNext(),y=(m||this)._point,x=this._point,E=(v||this)._point,A=y.getDistance(x),P=x.getDistance(E);if(!c||c==="catmull-rom"){var C=g===a?.5:g,B=Math.pow(A,C),O=B*B,V=Math.pow(P,C),I=V*V;if(!i&&m){var R=2*I+3*V*B+O,w=3*V*(V+B);this.setHandleIn(w!==0?new L((I*y._x+R*x._x-O*E._x)/w-x._x,(I*y._y+R*x._y-O*E._y)/w-x._y):new L)}if(!r&&v){var R=2*O+3*B*V+I,w=3*B*(B+V);this.setHandleOut(w!==0?new L((O*E._x+R*x._x-I*y._x)/w-x._x,(O*E._y+R*x._y-I*y._y)/w-x._y):new L)}}else if(c==="geometric"){if(m&&v){var N=y.subtract(E),U=g===a?.4:g,q=U*A/(A+P);i||this.setHandleIn(N.multiply(q)),r||this.setHandleOut(N.multiply(q-U))}}else throw new Error("Smoothing method '"+c+"' not supported.")},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var e=this._path;return e&&this._index===e._segments.length-1||!1},reverse:function(){var e=this._handleIn,i=this._handleOut,r=e.clone();e.set(i),i.set(r)},reversed:function(){return new Pe(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Pe(this._point,this._handleIn,this._handleOut)},equals:function(e){return e===this||e&&this._class===e._class&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)||!1},toString:function(){var e=["point: "+this._point];return this._handleIn.isZero()||e.push("handleIn: "+this._handleIn),this._handleOut.isZero()||e.push("handleOut: "+this._handleOut),"{ "+e.join(", ")+" }"},transform:function(e){this._transformCoordinates(e,new Array(6),!0),this._changed()},interpolate:function(e,i,r){var h=1-r,c=r,g=e._point,m=i._point,v=e._handleIn,y=i._handleIn,x=i._handleOut,E=e._handleOut;this._point._set(h*g._x+c*m._x,h*g._y+c*m._y,!0),this._handleIn._set(h*v._x+c*y._x,h*v._y+c*y._y,!0),this._handleOut._set(h*E._x+c*x._x,h*E._y+c*x._y,!0),this._changed()},_transformCoordinates:function(e,i,r){var h=this._point,c=!r||!this._handleIn.isZero()?this._handleIn:null,g=!r||!this._handleOut.isZero()?this._handleOut:null,m=h._x,v=h._y,y=2;return i[0]=m,i[1]=v,c&&(i[y++]=c._x+m,i[y++]=c._y+v),g&&(i[y++]=g._x+m,i[y++]=g._y+v),e&&(e._transformCoordinates(i,i,y/2),m=i[0],v=i[1],r?(h._x=m,h._y=v,y=2,c&&(c._x=i[y++]-m,c._y=i[y++]-v),g&&(g._x=i[y++]-m,g._y=i[y++]-v)):(c||(i[y++]=m,i[y++]=v),g||(i[y++]=m,i[y++]=v))),i}}),et=L.extend({initialize:function(i,r,h){var c,g,m;if(!i)c=g=0;else if((c=i[0])!==a)g=i[1];else{var v=i;(c=v.x)===a&&(v=L.read(arguments),c=v.x),g=v.y,m=v.selected}this._x=c,this._y=g,this._owner=r,r[h]=this,m&&this.setSelected(!0)},_set:function(e,i){return this._x=e,this._y=i,this._owner._changed(this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner._changed(this)},isZero:function(){var e=M.isZero;return e(this._x)&&e(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){var e=this._owner;return this===e._point?1:this===e._handleIn?2:this===e._handleOut?4:0}}),ge=o.extend({_class:"Curve",beans:!0,initialize:function(i,r,h,c,g,m,v,y){var x=arguments.length,E,A,P,C,B,O;x===3?(this._path=i,E=r,A=h):x?x===1?"segment1"in i?(E=new Pe(i.segment1),A=new Pe(i.segment2)):"point1"in i?(P=i.point1,B=i.handle1,O=i.handle2,C=i.point2):Array.isArray(i)&&(P=[i[0],i[1]],C=[i[6],i[7]],B=[i[2]-i[0],i[3]-i[1]],O=[i[4]-i[6],i[5]-i[7]]):x===2?(E=new Pe(i),A=new Pe(r)):x===4?(P=i,B=r,O=h,C=c):x===8&&(P=[i,r],C=[v,y],B=[h-i,c-r],O=[g-v,m-y]):(E=new Pe,A=new Pe),this._segment1=E||new Pe(P,null,B),this._segment2=A||new Pe(C,O,null)},_serialize:function(e,i){return o.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],e,!0,i)},_changed:function(){this._length=this._bounds=a},clone:function(){return new ge(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||e.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||e.push("handle2: "+this._segment2._handleIn),e.push("point2: "+this._segment2._point),"{ "+e.join(", ")+" }"},classify:function(){return ge.classify(this.getValues())},remove:function(){var e=!1;if(this._path){var i=this._segment2,r=i._handleOut;e=i.remove(),e&&this._segment1._handleOut.set(r)}return e},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(L.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(L.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(L.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(L.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var e=this._path;return e&&this._segment1._index===e._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(e){this.getPoint1().setSelected(e),this.getHandle1().setSelected(e),this.getHandle2().setSelected(e),this.getPoint2().setSelected(e)},getValues:function(e){return ge.getValues(this._segment1,this._segment2,e)},getPoints:function(){for(var e=this.getValues(),i=[],r=0;r<8;r+=2)i.push(new L(e[r],e[r+1]));return i}},{getLength:function(){return this._length==null&&(this._length=ge.getLength(this.getValues(),0,1)),this._length},getArea:function(){return ge.getArea(this.getValues())},getLine:function(){return new _e(this._segment1._point,this._segment2._point)},getPart:function(e,i){return new ge(ge.getPart(this.getValues(),e,i))},getPartLength:function(e,i){return ge.getLength(this.getValues(),e,i)},divideAt:function(e){return this.divideAtTime(e&&e.curve===this?e.time:this.getTimeAt(e))},divideAtTime:function(e,i){var r=1e-8,h=1-r,c=null;if(e>=r&&e<=h){var g=ge.subdivide(this.getValues(),e),m=g[0],v=g[1],y=i||this.hasHandles(),x=this._segment1,E=this._segment2,A=this._path;y&&(x._handleOut._set(m[2]-m[0],m[3]-m[1]),E._handleIn._set(v[4]-v[6],v[5]-v[7]));var P=m[6],C=m[7],B=new Pe(new L(P,C),y&&new L(m[4]-P,m[5]-C),y&&new L(v[2]-P,v[3]-C));A?(A.insert(x._index+1,B),c=this.getNext()):(this._segment2=B,this._changed(),c=new ge(B,E))}return c},splitAt:function(e){var i=this._path;return i?i.splitAt(e):null},splitAtTime:function(e){return this.splitAt(this.getLocationAtTime(e))},divide:function(e,i){return this.divideAtTime(e===a?.5:i?e:this.getTimeAt(e))},split:function(e,i){return this.splitAtTime(e===a?.5:i?e:this.getTimeAt(e))},reversed:function(){return new ge(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(e,i,r,h){var c=e._point,g=e._handleOut,m=i._handleIn,v=i._point,y=c.x,x=c.y,E=v.x,A=v.y,P=h?[y,x,y,x,E,A,E,A]:[y,x,y+g._x,x+g._y,E+m._x,A+m._y,E,A];return r&&r._transformCoordinates(P,P,4),P},subdivide:function(e,i){var r=e[0],h=e[1],c=e[2],g=e[3],m=e[4],v=e[5],y=e[6],x=e[7];i===a&&(i=.5);var E=1-i,A=E*r+i*c,P=E*h+i*g,C=E*c+i*m,B=E*g+i*v,O=E*m+i*y,V=E*v+i*x,I=E*A+i*C,R=E*P+i*B,w=E*C+i*O,N=E*B+i*V,U=E*I+i*w,q=E*R+i*N;return[[r,h,A,P,I,R,U,q],[U,q,w,N,O,V,y,x]]},getMonoCurves:function(e,i){var r=[],h=i?0:1,c=e[h+0],g=e[h+2],m=e[h+4],v=e[h+6];if(c>=g==g>=m&&g>=m==m>=v||ge.isStraight(e))r.push(e);else{var y=3*(g-m)-c+v,x=2*(c+m)-4*g,E=g-c,A=1e-8,P=1-A,C=[],B=M.solveQuadratic(y,x,E,C,A,P);if(!B)r.push(e);else{C.sort();var O=C[0],V=ge.subdivide(e,O);r.push(V[0]),B>1&&(O=(C[1]-O)/(1-O),V=ge.subdivide(V[1],O),r.push(V[0])),r.push(V[1])}}return r},solveCubic:function(e,i,r,h,c,g){var m=e[i],v=e[i+2],y=e[i+4],x=e[i+6],E=0;if(!(m<r&&x<r&&v<r&&y<r||m>r&&x>r&&v>r&&y>r)){var A=3*(v-m),P=3*(y-v)-A,C=x-m-A-P;E=M.solveCubic(C,P,A,m-r,h,c,g)}return E},getTimeOf:function(e,i){var r=new L(e[0],e[1]),h=new L(e[6],e[7]),c=1e-12,g=1e-7,m=i.isClose(r,c)?0:i.isClose(h,c)?1:null;if(m===null)for(var v=[i.x,i.y],y=[],x=0;x<2;x++)for(var E=ge.solveCubic(e,x,v[x],y,0,1),A=0;A<E;A++){var P=y[A];if(i.isClose(ge.getPoint(e,P),g))return P}return i.isClose(r,g)?0:i.isClose(h,g)?1:null},getNearestTime:function(e,i){if(ge.isStraight(e)){var r=e[0],h=e[1],c=e[6],g=e[7],m=c-r,v=g-h,y=m*m+v*v;if(y===0)return 0;var x=((i.x-r)*m+(i.y-h)*v)/y;return x<1e-12?0:x>.999999999999?1:ge.getTimeOf(e,new L(r+x*m,h+x*v))}var E=100,A=1/0,P=0;function C(V){if(V>=0&&V<=1){var I=i.getDistance(ge.getPoint(e,V),!0);if(I<A)return A=I,P=V,!0}}for(var B=0;B<=E;B++)C(B/E);for(var O=1/(E*2);O>1e-8;)!C(P-O)&&!C(P+O)&&(O/=2);return P},getPart:function(e,i,r){var h=i>r;if(h){var c=i;i=r,r=c}return i>0&&(e=ge.subdivide(e,i)[1]),r<1&&(e=ge.subdivide(e,(r-i)/(1-i))[0]),h?[e[6],e[7],e[4],e[5],e[2],e[3],e[0],e[1]]:e},isFlatEnough:function(e,i){var r=e[0],h=e[1],c=e[2],g=e[3],m=e[4],v=e[5],y=e[6],x=e[7],E=3*c-2*r-y,A=3*g-2*h-x,P=3*m-2*y-r,C=3*v-2*x-h;return Math.max(E*E,P*P)+Math.max(A*A,C*C)<=16*i*i},getArea:function(e){var i=e[0],r=e[1],h=e[2],c=e[3],g=e[4],m=e[5],v=e[6],y=e[7];return 3*((y-r)*(h+g)-(v-i)*(c+m)+c*(i-g)-h*(r-m)+y*(g+i/3)-v*(m+r/3))/20},getBounds:function(e){for(var i=e.slice(0,2),r=i.slice(),h=[0,0],c=0;c<2;c++)ge._addBounds(e[c],e[c+2],e[c+4],e[c+6],c,0,i,r,h);return new $(i[0],i[1],r[0]-i[0],r[1]-i[1])},_addBounds:function(e,i,r,h,c,g,m,v,y){function x(U,q){var D=U-q,G=U+q;D<m[c]&&(m[c]=D),G>v[c]&&(v[c]=G)}g/=2;var E=m[c]+g,A=v[c]-g;if(e<E||i<E||r<E||h<E||e>A||i>A||r>A||h>A)if(i<e!=i<h&&r<e!=r<h)x(e,0),x(h,0);else{var P=3*(i-r)-e+h,C=2*(e+r)-4*i,B=i-e,O=M.solveQuadratic(P,C,B,y),V=1e-8,I=1-V;x(h,0);for(var R=0;R<O;R++){var w=y[R],N=1-w;V<=w&&w<=I&&x(N*N*N*e+3*N*N*w*i+3*N*w*w*r+w*w*w*h,g)}}}}},o.each(["getBounds","getStrokeBounds","getHandleBounds"],function(e){this[e]=function(){this._bounds||(this._bounds={});var i=this._bounds[e];return i||(i=this._bounds[e]=Fe[e]([this._segment1,this._segment2],!1,this._path)),i.clone()}},{}),o.each({isStraight:function(e,i,r,h){if(i.isZero()&&r.isZero())return!0;var c=h.subtract(e);if(c.isZero())return!1;if(c.isCollinear(i)&&c.isCollinear(r)){var g=new _e(e,h),m=1e-7;if(g.getDistance(e.add(i))<m&&g.getDistance(h.add(r))<m){var v=c.dot(c),y=c.dot(i)/v,x=c.dot(r)/v;return y>=0&&y<=1&&x<=0&&x>=-1}}return!1},isLinear:function(e,i,r,h){var c=h.subtract(e).divide(3);return i.equals(c)&&r.negate().equals(c)}},function(e,i){this[i]=function(r){var h=this._segment1,c=this._segment2;return e(h._point,h._handleOut,c._handleIn,c._point,r)},this.statics[i]=function(r,h){var c=r[0],g=r[1],m=r[6],v=r[7];return e(new L(c,g),new L(r[2]-c,r[3]-g),new L(r[4]-m,r[5]-v),new L(m,v),h)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(e){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(e||0)},isCollinear:function(e){return e&&this.isStraight()&&e.isStraight()&&this.getLine().isCollinear(e.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(e,i){return this.getLocationAtTime(i?e:this.getTimeAt(e))},getLocationAtTime:function(e){return e!=null&&e>=0&&e<=1?new Ye(this,e):null},getTimeAt:function(e,i){return ge.getTimeAt(this.getValues(),e,i)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var e=L.read(arguments);return e.isZero()?[]:ge.getTimesWithTangent(this.getValues(),e)},getOffsetAtTime:function(e){return this.getPartLength(0,e)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(L.read(arguments)))},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getTimeOf:function(){return ge.getTimeOf(this.getValues(),L.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var e=L.read(arguments),i=this.getValues(),r=ge.getNearestTime(i,e),h=ge.getPoint(i,r);return new Ye(this,r,h,null,e.getDistance(h))},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()}},new function(){var e=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return o.each(e,function(i){this[i+"At"]=function(r,h){var c=this.getValues();return ge[i](c,h?r:ge.getTimeAt(c,r))},this[i+"AtTime"]=function(r){return ge[i](this.getValues(),r)}},{statics:{_evaluateMethods:e}})},new function(){function e(h){var c=h[0],g=h[1],m=h[2],v=h[3],y=h[4],x=h[5],E=h[6],A=h[7],P=9*(m-y)+3*(E-c),C=6*(c+y)-12*m,B=3*(m-c),O=9*(v-x)+3*(A-g),V=6*(g+x)-12*v,I=3*(v-g);return function(R){var w=(P*R+C)*R+B,N=(O*R+V)*R+I;return Math.sqrt(w*w+N*N)}}function i(h,c){return Math.max(2,Math.min(16,Math.ceil(Math.abs(c-h)*32)))}function r(h,c,g,m){if(c==null||c<0||c>1)return null;var v=h[0],y=h[1],x=h[2],E=h[3],A=h[4],P=h[5],C=h[6],B=h[7],O=M.isZero;O(x-v)&&O(E-y)&&(x=v,E=y),O(A-C)&&O(P-B)&&(A=C,P=B);var V=3*(x-v),I=3*(A-x)-V,R=C-v-V-I,w=3*(E-y),N=3*(P-E)-w,U=B-y-w-N,q,D;if(g===0)q=c===0?v:c===1?C:((R*c+I)*c+V)*c+v,D=c===0?y:c===1?B:((U*c+N)*c+w)*c+y;else{var G=1e-8,Z=1-G;if(c<G?(q=V,D=w):c>Z?(q=3*(C-A),D=3*(B-P)):(q=(3*R*c+2*I)*c+V,D=(3*U*c+2*N)*c+w),m){q===0&&D===0&&(c<G||c>Z)&&(q=A-x,D=P-E);var K=Math.sqrt(q*q+D*D);K&&(q/=K,D/=K)}if(g===3){var A=6*R*c+2*I,P=6*U*c+2*N,ee=Math.pow(q*q+D*D,3/2);q=ee!==0?(q*P-D*A)/ee:0,D=0}}return g===2?new L(D,-q):new L(q,D)}return{statics:{classify:function(h){var c=h[0],g=h[1],m=h[2],v=h[3],y=h[4],x=h[5],E=h[6],A=h[7],P=c*(A-x)+g*(y-E)+E*x-A*y,C=m*(g-A)+v*(E-c)+c*A-g*E,B=y*(v-g)+x*(c-m)+m*g-v*c,O=3*B,V=O-C,I=V-C+P,R=Math.sqrt(I*I+V*V+O*O),w=R!==0?1/R:0,N=M.isZero,U="serpentine";I*=w,V*=w,O*=w;function q(K,ee,j){var J=ee!==a,ie=J&&ee>0&&ee<1,se=J&&j>0&&j<1;return J&&(!(ie||se)||K==="loop"&&!(ie&&se))&&(K="arch",ie=se=!1),{type:K,roots:ie||se?ie&&se?ee<j?[ee,j]:[j,ee]:[ie?ee:j]:null}}if(N(I))return N(V)?q(N(O)?"line":"quadratic"):q(U,O/(3*V));var D=3*V*V-4*I*O;if(N(D))return q("cusp",V/(2*I));var G=D>0?Math.sqrt(D/3):Math.sqrt(-D),Z=2*I;return q(D>0?U:"loop",(V+G)/Z,(V-G)/Z)},getLength:function(h,c,g,m){if(c===a&&(c=0),g===a&&(g=1),ge.isStraight(h)){var v=h;g<1&&(v=ge.subdivide(v,g)[0],c/=g),c>0&&(v=ge.subdivide(v,c)[1]);var y=v[6]-v[0],x=v[7]-v[1];return Math.sqrt(y*y+x*x)}return M.integrate(m||e(h),c,g,i(c,g))},getTimeAt:function(h,c,g){if(g===a&&(g=c<0?1:0),c===0)return g;var m=Math.abs,v=1e-12,y=c>0,x=y?g:0,E=y?1:g,A=e(h),P=ge.getLength(h,x,E,A),C=m(c)-P;if(m(C)<v)return y?E:x;if(C>v)return null;var B=c/P,O=0;function V(I){return O+=M.integrate(A,g,I,i(g,I)),g=I,O-c}return M.findRoot(V,A,g+B,x,E,32,1e-12)},getPoint:function(h,c){return r(h,c,0,!1)},getTangent:function(h,c){return r(h,c,1,!0)},getWeightedTangent:function(h,c){return r(h,c,1,!1)},getNormal:function(h,c){return r(h,c,2,!0)},getWeightedNormal:function(h,c){return r(h,c,2,!1)},getCurvature:function(h,c){return r(h,c,3,!1).x},getPeaks:function(h){var c=h[0],g=h[1],m=h[2],v=h[3],y=h[4],x=h[5],E=h[6],A=h[7],P=-c+3*m-3*y+E,C=3*c-6*m+3*y,B=-3*c+3*m,O=-g+3*v-3*x+A,V=3*g-6*v+3*x,I=-3*g+3*v,R=1e-8,w=1-R,N=[];return M.solveCubic(9*(P*P+O*O),9*(P*C+V*O),2*(C*C+V*V)+3*(B*P+I*O),B*C+V*I,N,R,w),N.sort()}}}},new function(){function e(C,B,O,V,I,R,w){var N=!w&&O.getPrevious()===I,U=!w&&O!==I&&O.getNext()===I,q=1e-8,D=1-q;if(V!==null&&V>=(N?q:0)&&V<=(U?D:1)&&R!==null&&R>=(U?q:0)&&R<=(N?D:1)){var G=new Ye(O,V,null,w),Z=new Ye(I,R,null,w);G._intersection=Z,Z._intersection=G,(!B||B(G))&&Ye.insert(C,G,!0)}}function i(C,B,O,V,I,R,w,N,U,q,D,G,Z){if(++U>=4096||++N>=40)return U;var K=1e-9,ee=B[0],j=B[1],J=B[6],ie=B[7],se=_e.getSignedDistance,ae=se(ee,j,J,ie,B[2],B[3]),le=se(ee,j,J,ie,B[4],B[5]),we=ae*le>0?3/4:4/9,Ee=we*Math.min(0,ae,le),Me=we*Math.max(0,ae,le),Ne=se(ee,j,J,ie,C[0],C[1]),me=se(ee,j,J,ie,C[2],C[3]),ye=se(ee,j,J,ie,C[4],C[5]),Le=se(ee,j,J,ie,C[6],C[7]),De=r(Ne,me,ye,Le),Re=De[0],Ue=De[1],Be,je;if(ae===0&&le===0&&Ne===0&&me===0&&ye===0&&Le===0||(Be=h(Re,Ue,Ee,Me))==null||(je=h(Re.reverse(),Ue.reverse(),Ee,Me))==null)return U;var Ke=q+(D-q)*Be,qe=q+(D-q)*je;if(Math.max(Z-G,qe-Ke)<K){var _t=(Ke+qe)/2,gt=(G+Z)/2;e(I,R,w?V:O,w?gt:_t,w?O:V,w?_t:gt)}else{C=ge.getPart(C,Be,je);var bt=Z-G;if(je-Be>.8)if(qe-Ke>bt){var mt=ge.subdivide(C,.5),_t=(Ke+qe)/2;U=i(B,mt[0],V,O,I,R,!w,N,U,G,Z,Ke,_t),U=i(B,mt[1],V,O,I,R,!w,N,U,G,Z,_t,qe)}else{var mt=ge.subdivide(B,.5),gt=(G+Z)/2;U=i(mt[0],C,V,O,I,R,!w,N,U,G,gt,Ke,qe),U=i(mt[1],C,V,O,I,R,!w,N,U,gt,Z,Ke,qe)}else bt===0||bt>=K?U=i(B,C,V,O,I,R,!w,N,U,G,Z,Ke,qe):U=i(C,B,O,V,I,R,w,N,U,Ke,qe,G,Z)}return U}function r(C,B,O,V){var I=[0,C],R=[1/3,B],w=[2/3,O],N=[1,V],U=B-(2*C+V)/3,q=O-(C+2*V)/3,D;if(U*q<0)D=[[I,R,N],[I,w,N]];else{var G=U/q;D=[G>=2?[I,R,N]:G<=.5?[I,w,N]:[I,R,w,N],[I,N]]}return(U||q)<0?D.reverse():D}function h(C,B,O,V){return C[0][1]<O?c(C,!0,O):B[0][1]>V?c(B,!1,V):C[0][0]}function c(C,B,O){for(var V=C[0][0],I=C[0][1],R=1,w=C.length;R<w;R++){var N=C[R][0],U=C[R][1];if(B?U>=O:U<=O)return U===O?N:V+(O-I)*(N-V)/(U-I);V=N,I=U}return null}function g(C,B,O,V,I){var R=M.isZero;if(R(V)&&R(I)){var w=ge.getTimeOf(C,new L(B,O));return w===null?[]:[w]}for(var N=Math.atan2(-I,V),U=Math.sin(N),q=Math.cos(N),D=[],G=[],Z=0;Z<8;Z+=2){var K=C[Z]-B,ee=C[Z+1]-O;D.push(K*q-ee*U,K*U+ee*q)}return ge.solveCubic(D,1,0,G,0,1),G}function m(C,B,O,V,I,R,w){for(var N=B[0],U=B[1],q=B[6],D=B[7],G=g(C,N,U,q-N,D-U),Z=0,K=G.length;Z<K;Z++){var ee=G[Z],j=ge.getPoint(C,ee),J=ge.getTimeOf(B,j);J!==null&&e(I,R,w?V:O,w?J:ee,w?O:V,w?ee:J)}}function v(C,B,O,V,I,R){var w=_e.intersect(C[0],C[1],C[6],C[7],B[0],B[1],B[6],B[7]);w&&e(I,R,O,ge.getTimeOf(C,w),V,ge.getTimeOf(B,w))}function y(C,B,O,V,I,R){var w=1e-12,N=Math.min,U=Math.max;if(U(C[0],C[2],C[4],C[6])+w>N(B[0],B[2],B[4],B[6])&&N(C[0],C[2],C[4],C[6])-w<U(B[0],B[2],B[4],B[6])&&U(C[1],C[3],C[5],C[7])+w>N(B[1],B[3],B[5],B[7])&&N(C[1],C[3],C[5],C[7])-w<U(B[1],B[3],B[5],B[7])){var q=A(C,B);if(q)for(var D=0;D<2;D++){var G=q[D];e(I,R,O,G[0],V,G[1],!0)}else{var Z=ge.isStraight(C),K=ge.isStraight(B),ee=Z&&K,j=Z&&!K,J=I.length;if((ee?v:Z||K?m:i)(j?B:C,j?C:B,j?V:O,j?O:V,I,R,j,0,0,0,1,0,1),!ee||I.length===J)for(var D=0;D<4;D++){var ie=D>>1,se=D&1,ae=ie*6,le=se*6,we=new L(C[ae],C[ae+1]),Ee=new L(B[le],B[le+1]);we.isClose(Ee,w)&&e(I,R,O,ie,V,se)}}}return I}function x(C,B,O,V){var I=ge.classify(C);if(I.type==="loop"){var R=I.roots;e(O,V,B,R[0],B,R[1])}return O}function E(C,B,O,V,I,R){var w=1e-7,N=!B;N&&(B=C);for(var U=C.length,q=B.length,D=new Array(U),G=N?D:new Array(q),Z=[],K=0;K<U;K++)D[K]=C[K].getValues(V);if(!N)for(var K=0;K<q;K++)G[K]=B[K].getValues(I);for(var ee=S.findCurveBoundsCollisions(D,G,w),j=0;j<U;j++){var J=C[j],ie=D[j];N&&x(ie,J,Z,O);var se=ee[j];if(se)for(var ae=0;ae<se.length;ae++){if(R&&Z.length)return Z;var le=se[ae];if(!N||le>j){var we=B[le],Ee=G[le];y(ie,Ee,J,we,Z,O)}}}return Z}function A(C,B){function O(Le){var De=Le[6]-Le[0],Re=Le[7]-Le[1];return De*De+Re*Re}var V=Math.abs,I=_e.getDistance,R=1e-8,w=1e-7,N=ge.isStraight(C),U=ge.isStraight(B),q=N&&U,D=O(C)<O(B),G=D?B:C,Z=D?C:B,K=G[0],ee=G[1],j=G[6]-K,J=G[7]-ee;if(I(K,ee,j,J,Z[0],Z[1],!0)<w&&I(K,ee,j,J,Z[6],Z[7],!0)<w)!q&&I(K,ee,j,J,G[2],G[3],!0)<w&&I(K,ee,j,J,G[4],G[5],!0)<w&&I(K,ee,j,J,Z[2],Z[3],!0)<w&&I(K,ee,j,J,Z[4],Z[5],!0)<w&&(N=U=q=!0);else if(q)return null;if(N^U)return null;for(var ie=[C,B],se=[],ae=0;ae<4&&se.length<2;ae++){var le=ae&1,we=le^1,Ee=ae>>1,Me=ge.getTimeOf(ie[le],new L(ie[we][Ee?6:0],ie[we][Ee?7:1]));if(Me!=null){var Ne=le?[Ee,Me]:[Me,Ee];(!se.length||V(Ne[0]-se[0][0])>R&&V(Ne[1]-se[0][1])>R)&&se.push(Ne)}if(ae>2&&!se.length)break}if(se.length!==2)se=null;else if(!q){var me=ge.getPart(C,se[0][0],se[1][0]),ye=ge.getPart(B,se[0][1],se[1][1]);(V(ye[2]-me[2])>w||V(ye[3]-me[3])>w||V(ye[4]-me[4])>w||V(ye[5]-me[5])>w)&&(se=null)}return se}function P(C,B){var O=C[0],V=C[1],I=C[2],R=C[3],w=C[4],N=C[5],U=C[6],q=C[7],D=B.normalize(),G=D.x,Z=D.y,K=3*U-9*w+9*I-3*O,ee=3*q-9*N+9*R-3*V,j=6*w-12*I+6*O,J=6*N-12*R+6*V,ie=3*I-3*O,se=3*R-3*V,ae=2*K*Z-2*ee*G,le=[];if(Math.abs(ae)<M.CURVETIME_EPSILON){var we=K*se-ee*ie,ae=K*J-ee*j;if(ae!=0){var Ee=-we/ae;Ee>=0&&Ee<=1&&le.push(Ee)}}else{var Me=(j*j-4*K*ie)*Z*Z+(-2*j*J+4*ee*ie+4*K*se)*G*Z+(J*J-4*ee*se)*G*G,Ne=j*Z-J*G;if(Me>=0&&ae!=0){var me=Math.sqrt(Me),ye=-(Ne+me)/ae,Le=(-Ne+me)/ae;ye>=0&&ye<=1&&le.push(ye),Le>=0&&Le<=1&&le.push(Le)}}return le}return{getIntersections:function(C){var B=this.getValues(),O=C&&C!==this&&C.getValues();return O?y(B,O,this,C,[]):x(B,this,[])},statics:{getOverlaps:A,getIntersections:E,getCurveLineIntersections:g,getTimesWithTangent:P}}}),Ye=o.extend({_class:"CurveLocation",initialize:function(i,r,h,c,g){if(r>=.99999999){var m=i.getNext();m&&(r=0,i=m)}this._setCurve(i),this._time=r,this._point=h||i.getPointAtTime(r),this._overlap=c,this._distance=g,this._intersection=this._next=this._previous=null},_setPath:function(e){this._path=e,this._version=e?e._version:0},_setCurve:function(e){this._setPath(e._path),this._curve=e,this._segment=null,this._segment1=e._segment1,this._segment2=e._segment2},_setSegment:function(e){var i=e.getCurve();i?this._setCurve(i):(this._setPath(e._path),this._segment1=e,this._segment2=null),this._segment=e,this._time=e===this._segment1?0:1,this._point=e._point.clone()},getSegment:function(){var e=this._segment;if(!e){var i=this.getCurve(),r=this.getTime();r===0?e=i._segment1:r===1?e=i._segment2:r!=null&&(e=i.getPartLength(0,r)<i.getPartLength(r,1)?i._segment1:i._segment2),this._segment=e}return e},getCurve:function(){var e=this._path,i=this;e&&e._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function r(h){var c=h&&h.getCurve();if(c&&(i._time=c.getTimeOf(i._point))!=null)return i._setCurve(c),c}return this._curve||r(this._segment)||r(this._segment1)||r(this._segment2.getPrevious())},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getTime:function(){var e=this.getCurve(),i=this._time;return e&&i==null?this._time=e.getTimeOf(this._point):i},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var e=this._offset;if(e==null){e=0;var i=this.getPath(),r=this.getIndex();if(i&&r!=null)for(var h=i.getCurves(),c=0;c<r;c++)e+=h[c].getLength();this._offset=e+=this.getCurveOffset()}return e},getCurveOffset:function(){var e=this._curveOffset;if(e==null){var i=this.getCurve(),r=this.getTime();this._curveOffset=e=r!=null&&i&&i.getPartLength(0,r)}return e},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(),i=e&&e.divideAtTime(this.getTime());return i&&this._setSegment(i._segment1),i},split:function(){var e=this.getCurve(),i=e._path,r=e&&e.splitAtTime(this.getTime());return r&&this._setSegment(i.getLastSegment()),r},equals:function(e,i){var r=this===e;if(!r&&e instanceof Ye){var h=this.getCurve(),c=e.getCurve(),g=h._path,m=c._path;if(g===m){var v=Math.abs,y=1e-7,x=v(this.getOffset()-e.getOffset()),E=!i&&this._intersection,A=!i&&e._intersection;r=(x<y||g&&v(g.getLength()-x)<y)&&(!E&&!A||E&&A&&E.equals(A,!0))}}return r},toString:function(){var e=[],i=this.getPoint(),r=z.instance;i&&e.push("point: "+i);var h=this.getIndex();h!=null&&e.push("index: "+h);var c=this.getTime();return c!=null&&e.push("time: "+r.number(c)),this._distance!=null&&e.push("distance: "+r.number(this._distance)),"{ "+e.join(", ")+" }"},isTouching:function(){var e=this._intersection;if(e&&this.getTangent().isCollinear(e.getTangent())){var i=this.getCurve(),r=e.getCurve();return!(i.isStraight()&&r.isStraight()&&i.getLine().intersect(r.getLine()))}return!1},isCrossing:function(){var e=this._intersection;if(!e)return!1;var i=this.getTime(),r=e.getTime(),h=1e-8,c=1-h,g=i>=h&&i<=c,m=r>=h&&r<=c;if(g&&m)return!this.isTouching();var v=this.getCurve(),y=v&&i<h?v.getPrevious():v,x=e.getCurve(),E=x&&r<h?x.getPrevious():x;if(i>c&&(v=v.getNext()),r>c&&(x=x.getNext()),!y||!v||!E||!x)return!1;var A=[];function P(G,Z){var K=G.getValues(),ee=ge.classify(K).roots||ge.getPeaks(K),j=ee.length,J=ge.getLength(K,Z&&j?ee[j-1]:0,!Z&&j?ee[0]:1);A.push(j?J:J/32)}function C(G,Z,K){return Z<K?G>Z&&G<K:G>Z||G<K}g||(P(y,!0),P(v,!1)),m||(P(E,!0),P(x,!1));var B=this.getPoint(),O=Math.min.apply(Math,A),V=g?v.getTangentAtTime(i):v.getPointAt(O).subtract(B),I=g?V.negate():y.getPointAt(-O).subtract(B),R=m?x.getTangentAtTime(r):x.getPointAt(O).subtract(B),w=m?R.negate():E.getPointAt(-O).subtract(B),N=I.getAngle(),U=V.getAngle(),q=w.getAngle(),D=R.getAngle();return!!(g?C(N,q,D)^C(U,q,D)&&C(N,D,q)^C(U,D,q):C(q,N,U)^C(D,N,U)&&C(q,U,N)^C(D,U,N))},hasOverlap:function(){return!!this._overlap}},o.each(ge._evaluateMethods,function(e){var i=e+"At";this[e]=function(){var r=this.getCurve(),h=this.getTime();return h!=null&&r&&r[i](h,!0)}},{preserve:!0}),new function(){function e(i,r,h){var c=i.length,g=0,m=c-1;function v(B,O){for(var V=B+O;V>=-1&&V<=c;V+=O){var I=i[(V%c+c)%c];if(!r.getPoint().isClose(I.getPoint(),1e-7))break;if(r.equals(I))return I}return null}for(;g<=m;){var y=g+m>>>1,x=i[y],E;if(h&&(E=r.equals(x)?x:v(y,-1)||v(y,1)))return r._overlap&&(E._overlap=E._intersection._overlap=!0),E;var A=r.getPath(),P=x.getPath(),C=A!==P?A._id-P._id:r.getIndex()+r.getTime()-(x.getIndex()+x.getTime());C<0?m=y-1:g=y+1}return i.splice(g,0,r),r}return{statics:{insert:e,expand:function(i){for(var r=i.slice(),h=i.length-1;h>=0;h--)e(r,i[h]._intersection,!1);return r}}}}),st=T.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(e){var i,r,h;if(o.isPlainObject(e)?(r=e.segments,i=e.pathData):Array.isArray(e)?r=e:typeof e=="string"&&(i=e),r){var c=r[0];h=c&&Array.isArray(c[0])}else i&&(h=(i.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(i));var g=h?it:Fe;return new g(e)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(e){this.isClockwise()!=(e=!!e)&&this.reverse()},setPathData:function(e){var i=e&&e.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),r,h=!1,c,g,m=new L,v=new L;function y(w,N){var U=+r[w];return h&&(U+=m[N]),U}function x(w){return new L(y(w,"x"),y(w+1,"y"))}this.clear();for(var E=0,A=i&&i.length;E<A;E++){var P=i[E],C=P[0],B=C.toLowerCase();r=P.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var O=r&&r.length;switch(h=C===B,c==="z"&&!/[mz]/.test(B)&&this.moveTo(m),B){case"m":case"l":for(var V=B==="m",I=0;I<O;I+=2)this[V?"moveTo":"lineTo"](m=x(I)),V&&(v=m,V=!1);g=m;break;case"h":case"v":var R=B==="h"?"x":"y";m=m.clone();for(var I=0;I<O;I++)m[R]=y(I,R),this.lineTo(m);g=m;break;case"c":for(var I=0;I<O;I+=6)this.cubicCurveTo(x(I),g=x(I+2),m=x(I+4));break;case"s":for(var I=0;I<O;I+=4)this.cubicCurveTo(/[cs]/.test(c)?m.multiply(2).subtract(g):m,g=x(I),m=x(I+2)),c=B;break;case"q":for(var I=0;I<O;I+=4)this.quadraticCurveTo(g=x(I),m=x(I+2));break;case"t":for(var I=0;I<O;I+=2)this.quadraticCurveTo(g=/[qt]/.test(c)?m.multiply(2).subtract(g):m,m=x(I)),c=B;break;case"a":for(var I=0;I<O;I+=7)this.arcTo(m=x(I+5),new X(+r[I],+r[I+1]),+r[I+2],+r[I+4],+r[I+3]);break;case"z":this.closePath(1e-12),m=v;break}c=B}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(e){var i=e.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(e):{};return i.onPath||!!(this.getFillRule()==="evenodd"?i.windingL&1||i.windingR&1:i.winding)},getIntersections:function(e,i,r,h){var c=this===e||!e,g=this._matrix._orNullIfIdentity(),m=c?g:(r||e._matrix)._orNullIfIdentity();return c||this.getBounds(g).intersects(e.getBounds(m),1e-12)?ge.getIntersections(this.getCurves(),!c&&e.getCurves(),i,g,m,h):[]},getCrossings:function(e){return this.getIntersections(e,function(i){return i.isCrossing()})},getNearestLocation:function(){for(var e=L.read(arguments),i=this.getCurves(),r=1/0,h=null,c=0,g=i.length;c<g;c++){var m=i[c].getNearestLocation(e);m._distance<r&&(r=m._distance,h=m)}return h},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()},interpolate:function(e,i,r){var h=!this._children,c=h?"_segments":"_children",g=e[c],m=i[c],v=this[c];if(!g||!m||g.length!==m.length)throw new Error("Invalid operands in interpolate() call: "+e+", "+i);var y=v.length,x=m.length;if(y<x)for(var E=h?Pe:Fe,A=y;A<x;A++)this.add(new E);else y>x&&this[h?"removeSegments":"removeChildren"](x,y);for(var A=0;A<x;A++)v[A].interpolate(g[A],m[A],r);h&&(this.setClosed(e._closed),this._changed(9))},compare:function(e){var i=!1;if(e){var r=this._children||[this],h=e._children?e._children.slice():[e],c=r.length,g=h.length,m=[],v=0;i=!0;for(var y=S.findItemBoundsCollisions(r,h,M.GEOMETRIC_EPSILON),x=c-1;x>=0&&i;x--){var E=r[x];i=!1;var A=y[x];if(A)for(var P=A.length-1;P>=0&&!i;P--)E.compare(h[A[P]])&&(m[A[P]]||(m[A[P]]=!0,v++),i=!0)}i=i&&v===g}return i}}),Fe=st.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(i){this._closed=!1,this._segments=[],this._version=0;var r=arguments,h=Array.isArray(i)?typeof i[0]=="object"?i:r:i&&i.size===a&&(i.x!==a||i.point!==a)?r:null;h&&h.length>0?this.setSegments(h):(this._curves=a,this._segmentSelection=0,!h&&typeof i=="string"&&(this.setPathData(i),i=null)),this._initialize(!h&&i)},_equals:function(e){return this._closed===e._closed&&o.equals(this._segments,e._segments)},copyContent:function(e){this.setSegments(e._segments),this._closed=e._closed},_changed:function e(i){if(e.base.call(this,i),i&8){if(this._length=this._area=a,i&32)this._version++;else if(this._curves)for(var r=0,h=this._curves.length;r<h;r++)this._curves[r]._changed()}else i&64&&(this._bounds=a)},getStyle:function(){var e=this._parent;return(e instanceof it?e:this)._style},getSegments:function(){return this._segments},setSegments:function(e){var i=this.isFullySelected(),r=e&&e.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=a,r){var h=e[r-1];typeof h=="boolean"&&(this.setClosed(h),r--),this._add(Pe.readList(e,0,{},r))}i&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,i=this._segments;if(!e){var r=this._countCurves();e=this._curves=new Array(r);for(var h=0;h<r;h++)e[h]=new ge(this,i[h],i[h+1]||i[0])}return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},isClosed:function(){return this._closed},setClosed:function(e){if(this._closed!=(e=!!e)){if(this._closed=e,this._curves){var i=this._curves.length=this._countCurves();e&&(this._curves[i-1]=new ge(this,this._segments[i-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(e,i){var r=this._segments,h=r.length,c=new z(i),g=new Array(6),m=!0,v,y,x,E,A,P,C,B,O=[];function V(R,w){if(R._transformCoordinates(e,g),v=g[0],y=g[1],m)O.push("M"+c.pair(v,y)),m=!1;else if(A=g[2],P=g[3],A===v&&P===y&&C===x&&B===E){if(!w){var N=v-x,U=y-E;O.push(N===0?"v"+c.number(U):U===0?"h"+c.number(N):"l"+c.pair(N,U))}}else O.push("c"+c.pair(C-x,B-E)+" "+c.pair(A-x,P-E)+" "+c.pair(v-x,y-E));x=v,E=y,C=g[4],B=g[5]}if(!h)return"";for(var I=0;I<h;I++)V(r[I]);return this._closed&&h>0&&(V(r[0],!0),O.push("z")),O.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(e){for(var i=this._segments,r=new Array(6),h=0,c=i.length;h<c;h++)i[h]._transformCoordinates(e,r,!0);return!0},_add:function(e,m){for(var r=this._segments,h=this._curves,c=e.length,g=m==null,m=g?r.length:m,v=0;v<c;v++){var y=e[v];y._path&&(y=e[v]=y.clone()),y._path=this,y._index=m+v,y._selection&&this._updateSelection(y,0,y._selection)}if(g)o.push(r,e);else{r.splice.apply(r,[m,0].concat(e));for(var v=m+c,x=r.length;v<x;v++)r[v]._index=v}if(h){var E=this._countCurves(),A=m>0&&m+c-1===E?m-1:m,P=A,C=Math.min(A+c,E);e._curves&&(h.splice.apply(h,[A,0].concat(e._curves)),P+=e._curves.length);for(var v=P;v<C;v++)h.splice(v,0,new ge(this,null,null));this._adjustCurves(A,C)}return this._changed(41),e},_adjustCurves:function(e,i){for(var r=this._segments,h=this._curves,c,g=e;g<i;g++)c=h[g],c._path=this,c._segment1=r[g],c._segment2=r[g+1]||r[0],c._changed();(c=h[this._closed&&!e?r.length-1:e-1])&&(c._segment2=r[e]||r[0],c._changed()),(c=h[i])&&(c._segment1=r[i],c._changed())},_countCurves:function(){var e=this._segments.length;return!this._closed&&e>0?e-1:e},add:function(e){var i=arguments;return i.length>1&&typeof e!="number"?this._add(Pe.readList(i)):this._add([Pe.read(i)])[0]},insert:function(e,i){var r=arguments;return r.length>2&&typeof i!="number"?this._add(Pe.readList(r,1),e):this._add([Pe.read(r,1)],e)[0]},addSegment:function(){return this._add([Pe.read(arguments)])[0]},insertSegment:function(e){return this._add([Pe.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(Pe.readList(e))},insertSegments:function(e,i){return this._add(Pe.readList(i),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(e,i,r){e=e||0,i=o.pick(i,this._segments.length);var h=this._segments,c=this._curves,g=h.length,m=h.splice(e,i-e),v=m.length;if(!v)return m;for(var y=0;y<v;y++){var x=m[y];x._selection&&this._updateSelection(x,x._selection,0),x._index=x._path=null}for(var y=e,E=h.length;y<E;y++)h[y]._index=y;if(c){for(var A=e>0&&i===g+(this._closed?1:0)?e-1:e,c=c.splice(A,v),y=c.length-1;y>=0;y--)c[y]._path=null;r&&(m._curves=c.slice(1)),this._adjustCurves(A,A)}return this._changed(41),m},clear:"#removeSegments",hasHandles:function(){for(var e=this._segments,i=0,r=e.length;i<r;i++)if(e[i].hasHandles())return!0;return!1},clearHandles:function(){for(var e=this._segments,i=0,r=e.length;i<r;i++)e[i].clearHandles()},getLength:function(){if(this._length==null){for(var e=this.getCurves(),i=0,r=0,h=e.length;r<h;r++)i+=e[r].getLength();this._length=i}return this._length},getArea:function(){var e=this._area;if(e==null){var i=this._segments,r=this._closed;e=0;for(var h=0,c=i.length;h<c;h++){var g=h+1===c;e+=ge.getArea(ge.getValues(i[h],i[g?0:h+1],null,g&&!r))}this._area=e}return e},isFullySelected:function(){var e=this._segments.length;return this.isSelected()&&e>0&&this._segmentSelection===e*7},setFullySelected:function(e){e&&this._selectSegments(!0),this.setSelected(e)},setSelection:function e(i){i&1||this._selectSegments(!1),e.base.call(this,i)},_selectSegments:function(e){var i=this._segments,r=i.length,h=e?7:0;this._segmentSelection=h*r;for(var c=0;c<r;c++)i[c]._selection=h},_updateSelection:function(e,i,r){e._selection=r;var h=this._segmentSelection+=r-i;h>0&&this.setSelected(!0)},divideAt:function(e){var i=this.getLocationAt(e),r;return i&&(r=i.getCurve().divideAt(i.getCurveOffset()))?r._segment1:null},splitAt:function(e){var i=this.getLocationAt(e),r=i&&i.index,h=i&&i.time,c=1e-8,g=1-c;h>g&&(r++,h=0);var m=this.getCurves();if(r>=0&&r<m.length){h>=c&&m[r++].divideAtTime(h);var v=this.removeSegments(r,this._segments.length,!0),y;return this._closed?(this.setClosed(!1),y=this):(y=new Fe(T.NO_INSERT),y.insertAbove(this),y.copyAttributes(this)),y._add(v,0),this.addSegment(v[0]),y}return null},split:function(e,i){var r,h=i===a?e:(r=this.getCurves()[e])&&r.getLocationAtTime(i);return h!=null?this.splitAt(h):null},join:function(e,i){var r=i||0;if(e&&e!==this){var h=e._segments,c=this.getLastSegment(),g=e.getLastSegment();if(!g)return this;c&&c._point.isClose(g._point,r)&&e.reverse();var m=e.getFirstSegment();if(c&&c._point.isClose(m._point,r))c.setHandleOut(m._handleOut),this._add(h.slice(1));else{var v=this.getFirstSegment();v&&v._point.isClose(m._point,r)&&e.reverse(),g=e.getLastSegment(),v&&v._point.isClose(g._point,r)?(v.setHandleIn(g._handleIn),this._add(h.slice(0,h.length-1),0)):this._add(h.slice())}e._closed&&this._add([h[0]]),e.remove()}var y=this.getFirstSegment(),x=this.getLastSegment();return y!==x&&y._point.isClose(x._point,r)&&(y.setHandleIn(x._handleIn),x.remove(),this.setClosed(!0)),this},reduce:function(e){for(var i=this.getCurves(),r=e&&e.simplify,h=r?1e-7:0,c=i.length-1;c>=0;c--){var g=i[c];!g.hasHandles()&&(!g.hasLength(h)||r&&g.isCollinear(g.getNext()))&&g.remove()}return this},reverse:function(){this._segments.reverse();for(var e=0,i=this._segments.length;e<i;e++){var r=this._segments[e],h=r._handleIn;r._handleIn=r._handleOut,r._handleOut=h,r._index=e}this._curves=null,this._changed(9)},flatten:function(e){for(var i=new Kt(this,e||.25,256,!0),r=i.parts,h=r.length,c=[],g=0;g<h;g++)c.push(new Pe(r[g].curve.slice(0,2)));!this._closed&&h>0&&c.push(new Pe(r[h-1].curve.slice(6))),this.setSegments(c)},simplify:function(e){var i=new Bt(this).fit(e||2.5);return i&&this.setSegments(i),!!i},smooth:function(e){var i=this,r=e||{},h=r.type||"asymmetric",c=this._segments,g=c.length,m=this._closed;function v(Re,Ue){var Be=Re&&Re.index;if(Be!=null){var je=Re.path;if(je&&je!==i)throw new Error(Re._class+" "+Be+" of "+je+" is not part of "+i);Ue&&Re instanceof ge&&Be++}else Be=typeof Re=="number"?Re:Ue;return Math.min(Be<0&&m?Be%g:Be<0?Be+g:Be,g-1)}var y=m&&r.from===a&&r.to===a,x=v(r.from,0),E=v(r.to,g-1);if(x>E)if(m)x-=g;else{var A=x;x=E,E=A}if(/^(?:asymmetric|continuous)$/.test(h)){var P=h==="asymmetric",C=Math.min,B=E-x+1,O=B-1,V=y?C(B,4):1,I=V,R=V,w=[];if(m||(I=C(1,x),R=C(1,g-E-1)),O+=I+R,O<=1)return;for(var N=0,U=x-I;N<=O;N++,U++)w[N]=c[(U<0?U+g:U)%g]._point;for(var q=w[0]._x+2*w[1]._x,D=w[0]._y+2*w[1]._y,G=2,Z=O-1,K=[q],ee=[D],j=[G],J=[],ie=[],N=1;N<O;N++){var se=N<Z,ae=se||P?1:2,le=se?4:P?2:7,we=se?4:P?3:8,Ee=se?2:P?0:1,Me=ae/G;G=j[N]=le-Me,q=K[N]=we*w[N]._x+Ee*w[N+1]._x-Me*q,D=ee[N]=we*w[N]._y+Ee*w[N+1]._y-Me*D}J[Z]=K[Z]/j[Z],ie[Z]=ee[Z]/j[Z];for(var N=O-2;N>=0;N--)J[N]=(K[N]-J[N+1])/j[N],ie[N]=(ee[N]-ie[N+1])/j[N];J[O]=(3*w[O]._x-J[Z])/2,ie[O]=(3*w[O]._y-ie[Z])/2;for(var N=I,Ne=O-R,U=x;N<=Ne;N++,U++){var me=c[U<0?U+g:U],ye=me._point,Le=J[N]-ye._x,De=ie[N]-ye._y;(y||N<Ne)&&me.setHandleOut(Le,De),(y||N>I)&&me.setHandleIn(-Le,-De)}}else for(var N=x;N<=E;N++)c[N<0?N+g:N].smooth(r,!y&&N===x,!y&&N===E)},toShape:function(e){if(!this._closed)return null;var i=this._segments,r,h,c,g;function m(P,C){var B=i[P],O=B.getNext(),V=i[C],I=V.getNext();return B._handleOut.isZero()&&O._handleIn.isZero()&&V._handleOut.isZero()&&I._handleIn.isZero()&&O._point.subtract(B._point).isCollinear(I._point.subtract(V._point))}function v(P){var C=i[P],B=C.getPrevious(),O=C.getNext();return B._handleOut.isZero()&&C._handleIn.isZero()&&C._handleOut.isZero()&&O._handleIn.isZero()&&C._point.subtract(B._point).isOrthogonal(O._point.subtract(C._point))}function y(P){var C=i[P],B=C.getNext(),O=C._handleOut,V=B._handleIn,I=.5522847498307936;if(O.isOrthogonal(V)){var R=C._point,w=B._point,N=new _e(R,O,!0).intersect(new _e(w,V,!0),!0);return N&&M.isZero(O.getLength()/N.subtract(R).getLength()-I)&&M.isZero(V.getLength()/N.subtract(w).getLength()-I)}return!1}function x(P,C){return i[P]._point.getDistance(i[C]._point)}if(!this.hasHandles()&&i.length===4&&m(0,2)&&m(1,3)&&v(1)?(r=de.Rectangle,h=new X(x(0,3),x(0,1)),g=i[1]._point.add(i[2]._point).divide(2)):i.length===8&&y(0)&&y(2)&&y(4)&&y(6)&&m(1,5)&&m(3,7)?(r=de.Rectangle,h=new X(x(1,6),x(0,3)),c=h.subtract(new X(x(0,7),x(1,2))).divide(2),g=i[3]._point.add(i[4]._point).divide(2)):i.length===4&&y(0)&&y(1)&&y(2)&&y(3)&&(M.isZero(x(0,2)-x(1,3))?(r=de.Circle,c=x(0,2)/2):(r=de.Ellipse,c=new X(x(2,0)/2,x(3,1)/2)),g=i[1]._point),r){var E=this.getPosition(!0),A=new r({center:E,size:h,radius:c,insert:!1});return A.copyAttributes(this,!0),A._matrix.prepend(this._matrix),A.rotate(g.subtract(E).getAngle()+90),(e===a||e)&&A.insertAbove(this),A}return null},toPath:"#clone",compare:function e(i){if(!i||i instanceof it)return e.base.call(this,i);var r=this.getCurves(),h=i.getCurves(),c=r.length,g=h.length;if(!c||!g)return c==g;for(var m=r[0].getValues(),v=[],y=0,x,E=0,A,P=0;P<g;P++){var V=h[P].getValues();v.push(V);var C=ge.getOverlaps(m,V);if(C){x=!P&&C[0][0]>0?g-1:P,A=C[0][1];break}}for(var B=Math.abs,O=1e-8,V=v[x],I;m&&V;){var C=ge.getOverlaps(m,V);if(C){var R=C[0][0];if(B(R-E)<O){E=C[1][0],E===1&&(m=++y<c?r[y].getValues():null,E=0);var w=C[0][1];if(B(w-A)<O){if(I||(I=[x,w]),A=C[1][1],A===1&&(++x>=g&&(x=0),V=v[x]||h[x].getValues(),A=0),!m)return I[0]===x&&I[1]===A;continue}}}break}return!1},_hitTestSelf:function(e,i,r,h){var c=this,g=this.getStyle(),m=this._segments,v=m.length,y=this._closed,x=i._tolerancePadding,E=x,A,P,C,B,O,V,I=i.stroke&&g.hasStroke(),R=i.fill&&g.hasFill(),w=i.curves,N=I?g.getStrokeWidth()/2:R&&i.tolerance>0||w?0:null;N!==null&&(N>0?(A=g.getStrokeJoin(),P=g.getStrokeCap(),C=g.getMiterLimit(),E=E.add(Fe._getStrokePadding(N,h))):A=P="round");function U(J,ie){return e.subtract(J).divide(ie).length<=1}function q(J,ie,se){if(!i.selected||ie.isSelected()){var ae=J._point;if(ie!==ae&&(ie=ie.add(ae)),U(ie,E))return new ze(se,c,{segment:J,point:ie})}}function D(J,ie){return(ie||i.segments)&&q(J,J._point,"segment")||!ie&&i.handles&&(q(J,J._handleIn,"handle-in")||q(J,J._handleOut,"handle-out"))}function G(J){B.add(J)}function Z(J){var ie=y||J._index>0&&J._index<v-1;if((ie?A:P)==="round")return U(J._point,E);if(B=new Fe({internal:!0,closed:!0}),ie?J.isSmooth()||Fe._addBevelJoin(J,A,N,C,null,h,G,!0):P==="square"&&Fe._addSquareCap(J,P,N,null,h,G,!0),!B.isEmpty()){var se;return B.contains(e)||(se=B.getNearestLocation(e))&&U(se.getPoint(),x)}}if(i.ends&&!i.segments&&!y){if(V=D(m[0],!0)||D(m[v-1],!0))return V}else if(i.segments||i.handles){for(var K=0;K<v;K++)if(V=D(m[K]))return V}if(N!==null){if(O=this.getNearestLocation(e),O){var ee=O.getTime();ee===0||ee===1&&v>1?Z(O.getSegment())||(O=null):U(O.getPoint(),E)||(O=null)}if(!O&&A==="miter"&&v>1)for(var K=0;K<v;K++){var j=m[K];if(e.getDistance(j._point)<=C*N&&Z(j)){O=j.getLocation();break}}}return!O&&R&&this._contains(e)||O&&!I&&!w?new ze("fill",this):O?new ze(I?"stroke":"curve",this,{location:O,point:O.getPoint()}):null}},o.each(ge._evaluateMethods,function(e){this[e+"At"]=function(i){var r=this.getLocationAt(i);return r&&r[e]()}},{beans:!1,getLocationOf:function(){for(var e=L.read(arguments),i=this.getCurves(),r=0,h=i.length;r<h;r++){var c=i[r].getLocationOf(e);if(c)return c}return null},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getLocationAt:function(e){if(typeof e=="number"){for(var i=this.getCurves(),r=0,h=0,c=i.length;h<c;h++){var g=r,m=i[h];if(r+=m.getLength(),r>e)return m.getLocationAt(e-g)}if(i.length>0&&e<=this.getLength())return new Ye(i[i.length-1],1)}else if(e&&e.getPath&&e.getPath()===this)return e;return null},getOffsetsWithTangent:function(){var e=L.read(arguments);if(e.isZero())return[];for(var i=[],r=0,h=this.getCurves(),c=0,g=h.length;c<g;c++){for(var m=h[c],v=m.getTimesWithTangent(e),y=0,x=v.length;y<x;y++){var E=r+m.getOffsetAtTime(v[y]);i.indexOf(E)<0&&i.push(E)}r+=m.length}return i}}),new function(){function e(r,h,c,g){if(g<=0)return;var m=g/2,v=g-2,y=m-1,x=new Array(6),E,A;function P(R){var w=x[R],N=x[R+1];(E!=w||A!=N)&&(r.beginPath(),r.moveTo(E,A),r.lineTo(w,N),r.stroke(),r.beginPath(),r.arc(w,N,m,0,Math.PI*2,!0),r.fill())}for(var C=0,B=h.length;C<B;C++){var O=h[C],V=O._selection;if(O._transformCoordinates(c,x),E=x[0],A=x[1],V&2&&P(2),V&4&&P(4),r.fillRect(E-m,A-m,g,g),v>0&&!(V&1)){var I=r.fillStyle;r.fillStyle="#ffffff",r.fillRect(E-y,A-y,v,v),r.fillStyle=I}}}function i(r,h,c){var g=h._segments,m=g.length,v=new Array(6),y=!0,x,E,A,P,C,B,O,V;function I(w){if(c)w._transformCoordinates(c,v),x=v[0],E=v[1];else{var N=w._point;x=N._x,E=N._y}if(y)r.moveTo(x,E),y=!1;else{if(c)C=v[2],B=v[3];else{var U=w._handleIn;C=x+U._x,B=E+U._y}C===x&&B===E&&O===A&&V===P?r.lineTo(x,E):r.bezierCurveTo(O,V,C,B,x,E)}if(A=x,P=E,c)O=v[4],V=v[5];else{var U=w._handleOut;O=A+U._x,V=P+U._y}}for(var R=0;R<m;R++)I(g[R]);h._closed&&m>0&&I(g[0])}return{_draw:function(r,h,c,g){var m=h.dontStart,v=h.dontFinish||h.clip,y=this.getStyle(),x=y.hasFill(),E=y.hasStroke(),A=y.getDashArray(),P=!Qe.support.nativeDash&&E&&A&&A.length;m||r.beginPath(),(x||E&&!P||v)&&(i(r,this,g),this._closed&&r.closePath());function C(w){return A[(w%P+P)%P]}if(!v&&(x||E)&&(this._setStyles(r,h,c),x&&(r.fill(y.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),E)){if(P){m||r.beginPath();for(var B=new Kt(this,.25,32,!1,g),O=B.length,V=-y.getDashOffset(),I,R=0;V>0;)V-=C(R--)+C(R--);for(;V<O;)I=V+C(R++),(V>0||I>0)&&B.drawPart(r,Math.max(V,0),Math.max(I,0)),V=I+C(R++)}r.stroke()}},_drawSelected:function(r,h){r.beginPath(),i(r,this,h),r.stroke(),e(r,this._segments,h,Qe.settings.handleSize)}}},new function(){function e(i){var r=i._segments;if(!r.length)throw new Error("Use a moveTo() command first");return r[r.length-1]}return{moveTo:function(){var i=this._segments;i.length===1&&this.removeSegment(0),i.length||this._add([new Pe(L.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Pe(L.read(arguments))])},cubicCurveTo:function(){var i=arguments,r=L.read(i),h=L.read(i),c=L.read(i),g=e(this);g.setHandleOut(r.subtract(g._point)),this._add([new Pe(c,h.subtract(c))])},quadraticCurveTo:function(){var i=arguments,r=L.read(i),h=L.read(i),c=e(this)._point;this.cubicCurveTo(r.add(c.subtract(r).multiply(1/3)),r.add(h.subtract(r).multiply(1/3)),h)},curveTo:function(){var i=arguments,r=L.read(i),h=L.read(i),c=o.pick(o.read(i),.5),g=1-c,m=e(this)._point,v=r.subtract(m.multiply(g*g)).subtract(h.multiply(c*c)).divide(2*c*g);if(v.isNaN())throw new Error("Cannot put a curve through points with parameter = "+c);this.quadraticCurveTo(v,h)},arcTo:function(){var i=arguments,r=Math.abs,h=Math.sqrt,c=e(this),g=c._point,m=L.read(i),v,y=o.peek(i),x=o.pick(y,!0),E,A,P,C;if(typeof x=="boolean")var B=g.add(m).divide(2),v=B.add(B.subtract(g).rotate(x?-90:90));else if(o.remain(i)<=2)v=m,m=L.read(i);else if(!g.equals(m)){var O=X.read(i),V=M.isZero;if(V(O.width)||V(O.height))return this.lineTo(m);var I=o.read(i),x=!!o.read(i),R=!!o.read(i),B=g.add(m).divide(2),w=g.subtract(B).rotate(-I),N=w.x,U=w.y,q=r(O.width),D=r(O.height),G=q*q,Z=D*D,K=N*N,ee=U*U,j=h(K/G+ee/Z);if(j>1&&(q*=j,D*=j,G=q*q,Z=D*D),j=(G*Z-G*ee-Z*K)/(G*ee+Z*K),r(j)<1e-12&&(j=0),j<0)throw new Error("Cannot create an arc with the given arguments");E=new L(q*U/D,-D*N/q).multiply((R===x?-1:1)*h(j)).rotate(I).add(B),C=new re().translate(E).rotate(I).scale(q,D),P=C._inverseTransform(g),A=P.getDirectedAngle(C._inverseTransform(m)),!x&&A>0?A-=360:x&&A<0&&(A+=360)}if(v){var J=new _e(g.add(v).divide(2),v.subtract(g).rotate(90),!0),ie=new _e(v.add(m).divide(2),m.subtract(v).rotate(90),!0),se=new _e(g,m),ae=se.getSide(v);if(E=J.intersect(ie,!0),!E){if(!ae)return this.lineTo(m);throw new Error("Cannot create an arc with the given arguments")}P=g.subtract(E),A=P.getDirectedAngle(m.subtract(E));var le=se.getSide(E,!0);le===0?A=ae*r(A):ae===le&&(A+=A<0?360:-360)}if(A){for(var we=1e-5,Ee=r(A),Me=Ee>=360?4:Math.ceil((Ee-we)/90),Ne=A/Me,me=Ne*Math.PI/360,ye=4/3*Math.sin(me)/(1+Math.cos(me)),Le=[],De=0;De<=Me;De++){var w=m,Re=null;if(De<Me&&(Re=P.rotate(90).multiply(ye),C?(w=C._transformPoint(P),Re=C._transformPoint(P.add(Re)).subtract(w)):w=E.add(P)),!De)c.setHandleOut(Re);else{var Ue=P.rotate(-90).multiply(ye);C&&(Ue=C._transformPoint(P.add(Ue)).subtract(w)),Le.push(new Pe(w,Ue,Re))}P=P.rotate(Ne)}this._add(Le)}},lineBy:function(){var i=L.read(arguments),r=e(this)._point;this.lineTo(r.add(i))},curveBy:function(){var i=arguments,r=L.read(i),h=L.read(i),c=o.read(i),g=e(this)._point;this.curveTo(g.add(r),g.add(h),c)},cubicCurveBy:function(){var i=arguments,r=L.read(i),h=L.read(i),c=L.read(i),g=e(this)._point;this.cubicCurveTo(g.add(r),g.add(h),g.add(c))},quadraticCurveBy:function(){var i=arguments,r=L.read(i),h=L.read(i),c=e(this)._point;this.quadraticCurveTo(c.add(r),c.add(h))},arcBy:function(){var i=arguments,r=e(this)._point,h=r.add(L.read(i)),c=o.pick(o.peek(i),!0);typeof c=="boolean"?this.arcTo(h,c):this.arcTo(h,r.add(L.read(i)))},closePath:function(i){this.setClosed(!0),this.join(this,i)}}},{_getBounds:function(e,i){var r=i.handle?"getHandleBounds":i.stroke?"getStrokeBounds":"getBounds";return Fe[r](this._segments,this._closed,this,e,i)},statics:{getBounds:function(e,i,r,h,c,g){var m=e[0];if(!m)return new $;var v=new Array(6),y=m._transformCoordinates(h,new Array(6)),x=y.slice(0,2),E=x.slice(),A=new Array(2);function P(O){O._transformCoordinates(h,v);for(var V=0;V<2;V++)ge._addBounds(y[V],y[V+4],v[V+2],v[V],V,g?g[V]:0,x,E,A);var I=y;y=v,v=I}for(var C=1,B=e.length;C<B;C++)P(e[C]);return i&&P(m),new $(x[0],x[1],E[0]-x[0],E[1]-x[1])},getStrokeBounds:function(e,i,r,h,c){var g=r.getStyle(),m=g.hasStroke(),v=g.getStrokeWidth(),y=m&&r._getStrokeMatrix(h,c),x=m&&Fe._getStrokePadding(v,y),E=Fe.getBounds(e,i,r,h,c,x);if(!m)return E;var A=v/2,P=g.getStrokeJoin(),C=g.getStrokeCap(),B=g.getMiterLimit(),O=new $(new X(x));function V(q){E=E.include(q)}function I(q){E=E.unite(O.setCenter(q._point.transform(h)))}function R(q,D){D==="round"||q.isSmooth()?I(q):Fe._addBevelJoin(q,D,A,B,h,y,V)}function w(q,D){D==="round"?I(q):Fe._addSquareCap(q,D,A,h,y,V)}var N=e.length-(i?0:1);if(N>0){for(var U=1;U<N;U++)R(e[U],P);i?R(e[0],P):(w(e[0],C),w(e[e.length-1],C))}return E},_getStrokePadding:function(e,i){if(!i)return[e,e];var r=new L(e,0).transform(i),h=new L(0,e).transform(i),c=r.getAngleInRadians(),g=r.getLength(),m=h.getLength(),v=Math.sin(c),y=Math.cos(c),x=Math.tan(c),E=Math.atan2(m*x,g),A=Math.atan2(m,x*g);return[Math.abs(g*Math.cos(E)*y+m*Math.sin(E)*v),Math.abs(m*Math.sin(A)*y+g*Math.cos(A)*v)]},_addBevelJoin:function(e,i,r,h,c,g,m,v){var y=e.getCurve(),x=y.getPrevious(),E=y.getPoint1().transform(c),A=x.getNormalAtTime(1).multiply(r).transform(g),P=y.getNormalAtTime(0).multiply(r).transform(g),C=A.getDirectedAngle(P);if((C<0||C>=180)&&(A=A.negate(),P=P.negate()),v&&m(E),m(E.add(A)),i==="miter"){var B=new _e(E.add(A),new L(-A.y,A.x),!0).intersect(new _e(E.add(P),new L(-P.y,P.x),!0),!0);B&&E.getDistance(B)<=h*r&&m(B)}m(E.add(P))},_addSquareCap:function(e,i,r,h,c,g,m){var v=e._point.transform(h),y=e.getLocation(),x=y.getNormal().multiply(y.getTime()===0?r:-r).transform(c);i==="square"&&(m&&(g(v.subtract(x)),g(v.add(x))),v=v.add(x.rotate(-90))),g(v.add(x)),g(v.subtract(x))},getHandleBounds:function(e,i,r,h,c){var g=r.getStyle(),m=c.stroke&&g.hasStroke(),v,y;if(m){var x=r._getStrokeMatrix(h,c),E=g.getStrokeWidth()/2,A=E;g.getStrokeJoin()==="miter"&&(A=E*g.getMiterLimit()),g.getStrokeCap()==="square"&&(A=Math.max(A,E*Math.SQRT2)),v=Fe._getStrokePadding(E,x),y=Fe._getStrokePadding(A,x)}for(var P=new Array(6),C=1/0,B=-C,O=C,V=B,I=0,R=e.length;I<R;I++){var w=e[I];w._transformCoordinates(h,P);for(var N=0;N<6;N+=2){var U=N?v:y,q=U?U[0]:0,D=U?U[1]:0,G=P[N],Z=P[N+1],K=G-q,ee=G+q,j=Z-D,J=Z+D;K<C&&(C=K),ee>B&&(B=ee),j<O&&(O=j),J>V&&(V=J)}}return new $(C,O,B-C,V-O)}}});Fe.inject({statics:new function(){var e=.5522847498307936,i=[new Pe([-1,0],[0,e],[0,-e]),new Pe([0,-1],[-e,0],[e,0]),new Pe([1,0],[0,-e],[0,e]),new Pe([0,1],[e,0],[-e,0])];function r(c,g,m){var v=o.getNamed(m),y=new Fe(v&&(v.insert==!0?T.INSERT:v.insert==!1?T.NO_INSERT:null));return y._add(c),y._closed=g,y.set(v,T.INSERT)}function h(c,g,m){for(var v=new Array(4),y=0;y<4;y++){var x=i[y];v[y]=new Pe(x._point.multiply(g).add(c),x._handleIn.multiply(g),x._handleOut.multiply(g))}return r(v,!0,m)}return{Line:function(){var c=arguments;return r([new Pe(L.readNamed(c,"from")),new Pe(L.readNamed(c,"to"))],!1,c)},Circle:function(){var c=arguments,g=L.readNamed(c,"center"),m=o.readNamed(c,"radius");return h(g,new X(m),c)},Rectangle:function(){var c=arguments,g=$.readNamed(c,"rectangle"),m=X.readNamed(c,"radius",0,{readNull:!0}),v=g.getBottomLeft(!0),y=g.getTopLeft(!0),x=g.getTopRight(!0),E=g.getBottomRight(!0),A;if(!m||m.isZero())A=[new Pe(v),new Pe(y),new Pe(x),new Pe(E)];else{m=X.min(m,g.getSize(!0).divide(2));var P=m.width,C=m.height,B=P*e,O=C*e;A=[new Pe(v.add(P,0),null,[-B,0]),new Pe(v.subtract(0,C),[0,O]),new Pe(y.add(0,C),null,[0,-O]),new Pe(y.add(P,0),[-B,0],null),new Pe(x.subtract(P,0),null,[B,0]),new Pe(x.add(0,C),[0,-O],null),new Pe(E.subtract(0,C),null,[0,O]),new Pe(E.subtract(P,0),[B,0])]}return r(A,!0,c)},RoundRectangle:"#Rectangle",Ellipse:function(){var c=arguments,g=de._readEllipse(c);return h(g.center,g.radius,c)},Oval:"#Ellipse",Arc:function(){var c=arguments,g=L.readNamed(c,"from"),m=L.readNamed(c,"through"),v=L.readNamed(c,"to"),y=o.getNamed(c),x=new Fe(y&&y.insert==!1&&T.NO_INSERT);return x.moveTo(g),x.arcTo(m,v),x.set(y)},RegularPolygon:function(){for(var c=arguments,g=L.readNamed(c,"center"),m=o.readNamed(c,"sides"),v=o.readNamed(c,"radius"),y=360/m,x=m%3===0,E=new L(0,x?-v:v),A=x?-1:.5,P=new Array(m),C=0;C<m;C++)P[C]=new Pe(g.add(E.rotate((C+A)*y)));return r(P,!0,c)},Star:function(){for(var c=arguments,g=L.readNamed(c,"center"),m=o.readNamed(c,"points")*2,v=o.readNamed(c,"radius1"),y=o.readNamed(c,"radius2"),x=360/m,E=new L(0,-1),A=new Array(m),P=0;P<m;P++)A[P]=new Pe(g.add(E.rotate(x*P).multiply(P%2?y:v)));return r(A,!0,c)}}}});var it=st.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(i){this._children=[],this._namedChildren={},this._initialize(i)||(typeof i=="string"?this.setPathData(i):this.addChildren(Array.isArray(i)?i:arguments))},insertChildren:function e(i,r){var h=r,c=h[0];c&&typeof c[0]=="number"&&(h=[h]);for(var g=r.length-1;g>=0;g--){var m=h[g];h===r&&!(m instanceof Fe)&&(h=o.slice(h)),Array.isArray(m)?h[g]=new Fe({segments:m,insert:!1}):m instanceof it&&(h.splice.apply(h,[g,1].concat(m.removeChildren())),m.remove())}return e.base.call(this,i,h)},reduce:function e(i){for(var r=this._children,h=r.length-1;h>=0;h--){var c=r[h].reduce(i);c.isEmpty()&&c.remove()}if(!r.length){var c=new Fe(T.NO_INSERT);return c.copyAttributes(this),c.insertAbove(this),this.remove(),c}return e.base.call(this)},isClosed:function(){for(var e=this._children,i=0,r=e.length;i<r;i++)if(!e[i]._closed)return!1;return!0},setClosed:function(e){for(var i=this._children,r=0,h=i.length;r<h;r++)i[r].setClosed(e)},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){for(var e=this._children,i=[],r=0,h=e.length;r<h;r++)o.push(i,e[r].getCurves());return i},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getLastCurve()},getArea:function(){for(var e=this._children,i=0,r=0,h=e.length;r<h;r++)i+=e[r].getArea();return i},getLength:function(){for(var e=this._children,i=0,r=0,h=e.length;r<h;r++)i+=e[r].getLength();return i},getPathData:function(e,i){for(var r=this._children,h=[],c=0,g=r.length;c<g;c++){var m=r[c],v=m._matrix;h.push(m.getPathData(e&&!v.isIdentity()?e.appended(v):e,i))}return h.join("")},_hitTestChildren:function e(i,r,h){return e.base.call(this,i,r.class===Fe||r.type==="path"?r:o.set({},r,{fill:!1}),h)},_draw:function(e,i,r,h){var c=this._children;if(c.length){i=i.extend({dontStart:!0,dontFinish:!0}),e.beginPath();for(var g=0,m=c.length;g<m;g++)c[g].draw(e,i,h);if(!i.clip){this._setStyles(e,i,r);var v=this._style;v.hasFill()&&(e.fill(v.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),v.hasStroke()&&e.stroke()}}},_drawSelected:function(e,i,r){for(var h=this._children,c=0,g=h.length;c<g;c++){var m=h[c],v=m._matrix;r[m._id]||m._drawSelected(e,v.isIdentity()?i:i.appended(v))}}},new function(){function e(i,r){var h=i._children;if(r&&!h.length)throw new Error("Use a moveTo() command first");return h[h.length-1]}return o.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(i){this[i]=function(){var r=e(this,!0);r[i].apply(r,arguments)}},{moveTo:function(){var i=e(this),r=i&&i.isEmpty()?i:new Fe(T.NO_INSERT);r!==i&&this.addChild(r),r.moveTo.apply(r,arguments)},moveBy:function(){var i=e(this,!0),r=i&&i.getLastSegment(),h=L.read(arguments);this.moveTo(r?h.add(r._point):h)},closePath:function(i){e(this,!0).closePath(i)}})},o.each(["reverse","flatten","simplify","smooth"],function(e){this[e]=function(i){for(var r=this._children,h,c=0,g=r.length;c<g;c++)h=r[c][e](i)||h;return h}},{}));st.inject(new function(){var e=Math.min,i=Math.max,r=Math.abs,h={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function c(I){return I._children||[I]}function g(I,R){var w=I.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(R){for(var N=c(w),U=0,q=N.length;U<q;U++){var I=N[U];!I._closed&&!I.isEmpty()&&(I.closePath(1e-12),I.getFirstSegment().setHandleIn(0,0),I.getLastSegment().setHandleOut(0,0))}w=w.resolveCrossings().reorient(w.getFillRule()==="nonzero",!0)}return w}function m(I,R,w,N,U){var q=new it(T.NO_INSERT);return q.addChildren(I,!0),q=q.reduce({simplify:R}),U&&U.insert==!1||q.insertAbove(N&&w.isSibling(N)&&w.getIndex()<N.getIndex()?N:w),q.copyAttributes(w,!0),q}function v(I){return I.hasOverlap()||I.isCrossing()}function y(I,R,w,N){if(N&&(N.trace==!1||N.stroke)&&/^(subtract|intersect)$/.test(w))return x(I,R,w);var U=g(I,!0),q=R&&I!==R&&g(R,!0),D=h[w];D[w]=!0,q&&(D.subtract||D.exclude)^(q.isClockwise()^U.isClockwise())&&q.reverse();var G=C(Ye.expand(U.getIntersections(q,v))),Z=c(U),K=q&&c(q),ee=[],j=[],J;function ie(Re){for(var Ue=0,Be=Re.length;Ue<Be;Ue++){var je=Re[Ue];o.push(ee,je._segments),o.push(j,je.getCurves()),je._overlapsOnly=!0}}function se(Re){for(var Ue=[],Be=0,je=Re&&Re.length;Be<je;Be++)Ue.push(j[Re[Be]]);return Ue}if(G.length){ie(Z),K&&ie(K);for(var ae=new Array(j.length),le=0,we=j.length;le<we;le++)ae[le]=j[le].getValues();for(var Ee=S.findCurveBoundsCollisions(ae,ae,0,!0),Me={},le=0;le<j.length;le++){var Ne=j[le],me=Ne._path._id,ye=Me[me]=Me[me]||{};ye[Ne.getIndex()]={hor:se(Ee[le].hor),ver:se(Ee[le].ver)}}for(var le=0,we=G.length;le<we;le++)O(G[le]._segment,U,q,Me,D);for(var le=0,we=ee.length;le<we;le++){var Le=ee[le],De=Le._intersection;Le._winding||O(Le,U,q,Me,D),De&&De._overlap||(Le._path._overlapsOnly=!1)}J=V(ee,D)}else J=P(K?Z.concat(K):Z.slice(),function(Re){return!!D[Re]});return m(J,!0,I,R,N)}function x(I,R,w){var N=g(I),U=g(R),q=N.getIntersections(U,v),D=w==="subtract",G=w==="divide",Z={},K=[];function ee(ie){if(!Z[ie._id]&&(G||U.contains(ie.getPointAt(ie.getLength()/2))^D))return K.unshift(ie),Z[ie._id]=!0}for(var j=q.length-1;j>=0;j--){var J=q[j].split();J&&(ee(J)&&J.getFirstSegment().setHandleIn(0,0),N.getLastSegment().setHandleOut(0,0))}return ee(N),m(K,!1,I,R)}function E(I,R){for(var w=I;w;){if(w===R)return;w=w._previous}for(;I._next&&I._next!==R;)I=I._next;if(!I._next){for(;R._previous;)R=R._previous;I._next=R,R._previous=I}}function A(I){for(var R=I.length-1;R>=0;R--)I[R].clearHandles()}function P(I,R,w){var N=I&&I.length;if(N){var U=o.each(I,function(Ee,Me){this[Ee._id]={container:null,winding:Ee.isClockwise()?1:-1,index:Me}},{}),q=I.slice().sort(function(Ee,Me){return r(Me.getArea())-r(Ee.getArea())}),D=q[0],G=S.findItemBoundsCollisions(q,null,M.GEOMETRIC_EPSILON);w==null&&(w=D.isClockwise());for(var Z=0;Z<N;Z++){var K=q[Z],ee=U[K._id],j=0,J=G[Z];if(J){for(var ie=null,se=J.length-1;se>=0;se--)if(J[se]<Z){ie=ie||K.getInteriorPoint();var ae=q[J[se]];if(ae.contains(ie)){var le=U[ae._id];j=le.winding,ee.winding+=j,ee.container=le.exclude?le.container:ae;break}}}if(R(ee.winding)===R(j))ee.exclude=!0,I[ee.index]=null;else{var we=ee.container;K.setClockwise(we?!we.isClockwise():w)}}}return I}function C(I,R,w){var N=R&&[],U=1e-8,q=1-U,D=!1,G=w||[],Z=w&&{},K,ee,j;function J(Ue){return Ue._path._id+"."+Ue._segment1._index}for(var ie=(w&&w.length)-1;ie>=0;ie--){var se=w[ie];se._path&&(Z[J(se)]=!0)}for(var ie=I.length-1;ie>=0;ie--){var ae=I[ie],le=ae._time,we=le,Ee=R&&!R(ae),se=ae._curve,Me;if(se&&(se!==ee?(D=!se.hasHandles()||Z&&Z[J(se)],K=[],j=null,ee=se):j>=U&&(le/=j)),Ee){K&&K.push(ae);continue}else R&&N.unshift(ae);if(j=we,le<U)Me=se._segment1;else if(le>q)Me=se._segment2;else{var Ne=se.divideAtTime(le,!0);D&&G.push(se,Ne),Me=Ne._segment1;for(var me=K.length-1;me>=0;me--){var ye=K[me];ye._time=(ye._time-le)/(1-le)}}ae._setSegment(Me);var Le=Me._intersection,De=ae._intersection;if(Le){E(Le,De);for(var Re=Le;Re;)E(Re._intersection,Le),Re=Re._next}else Me._intersection=De}return w||A(G),N||I}function B(I,R,w,N,U){var q=Array.isArray(R)?R:R[w?"hor":"ver"],D=w?1:0,G=D^1,Z=[I.x,I.y],K=Z[D],ee=Z[G],j=1e-9,J=1e-6,ie=K-j,se=K+j,ae=0,le=0,we=0,Ee=0,Me=!1,Ne=!1,me=1,ye=[],Le,De;function Re(Ae){var lt=Ae[G+0],ct=Ae[G+6];if(!(ee<e(lt,ct)||ee>i(lt,ct))){var yt=Ae[D+0],Nt=Ae[D+2],Gt=Ae[D+4],Rt=Ae[D+6];if(lt===ct){(yt<se&&Rt>ie||Rt<se&&yt>ie)&&(Me=!0);return}var Dt=ee===lt?0:ee===ct||ie>i(yt,Nt,Gt,Rt)||se<e(yt,Nt,Gt,Rt)?1:ge.solveCubic(Ae,G,ee,ye,0,1)>0?ye[0]:1,It=Dt===0?yt:Dt===1?Rt:ge.getPoint(Ae,Dt)[w?"y":"x"],Lt=lt>ct?1:-1,jt=Le[G]>Le[G+6]?1:-1,xt=Le[D+6];return ee!==lt?(It<ie?we+=Lt:It>se?Ee+=Lt:Me=!0,It>K-J&&It<K+J&&(me/=2)):(Lt!==jt?yt<ie?we+=Lt:yt>se&&(Ee+=Lt):yt!=xt&&(xt<se&&It>se?(Ee+=Lt,Me=!0):xt>ie&&It<ie&&(we+=Lt,Me=!0)),me/=4),Le=Ae,!U&&It>ie&&It<se&&ge.getTangent(Ae,Dt)[w?"x":"y"]===0&&B(I,R,!w,N,!0)}}function Ue(Ae){var lt=Ae[G+0],ct=Ae[G+2],yt=Ae[G+4],Nt=Ae[G+6];if(ee<=i(lt,ct,yt,Nt)&&ee>=e(lt,ct,yt,Nt)){for(var Gt=Ae[D+0],Rt=Ae[D+2],Dt=Ae[D+4],It=Ae[D+6],Lt=ie>i(Gt,Rt,Dt,It)||se<e(Gt,Rt,Dt,It)?[Ae]:ge.getMonoCurves(Ae,w),jt,xt=0,kt=Lt.length;xt<kt;xt++)if(jt=Re(Lt[xt]))return jt}}for(var Be=0,je=q.length;Be<je;Be++){var Ke=q[Be],qe=Ke._path,_t=Ke.getValues(),gt;if((!Be||q[Be-1]._path!==qe)&&(Le=null,qe._closed||(De=ge.getValues(qe.getLastCurve().getSegment2(),Ke.getSegment1(),null,!N),De[G]!==De[G+6]&&(Le=De)),!Le)){Le=_t;for(var bt=qe.getLastCurve();bt&&bt!==Ke;){var mt=bt.getValues();if(mt[G]!==mt[G+6]){Le=mt;break}bt=bt.getPrevious()}}if(gt=Ue(_t))return gt;if(Be+1===je||q[Be+1]._path!==qe){if(De&&(gt=Ue(De)))return gt;Me&&!we&&!Ee&&(we=Ee=qe.isClockwise(N)^w?1:-1),ae+=we,le+=Ee,we=Ee=0,Me&&(Ne=!0,Me=!1),De=null}}return ae=r(ae),le=r(le),{winding:i(ae,le),windingL:ae,windingR:le,quality:me,onPath:Ne}}function O(I,R,w,N,U){var q=[],D=I,G=0,j;do{var Z=I.getCurve();if(Z){var K=Z.getLength();q.push({segment:I,curve:Z,length:K}),G+=K}I=I.getNext()}while(I&&!I._intersection&&I!==D);for(var ee=[.5,.25,.75],j={winding:0,quality:-1},J=.001,ie=1-J,se=0;se<ee.length&&j.quality<.5;se++)for(var K=G*ee[se],ae=0,le=q.length;ae<le;ae++){var we=q[ae],Ee=we.length;if(K<=Ee){var Z=we.curve,Me=Z._path,Ne=Me._parent,me=Ne instanceof it?Ne:Me,ye=M.clamp(Z.getTimeAt(K),J,ie),Le=Z.getPointAtTime(ye),De=r(Z.getTangentAtTime(ye).y)<Math.SQRT1_2,Re=null;if(U.subtract&&w){var Ue=me===R?w:R,Be=Ue._getWinding(Le,De,!0);if(me===R&&Be.winding||me===w&&!Be.winding){if(Be.quality<1)continue;Re={winding:0,quality:1}}}Re=Re||B(Le,N[Me._id][Z.getIndex()],De,!0),Re.quality>j.quality&&(j=Re);break}K-=Ee}for(var ae=q.length-1;ae>=0;ae--)q[ae].segment._winding=j}function V(I,R){var w=[],N;function U(je){var Ke;return!!(je&&!je._visited&&(!R||R[(Ke=je._winding||{}).winding]&&!(R.unite&&Ke.winding===2&&Ke.windingL&&Ke.windingR)))}function q(je){if(je){for(var Ke=0,qe=N.length;Ke<qe;Ke++)if(je===N[Ke])return!0}return!1}function D(je){for(var Ke=je._segments,qe=0,_t=Ke.length;qe<_t;qe++)Ke[qe]._visited=!0}function G(je,Ke){var qe=je._intersection,_t=qe,gt=[];Ke&&(N=[je]);function bt(mt,Ae){for(;mt&&mt!==Ae;){var lt=mt._segment,ct=lt&&lt._path;if(ct){var yt=lt.getNext()||ct.getFirstSegment(),Nt=yt._intersection;lt!==je&&(q(lt)||q(yt)||yt&&U(lt)&&(U(yt)||Nt&&U(Nt._segment)))&&gt.push(lt),Ke&&N.push(lt)}mt=mt._next}}if(qe){for(bt(qe);qe&&qe._previous;)qe=qe._previous;bt(qe,_t)}return gt}I.sort(function(je,Ke){var qe=je._intersection,_t=Ke._intersection,gt=!!(qe&&qe._overlap),bt=!!(_t&&_t._overlap),mt=je._path,Ae=Ke._path;return gt^bt?gt?1:-1:!qe^!_t?qe?1:-1:mt!==Ae?mt._id-Ae._id:je._index-Ke._index});for(var Z=0,K=I.length;Z<K;Z++){var ee=I[Z],j=U(ee),J=null,ie=!1,se=!0,ae=[],le,we,Ee;if(j&&ee._path._overlapsOnly){var Me=ee._path,Ne=ee._intersection._segment._path;Me.compare(Ne)&&(Me.getArea()&&w.push(Me.clone(!1)),D(Me),D(Ne),j=!1)}for(;j;){var me=!J,ye=G(ee,me),Le=ye.shift(),ie=!me&&(q(ee)||q(Le)),De=!ie&&Le;if(me&&(J=new Fe(T.NO_INSERT),le=null),ie){(ee.isFirst()||ee.isLast())&&(se=ee._path._closed),ee._visited=!0;break}if(De&&le&&(ae.push(le),le=null),le||(De&&ye.push(ee),le={start:J._segments.length,crossings:ye,visited:we=[],handleIn:Ee}),De&&(ee=Le),!U(ee)){J.removeSegments(le.start);for(var Re=0,Ue=we.length;Re<Ue;Re++)we[Re]._visited=!1;we.length=0;do ee=le&&le.crossings.shift(),(!ee||!ee._path)&&(ee=null,le=ae.pop(),le&&(we=le.visited,Ee=le.handleIn));while(le&&!U(ee));if(!ee)break}var Be=ee.getNext();J.add(new Pe(ee._point,Ee,Be&&ee._handleOut)),ee._visited=!0,we.push(ee),ee=Be||ee._path.getFirstSegment(),Ee=Be&&Be._handleIn}ie&&(se&&(J.getFirstSegment().setHandleIn(Ee),J.setClosed(se)),J.getArea()!==0&&w.push(J))}return w}return{_getWinding:function(I,R,w){return B(I,this.getCurves(),R,w)},unite:function(I,R){return y(this,I,"unite",R)},intersect:function(I,R){return y(this,I,"intersect",R)},subtract:function(I,R){return y(this,I,"subtract",R)},exclude:function(I,R){return y(this,I,"exclude",R)},divide:function(I,R){return R&&(R.trace==!1||R.stroke)?x(this,I,"divide"):m([this.subtract(I,R),this.intersect(I,R)],!0,this,I,R)},resolveCrossings:function(){var I=this._children,R=I||[this];function w(le,we){var Ee=le&&le._intersection;return Ee&&Ee._overlap&&Ee._path===we}var N=!1,U=!1,q=this.getIntersections(null,function(le){return le.hasOverlap()&&(N=!0)||le.isCrossing()&&(U=!0)}),D=N&&U&&[];if(q=Ye.expand(q),N)for(var G=C(q,function(le){return le.hasOverlap()},D),Z=G.length-1;Z>=0;Z--){var K=G[Z],ee=K._path,j=K._segment,J=j.getPrevious(),ie=j.getNext();w(J,ee)&&w(ie,ee)&&(j.remove(),J._handleOut._set(0,0),ie._handleIn._set(0,0),J!==j&&!J.getCurve().hasLength()&&(ie._handleIn.set(J._handleIn),J.remove()))}U&&(C(q,N&&function(le){var we=le.getCurve(),Ee=le.getSegment(),Me=le._intersection,Ne=Me._curve,me=Me._segment;if(we&&Ne&&we._path&&Ne._path)return!0;Ee&&(Ee._intersection=null),me&&(me._intersection=null)},D),D&&A(D),R=V(o.each(R,function(le){o.push(this,le._segments)},[])));var se=R.length,ae;return se>1&&I?(R!==I&&this.setChildren(R),ae=this):se===1&&!I&&(R[0]!==this&&this.setSegments(R[0].removeSegments()),ae=this),ae||(ae=new it(T.NO_INSERT),ae.addChildren(R),ae=ae.reduce(),ae.copyAttributes(this),this.replaceWith(ae)),ae},reorient:function(I,R){var w=this._children;return w&&w.length?this.setChildren(P(this.removeChildren(),function(N){return!!(I?N:N&1)},R)):R!==a&&this.setClockwise(R),this},getInteriorPoint:function(){var I=this.getBounds(),R=I.getCenter(!0);if(!this.contains(R)){for(var w=this.getCurves(),N=R.y,U=[],q=[],D=0,G=w.length;D<G;D++){var Z=w[D].getValues(),K=Z[1],ee=Z[3],j=Z[5],J=Z[7];if(N>=e(K,ee,j,J)&&N<=i(K,ee,j,J))for(var ie=ge.getMonoCurves(Z),se=0,ae=ie.length;se<ae;se++){var le=ie[se],we=le[1],Ee=le[7];if(we!==Ee&&(N>=we&&N<=Ee||N>=Ee&&N<=we)){var Me=N===we?le[0]:N===Ee?le[6]:ge.solveCubic(le,1,N,q,0,1)===1?ge.getPoint(le,q[0]).x:(le[0]+le[6])/2;U.push(Me)}}}U.length>1&&(U.sort(function(Ne,me){return Ne-me}),R.x=(U[0]+U[1])/2)}return R}}});var Kt=o.extend({_class:"PathFlattener",initialize:function(e,i,r,h,c){var g=[],m=[],v=0,y=1/(r||32),x=e._segments,E=x[0],A;function P(V,I){var R=ge.getValues(V,I,c);g.push(R),C(R,V._index,0,1)}function C(V,I,R,w){if(w-R>y&&!(h&&ge.isStraight(V))&&!ge.isFlatEnough(V,i||.25)){var N=ge.subdivide(V,.5),U=(R+w)/2;C(N[0],I,R,U),C(N[1],I,U,w)}else{var q=V[6]-V[0],D=V[7]-V[1],G=Math.sqrt(q*q+D*D);G>0&&(v+=G,m.push({offset:v,curve:V,index:I,time:w}))}}for(var B=1,O=x.length;B<O;B++)A=x[B],P(E,A),E=A;e._closed&&P(A||E,x[0]),this.curves=g,this.parts=m,this.length=v,this.index=0},_get:function(e){for(var i=this.parts,r=i.length,h,c=this.index;h=c,!(!c||i[--c].offset<e););for(;h<r;h++){var g=i[h];if(g.offset>=e){this.index=h;var m=i[h-1],v=m&&m.index===g.index?m.time:0,y=m?m.offset:0;return{index:g.index,time:v+(g.time-v)*(e-y)/(g.offset-y)}}}return{index:i[r-1].index,time:1}},drawPart:function(e,i,r){for(var h=this._get(i),c=this._get(r),g=h.index,m=c.index;g<=m;g++){var v=ge.getPart(this.curves[g],g===h.index?h.time:0,g===c.index?c.time:1);g===h.index&&e.moveTo(v[0],v[1]),e.bezierCurveTo.apply(e,v.slice(2))}}},o.each(ge._evaluateMethods,function(e){this[e+"At"]=function(i){var r=this._get(i);return ge[e](this.curves[r.index],r.time)}},{})),Bt=o.extend({initialize:function(e){for(var i=this.points=[],r=e._segments,h=e._closed,c=0,g,m=r.length;c<m;c++){var v=r[c].point;(!g||!g.equals(v))&&i.push(g=v.clone())}h&&(i.unshift(i[i.length-1]),i.push(i[1])),this.closed=h},fit:function(e){var i=this.points,r=i.length,h=null;return r>0&&(h=[new Pe(i[0])],r>1&&(this.fitCubic(h,e,0,r-1,i[1].subtract(i[0]),i[r-2].subtract(i[r-1])),this.closed&&(h.shift(),h.pop()))),h},fitCubic:function(e,i,r,h,c,g){var m=this.points;if(h-r===1){var v=m[r],y=m[h],x=v.getDistance(y)/3;this.addCurve(e,[v,v.add(c.normalize(x)),y.add(g.normalize(x)),y]);return}for(var E=this.chordLengthParameterize(r,h),A=Math.max(i,i*i),P,C=!0,B=0;B<=4;B++){var O=this.generateBezier(r,h,E,c,g),V=this.findMaxError(r,h,O,E);if(V.error<i&&C){this.addCurve(e,O);return}if(P=V.index,V.error>=A)break;C=this.reparameterize(r,h,E,O),A=V.error}var I=m[P-1].subtract(m[P+1]);this.fitCubic(e,i,r,P,c,I),this.fitCubic(e,i,P,h,I.negate(),g)},addCurve:function(e,i){var r=e[e.length-1];r.setHandleOut(i[1].subtract(i[0])),e.push(new Pe(i[3],i[2].subtract(i[3])))},generateBezier:function(e,i,r,h,c){for(var g=1e-12,m=Math.abs,v=this.points,y=v[e],x=v[i],E=[[0,0],[0,0]],A=[0,0],P=0,C=i-e+1;P<C;P++){var B=r[P],O=1-B,V=3*B*O,I=O*O*O,R=V*O,w=V*B,N=B*B*B,U=h.normalize(R),q=c.normalize(w),D=v[e+P].subtract(y.multiply(I+R)).subtract(x.multiply(w+N));E[0][0]+=U.dot(U),E[0][1]+=U.dot(q),E[1][0]=E[0][1],E[1][1]+=q.dot(q),A[0]+=U.dot(D),A[1]+=q.dot(D)}var G=E[0][0]*E[1][1]-E[1][0]*E[0][1],Z,K;if(m(G)>g){var ee=E[0][0]*A[1]-E[1][0]*A[0],j=A[0]*E[1][1]-A[1]*E[0][1];Z=j/G,K=ee/G}else{var J=E[0][0]+E[0][1],ie=E[1][0]+E[1][1];Z=K=m(J)>g?A[0]/J:m(ie)>g?A[1]/ie:0}var se=x.getDistance(y),ae=g*se,le,we;if(Z<ae||K<ae)Z=K=se/3;else{var Ee=x.subtract(y);le=h.normalize(Z),we=c.normalize(K),le.dot(Ee)-we.dot(Ee)>se*se&&(Z=K=se/3,le=we=null)}return[y,y.add(le||h.normalize(Z)),x.add(we||c.normalize(K)),x]},reparameterize:function(e,i,r,h){for(var c=e;c<=i;c++)r[c-e]=this.findRoot(h,this.points[c],r[c-e]);for(var c=1,g=r.length;c<g;c++)if(r[c]<=r[c-1])return!1;return!0},findRoot:function(e,i,r){for(var h=[],c=[],g=0;g<=2;g++)h[g]=e[g+1].subtract(e[g]).multiply(3);for(var g=0;g<=1;g++)c[g]=h[g+1].subtract(h[g]).multiply(2);var m=this.evaluate(3,e,r),v=this.evaluate(2,h,r),y=this.evaluate(1,c,r),x=m.subtract(i),E=v.dot(v)+x.dot(y);return M.isMachineZero(E)?r:r-x.dot(v)/E},evaluate:function(e,i,r){for(var h=i.slice(),c=1;c<=e;c++)for(var g=0;g<=e-c;g++)h[g]=h[g].multiply(1-r).add(h[g+1].multiply(r));return h[0]},chordLengthParameterize:function(e,i){for(var r=[0],h=e+1;h<=i;h++)r[h-e]=r[h-e-1]+this.points[h].getDistance(this.points[h-1]);for(var h=1,c=i-e;h<=c;h++)r[h]/=r[c];return r},findMaxError:function(e,i,r,h){for(var c=Math.floor((i-e+1)/2),g=0,m=e+1;m<i;m++){var v=this.evaluate(3,r,h[m-e]),y=v.subtract(this.points[m]),x=y.x*y.x+y.y*y.y;x>=g&&(g=x,c=m)}return{error:g,index:c}}}),Yt=T.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(i){this._content="",this._lines=[];var r=i&&o.isPlainObject(i)&&i.x===a&&i.y===a;this._initialize(r&&i,!r&&L.read(arguments))},_equals:function(e){return this._content===e._content},copyContent:function(e){this.setContent(e._content)},getContent:function(){return this._content},setContent:function(e){this._content=""+e,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Wi=Yt.extend({_class:"PointText",initialize:function(){Yt.apply(this,arguments)},getPoint:function(){var e=this._matrix.getTranslation();return new Q(e.x,e.y,this,"setPoint")},setPoint:function(){var e=L.read(arguments);this.translate(e.subtract(this._matrix.getTranslation()))},_draw:function(e,i,r){if(this._content){this._setStyles(e,i,r);var h=this._lines,c=this._style,g=c.hasFill(),m=c.hasStroke(),v=c.getLeading(),y=e.shadowColor;e.font=c.getFontStyle(),e.textAlign=c.getJustification();for(var x=0,E=h.length;x<E;x++){e.shadowColor=y;var A=h[x];g&&(e.fillText(A,0,0),e.shadowColor="rgba(0,0,0,0)"),m&&e.strokeText(A,0,0),e.translate(0,v)}}},_getBounds:function(e,i){var r=this._style,h=this._lines,c=h.length,g=r.getJustification(),m=r.getLeading(),v=this.getView().getTextWidth(r.getFontStyle(),h),y=0;g!=="left"&&(y-=v/(g==="center"?2:1));var x=new $(y,c?-.75*m:0,v,c*m);return e?e._transformBounds(x,x):x}}),dt=o.extend(new function(){var e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},r={transparent:[0,0,0,0]},h;function c(v){var y=v.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||v.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),x="rgb",E;if(y){var A=y[4]?4:3;E=new Array(A);for(var P=0;P<A;P++){var C=y[P+1];E[P]=parseInt(C.length==1?C+C:C,16)/255}}else if(y=v.match(/^(rgb|hsl)a?\((.*)\)$/)){x=y[1],E=y[2].trim().split(/[,\s]+/g);for(var B=x==="hsl",P=0,O=Math.min(E.length,4);P<O;P++){var V=E[P],C=parseFloat(V);if(B)if(P===0){var I=V.match(/([a-z]*)$/)[1];C*={turn:360,rad:180/Math.PI,grad:.9}[I]||1}else P<3&&(C/=100);else P<3&&(C/=/%$/.test(V)?100:255);E[P]=C}}else{var R=r[v];if(!R)if(l){h||(h=pt.getContext(1,1,{willReadFrequently:!0}),h.globalCompositeOperation="copy"),h.fillStyle="rgba(0,0,0,0)",h.fillStyle=v,h.fillRect(0,0,1,1);var w=h.getImageData(0,0,1,1).data;R=r[v]=[w[0]/255,w[1]/255,w[2]/255]}else R=[0,0,0];E=R.slice()}return[x,E]}var g=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],m={"rgb-hsb":function(v,y,x){var E=Math.max(v,y,x),A=Math.min(v,y,x),P=E-A,C=P===0?0:(E==v?(y-x)/P+(y<x?6:0):E==y?(x-v)/P+2:(v-y)/P+4)*60;return[C,E===0?0:P/E,E]},"hsb-rgb":function(v,y,x){v=(v/60%6+6)%6;var A=Math.floor(v),E=v-A,A=g[A],P=[x,x*(1-y),x*(1-y*E),x*(1-y*(1-E))];return[P[A[0]],P[A[1]],P[A[2]]]},"rgb-hsl":function(v,y,x){var E=Math.max(v,y,x),A=Math.min(v,y,x),P=E-A,C=P===0,B=C?0:(E==v?(y-x)/P+(y<x?6:0):E==y?(x-v)/P+2:(v-y)/P+4)*60,O=(E+A)/2,V=C?0:O<.5?P/(E+A):P/(2-E-A);return[B,V,O]},"hsl-rgb":function(v,y,x){if(v=(v/360%1+1)%1,y===0)return[x,x,x];for(var E=[v+1/3,v,v-1/3],A=x<.5?x*(1+y):x+y-x*y,P=2*x-A,C=[],B=0;B<3;B++){var O=E[B];O<0&&(O+=1),O>1&&(O-=1),C[B]=6*O<1?P+(A-P)*6*O:2*O<1?A:3*O<2?P+(A-P)*(2/3-O)*6:P}return C},"rgb-gray":function(v,y,x){return[v*.2989+y*.587+x*.114]},"gray-rgb":function(v){return[v,v,v]},"gray-hsb":function(v){return[0,0,v]},"gray-hsl":function(v){return[0,0,v]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return o.each(e,function(v,y){i[y]=[],o.each(v,function(x,E){var A=o.capitalize(x),P=/^(hue|saturation)$/.test(x),C=i[y][E]=y==="gradient"?x==="gradient"?function(B){var O=this._components[0];return B=vi.read(Array.isArray(B)?B:arguments,0,{readNull:!0}),O!==B&&(O&&O._removeOwner(this),B&&B._addOwner(this)),B}:function(){return L.read(arguments,0,{readNull:x==="highlight",clone:!0})}:function(B){return B==null||isNaN(B)?0:+B};this["get"+A]=function(){return this._type===y||P&&/^hs[bl]$/.test(this._type)?this._components[E]:this._convert(y)[E]},this["set"+A]=function(B){this._type!==y&&!(P&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(y),this._properties=e[y],this._type=y),this._components[E]=C.call(this,B),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function v(y){var x=arguments,E=this.__read,A=0,P,C,B,O;Array.isArray(y)&&(x=y,y=x[0]);var V=y!=null&&typeof y;if(V==="string"&&y in e&&(P=y,y=x[1],Array.isArray(y)?(C=y,B=x[2]):(E&&(A=1),x=o.slice(x,1),V=typeof y)),!C){if(O=V==="number"?x:V==="object"&&y.length!=null?y:null,O){P||(P=O.length>=3?"rgb":"gray");var I=e[P].length;B=O[I],E&&(A+=O===arguments?I+(B!=null?1:0):1),O.length>I&&(O=o.slice(O,0,I))}else if(V==="string"){var R=c(y);P=R[0],C=R[1],C.length===4&&(B=C[3],C.length--)}else if(V==="object")if(y.constructor===v){if(P=y._type,C=y._components.slice(),B=y._alpha,P==="gradient")for(var w=1,N=C.length;w<N;w++){var U=C[w];U&&(C[w]=U.clone())}}else if(y.constructor===vi)P="gradient",O=x;else{P="hue"in y?"lightness"in y?"hsl":"hsb":"gradient"in y||"stops"in y||"radial"in y?"gradient":"gray"in y?"gray":"rgb";var q=e[P],D=i[P];this._components=C=[];for(var w=0,N=q.length;w<N;w++){var G=y[q[w]];G==null&&!w&&P==="gradient"&&"stops"in y&&(G={stops:y.stops,radial:y.radial}),G=D[w].call(this,G),G!=null&&(C[w]=G)}B=y.alpha}E&&P&&(A=1)}if(this._type=P||"rgb",!C){this._components=C=[];for(var D=i[this._type],w=0,N=D.length;w<N;w++){var G=D[w].call(this,O&&O[w]);G!=null&&(C[w]=G)}}return this._components=C,this._properties=e[this._type],this._alpha=B,E&&(this.__read=A),this},set:"#initialize",_serialize:function(v,y){var x=this.getComponents();return o.serialize(/^(gray|rgb)$/.test(this._type)?x:[this._type].concat(x),v,!0,y)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(v){var y;return this._type===v?this._components.slice():(y=m[this._type+"-"+v])?y.apply(this,this._components):m["rgb-"+v].apply(this,m[this._type+"-rgb"].apply(this,this._components))},convert:function(v){return new dt(v,this._convert(v),this._alpha)},getType:function(){return this._type},setType:function(v){this._components=this._convert(v),this._properties=e[v],this._type=v},getComponents:function(){var v=this._components.slice();return this._alpha!=null&&v.push(this._alpha),v},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(v){this._alpha=v==null?null:Math.min(Math.max(v,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(v){var y=o.isPlainValue(v,!0)?dt.read(arguments):v;return y===this||y&&this._class===y._class&&this._type===y._type&&this.getAlpha()===y.getAlpha()&&o.equals(this._components,y._components)||!1},toString:function(){for(var v=this._properties,y=[],x=this._type==="gradient",E=z.instance,A=0,P=v.length;A<P;A++){var C=this._components[A];C!=null&&y.push(v[A]+": "+(x?C:E.number(C)))}return this._alpha!=null&&y.push("alpha: "+E.number(this._alpha)),"{ "+y.join(", ")+" }"},toCSS:function(v){var y=this._convert("rgb"),x=v||this._alpha==null?1:this._alpha;function E(A){return Math.round((A<0?0:A>1?1:A)*255)}return y=[E(y[0]),E(y[1]),E(y[2])],x<1&&y.push(x<0?0:x),v?"#"+((1<<24)+(y[0]<<16)+(y[1]<<8)+y[2]).toString(16).slice(1):(y.length==4?"rgba(":"rgb(")+y.join(",")+")"},toCanvasStyle:function(v,y){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var x=this._components,E=x[0],A=E._stops,P=x[1],C=x[2],B=x[3],O=y&&y.inverted(),V;if(O&&(P=O._transformPoint(P),C=O._transformPoint(C),B&&(B=O._transformPoint(B))),E._radial){var I=C.getDistance(P);if(B){var R=B.subtract(P);R.getLength()>I&&(B=P.add(R.normalize(I-.1)))}var w=B||P;V=v.createRadialGradient(w.x,w.y,0,P.x,P.y,I)}else V=v.createLinearGradient(P.x,P.y,C.x,C.y);for(var N=0,U=A.length;N<U;N++){var q=A[N],D=q._offset;V.addColorStop(D??N/(U-1),q._color.toCanvasStyle())}return this._canvasStyle=V},transform:function(v){if(this._type==="gradient"){for(var y=this._components,x=1,E=y.length;x<E;x++){var A=y[x];v._transformPoint(A,A,!0)}this._changed()}},statics:{_types:e,random:function(){var v=Math.random;return new dt(v(),v(),v())},_setOwner:function(v,y,x){return v&&(v._owner&&y&&v._owner!==y&&(v=v.clone()),!v._owner^!y&&(v._owner=y||null,v._setter=x||null)),v}}})},new function(){var e={add:function(i,r){return i+r},subtract:function(i,r){return i-r},multiply:function(i,r){return i*r},divide:function(i,r){return i/r}};return o.each(e,function(i,r){this[r]=function(h){h=dt.read(arguments);for(var c=this._type,g=this._components,m=h._convert(c),v=0,y=g.length;v<y;v++)m[v]=i(g[v],m[v]);return new dt(c,m,this._alpha!=null?i(this._alpha,h.getAlpha()):null)}},{})}),vi=o.extend({_class:"Gradient",initialize:function(i,r){this._id=H.get(),i&&o.isPlainObject(i)&&(this.set(i),i=r=null),this._stops==null&&this.setStops(i||["white","black"]),this._radial==null&&this.setRadial(typeof r=="string"&&r==="radial"||r||!1)},_serialize:function(e,i){return i.add(this,function(){return o.serialize([this._stops,this._radial],e,!0,i)})},_changed:function(){for(var e=0,i=this._owners&&this._owners.length;e<i;e++)this._owners[e]._changed()},_addOwner:function(e){this._owners||(this._owners=[]),this._owners.push(e)},_removeOwner:function(e){var i=this._owners?this._owners.indexOf(e):-1;i!=-1&&(this._owners.splice(i,1),this._owners.length||(this._owners=a))},clone:function(){for(var e=[],i=0,r=this._stops.length;i<r;i++)e[i]=this._stops[i].clone();return new vi(e,this._radial)},getStops:function(){return this._stops},setStops:function(e){if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var i=this._stops;if(i)for(var r=0,h=i.length;r<h;r++)i[r]._owner=a;i=this._stops=Zi.readList(e,0,{clone:!0});for(var r=0,h=i.length;r<h;r++)i[r]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(e){this._radial=e,this._changed()},equals:function(e){if(e===this)return!0;if(e&&this._class===e._class){var i=this._stops,r=e._stops,h=i.length;if(h===r.length){for(var c=0;c<h;c++)if(!i[c].equals(r[c]))return!1;return!0}}return!1}}),Zi=o.extend({_class:"GradientStop",initialize:function(i,r){var h=i,c=r;typeof i=="object"&&r===a&&(Array.isArray(i)&&typeof i[0]!="number"?(h=i[0],c=i[1]):("color"in i||"offset"in i||"rampPoint"in i)&&(h=i.color,c=i.offset||i.rampPoint||0)),this.setColor(h),this.setOffset(c)},clone:function(){return new Zi(this._color.clone(),this._offset)},_serialize:function(e,i){var r=this._color,h=this._offset;return o.serialize(h==null?[r]:[r,h],e,!0,i)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(e){this._offset=e,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){dt._setOwner(this._color,null),this._color=dt._setOwner(dt.read(arguments,0),this,"setColor"),this._changed()},equals:function(e){return e===this||e&&this._class===e._class&&this._color.equals(e._color)&&this._offset==e._offset||!1}}),Xi=o.extend(new function(){var e={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new L,selectedColor:null},i=o.set({},e,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),r=o.set({},i,{fillColor:new dt}),h={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},c={beans:!0},g={_class:"Style",beans:!0,initialize:function(v,y,x){this._values={},this._owner=y,this._project=y&&y._project||x||Qe.project,this._defaults=!y||y instanceof ve?i:y instanceof Yt?r:e,v&&this.set(v)}};return o.each(i,function(m,v){var y=/Color$/.test(v),x=v==="shadowOffset",E=o.capitalize(v),A=h[v],P="set"+E,C="get"+E;g[P]=function(B){var O=this._owner,V=O&&O._children,I=V&&V.length>0&&!(O instanceof it);if(I)for(var R=0,w=V.length;R<w;R++)V[R]._style[P](B);if((v==="selectedColor"||!I)&&v in this._defaults){var N=this._values[v];N!==B&&(y&&(N&&(dt._setOwner(N,null),N._canvasStyle=null),B&&B.constructor===dt&&(B=dt._setOwner(B,O,I&&P))),this._values[v]=B,O&&O._changed(A||129))}},g[C]=function(B){var O=this._owner,V=O&&O._children,I=V&&V.length>0&&!(O instanceof it),R;if(I&&!B)for(var w=0,N=V.length;w<N;w++){var U=V[w]._style[C]();if(!w)R=U;else if(!o.equals(R,U))return a}else if(v in this._defaults){var R=this._values[v];if(R===a)R=this._defaults[v],R&&R.clone&&(R=R.clone());else{var q=y?dt:x?L:null;q&&!(R&&R.constructor===q)&&(this._values[v]=R=q.read([R],0,{readNull:!0,clone:!0}))}}return R&&y&&(R=dt._setOwner(R,O,I&&P)),R},c[C]=function(B){return this._style[C](B)},c[P]=function(B){this._style[P](B)}}),o.each({Font:"FontFamily",WindingRule:"FillRule"},function(m,v){var y="get"+v,x="set"+v;g[y]=c[y]="#get"+m,g[x]=c[x]="#set"+m}),T.inject(c),g},{set:function(e){var i=e instanceof Xi,r=i?e._values:e;if(r){for(var h in r)if(h in this._defaults){var c=r[h];this[h]=c&&i&&c.clone?c.clone():c}}},equals:function(e){function i(r,h,c){var g=r._values,m=h._values,v=h._defaults;for(var y in g){var x=g[y],E=m[y];if(!(c&&y in m)&&!o.equals(x,E===a?v[y]:E))return!1}return!0}return e===this||e&&this._class===e._class&&i(this,e)&&i(e,this,!0)||!1},_dispose:function(){var e;e=this.getFillColor(),e&&(e._canvasStyle=null),e=this.getStrokeColor(),e&&(e._canvasStyle=null),e=this.getShadowColor(),e&&(e._canvasStyle=null)},hasFill:function(){var e=this.getFillColor();return!!e&&e.alpha>0},hasStroke:function(){var e=this.getStrokeColor();return!!e&&e.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var e=this.getShadowColor();return!!e&&e.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var e=this.getFontSize();return this.getFontWeight()+" "+e+(/[a-z]/i.test(e+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function e(){var i=e.base.call(this),r=this.getFontSize();return/pt|em|%|px/.test(r)&&(r=this.getView().getPixelSize(r)),i??r*1.2}}),at=new function(){function e(i,r,h,c){for(var g=["","webkit","moz","Moz","ms","o"],m=r[0].toUpperCase()+r.substring(1),v=0;v<6;v++){var y=g[v],x=y?y+m:r;if(x in i){if(h)i[x]=c;else return i[x];break}}}return{getStyles:function(i){var r=i&&i.nodeType!==9?i.ownerDocument:i,h=r&&r.defaultView;return h&&h.getComputedStyle(i,"")},getBounds:function(i,r){var h=i.ownerDocument,c=h.body,g=h.documentElement,m;try{m=i.getBoundingClientRect()}catch{m={left:0,top:0,width:0,height:0}}var v=m.left-(g.clientLeft||c.clientLeft||0),y=m.top-(g.clientTop||c.clientTop||0);if(!r){var x=h.defaultView;v+=x.pageXOffset||g.scrollLeft||c.scrollLeft,y+=x.pageYOffset||g.scrollTop||c.scrollTop}return new $(v,y,m.width,m.height)},getViewportBounds:function(i){var r=i.ownerDocument,h=r.defaultView,c=r.documentElement;return new $(0,0,h.innerWidth||c.clientWidth,h.innerHeight||c.clientHeight)},getOffset:function(i,r){return at.getBounds(i,r).getPoint()},getSize:function(i){return at.getBounds(i,!0).getSize()},isInvisible:function(i){return at.getSize(i).equals(new X(0,0))},isInView:function(i){return!at.isInvisible(i)&&at.getViewportBounds(i).intersects(at.getBounds(i,!0))},isInserted:function(i){return f.body.contains(i)},getPrefixed:function(i,r){return i&&e(i,r)},setPrefixed:function(i,r,h){if(typeof r=="object")for(var c in r)e(i,c,!0,r[c]);else e(i,r,!0,h)}}},ut={add:function(e,i){if(e)for(var r in i)for(var h=i[r],c=r.split(/[\s,]+/g),g=0,m=c.length;g<m;g++){var v=c[g],y=e===f&&(v==="touchstart"||v==="touchmove")?{passive:!1}:!1;e.addEventListener(v,h,y)}},remove:function(e,i){if(e)for(var r in i)for(var h=i[r],c=r.split(/[\s,]+/g),g=0,m=c.length;g<m;g++)e.removeEventListener(c[g],h,!1)},getPoint:function(e){var i=e.targetTouches?e.targetTouches.length?e.targetTouches[0]:e.changedTouches[0]:e;return new L(i.pageX||i.clientX+f.documentElement.scrollLeft,i.pageY||i.clientY+f.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getRelatedTarget:function(e){return e.relatedTarget||e.toElement},getOffset:function(e,i){return ut.getPoint(e).subtract(at.getOffset(i||ut.getTarget(e)))}};ut.requestAnimationFrame=new function(){var e=at.getPrefixed(l,"requestAnimationFrame"),i=!1,r=[],h;function c(){var g=r;r=[];for(var m=0,v=g.length;m<v;m++)g[m]();i=e&&r.length,i&&e(c)}return function(g){r.push(g),e?i||(e(c),i=!0):h||(h=setInterval(c,1e3/60))}};var ht=o.extend(d,{_class:"View",initialize:function e(i,r){function h(A){return r[A]||parseInt(r.getAttribute(A),10)}function c(){var A=at.getSize(r);return A.isNaN()||A.isZero()?new X(h("width"),h("height")):A}var g;if(l&&r){this._id=r.getAttribute("id"),this._id==null&&r.setAttribute("id",this._id="paper-view-"+e._id++),ut.add(r,this._viewEvents);var m="none";if(at.setPrefixed(r.style,{userDrag:m,userSelect:m,touchCallout:m,contentZooming:m,tapHighlightColor:"rgba(0,0,0,0)"}),_.hasAttribute(r,"resize")){var v=this;ut.add(l,this._windowEvents={resize:function(){v.setViewSize(c())}})}if(g=c(),_.hasAttribute(r,"stats")&&typeof Stats<"u"){this._stats=new Stats;var y=this._stats.domElement,x=y.style,E=at.getOffset(r);x.position="absolute",x.left=E.x+"px",x.top=E.y+"px",f.body.appendChild(y)}}else g=new X(r),r=null;this._project=i,this._scope=i._scope,this._element=r,this._pixelRatio||(this._pixelRatio=l&&l.devicePixelRatio||1),this._setElementSize(g.width,g.height),this._viewSize=g,e._views.push(this),e._viewsById[this._id]=this,(this._matrix=new re)._owner=this,e._focused||(e._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!Qe.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;ht._focused===this&&(ht._focused=null),ht._views.splice(ht._views.indexOf(this),1),delete ht._viewsById[this._id];var e=this._project;return e._view===this&&(e._view=null),ut.remove(this._element,this._viewEvents),ut.remove(l,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:o.each(T._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(e){this[e]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(e){this._autoUpdate=e,e&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var e=this;ut.requestAnimationFrame(function(){if(e._requested=!1,e._animate){e.requestUpdate();var i=e._element;(!at.getPrefixed(f,"hidden")||_.getAttribute(i,"keepalive")==="true")&&at.isInView(i)&&e._handleFrame()}e._autoUpdate&&e.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){Qe=this._scope;var e=Date.now()/1e3,i=this._last?e-this._last:0;this._last=e,this.emit("frame",new o({delta:i,time:this._time+=i,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(e,i){var r=this._frameItems;i?(r[e._id]={item:e,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete r[e._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(e){for(var i in this._frameItems){var r=this._frameItems[i];r.item.emit("frame",new o(e,{time:r.time+=e.delta,count:r.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=a},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var e=this._viewSize;return new te(e.width,e.height,this,"setViewSize")},setViewSize:function(){var e=X.read(arguments),i=e.subtract(this._viewSize);i.isZero()||(this._setElementSize(e.width,e.height),this._viewSize.set(e),this._changed(),this.emit("resize",{size:e,delta:i}),this._autoUpdate&&this.update())},_setElementSize:function(e,i){var r=this._element;r&&(r.width!==e&&(r.width=e),r.height!==i&&(r.height=i))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new $(new L,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return at.isInView(this._element)},isInserted:function(){return at.isInserted(this._element)},getPixelSize:function(e){var i=this._element,r;if(i){var h=i.parentNode,c=f.createElement("div");c.style.fontSize=e,h.appendChild(c),r=parseFloat(at.getStyles(c).fontSize),h.removeChild(c)}else r=parseFloat(r);return r},getTextWidth:function(e,i){return 0}},o.each(["rotate","scale","shear","skew"],function(e){var i=e==="rotate";this[e]=function(){var r=arguments,h=(i?o:L).read(r),c=L.read(r,0,{readNull:!0});return this.transform(new re()[e](h,c||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var e=new re;return this.transform(e.translate.apply(e,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var e=L.read(arguments);this.translate(this.getCenter().subtract(e))},getZoom:function(){var e=this._decompose().scaling;return(e.x+e.y)/2},setZoom:function(e){this.transform(new re().scale(e/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(e){var i=this.getRotation();i!=null&&e!=null&&this.rotate(e-i)},getScaling:function(){var e=this._decompose().scaling;return new Q(e.x,e.y,this,"setScaling")},setScaling:function(){var e=this.getScaling(),i=L.read(arguments,0,{clone:!0,readNull:!0});e&&i&&this.scale(i.x/e.x,i.y/e.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},transform:function(e){this._matrix.append(e)},scrollBy:function(){this.translate(L.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(L.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(L.read(arguments))},getEventPoint:function(e){return this.viewToProject(ut.getOffset(e,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e,i){f&&typeof i=="string"&&(i=f.getElementById(i));var r=l?In:ht;return new r(e,i)}}},new function(){if(!l)return;var e,i,r=!1,h=!1;function c(j){var J=ut.getTarget(j);return J.getAttribute&&ht._viewsById[J.getAttribute("id")]}function g(){var j=ht._focused;if(!j||!j.isVisible()){for(var J=0,ie=ht._views.length;J<ie;J++)if((j=ht._views[J]).isVisible()){ht._focused=i=j;break}}}function m(j,J,ie){j._handleMouseEvent("mousemove",J,ie)}var v=l.navigator,y,x,E;v.pointerEnabled||v.msPointerEnabled?(y="pointerdown MSPointerDown",x="pointermove MSPointerMove",E="pointerup pointercancel MSPointerUp MSPointerCancel"):(y="touchstart",x="touchmove",E="touchend touchcancel","ontouchstart"in l&&v.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(y+=" mousedown",x+=" mousemove",E+=" mouseup"));var A={},P={mouseout:function(j){var J=ht._focused,ie=ut.getRelatedTarget(j);if(J&&(!ie||ie.nodeName==="HTML")){var se=ut.getOffset(j,J._element),ae=se.x,le=Math.abs,we=le(ae),Ee=1<<25,Me=we-Ee;se.x=le(Me)<we?Me*(ae<0?-1:1):ae,m(J,j,J.viewToProject(se))}},scroll:g};A[y]=function(j){var J=ht._focused=c(j);r||(r=!0,J._handleMouseEvent("mousedown",j))},P[x]=function(j){var J=ht._focused;if(!h){var ie=c(j);ie?J!==ie&&(J&&m(J,j),e||(e=J),J=ht._focused=i=ie):i&&i===J&&(e&&!e.isInserted()&&(e=null),J=ht._focused=e,e=null,g())}J&&m(J,j)},P[y]=function(){h=!0},P[E]=function(j){var J=ht._focused;J&&r&&J._handleMouseEvent("mouseup",j),h=r=!1},ut.add(f,P),ut.add(l,{load:g});var C=!1,B=!1,O={doubleclick:"click",mousedrag:"mousemove"},V=!1,I,R,w,N,U,q,D,G;function Z(j,J,ie,se,ae,le,we){var Ee=!1,Me;function Ne(me,ye){if(me.responds(ye)){if(Me||(Me=new En(ye,se,ae,J||me,le?ae.subtract(le):null)),me.emit(ye,Me)&&(C=!0,Me.prevented&&(B=!0),Me.stopped))return Ee=!0}else{var Le=O[ye];if(Le)return Ne(me,Le)}}for(;j&&j!==we&&!Ne(j,ie);)j=j._parent;return Ee}function K(j,J,ie,se,ae,le){return j._project.removeOn(ie),B=C=!1,U&&Z(U,null,ie,se,ae,le)||J&&J!==U&&!J.isDescendant(U)&&Z(J,null,ie==="mousedrag"?"mousemove":ie,se,ae,le,U)||Z(j,U||J||j,ie,se,ae,le)}var ee={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:A,_handleMouseEvent:function(j,J,ie){var se=this._itemEvents,ae=se.native[j],le=j==="mousemove",we=this._scope.tool,Ee=this;function Me(Ue){return se.virtual[Ue]||Ee.responds(Ue)||we&&we.responds(Ue)}le&&r&&Me("mousedrag")&&(j="mousedrag"),ie||(ie=this.getEventPoint(J));var Ne=this.getBounds().contains(ie),me=ae&&Ne&&Ee._project.hitTest(ie,{tolerance:0,fill:!0,stroke:!0}),ye=me&&me.item||null,Le=!1,De={};if(De[j.substr(5)]=!0,ae&&ye!==N&&(N&&Z(N,null,"mouseleave",J,ie),ye&&Z(ye,null,"mouseenter",J,ie),N=ye),V^Ne&&(Z(this,null,Ne?"mouseenter":"mouseleave",J,ie),Le=!0),(Ne||De.drag)&&!ie.equals(R)&&(K(this,ye,le?j:"mousemove",J,ie,R),Le=!0),V=Ne,De.down&&Ne||De.up&&I){if(K(this,ye,j,J,ie,I),De.down){if(G=ye===q&&Date.now()-D<300,w=q=ye,!B&&ye){for(var Re=ye;Re&&!Re.responds("mousedrag");)Re=Re._parent;Re&&(U=ye)}I=ie}else De.up&&(!B&&ye===w&&(D=Date.now(),K(this,ye,G?"doubleclick":"click",J,ie,I),G=!1),w=U=null);V=!1,Le=!0}R=ie,Le&&we&&(C=we._handleMouseEvent(j,J,ie,De)||C),J.cancelable!==!1&&(C&&!De.move||De.down&&Me("mouseup"))&&J.preventDefault()},_handleKeyEvent:function(j,J,ie,se){var ae=this._scope,le=ae.tool,we;function Ee(Me){Me.responds(j)&&(Qe=ae,Me.emit(j,we=we||new kn(j,J,ie,se)))}this.isVisible()&&(Ee(this),le&&le.responds(j)&&Ee(le))},_countItemEvent:function(j,J){var ie=this._itemEvents,se=ie.native,ae=ie.virtual;for(var le in ee)se[le]=(se[le]||0)+(ee[le][j]||0)*J;ae[j]=(ae[j]||0)+J},statics:{updateFocus:g,_resetState:function(){r=h=C=V=!1,e=i=I=R=w=N=U=q=D=G=null}}}}),In=ht.extend({_class:"CanvasView",initialize:function(i,r){if(!(r instanceof l.HTMLCanvasElement)){var h=X.read(arguments,1);if(h.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+o.slice(arguments,1));r=pt.getCanvas(h)}var c=this._context=r.getContext("2d");if(c.save(),this._pixelRatio=1,!/^off|false$/.test(_.getAttribute(r,"hidpi"))){var g=l.devicePixelRatio||1,m=at.getPrefixed(c,"backingStorePixelRatio")||1;this._pixelRatio=g/m}ht.call(this,i,r),this._needsUpdate=!0},remove:function e(){return this._context.restore(),e.base.call(this)},_setElementSize:function e(i,r){var h=this._pixelRatio;if(e.base.call(this,i*h,r*h),h!==1){var c=this._element,g=this._context;if(!_.hasAttribute(c,"resize")){var m=c.style;m.width=i+"px",m.height=r+"px"}g.restore(),g.save(),g.scale(h,h)}},getContext:function(){return this._context},getPixelSize:function e(i){var r=Qe.agent,h;if(r&&r.firefox)h=e.base.call(this,i);else{var c=this._context,g=c.font;c.font=i+" serif",h=parseFloat(c.font),c.font=g}return h},getTextWidth:function(e,i){var r=this._context,h=r.font,c=0;r.font=e;for(var g=0,m=i.length;g<m;g++)c=Math.max(c,r.measureText(i[g]).width);return r.font=h,c},update:function(){if(!this._needsUpdate)return!1;var e=this._project,i=this._context,r=this._viewSize;return i.clearRect(0,0,r.width+1,r.height+1),e&&e.draw(i,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),oi=o.extend({_class:"Event",initialize:function(i){this.event=i,this.type=i&&i.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return _i.modifiers}}),kn=oi.extend({_class:"KeyEvent",initialize:function(i,r,h,c){this.type=i,this.event=r,this.key=h,this.character=c},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),_i=new function(){var e={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},i={tab:"	",space:" ",enter:"\r"},r={},h={},c,g,m=new o({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var x=Qe&&Qe.agent;return x&&x.mac?this.meta:this.control}}});function v(x){var E=x.key||x.keyIdentifier;return E=/^U\+/.test(E)?String.fromCharCode(parseInt(E.substr(2),16)):/^Arrow[A-Z]/.test(E)?E.substr(5):E==="Unidentified"||E===a?String.fromCharCode(x.keyCode):E,e[E]||(E.length>1?o.hyphenate(E):E.toLowerCase())}function y(x,E,A,P){var C=ht._focused,B;if(r[E]=x,x?h[E]=A:delete h[E],E.length>1&&(B=o.camelize(E))in m){m[B]=x;var O=Qe&&Qe.agent;if(B==="meta"&&O&&O.mac)if(x)c={};else{for(var V in c)V in h&&y(!1,V,c[V],P);c=null}}else x&&c&&(c[E]=A);C&&C._handleKeyEvent(x?"keydown":"keyup",P,E,A)}return ut.add(f,{keydown:function(x){var E=v(x),A=Qe&&Qe.agent;E.length>1||A&&A.chrome&&(x.altKey||A.mac&&x.metaKey||!A.mac&&x.ctrlKey)?y(!0,E,i[E]||(E.length>1?"":E),x):g=E},keypress:function(x){if(g){var E=v(x),A=x.charCode,P=A>=32?String.fromCharCode(A):E.length>1?"":E;E!==g&&(E=P.toLowerCase()),y(!0,E,P,x),g=null}},keyup:function(x){var E=v(x);E in h&&y(!1,E,h[E],x)}}),ut.add(l,{blur:function(x){for(var E in h)y(!1,E,h[E],x)}}),{modifiers:m,isDown:function(x){return!!r[x]}}},En=oi.extend({_class:"MouseEvent",initialize:function(i,r,h,c,g){this.type=i,this.event=r,this.point=h,this.target=c,this.delta=g},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Jt=oi.extend({_class:"ToolEvent",_item:null,initialize:function(i,r,h){this.tool=i,this.type=r,this.event=h},_choosePoint:function(e,i){return e||(i?i.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){for(var i=e.item,r=i._parent;/^(Group|CompoundPath)$/.test(r._class);)i=r,r=r._parent;this._item=i}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),yi=b.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(i){b.call(this),this._moveCount=-1,this._downCount=-1,this.set(i)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){this._minDistance=e,e!=null&&this._maxDistance!=null&&e>this._maxDistance&&(this._maxDistance=e)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e,this._minDistance!=null&&e!=null&&e<this._minDistance&&(this._minDistance=e)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=this._maxDistance=e},_handleMouseEvent:function(e,i,r,h){Qe=this._scope,h.drag&&!this.responds(e)&&(e="mousemove");var c=h.move||h.drag,g=this.responds(e),m=!1,v=this;function y(E,A){var P=r,C=c?v._point:v._downPoint||P;if(c){if(v._moveCount>=0&&P.equals(C))return!1;if(C&&(E!=null||A!=null)){var B=P.subtract(C),O=B.getLength();if(O<(E||0))return!1;A&&(P=C.add(B.normalize(Math.min(O,A))))}v._moveCount++}return v._point=P,v._lastPoint=C||P,h.down&&(v._moveCount=-1,v._downPoint=P,v._downCount++),!0}function x(){g&&(m=v.emit(e,new Jt(v,e,i))||m)}if(h.down)y(),x();else if(h.up)y(null,this._maxDistance),x();else if(g)for(;y(this._minDistance,this._maxDistance);)x();return m}}),Oi=o.extend(d,{_class:"Tween",statics:{easings:new o({linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:-1+2*(2-e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}})},initialize:function e(i,r,h,c,g,m){this.object=i;var v=typeof g,y=v==="function";this.type=y?v:v==="string"?g:"linear",this.easing=y?g:e.easings[this.type],this.duration=c,this.running=!1,this._then=null,this._startTime=null;var x=r||h;this._keys=x?Object.keys(x):[],this._parsedKeys=this._parseKeys(this._keys),this._from=x&&this._getState(r),this._to=x&&this._getState(h),m!==!1&&this.start()},then:function(e){return this._then=e,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(e){if(this.running){e>=1&&(e=1,this.running=!1);for(var i=this.easing(e),r=this._keys,h=function(E){return typeof E=="function"?E(i,e):E},c=0,g=r&&r.length;c<g;c++){var m=r[c],v=h(this._from[m]),y=h(this._to[m]),x=v&&y&&v.__add&&y.__add?y.__subtract(v).__multiply(i).__add(v):(y-v)*i+v;this._setProperty(this._parsedKeys[m],x)}this.responds("update")&&this.emit("update",new o({progress:e,factor:i})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(e){var i=this._startTime,r=i?(e-i)/this.duration:0;i||(this._startTime=e),this.update(r)},_getState:function(e){for(var i=this._keys,r={},h=0,c=i.length;h<c;h++){var g=i[h],m=this._parsedKeys[g],v=this._getProperty(m),y;if(e){var x=this._resolveValue(v,e[g]);this._setProperty(m,x),y=this._getProperty(m),y=y&&y.clone?y.clone():y,this._setProperty(m,v)}else y=v&&v.clone?v.clone():v;r[g]=y}return r},_resolveValue:function(e,i){if(i){if(Array.isArray(i)&&i.length===2){var r=i[0];return r&&r.match&&r.match(/^[+\-\*\/]=/)?this._calculate(e,r[0],i[1]):i}else if(typeof i=="string"){var h=i.match(/^[+\-*/]=(.*)/);if(h){var c=JSON.parse(h[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(e,i[0],c)}}}return i},_calculate:function(e,i,r){return Qe.PaperScript.calculateBinary(e,i,r)},_parseKeys:function(e){for(var i={},r=0,h=e.length;r<h;r++){var c=e[r],g=c.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");i[c]=g.split("/")}return i},_getProperty:function(e,i){for(var r=this.object,h=0,c=e.length-(i||0);h<c&&r;h++)r=r[e[h]];return r},_setProperty:function(e,i){var r=this._getProperty(e,1);r&&(r[e[e.length-1]]=i)}}),zi={request:function(e){var i=new s.XMLHttpRequest;return i.open((e.method||"get").toUpperCase(),e.url,o.pick(e.async,!0)),e.mimeType&&i.overrideMimeType(e.mimeType),i.onload=function(){var r=i.status;r===0||r===200?e.onLoad&&e.onLoad.call(i,i.responseText):i.onerror()},i.onerror=function(){var r=i.status,h='Could not load "'+e.url+'" (Status: '+r+")";if(e.onError)e.onError(h,r);else throw new Error(h)},i.send(null)}},pt=o.exports.CanvasProvider={canvases:[],getCanvas:function(e,i,r){if(!l)return null;var h,c=!0;typeof e=="object"&&(i=e.height,e=e.width),this.canvases.length?h=this.canvases.pop():(h=f.createElement("canvas"),c=!1);var g=h.getContext("2d",r||{});if(!g)throw new Error("Canvas "+h+" is unable to provide a 2D context.");return h.width===e&&h.height===i?c&&g.clearRect(0,0,e+1,i+1):(h.width=e,h.height=i),g.save(),h},getContext:function(e,i,r){var h=this.getCanvas(e,i,r);return h?h.getContext("2d",r||{}):null},release:function(e){var i=e&&e.canvas?e.canvas:e;i&&i.getContext&&(i.getContext("2d").restore(),this.canvases.push(i))}},xi=new function(){var e=Math.min,i=Math.max,r=Math.abs,h,c,g,m,v,y,x,E,A,P,C;function B(U,q,D){return .2989*U+.587*q+.114*D}function O(U,q,D,K){var Z=K-B(U,q,D);A=U+Z,P=q+Z,C=D+Z;var K=B(A,P,C),ee=e(A,P,C),j=i(A,P,C);if(ee<0){var J=K-ee;A=K+(A-K)*K/J,P=K+(P-K)*K/J,C=K+(C-K)*K/J}if(j>255){var ie=255-K,se=j-K;A=K+(A-K)*ie/se,P=K+(P-K)*ie/se,C=K+(C-K)*ie/se}}function V(U,q,D){return i(U,q,D)-e(U,q,D)}function I(U,q,D,G){var Z=[U,q,D],K=i(U,q,D),ee=e(U,q,D),j;ee=ee===U?0:ee===q?1:2,K=K===U?0:K===q?1:2,j=e(ee,K)===0?i(ee,K)===1?2:1:0,Z[K]>Z[ee]?(Z[j]=(Z[j]-Z[ee])*G/(Z[K]-Z[ee]),Z[K]=G):Z[j]=Z[K]=0,Z[ee]=0,A=Z[0],P=Z[1],C=Z[2]}var R={multiply:function(){A=v*h/255,P=y*c/255,C=x*g/255},screen:function(){A=v+h-v*h/255,P=y+c-y*c/255,C=x+g-x*g/255},overlay:function(){A=v<128?2*v*h/255:255-2*(255-v)*(255-h)/255,P=y<128?2*y*c/255:255-2*(255-y)*(255-c)/255,C=x<128?2*x*g/255:255-2*(255-x)*(255-g)/255},"soft-light":function(){var U=h*v/255;A=U+v*(255-(255-v)*(255-h)/255-U)/255,U=c*y/255,P=U+y*(255-(255-y)*(255-c)/255-U)/255,U=g*x/255,C=U+x*(255-(255-x)*(255-g)/255-U)/255},"hard-light":function(){A=h<128?2*h*v/255:255-2*(255-h)*(255-v)/255,P=c<128?2*c*y/255:255-2*(255-c)*(255-y)/255,C=g<128?2*g*x/255:255-2*(255-g)*(255-x)/255},"color-dodge":function(){A=v===0?0:h===255?255:e(255,255*v/(255-h)),P=y===0?0:c===255?255:e(255,255*y/(255-c)),C=x===0?0:g===255?255:e(255,255*x/(255-g))},"color-burn":function(){A=v===255?255:h===0?0:i(0,255-(255-v)*255/h),P=y===255?255:c===0?0:i(0,255-(255-y)*255/c),C=x===255?255:g===0?0:i(0,255-(255-x)*255/g)},darken:function(){A=v<h?v:h,P=y<c?y:c,C=x<g?x:g},lighten:function(){A=v>h?v:h,P=y>c?y:c,C=x>g?x:g},difference:function(){A=v-h,A<0&&(A=-A),P=y-c,P<0&&(P=-P),C=x-g,C<0&&(C=-C)},exclusion:function(){A=v+h*(255-v-v)/255,P=y+c*(255-y-y)/255,C=x+g*(255-x-x)/255},hue:function(){I(h,c,g,V(v,y,x)),O(A,P,C,B(v,y,x))},saturation:function(){I(v,y,x,V(h,c,g)),O(A,P,C,B(v,y,x))},luminosity:function(){O(v,y,x,B(h,c,g))},color:function(){O(h,c,g,B(v,y,x))},add:function(){A=e(v+h,255),P=e(y+c,255),C=e(x+g,255)},subtract:function(){A=i(v-h,0),P=i(y-c,0),C=i(x-g,0)},average:function(){A=(v+h)/2,P=(y+c)/2,C=(x+g)/2},negation:function(){A=255-r(255-h-v),P=255-r(255-c-y),C=255-r(255-g-x)}},w=this.nativeModes=o.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(U){this[U]=!0},{}),N=pt.getContext(1,1,{willReadFrequently:!0});N&&(o.each(R,function(U,q){var D=q==="darken",G=!1;N.save();try{N.fillStyle=D?"#300":"#a00",N.fillRect(0,0,1,1),N.globalCompositeOperation=q,N.globalCompositeOperation===q&&(N.fillStyle=D?"#a00":"#300",N.fillRect(0,0,1,1),G=N.getImageData(0,0,1,1).data[0]!==D?170:51)}catch{}N.restore(),w[q]=G}),pt.release(N)),this.process=function(U,q,D,G,Z){var K=q.canvas,ee=U==="normal";if(ee||w[U])D.save(),D.setTransform(1,0,0,1,0,0),D.globalAlpha=G,ee||(D.globalCompositeOperation=U),D.drawImage(K,Z.x,Z.y),D.restore();else{var j=R[U];if(!j)return;for(var J=D.getImageData(Z.x,Z.y,K.width,K.height),ie=J.data,se=q.getImageData(0,0,K.width,K.height).data,ae=0,le=ie.length;ae<le;ae+=4){h=se[ae],v=ie[ae],c=se[ae+1],y=ie[ae+1],g=se[ae+2],x=ie[ae+2],m=se[ae+3],E=ie[ae+3],j();var we=m*G/255,Ee=1-we;ie[ae]=we*A+Ee*v,ie[ae+1]=we*P+Ee*y,ie[ae+2]=we*C+Ee*x,ie[ae+3]=m*G+Ee*E}D.putImageData(J,Z.x,Z.y)}}},nt=new function(){var e="http://www.w3.org/2000/svg",i="http://www.w3.org/2000/xmlns",r="http://www.w3.org/1999/xlink",h={href:r,xlink:i,xmlns:i+"/","xmlns:xlink":i+"/"};function c(v,y,x){return m(f.createElementNS(e,v),y,x)}function g(v,y){var x=h[y],E=x?v.getAttributeNS(x,y):v.getAttribute(y);return E==="null"?null:E}function m(v,y,x){for(var E in y){var A=y[E],P=h[E];typeof A=="number"&&x&&(A=x.number(A)),P?v.setAttributeNS(P,E,A):v.setAttribute(E,A)}return v}return{svg:e,xmlns:i,xlink:r,create:c,get:g,set:m}},Ki=o.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(e,i){return!i&&(e instanceof st||e instanceof de||e instanceof Yt)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(e,i){var r=o.capitalize(i),h=e[2];this[i]={type:e[1],property:i,attribute:e[0],toSVG:h,fromSVG:h&&o.each(h,function(c,g){this[c]=g},{}),exportFilter:e[3],get:"get"+r,set:"set"+r}},{});new function(){var e;function i(R,w,N){var U=new o,q=R.getTranslation();if(w){var D;R.isInvertible()?(R=R._shiftless(),D=R._inverseTransform(q),q=null):D=new L,U[N?"cx":"x"]=D.x,U[N?"cy":"y"]=D.y}if(!R.isIdentity()){var G=R.decompose();if(G){var Z=[],K=G.rotation,ee=G.scaling,j=G.skewing;q&&!q.isZero()&&Z.push("translate("+e.point(q)+")"),K&&Z.push("rotate("+e.number(K)+")"),(!M.isZero(ee.x-1)||!M.isZero(ee.y-1))&&Z.push("scale("+e.point(ee)+")"),j.x&&Z.push("skewX("+e.number(j.x)+")"),j.y&&Z.push("skewY("+e.number(j.y)+")"),U.transform=Z.join(" ")}else U.transform="matrix("+R.getValues().join(",")+")"}return U}function r(R,w){for(var N=i(R._matrix),U=R._children,q=nt.create("g",N,e),D=0,G=U.length;D<G;D++){var Z=U[D],K=V(Z,w);if(K)if(Z.isClipMask()){var ee=nt.create("clipPath");ee.appendChild(K),B(Z,ee,"clip"),nt.set(q,{"clip-path":"url(#"+ee.id+")"})}else q.appendChild(K)}return q}function h(R,w){var N=i(R._matrix,!0),U=R.getSize(),q=R.getImage();return N.x-=U.width/2,N.y-=U.height/2,N.width=U.width,N.height=U.height,N.href=w.embedImages==!1&&q&&q.src||R.toDataURL(),nt.create("image",N,e)}function c(R,w){var N=w.matchShapes;if(N){var U=R.toShape(!1);if(U)return g(U)}var q=R._segments,D=q.length,G,Z=i(R._matrix);if(N&&D>=2&&!R.hasHandles())if(D>2){G=R._closed?"polygon":"polyline";for(var K=[],ee=0;ee<D;ee++)K.push(e.point(q[ee]._point));Z.points=K.join(" ")}else{G="line";var j=q[0]._point,J=q[1]._point;Z.set({x1:j.x,y1:j.y,x2:J.x,y2:J.y})}else G="path",Z.d=R.getPathData(null,w.precision);return nt.create(G,Z,e)}function g(R){var w=R._type,N=R._radius,U=i(R._matrix,!0,w!=="rectangle");if(w==="rectangle"){w="rect";var q=R._size,D=q.width,G=q.height;U.x-=D/2,U.y-=G/2,U.width=D,U.height=G,N.isZero()&&(N=null)}return N&&(w==="circle"?U.r=N:(U.rx=N.width,U.ry=N.height)),nt.create(w,U,e)}function m(R,w){var N=i(R._matrix),U=R.getPathData(null,w.precision);return U&&(N.d=U),nt.create("path",N,e)}function v(R,w){var N=i(R._matrix,!0),U=R._definition,q=C(U,"symbol"),D=U._item,G=D.getStrokeBounds();return q||(q=nt.create("symbol",{viewBox:e.rectangle(G)}),q.appendChild(V(D,w)),B(U,q,"symbol")),N.href="#"+q.id,N.x+=G.x,N.y+=G.y,N.width=G.width,N.height=G.height,N.overflow="visible",nt.create("use",N,e)}function y(R){var w=C(R,"color");if(!w){var N=R.getGradient(),U=N._radial,q=R.getOrigin(),D=R.getDestination(),G;if(U){G={cx:q.x,cy:q.y,r:q.getDistance(D)};var Z=R.getHighlight();Z&&(G.fx=Z.x,G.fy=Z.y)}else G={x1:q.x,y1:q.y,x2:D.x,y2:D.y};G.gradientUnits="userSpaceOnUse",w=nt.create((U?"radial":"linear")+"Gradient",G,e);for(var K=N._stops,ee=0,j=K.length;ee<j;ee++){var J=K[ee],ie=J._color,se=ie.getAlpha(),ae=J._offset;G={offset:ae??ee/(j-1)},ie&&(G["stop-color"]=ie.toCSS(!0)),se<1&&(G["stop-opacity"]=se),w.appendChild(nt.create("stop",G,e))}B(R,w,"color")}return"url(#"+w.id+")"}function x(R){var w=nt.create("text",i(R._matrix,!0),e);return w.textContent=R._content,w}var E={Group:r,Layer:r,Raster:h,Path:c,Shape:g,CompoundPath:m,SymbolItem:v,PointText:x};function A(R,w,N,U){var q={},D=!U&&R.getParent(),G=[];return R._name!=null&&(q.id=R._name),o.each(Ki,function(Z){var K=Z.get,ee=Z.type,j=R[K]();if(Z.exportFilter?Z.exportFilter(R,j):N.reduceAttributes==!1||!D||!o.equals(D[K](),j)){if(ee==="color"&&j!=null){var J=j.getAlpha();J<1&&(q[Z.attribute+"-opacity"]=J)}ee==="style"?G.push(Z.attribute+": "+j):q[Z.attribute]=j==null?"none":ee==="color"?j.gradient?y(j):j.toCSS(!0):ee==="array"?j.join(","):ee==="lookup"?Z.toSVG[j]:j}}),G.length&&(q.style=G.join(";")),q.opacity===1&&delete q.opacity,R._visible||(q.visibility="hidden"),nt.set(w,q,e)}var P;function C(R,w){return P||(P={ids:{},svgs:{}}),R&&P.svgs[w+"-"+(R._id||R.__id||(R.__id=H.get("svg")))]}function B(R,w,N){P||C();var U=P.ids[N]=(P.ids[N]||0)+1;w.id=N+"-"+U,P.svgs[N+"-"+(R._id||R.__id)]=w}function O(R,w){var N=R,U=null;if(P){N=R.nodeName.toLowerCase()==="svg"&&R;for(var q in P.svgs)U||(N||(N=nt.create("svg"),N.appendChild(R)),U=N.insertBefore(nt.create("defs"),N.firstChild)),U.appendChild(P.svgs[q]);P=null}return w.asString?new s.XMLSerializer().serializeToString(N):N}function V(R,w,N){var U=E[R._class],q=U&&U(R,w);if(q){var D=w.onExport;D&&(q=D(R,q,w)||q);var G=JSON.stringify(R._data);G&&G!=="{}"&&G!=="null"&&q.setAttribute("data-paper-data",G)}return q&&A(R,q,w,N)}function I(R){return R||(R={}),e=new z(R.precision),R}T.inject({exportSVG:function(R){return R=I(R),O(V(this,R,!0),R)}}),he.inject({exportSVG:function(R){R=I(R);var w=this._children,N=this.getView(),U=o.pick(R.bounds,"view"),q=R.matrix||U==="view"&&N._matrix,D=q&&re.read([q]),G=U==="view"?new $([0,0],N.getViewSize()):U==="content"?T._getBounds(w,D,{stroke:!0}).rect:$.read([U],0,{readNull:!0}),Z={version:"1.1",xmlns:nt.svg,"xmlns:xlink":nt.xlink};G&&(Z.width=G.width,Z.height=G.height,(G.x||G.x===0||G.y||G.y===0)&&(Z.viewBox=e.rectangle(G)));var K=nt.create("svg",Z,e),ee=K;D&&!D.isIdentity()&&(ee=K.appendChild(nt.create("g",i(D),e)));for(var j=0,J=w.length;j<J;j++)ee.appendChild(V(w[j],R,!0));return O(K,R)}})},new function(){var e={},i;function r(w,N,U,q,D,G){var Z=nt.get(w,N)||G,K=Z==null?q?null:U?"":0:U?Z:parseFloat(Z);return/%\s*$/.test(Z)?K/100*(D?1:i[/x|^width/.test(N)?"width":"height"]):K}function h(w,N,U,q,D,G,Z){return N=r(w,N||"x",!1,q,D,G),U=r(w,U||"y",!1,q,D,Z),q&&(N==null||U==null)?null:new L(N,U)}function c(w,N,U,q,D){return N=r(w,N||"width",!1,q,D),U=r(w,U||"height",!1,q,D),q&&(N==null||U==null)?null:new X(N,U)}function g(w,N,U){return w==="none"?null:N==="number"?parseFloat(w):N==="array"?w?w.split(/[\s,]+/g).map(parseFloat):[]:N==="color"?V(w)||w:N==="lookup"?U[w]:w}function m(w,N,U,q){var D=w.childNodes,G=N==="clippath",Z=N==="defs",K=new ve,ee=K._project,j=ee._currentStyle,J=[];if(!G&&!Z&&(K=O(K,w,q),ee._currentStyle=K._style.clone()),q)for(var ie=w.querySelectorAll("defs"),se=0,ae=ie.length;se<ae;se++)I(ie[se],U,!1);for(var se=0,ae=D.length;se<ae;se++){var le=D[se],we;le.nodeType===1&&!/^defs$/i.test(le.nodeName)&&(we=I(le,U,!1))&&!(we instanceof Ce)&&J.push(we)}return K.addChildren(J),G&&(K=O(K.reduce(),w,q)),ee._currentStyle=j,(G||Z)&&(K.remove(),K=null),K}function v(w,N){for(var U=w.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),q=[],D=0,G=U.length;D<G;D+=2)q.push(new L(parseFloat(U[D]),parseFloat(U[D+1])));var Z=new Fe(q);return N==="polygon"&&Z.closePath(),Z}function y(w){return st.create(w.getAttribute("d"))}function x(w,N){var U=(r(w,"href",!0)||"").substring(1),q=N==="radialgradient",D;if(U)D=e[U].getGradient(),D._radial^q&&(D=D.clone(),D._radial=q);else{for(var G=w.childNodes,Z=[],K=0,ee=G.length;K<ee;K++){var j=G[K];j.nodeType===1&&Z.push(O(new Zi,j))}D=new vi(Z,q)}var J,ie,se,ae=r(w,"gradientUnits",!0)!=="userSpaceOnUse";q?(J=h(w,"cx","cy",!1,ae,"50%","50%"),ie=J.add(r(w,"r",!1,!1,ae,"50%"),0),se=h(w,"fx","fy",!0,ae)):(J=h(w,"x1","y1",!1,ae,"0%","0%"),ie=h(w,"x2","y2",!1,ae,"100%","0%"));var le=O(new dt(D,J,ie,se),w);return le._scaleToBounds=ae,null}var E={"#document":function(w,N,U,q){for(var D=w.childNodes,G=0,Z=D.length;G<Z;G++){var K=D[G];if(K.nodeType===1)return I(K,U,q)}},g:m,svg:m,clippath:m,polygon:v,polyline:v,path:y,lineargradient:x,radialgradient:x,image:function(w){var N=new Se(r(w,"href",!0));return N.on("load",function(){var U=c(w);this.setSize(U);var q=h(w).add(U.divide(2));this._matrix.append(new re().translate(q))}),N},symbol:function(w,N,U,q){return new Ce(m(w,N,U,q),!0)},defs:m,use:function(w){var N=(r(w,"href",!0)||"").substring(1),U=e[N],q=h(w);return U?U instanceof Ce?U.place(q):U.clone().translate(q):null},circle:function(w){return new de.Circle(h(w,"cx","cy"),r(w,"r"))},ellipse:function(w){return new de.Ellipse({center:h(w,"cx","cy"),radius:c(w,"rx","ry")})},rect:function(w){return new de.Rectangle(new $(h(w),c(w)),c(w,"rx","ry"))},line:function(w){return new Fe.Line(h(w,"x1","y1"),h(w,"x2","y2"))},text:function(w){var N=new Wi(h(w).add(h(w,"dx","dy")));return N.setContent(w.textContent.trim()||""),N},switch:m};function A(w,N,U,q){if(w.transform){for(var D=(q.getAttribute(U)||"").split(/\)\s*/g),G=new re,Z=0,K=D.length;Z<K;Z++){var ee=D[Z];if(!ee)break;for(var j=ee.split(/\(\s*/),J=j[0].trim(),ie=j[1].split(/[\s,]+/g),se=0,ae=ie.length;se<ae;se++)ie[se]=parseFloat(ie[se]);switch(J){case"matrix":G.append(new re(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]));break;case"rotate":G.rotate(ie[0],ie[1]||0,ie[2]||0);break;case"translate":G.translate(ie[0],ie[1]||0);break;case"scale":G.scale(ie);break;case"skewX":G.skew(ie[0],0);break;case"skewY":G.skew(0,ie[0]);break}}w.transform(G)}}function P(w,N,U){var q=U==="fill-opacity"?"getFillColor":"getStrokeColor",D=w[q]&&w[q]();D&&D.setAlpha(parseFloat(N))}var C=o.set(o.each(Ki,function(w){this[w.attribute]=function(N,U){if(N[w.set]&&(N[w.set](g(U,w.type,w.fromSVG)),w.type==="color")){var q=N[w.get]();if(q&&q._scaleToBounds){var D=N.getBounds();q.transform(new re().translate(D.getPoint()).scale(D.getSize()))}}}},{}),{id:function(w,N){e[N]=w,w.setName&&w.setName(N)},"clip-path":function(w,N){var U=V(N);if(U)if(U=U.clone(),U.setClipMask(!0),w instanceof ve)w.insertChild(0,U);else return new ve(U,w)},gradientTransform:A,transform:A,"fill-opacity":P,"stroke-opacity":P,visibility:function(w,N){w.setVisible&&w.setVisible(N==="visible")},display:function(w,N){w.setVisible&&w.setVisible(N!==null)},"stop-color":function(w,N){w.setColor&&w.setColor(N)},"stop-opacity":function(w,N){w._color&&w._color.setAlpha(parseFloat(N))},offset:function(w,N){if(w.setOffset){var U=N.match(/(.*)%$/);w.setOffset(U?U[1]/100:parseFloat(N))}},viewBox:function(w,N,U,q,D){var G=new $(g(N,"array")),Z=c(q,null,null,!0),K,ee;if(w instanceof ve){var j=Z?Z.divide(G.getSize()):1,ee=new re().scale(j).translate(G.getPoint().negate());K=w}else w instanceof Ce&&(Z&&G.setSize(Z),K=w._item);if(K){if(B(q,"overflow",D)!=="visible"){var J=new de.Rectangle(G);J.setClipMask(!0),K.addChild(J)}ee&&K.transform(ee)}}});function B(w,N,U){var q=w.attributes[N],D=q&&q.value;if(!D&&w.style){var G=o.camelize(N);D=w.style[G],!D&&U.node[G]!==U.parent[G]&&(D=U.node[G])}return D?D==="none"?null:D:a}function O(w,N,U){var q=N.parentNode,D={node:at.getStyles(N)||{},parent:!U&&!/^defs$/i.test(q.tagName)&&at.getStyles(q)||{}};return o.each(C,function(G,Z){var K=B(N,Z,D);w=K!==a&&G(w,K,Z,N,D)||w}),w}function V(w){var N=w&&w.match(/\((?:["'#]*)([^"')]+)/),U=N&&N[1],q=U&&e[l?U.replace(l.location.href.split("#")[0]+"#",""):U];return q&&q._scaleToBounds&&(q=q.clone(),q._scaleToBounds=!0),q}function I(w,N,U){var q=w.nodeName.toLowerCase(),D=q!=="#document",G=f.body,Z,K,ee;U&&D&&(i=Qe.getView().getSize(),i=c(w,null,null,!0)||i,Z=nt.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),K=w.parentNode,ee=w.nextSibling,Z.appendChild(w),G.appendChild(Z));var j=Qe.settings,J=j.applyMatrix,ie=j.insertItems;j.applyMatrix=!1,j.insertItems=!1;var se=E[q],ae=se&&se(w,q,N,U)||null;if(j.insertItems=ie,j.applyMatrix=J,ae){D&&!(ae instanceof ve)&&(ae=O(ae,w,U));var le=N.onImport,we=D&&w.getAttribute("data-paper-data");le&&(ae=le(w,ae,N)||ae),N.expandShapes&&ae instanceof de&&(ae.remove(),ae=ae.toPath()),we&&(ae._data=JSON.parse(we))}return Z&&(G.removeChild(Z),K&&(ee?K.insertBefore(w,ee):K.appendChild(w))),U&&(e={},ae&&o.pick(N.applyMatrix,J)&&ae.matrix.apply(!0,!0)),ae}function R(w,N,U){if(!w)return null;N=typeof N=="function"?{onLoad:N}:N||{};var q=Qe,D=null;function G(j){try{var J=typeof j=="object"?j:new s.DOMParser().parseFromString(j.trim(),"image/svg+xml");if(!J.nodeName)throw J=null,new Error("Unsupported SVG source: "+w);Qe=q,D=I(J,N,!0),(!N||N.insert!==!1)&&U._insertItem(a,D);var ie=N.onLoad;ie&&ie(D,j)}catch(se){Z(se)}}function Z(j,J){var ie=N.onError;if(ie)ie(j,J);else throw new Error(j)}if(typeof w=="string"&&!/^[\s\S]*</.test(w)){var K=f.getElementById(w);K?G(K):zi.request({url:w,async:!0,onLoad:G,onError:Z})}else if(typeof File<"u"&&w instanceof File){var ee=new FileReader;return ee.onload=function(){G(ee.result)},ee.onerror=function(){Z(ee.error)},ee.readAsText(w)}else G(w);return D}T.inject({importSVG:function(w,N){return R(w,N,this)}}),he.inject({importSVG:function(w,N){return this.activate(),R(w,N,this)}})},o.exports.PaperScript=(function(){var e=this,i=e.acorn;if(!i&&typeof Ya<"u")try{i=eo()}catch{}if(!i){var r,h;i=r=h={},(function(O,V){if(typeof r=="object"&&typeof h=="object")return V(r);if(typeof a=="function"&&a.amd)return a(["exports"],V);V(O.acorn||(O.acorn={}))})(this,function(O){O.version="0.5.0";var V,I,R,w;O.parse=function(Y,ne){return I=String(Y),R=I.length,U(ne),ts(),Ra(V.program)};var N=O.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function U(Y){V=Y||{};for(var ne in N)Object.prototype.hasOwnProperty.call(V,ne)||(V[ne]=N[ne]);w=V.sourceFile||null}var q=O.getLineInfo=function(Y,ne){for(var fe=1,be=0;;){Ri.lastIndex=be;var He=Ri.exec(Y);if(He&&He.index<ne)++fe,be=He.index+He[0].length;else break}return{line:fe,column:ne-be}};O.tokenize=function(Y,ne){I=String(Y),R=I.length,U(ne),ts();var fe={};function be(He){return we=Z,Pi(He),fe.start=G,fe.end=Z,fe.startLoc=K,fe.endLoc=ee,fe.type=j,fe.value=J,fe}return be.jumpTo=function(He,We){if(D=He,V.locations){se=1,ae=Ri.lastIndex=0;for(var Xe;(Xe=Ri.exec(I))&&Xe.index<He;)++se,ae=Xe.index+Xe[0].length}ie=We,Di()},be};var D,G,Z,K,ee,j,J,ie,se,ae,le,we,Ee,Me,Ne,me;function ye(Y,ne){var fe=q(I,Y);ne+=" ("+fe.line+":"+fe.column+")";var be=new SyntaxError(ne);throw be.pos=Y,be.loc=fe,be.raisedAt=D,be}var Le=[],De={type:"num"},Re={type:"regexp"},Ue={type:"string"},Be={type:"name"},je={type:"eof"},Ke={keyword:"break"},qe={keyword:"case",beforeExpr:!0},_t={keyword:"catch"},gt={keyword:"continue"},bt={keyword:"debugger"},mt={keyword:"default"},Ae={keyword:"do",isLoop:!0},lt={keyword:"else",beforeExpr:!0},ct={keyword:"finally"},yt={keyword:"for",isLoop:!0},Nt={keyword:"function"},Gt={keyword:"if"},Rt={keyword:"return",beforeExpr:!0},Dt={keyword:"switch"},It={keyword:"throw",beforeExpr:!0},Lt={keyword:"try"},jt={keyword:"var"},xt={keyword:"while",isLoop:!0},kt={keyword:"with"},An={keyword:"new",beforeExpr:!0},Yi={keyword:"this"},Tn={keyword:"null",atomValue:null},Mn={keyword:"true",atomValue:!0},Ln={keyword:"false",atomValue:!1},Ni={keyword:"in",binop:7,beforeExpr:!0},ui={break:Ke,case:qe,catch:_t,continue:gt,debugger:bt,default:mt,do:Ae,else:lt,finally:ct,for:yt,function:Nt,if:Gt,return:Rt,switch:Dt,throw:It,try:Lt,var:jt,while:xt,with:kt,null:Tn,true:Mn,false:Ln,new:An,in:Ni,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Yi,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},bi={type:"[",beforeExpr:!0},wi={type:"]"},ei={type:"{",beforeExpr:!0},Ut={type:"}"},Ze={type:"(",beforeExpr:!0},Vt={type:")"},qt={type:",",beforeExpr:!0},Ft={type:";",beforeExpr:!0},ti={type:":",beforeExpr:!0},Qi={type:"."},$i={type:"?",beforeExpr:!0},Ji={binop:10,beforeExpr:!0},n={isAssign:!0,beforeExpr:!0},p={isAssign:!0,beforeExpr:!0},k={postfix:!0,prefix:!0,isUpdate:!0},F={prefix:!0,beforeExpr:!0},W={binop:1,beforeExpr:!0},ue={binop:2,beforeExpr:!0},ce={binop:3,beforeExpr:!0},ke={binop:4,beforeExpr:!0},Oe={binop:5,beforeExpr:!0},Ge={binop:6,beforeExpr:!0},$e={binop:7,beforeExpr:!0},ot={binop:8,beforeExpr:!0},St={binop:9,prefix:!0,beforeExpr:!0},Si={binop:10,beforeExpr:!0};O.tokTypes={bracketL:bi,bracketR:wi,braceL:ei,braceR:Ut,parenL:Ze,parenR:Vt,comma:qt,semi:Ft,colon:ti,dot:Qi,question:$i,slash:Ji,eq:n,name:Be,eof:je,num:De,regexp:Re,string:Ue};for(var ii in ui)O.tokTypes["_"+ii]=ui[ii];function Qt(Y){Y=Y.split(" ");var ne="",fe=[];e:for(var be=0;be<Y.length;++be){for(var He=0;He<fe.length;++He)if(fe[He][0].length==Y[be].length){fe[He].push(Y[be]);continue e}fe.push([Y[be]])}function We(rt){if(rt.length==1)return ne+="return str === "+JSON.stringify(rt[0])+";";ne+="switch(str){";for(var Zt=0;Zt<rt.length;++Zt)ne+="case "+JSON.stringify(rt[Zt])+":";ne+="return true}return false;"}if(fe.length>3){fe.sort(function(rt,Zt){return Zt.length-rt.length}),ne+="switch(str.length){";for(var be=0;be<fe.length;++be){var Xe=fe[be];ne+="case "+Xe[0].length+":",We(Xe)}ne+="}"}else We(Y);return new Function("str",ne)}var hi=Qt("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),li=Qt("class enum extends super const export import"),Qr=Qt("implements interface let package private protected public static yield"),On=Qt("eval arguments"),xa=Qt("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),ba=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,$r="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",wa="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Jr=new RegExp("["+$r+"]"),Sa=new RegExp("["+$r+wa+"]"),zn=/[\n\r\u2028\u2029]/,Ri=/\r\n|[\n\r\u2028\u2029]/g,Nn=O.isIdentifierStart=function(Y){return Y<65?Y===36:Y<91?!0:Y<97?Y===95:Y<123?!0:Y>=170&&Jr.test(String.fromCharCode(Y))},es=O.isIdentifierChar=function(Y){return Y<48?Y===36:Y<58?!0:Y<65?!1:Y<91?!0:Y<97?Y===95:Y<123?!0:Y>=170&&Sa.test(String.fromCharCode(Y))};function Ci(){this.line=se,this.column=D-ae}function ts(){se=1,D=ae=0,ie=!0,Di()}function Ct(Y,ne){Z=D,V.locations&&(ee=new Ci),j=Y,Di(),J=ne,ie=Y.beforeExpr}function Ca(){var Y=V.onComment&&V.locations&&new Ci,ne=D,fe=I.indexOf("*/",D+=2);if(fe===-1&&ye(D-2,"Unterminated comment"),D=fe+2,V.locations){Ri.lastIndex=ne;for(var be;(be=Ri.exec(I))&&be.index<D;)++se,ae=be.index+be[0].length}V.onComment&&V.onComment(!0,I.slice(ne+2,fe),ne,D,Y,V.locations&&new Ci)}function ar(){for(var Y=D,ne=V.onComment&&V.locations&&new Ci,fe=I.charCodeAt(D+=2);D<R&&fe!==10&&fe!==13&&fe!==8232&&fe!==8233;)++D,fe=I.charCodeAt(D);V.onComment&&V.onComment(!1,I.slice(Y+2,D),Y,D,ne,V.locations&&new Ci)}function Di(){for(;D<R;){var Y=I.charCodeAt(D);if(Y===32)++D;else if(Y===13){++D;var ne=I.charCodeAt(D);ne===10&&++D,V.locations&&(++se,ae=D)}else if(Y===10||Y===8232||Y===8233)++D,V.locations&&(++se,ae=D);else if(Y>8&&Y<14)++D;else if(Y===47){var ne=I.charCodeAt(D+1);if(ne===42)Ca();else if(ne===47)ar();else break}else if(Y===160)++D;else if(Y>=5760&&ba.test(String.fromCharCode(Y)))++D;else break}}function Pa(){var Y=I.charCodeAt(D+1);return Y>=48&&Y<=57?ns(!0):(++D,Ct(Qi))}function Ia(){var Y=I.charCodeAt(D+1);return ie?(++D,is()):Y===61?Pt(p,2):Pt(Ji,1)}function ka(){var Y=I.charCodeAt(D+1);return Y===61?Pt(p,2):Pt(Si,1)}function Ea(Y){var ne=I.charCodeAt(D+1);return ne===Y?Pt(Y===124?W:ue,2):ne===61?Pt(p,2):Pt(Y===124?ce:Oe,1)}function Aa(){var Y=I.charCodeAt(D+1);return Y===61?Pt(p,2):Pt(ke,1)}function Ta(Y){var ne=I.charCodeAt(D+1);return ne===Y?ne==45&&I.charCodeAt(D+2)==62&&zn.test(I.slice(we,D))?(D+=3,ar(),Di(),Pi()):Pt(k,2):ne===61?Pt(p,2):Pt(St,1)}function Ma(Y){var ne=I.charCodeAt(D+1),fe=1;return ne===Y?(fe=Y===62&&I.charCodeAt(D+2)===62?3:2,I.charCodeAt(D+fe)===61?Pt(p,fe+1):Pt(ot,fe)):ne==33&&Y==60&&I.charCodeAt(D+2)==45&&I.charCodeAt(D+3)==45?(D+=4,ar(),Di(),Pi()):(ne===61&&(fe=I.charCodeAt(D+2)===61?3:2),Pt($e,fe))}function La(Y){var ne=I.charCodeAt(D+1);return ne===61?Pt(Ge,I.charCodeAt(D+2)===61?3:2):Pt(Y===61?n:F,1)}function Oa(Y){switch(Y){case 46:return Pa();case 40:return++D,Ct(Ze);case 41:return++D,Ct(Vt);case 59:return++D,Ct(Ft);case 44:return++D,Ct(qt);case 91:return++D,Ct(bi);case 93:return++D,Ct(wi);case 123:return++D,Ct(ei);case 125:return++D,Ct(Ut);case 58:return++D,Ct(ti);case 63:return++D,Ct($i);case 48:var ne=I.charCodeAt(D+1);if(ne===120||ne===88)return za();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ns(!1);case 34:case 39:return Na(Y);case 47:return Ia();case 37:case 42:return ka();case 124:case 38:return Ea(Y);case 94:return Aa();case 43:case 45:return Ta(Y);case 60:case 62:return Ma(Y);case 61:case 33:return La(Y);case 126:return Pt(F,1)}return!1}function Pi(Y){if(Y?D=G+1:G=D,V.locations&&(K=new Ci),Y)return is();if(D>=R)return Ct(je);var ne=I.charCodeAt(D);if(Nn(ne)||ne===92)return ss();var fe=Oa(ne);if(fe===!1){var be=String.fromCharCode(ne);if(be==="\\"||Jr.test(be))return ss();ye(D,"Unexpected character '"+be+"'")}return fe}function Pt(Y,ne){var fe=I.slice(D,D+ne);D+=ne,Ct(Y,fe)}function is(){for(var He="",Y,ne,fe=D;;){D>=R&&ye(fe,"Unterminated regular expression");var be=I.charAt(D);if(zn.test(be)&&ye(fe,"Unterminated regular expression"),Y)Y=!1;else{if(be==="[")ne=!0;else if(be==="]"&&ne)ne=!1;else if(be==="/"&&!ne)break;Y=be==="\\"}++D}var He=I.slice(fe,D);++D;var We=rs();We&&!/^[gmsiy]*$/.test(We)&&ye(fe,"Invalid regexp flag");try{var Xe=new RegExp(He,We)}catch(rt){rt instanceof SyntaxError&&ye(fe,rt.message),ye(rt)}return Ct(Re,Xe)}function en(Y,ne){for(var fe=D,be=0,He=0,We=ne??1/0;He<We;++He){var Xe=I.charCodeAt(D),rt;if(Xe>=97?rt=Xe-97+10:Xe>=65?rt=Xe-65+10:Xe>=48&&Xe<=57?rt=Xe-48:rt=1/0,rt>=Y)break;++D,be=be*Y+rt}return D===fe||ne!=null&&D-fe!==ne?null:be}function za(){D+=2;var Y=en(16);return Y==null&&ye(G+2,"Expected hexadecimal number"),Nn(I.charCodeAt(D))&&ye(D,"Identifier directly after number"),Ct(De,Y)}function ns(Y){var ne=D,fe=!1,be=I.charCodeAt(D)===48;!Y&&en(10)===null&&ye(ne,"Invalid number"),I.charCodeAt(D)===46&&(++D,en(10),fe=!0);var He=I.charCodeAt(D);(He===69||He===101)&&(He=I.charCodeAt(++D),(He===43||He===45)&&++D,en(10)===null&&ye(ne,"Invalid number"),fe=!0),Nn(I.charCodeAt(D))&&ye(D,"Identifier directly after number");var We=I.slice(ne,D),Xe;return fe?Xe=parseFloat(We):!be||We.length===1?Xe=parseInt(We,10):/[89]/.test(We)||me?ye(ne,"Invalid number"):Xe=parseInt(We,8),Ct(De,Xe)}function Na(Y){D++;for(var ne="";;){D>=R&&ye(G,"Unterminated string constant");var fe=I.charCodeAt(D);if(fe===Y)return++D,Ct(Ue,ne);if(fe===92){fe=I.charCodeAt(++D);var be=/^[0-7]+/.exec(I.slice(D,D+3));for(be&&(be=be[0]);be&&parseInt(be,8)>255;)be=be.slice(0,-1);if(be==="0"&&(be=null),++D,be)me&&ye(D-2,"Octal literal in strict mode"),ne+=String.fromCharCode(parseInt(be,8)),D+=be.length-1;else switch(fe){case 110:ne+=`
`;break;case 114:ne+="\r";break;case 120:ne+=String.fromCharCode(Rn(2));break;case 117:ne+=String.fromCharCode(Rn(4));break;case 85:ne+=String.fromCharCode(Rn(8));break;case 116:ne+="	";break;case 98:ne+="\b";break;case 118:ne+="\v";break;case 102:ne+="\f";break;case 48:ne+="\0";break;case 13:I.charCodeAt(D)===10&&++D;case 10:V.locations&&(ae=D,++se);break;default:ne+=String.fromCharCode(fe);break}}else(fe===13||fe===10||fe===8232||fe===8233)&&ye(G,"Unterminated string constant"),ne+=String.fromCharCode(fe),++D}}function Rn(Y){var ne=en(16,Y);return ne===null&&ye(G,"Bad character escape sequence"),ne}var Vi;function rs(){Vi=!1;for(var Y,ne=!0,fe=D;;){var be=I.charCodeAt(D);if(es(be))Vi&&(Y+=I.charAt(D)),++D;else if(be===92){Vi||(Y=I.slice(fe,D)),Vi=!0,I.charCodeAt(++D)!=117&&ye(D,"Expecting Unicode escape sequence \\uXXXX"),++D;var He=Rn(4),We=String.fromCharCode(He);We||ye(D-1,"Invalid Unicode escape"),(ne?Nn(He):es(He))||ye(D-4,"Invalid Unicode escape"),Y+=We}else break;ne=!1}return Vi?Y:I.slice(fe,D)}function ss(){var Y=rs(),ne=Be;return!Vi&&xa(Y)&&(ne=ui[Y]),Ct(ne,Y)}function tt(){le=G,we=Z,Ee=ee,Pi()}function or(Y){if(me=Y,D=G,V.locations)for(;D<ae;)ae=I.lastIndexOf(`
`,ae-2)+1,--se;Di(),Pi()}function as(){this.type=null,this.start=G,this.end=null}function os(){this.start=K,this.end=null,w!==null&&(this.source=w)}function Et(){var Y=new as;return V.locations&&(Y.loc=new os),V.directSourceFile&&(Y.sourceFile=V.directSourceFile),V.ranges&&(Y.range=[G,0]),Y}function ci(Y){var ne=new as;return ne.start=Y.start,V.locations&&(ne.loc=new os,ne.loc.start=Y.loc.start),V.ranges&&(ne.range=[Y.range[0],0]),ne}function Je(Y,ne){return Y.type=ne,Y.end=we,V.locations&&(Y.loc.end=Ee),V.ranges&&(Y.range[1]=we),Y}function ur(Y){return V.ecmaVersion>=5&&Y.type==="ExpressionStatement"&&Y.expression.type==="Literal"&&Y.expression.value==="use strict"}function vt(Y){if(j===Y)return tt(),!0}function Dn(){return!V.strictSemicolons&&(j===je||j===Ut||zn.test(I.slice(we,G)))}function Ii(){!vt(Ft)&&!Dn()&&ni()}function wt(Y){j===Y?tt():ni()}function ni(){ye(G,"Unexpected token")}function Vn(Y){Y.type!=="Identifier"&&Y.type!=="MemberExpression"&&ye(Y.start,"Assigning to rvalue"),me&&Y.type==="Identifier"&&On(Y.name)&&ye(Y.start,"Assigning to "+Y.name+" in strict mode")}function Ra(Y){le=we=D,V.locations&&(Ee=new Ci),Me=me=null,Ne=[],Pi();var ne=Y||Et(),fe=!0;for(Y||(ne.body=[]);j!==je;){var be=Wt();ne.body.push(be),fe&&ur(be)&&or(!0),fe=!1}return Je(ne,"Program")}var hr={kind:"loop"},Da={kind:"switch"};function Wt(){(j===Ji||j===p&&J=="/=")&&Pi(!0);var Y=j,ne=Et();switch(Y){case Ke:case gt:tt();var fe=Y===Ke;vt(Ft)||Dn()?ne.label=null:j!==Be?ni():(ne.label=fi(),Ii());for(var be=0;be<Ne.length;++be){var He=Ne[be];if((ne.label==null||He.name===ne.label.name)&&(He.kind!=null&&(fe||He.kind==="loop")||ne.label&&fe))break}return be===Ne.length&&ye(ne.start,"Unsyntactic "+Y.keyword),Je(ne,fe?"BreakStatement":"ContinueStatement");case bt:return tt(),Ii(),Je(ne,"DebuggerStatement");case Ae:return tt(),Ne.push(hr),ne.body=Wt(),Ne.pop(),wt(xt),ne.test=tn(),Ii(),Je(ne,"DoWhileStatement");case yt:if(tt(),Ne.push(hr),wt(Ze),j===Ft)return lr(ne,null);if(j===jt){var We=Et();return tt(),hs(We,!0),Je(We,"VariableDeclaration"),We.declarations.length===1&&vt(Ni)?us(ne,We):lr(ne,We)}var We=At(!1,!0);return vt(Ni)?(Vn(We),us(ne,We)):lr(ne,We);case Nt:return tt(),gr(ne,!0);case Gt:return tt(),ne.test=tn(),ne.consequent=Wt(),ne.alternate=vt(lt)?Wt():null,Je(ne,"IfStatement");case Rt:return!Me&&!V.allowReturnOutsideFunction&&ye(G,"'return' outside of function"),tt(),vt(Ft)||Dn()?ne.argument=null:(ne.argument=At(),Ii()),Je(ne,"ReturnStatement");case Dt:tt(),ne.discriminant=tn(),ne.cases=[],wt(ei),Ne.push(Da);for(var Xe,rt;j!=Ut;)if(j===qe||j===mt){var Zt=j===qe;Xe&&Je(Xe,"SwitchCase"),ne.cases.push(Xe=Et()),Xe.consequent=[],tt(),Zt?Xe.test=At():(rt&&ye(le,"Multiple default clauses"),rt=!0,Xe.test=null),wt(ti)}else Xe||ni(),Xe.consequent.push(Wt());return Xe&&Je(Xe,"SwitchCase"),tt(),Ne.pop(),Je(ne,"SwitchStatement");case It:return tt(),zn.test(I.slice(we,G))&&ye(we,"Illegal newline after throw"),ne.argument=At(),Ii(),Je(ne,"ThrowStatement");case Lt:if(tt(),ne.block=nn(),ne.handler=null,j===_t){var ki=Et();tt(),wt(Ze),ki.param=fi(),me&&On(ki.param.name)&&ye(ki.param.start,"Binding "+ki.param.name+" in strict mode"),wt(Vt),ki.guard=null,ki.body=nn(),ne.handler=Je(ki,"CatchClause")}return ne.guardedHandlers=Le,ne.finalizer=vt(ct)?nn():null,!ne.handler&&!ne.finalizer&&ye(ne.start,"Missing catch or finally clause"),Je(ne,"TryStatement");case jt:return tt(),hs(ne),Ii(),Je(ne,"VariableDeclaration");case xt:return tt(),ne.test=tn(),Ne.push(hr),ne.body=Wt(),Ne.pop(),Je(ne,"WhileStatement");case kt:return me&&ye(G,"'with' in strict mode"),tt(),ne.object=tn(),ne.body=Wt(),Je(ne,"WithStatement");case ei:return nn();case Ft:return tt(),Je(ne,"EmptyStatement");default:var vr=J,Fn=At();if(Y===Be&&Fn.type==="Identifier"&&vt(ti)){for(var be=0;be<Ne.length;++be)Ne[be].name===vr&&ye(Fn.start,"Label '"+vr+"' is already declared");var Ha=j.isLoop?"loop":j===Dt?"switch":null;return Ne.push({name:vr,kind:Ha}),ne.body=Wt(),Ne.pop(),ne.label=Fn,Je(ne,"LabeledStatement")}else return ne.expression=Fn,Ii(),Je(ne,"ExpressionStatement")}}function tn(){wt(Ze);var Y=At();return wt(Vt),Y}function nn(Y){var ne=Et(),fe=!0,be=!1,He;for(ne.body=[],wt(ei);!vt(Ut);){var We=Wt();ne.body.push(We),fe&&Y&&ur(We)&&(He=be,or(be=!0)),fe=!1}return be&&!He&&or(!1),Je(ne,"BlockStatement")}function lr(Y,ne){return Y.init=ne,wt(Ft),Y.test=j===Ft?null:At(),wt(Ft),Y.update=j===Vt?null:At(),wt(Vt),Y.body=Wt(),Ne.pop(),Je(Y,"ForStatement")}function us(Y,ne){return Y.left=ne,Y.right=At(),wt(Vt),Y.body=Wt(),Ne.pop(),Je(Y,"ForInStatement")}function hs(Y,ne){for(Y.declarations=[],Y.kind="var";;){var fe=Et();if(fe.id=fi(),me&&On(fe.id.name)&&ye(fe.id.start,"Binding "+fe.id.name+" in strict mode"),fe.init=vt(n)?At(!0,ne):null,Y.declarations.push(Je(fe,"VariableDeclarator")),!vt(qt))break}return Y}function At(Y,ne){var fe=cr(ne);if(!Y&&j===qt){var be=ci(fe);for(be.expressions=[fe];vt(qt);)be.expressions.push(cr(ne));return Je(be,"SequenceExpression")}return fe}function cr(Y){var ne=Va(Y);if(j.isAssign){var fe=ci(ne);return fe.operator=J,fe.left=ne,tt(),fe.right=cr(Y),Vn(ne),Je(fe,"AssignmentExpression")}return ne}function Va(Y){var ne=Fa(Y);if(vt($i)){var fe=ci(ne);return fe.test=ne,fe.consequent=At(!0),wt(ti),fe.alternate=At(!0,Y),Je(fe,"ConditionalExpression")}return ne}function Fa(Y){return fr(dr(),-1,Y)}function fr(Y,ne,fe){var be=j.binop;if(be!=null&&(!fe||j!==Ni)&&be>ne){var He=ci(Y);He.left=Y,He.operator=J;var We=j;tt(),He.right=fr(dr(),be,fe);var Xe=Je(He,We===W||We===ue?"LogicalExpression":"BinaryExpression");return fr(Xe,ne,fe)}return Y}function dr(){if(j.prefix){var Y=Et(),ne=j.isUpdate;return Y.operator=J,Y.prefix=!0,ie=!0,tt(),Y.argument=dr(),ne?Vn(Y.argument):me&&Y.operator==="delete"&&Y.argument.type==="Identifier"&&ye(Y.start,"Deleting local variable in strict mode"),Je(Y,ne?"UpdateExpression":"UnaryExpression")}for(var fe=Ba();j.postfix&&!Dn();){var Y=ci(fe);Y.operator=J,Y.prefix=!1,Y.argument=fe,Vn(fe),tt(),fe=Je(Y,"UpdateExpression")}return fe}function Ba(){return rn(pr())}function rn(Y,ne){if(vt(Qi)){var fe=ci(Y);return fe.object=Y,fe.property=fi(!0),fe.computed=!1,rn(Je(fe,"MemberExpression"),ne)}else if(vt(bi)){var fe=ci(Y);return fe.object=Y,fe.property=At(),fe.computed=!0,wt(wi),rn(Je(fe,"MemberExpression"),ne)}else if(!ne&&vt(Ze)){var fe=ci(Y);return fe.callee=Y,fe.arguments=mr(Vt,!1),rn(Je(fe,"CallExpression"),ne)}else return Y}function pr(){switch(j){case Yi:var be=Et();return tt(),Je(be,"ThisExpression");case Be:return fi();case De:case Ue:case Re:var be=Et();return be.value=J,be.raw=I.slice(G,Z),tt(),Je(be,"Literal");case Tn:case Mn:case Ln:var be=Et();return be.value=j.atomValue,be.raw=j.keyword,tt(),Je(be,"Literal");case Ze:var Y=K,ne=G;tt();var fe=At();return fe.start=ne,fe.end=Z,V.locations&&(fe.loc.start=Y,fe.loc.end=ee),V.ranges&&(fe.range=[ne,Z]),wt(Vt),fe;case bi:var be=Et();return tt(),be.elements=mr(wi,!0,!0),Je(be,"ArrayExpression");case ei:return qa();case Nt:var be=Et();return tt(),gr(be,!1);case An:return Ua();default:ni()}}function Ua(){var Y=Et();return tt(),Y.callee=rn(pr(),!0),vt(Ze)?Y.arguments=mr(Vt,!1):Y.arguments=Le,Je(Y,"NewExpression")}function qa(){var Y=Et(),ne=!0,fe=!1;for(Y.properties=[],tt();!vt(Ut);){if(ne)ne=!1;else if(wt(qt),V.allowTrailingCommas&&vt(Ut))break;var be={key:ls()},He=!1,We;if(vt(ti)?(be.value=At(!0),We=be.kind="init"):V.ecmaVersion>=5&&be.key.type==="Identifier"&&(be.key.name==="get"||be.key.name==="set")?(He=fe=!0,We=be.kind=be.key.name,be.key=ls(),j!==Ze&&ni(),be.value=gr(Et(),!1)):ni(),be.key.type==="Identifier"&&(me||fe))for(var Xe=0;Xe<Y.properties.length;++Xe){var rt=Y.properties[Xe];if(rt.key.name===be.key.name){var Zt=We==rt.kind||He&&rt.kind==="init"||We==="init"&&(rt.kind==="get"||rt.kind==="set");Zt&&!me&&We==="init"&&rt.kind==="init"&&(Zt=!1),Zt&&ye(be.key.start,"Redefinition of property")}}Y.properties.push(be)}return Je(Y,"ObjectExpression")}function ls(){return j===De||j===Ue?pr():fi(!0)}function gr(Y,ne){j===Be?Y.id=fi():ne?ni():Y.id=null,Y.params=[];var fe=!0;for(wt(Ze);!vt(Vt);)fe?fe=!1:wt(qt),Y.params.push(fi());var be=Me,He=Ne;if(Me=!0,Ne=[],Y.body=nn(!0),Me=be,Ne=He,me||Y.body.body.length&&ur(Y.body.body[0]))for(var We=Y.id?-1:0;We<Y.params.length;++We){var Xe=We<0?Y.id:Y.params[We];if((Qr(Xe.name)||On(Xe.name))&&ye(Xe.start,"Defining '"+Xe.name+"' in strict mode"),We>=0)for(var rt=0;rt<We;++rt)Xe.name===Y.params[rt].name&&ye(Xe.start,"Argument name clash in strict mode")}return Je(Y,ne?"FunctionDeclaration":"FunctionExpression")}function mr(Y,ne,fe){for(var be=[],He=!0;!vt(Y);){if(He)He=!1;else if(wt(qt),ne&&V.allowTrailingCommas&&vt(Y))break;fe&&j===qt?be.push(null):be.push(At(!0))}return be}function fi(Y){var ne=Et();return Y&&V.forbidReserved=="everywhere"&&(Y=!1),j===Be?(!Y&&(V.forbidReserved&&(V.ecmaVersion===3?hi:li)(J)||me&&Qr(J))&&I.slice(G,Z).indexOf("\\")==-1&&ye(G,"The keyword '"+J+"' is reserved"),ne.name=J):Y&&j.keyword?ne.name=j.keyword:ni(),ie=!1,tt(),Je(ne,"Identifier")}}),i.version||(i=null)}function c(O,V){return(e.acorn||i).parse(O,V)}var g={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},m={"-":"__negate","+":"__self"},v=o.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(O){this["__"+O]="#"+O},{__self:function(){return this}});L.inject(v),X.inject(v),dt.inject(v);function y(O,V,I){var R=g[V];if(O&&O[R]){var w=O[R](I);return V==="!="?!w:w}switch(V){case"+":return O+I;case"-":return O-I;case"*":return O*I;case"/":return O/I;case"%":return O%I;case"==":return O==I;case"!=":return O!=I}}function x(O,V){var I=m[O];if(V&&V[I])return V[I]();switch(O){case"+":return+V;case"-":return-V}}function E(O,V){if(!O)return"";V=V||{};var I=[];function R(me){for(var ye=0,Le=I.length;ye<Le;ye++){var De=I[ye];if(De[0]>=me)break;me+=De[1]}return me}function w(me){return O.substring(R(me.range[0]),R(me.range[1]))}function N(me,ye){return O.substring(R(me.range[1]),R(ye.range[0]))}function U(me,ye){for(var Le=R(me.range[0]),De=R(me.range[1]),Re=0,Ue=I.length-1;Ue>=0;Ue--)if(Le>I[Ue][0]){Re=Ue+1;break}I.splice(Re,0,[Le,ye.length-De+Le]),O=O.substring(0,Le)+ye+O.substring(De)}function q(me,ye){switch(me.type){case"UnaryExpression":if(me.operator in m&&me.argument.type!=="Literal"){var Le=w(me.argument);U(me,'$__("'+me.operator+'", '+Le+")")}break;case"BinaryExpression":if(me.operator in g&&me.left.type!=="Literal"){var De=w(me.left),Re=w(me.right),Ue=N(me.left,me.right),Be=me.operator;U(me,"__$__("+De+","+Ue.replace(new RegExp("\\"+Be),'"'+Be+'"')+", "+Re+")")}break;case"UpdateExpression":case"AssignmentExpression":var je=ye&&ye.type;if(!(je==="ForStatement"||je==="BinaryExpression"&&/^[=!<>]/.test(ye.operator)||je==="MemberExpression"&&ye.computed)){if(me.type==="UpdateExpression"){var Le=w(me.argument),Ke="__$__("+Le+', "'+me.operator[0]+'", 1)',qe=Le+" = "+Ke;me.prefix?qe="("+qe+")":(je==="AssignmentExpression"||je==="VariableDeclarator"||je==="BinaryExpression")&&(w(ye.left||ye.id)===Le&&(qe=Ke),qe=Le+"; "+qe),U(me,qe)}else if(/^.=$/.test(me.operator)&&me.left.type!=="Literal"){var De=w(me.left),Re=w(me.right),Ke=De+" = __$__("+De+', "'+me.operator[0]+'", '+Re+")";U(me,/^\(.*\)$/.test(w(me))?"("+Ke+")":Ke)}}break}}function D(me){switch(me.type){case"ExportDefaultDeclaration":U({range:[me.start,me.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var ye=me.declaration,Le=me.specifiers;if(ye){var De=ye.declarations;De&&(De.forEach(function(Ue){U(Ue,"module.exports."+w(Ue))}),U({range:[me.start,ye.start+ye.kind.length]},""))}else if(Le){var Re=Le.map(function(Ue){var Be=w(Ue);return"module.exports."+Be+" = "+Be+"; "}).join("");Re&&U(me,Re)}break}}function G(me,ye,Le){if(me){for(var De in me)if(De!=="range"&&De!=="loc"){var Re=me[De];if(Array.isArray(Re))for(var Ue=0,Be=Re.length;Ue<Be;Ue++)G(Re[Ue],me,Le);else Re&&typeof Re=="object"&&G(Re,me,Le)}Le.operatorOverloading!==!1&&q(me,ye),Le.moduleExports!==!1&&D(me)}}function Z(me){var ye="",Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(me=(Math.abs(me)<<1)+(me<0?1:0);me||!ye;){var De=me&31;me>>=5,me&&(De|=32),ye+=Le[De]}return ye}var K=V.url||"",ee=V.sourceMaps,j=V.paperFeatures||{},J=V.source||O,ie=V.offset||0,se=Qe.agent,ae=se.versionNumber,le=!1,we=/\r\n|\n|\r/mg,Ee;if(ee&&(se.chrome&&ae>=30||se.webkit&&ae>=537.76||se.firefox&&ae>=23||se.node)){if(se.node)ie-=2;else if(l&&K&&!l.location.href.indexOf(K)){var Me=f.getElementsByTagName("html")[0].innerHTML;ie=Me.substr(0,Me.indexOf(O)+1).match(we).length+1}le=ie>0&&!(se.chrome&&ae>=36||se.safari&&ae>=600||se.firefox&&ae>=40||se.node);var Ne=["AA"+Z(le?0:ie)+"A"];Ne.length=(O.match(we)||[]).length+1+(le?ie:0),Ee={version:3,file:K,names:[],mappings:Ne.join(";AACA"),sourceRoot:"",sources:[K],sourcesContent:[J]}}return(j.operatorOverloading!==!1||j.moduleExports!==!1)&&G(c(O,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,j),Ee&&(le&&(O=new Array(ie+1).join(`
`)+O),/^(inline|both)$/.test(ee)&&(O+=`
//# sourceMappingURL=data:application/json;base64,`+s.btoa(unescape(encodeURIComponent(JSON.stringify(Ee))))),O+=`
//# sourceURL=`+(K||"paperscript")),{url:K,source:J,code:O,map:Ee}}function A(O,V,I){Qe=V;var R=V.getView(),w=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(O)&&!/\bnew\s+Tool\b/.test(O)?new yi:null,N=w?w._events:[],U=["onFrame","onResize"].concat(N),q=[],D=[],G,Z=typeof O=="object"?O:E(O,I);O=Z.code;function K(ae,le){for(var we in ae)(le||!/^_/.test(we))&&new RegExp("([\\b\\s\\W]|^)"+we.replace(/\$/g,"\\$")+"\\b").test(O)&&(q.push(we),D.push(ae[we]))}K({__$__:y,$__:x,paper:V,tool:w},!0),K(V),O="var module = { exports: {} }; "+O;var ie=o.each(U,function(ae){new RegExp("\\s+"+ae+"\\b").test(O)&&(q.push(ae),this.push("module.exports."+ae+" = "+ae+";"))},[]).join(`
`);ie&&(O+=`
`+ie),O+=`
return module.exports;`;var ee=Qe.agent;if(f&&(ee.chrome||ee.firefox&&ee.versionNumber<40)){var j=f.createElement("script"),J=f.head||f.getElementsByTagName("head")[0];ee.firefox&&(O=`
`+O),j.appendChild(f.createTextNode("document.__paperscript__ = function("+q+") {"+O+`
}`)),J.appendChild(j),G=f.__paperscript__,delete f.__paperscript__,J.removeChild(j)}else G=Function(q,O);var ie=G&&G.apply(V,D),se=ie||{};return o.each(N,function(ae){var le=se[ae];le&&(w[ae]=le)}),R&&(se.onResize&&R.setOnResize(se.onResize),R.emit("resize",{size:R.size,delta:new L}),se.onFrame&&R.setOnFrame(se.onFrame),R.requestUpdate()),ie}function P(O){if(/^text\/(?:x-|)paperscript$/.test(O.type)&&_.getAttribute(O,"ignore")!=="true"){var V=_.getAttribute(O,"canvas"),I=f.getElementById(V),R=O.src||O.getAttribute("data-src"),w=_.hasAttribute(O,"async"),N="data-paper-scope";if(!I)throw new Error('Unable to find canvas with id "'+V+'"');var U=_.get(I.getAttribute(N))||new _().setup(I);return I.setAttribute(N,U._id),R?zi.request({url:R,async:w,mimeType:"text/plain",onLoad:function(q){A(q,U,R)}}):A(O.innerHTML,U,O.baseURI),O.setAttribute("data-paper-ignore","true"),U}}function C(){o.each(f&&f.getElementsByTagName("script"),P)}function B(O){return O?P(O):C()}return l&&(f.readyState==="complete"?setTimeout(C):ut.add(l,{load:C})),{compile:E,execute:A,load:B,parse:c,calculateBinary:y,calculateUnary:x}}).call(this);var Qe=new(_.inject(o.exports,{Base:o,Numerical:M,Key:_i,DomEvent:ut,DomElement:at,document:f,window:l,Symbol:Ce,PlacedSymbol:Ie}));return Qe.agent.node&&ds(Qe),typeof a=="function"&&a.amd?a("paper",Qe):u&&(u.exports=Qe),Qe}).call(to,typeof self=="object"?self:null)})(Wn)),Wn.exports}var no=io();const Ve=Gr(no);function ro(u){const s=[];if(u.segments.length===0)return s;const a=u.segments[0],l={type:"move",p:[a.point.x,a.point.y]};s.push(l);for(let f=1;f<u.segments.length;f++){const o=u.segments[f-1],d=u.segments[f];if(o.handleOut&&o.handleOut.length>0||d.handleIn&&d.handleIn.length>0){const b=o.handleOut?[o.point.x+o.handleOut.x,o.point.y+o.handleOut.y]:[o.point.x,o.point.y],S=d.handleIn?[d.point.x+d.handleIn.x,d.point.y+d.handleIn.y]:[d.point.x,d.point.y],z={type:"bezier",p1:b,p2:S,p3:[d.point.x,d.point.y]};s.push(z)}else{const b={type:"line",p:[d.point.x,d.point.y]};s.push(b)}}return s}function Nr(u){const s=new Ve.Path;if(u.length===0)return s;let a=null;for(const l of u)switch(l.type){case"move":{const[f,o]=l.p;a=new Ve.Point(f,o),s.moveTo(a);break}case"line":{const[f,o]=l.p;a=new Ve.Point(f,o),s.lineTo(a);break}case"bezier":{if(!a){console.warn("paperUtils: CurveTo command without a current point, skipping");break}const[f,o]=l.p1,[d,_]=l.p2,[b,S]=l.p3,z=new Ve.Point(b,S),M=new Ve.Point(f,o),H=new Ve.Point(d,_);s.add(z);const L=s.lastSegment,Q=H.subtract(z);if(L.handleIn=Q,s.segments.length>=2){const X=M.subtract(a);s.segments[s.segments.length-2].handleOut=X}a=z;break}case"arc":console.warn("paperUtils: Arc commands not yet supported, skipping arc command");break}return s}function so(u,s){const a=new Ve.Group,l=Nr(u.borderPath);l.strokeColor=new Ve.Color(s),l.strokeWidth=1,l.data.isBorder=!0,a.addChild(l);for(const f of u.pieces.values()){const o=ao(f,u);o.strokeColor=new Ve.Color(s),o.strokeWidth=1,o.data.pieceId=f.id,a.addChild(o)}return a}function ao(u,s){const a=new Ve.Path;let l=s.halfEdges.get(u.halfEdge);if(!l)return a;const f=l.id;a.moveTo(new Ve.Point(l.origin[0],l.origin[1]));do{if(l.segments)for(const o of l.segments)oo(a,o);else{const o=s.halfEdges.get(l.next);a.lineTo(new Ve.Point(o.origin[0],o.origin[1]))}l=s.halfEdges.get(l.next)}while(l.id!==f);return a}function oo(u,s){switch(s.type){case"line":{u.lineTo(new Ve.Point(s.p[0],s.p[1]));break}case"bezier":{u.cubicCurveTo(new Ve.Point(s.p1[0],s.p1[1]),new Ve.Point(s.p2[0],s.p2[1]),new Ve.Point(s.p3[0],s.p3[1]));break}}}function uo(u,s,a){if(s.removeChildren(),!!a)for(const l of u.pieces.values()){const[f,o]=l.site,d=new Ve.Path.Circle(new Ve.Point(f,o),3);d.fillColor=new Ve.Color(a),d.data.pieceId=l.id,s.addChild(d)}}function ho(u,s){if(s.removeChildren(),!(!u.problems||u.problems.length===0))for(const a of u.problems){const[l,f]=a,o=new Ve.Path.Circle(new Ve.Point(l,f),8);o.strokeColor=new Ve.Color("red"),o.strokeWidth=2,s.addChild(o)}}function lo(u,s){return s()}async function co(u,s){return s()}function fo(u,s,a){Ve.setup(u),Ve.view.viewSize=new Ve.Size(s,a)}function Kn(u,s,a,l){lo("Paper.js Rendering",()=>{u.paperPath&&(u.paperPath.remove(),u.paperPath=null),u.paperPath=so(s,a),go(s,u),u.seedPointItems&&uo(s,u.seedPointItems,l),u.problemItems&&ho(s,u.problemItems)})}function po(u){u.seedPointItems=new Ve.Group,u.problemItems=new Ve.Group,u.vertexItems=new Ve.Group}function Xs(u){const s=new Set;for(const a of u.halfEdges.values())if(a.twin===-1){const l=u.vertices.findIndex(f=>f[0]===a.origin[0]&&f[1]===a.origin[1]);l>=0&&s.add(l)}return s}function go(u,s){if(!s.vertexItems)return;s.vertexItems.removeChildren();const a=Xs(u);for(let l=0;l<u.vertices.length;l++){if(a.has(l))continue;const[f,o]=u.vertices[l],d=new Ve.Path.Circle(new Ve.Point(f,o),4);d.fillColor=new Ve.Color("#4363d8"),d.strokeColor=new Ve.Color("#ffffff"),d.strokeWidth=1,d.visible=!1,d.data.vertexId=l,s.vertexItems.addChild(d)}}function mo(u){u.paperPath&&(u.paperPath.remove(),u.paperPath=null),u.seedPointItems&&(u.seedPointItems.remove(),u.seedPointItems=null),u.problemItems&&(u.problemItems.remove(),u.problemItems=null),u.vertexItems&&(u.vertexItems.remove(),u.vertexItems=null),Ve.project&&Ve.project.remove()}class rr{generators=new Map;register(s,a,l){this.generators.has(s)&&console.warn(`Generator "${s}" is already registered, overwriting`),this.generators.set(s,{factory:a,uiMetadata:l})}create(s,a,l){const f=this.generators.get(l.name);if(!f)throw new Error(`Unknown generator "${l.name}". Is it registered?`);return f.factory(s,a,l)}getAvailableGenerators(){return Array.from(this.generators.values()).sort((s,a)=>s.uiMetadata.sortHint-a.uiMetadata.sortHint).map(s=>({name:s.uiMetadata.name,displayName:s.uiMetadata.displayName}))}getUIMetadata(s){return this.generators.get(s)?.uiMetadata}getDefaultConfig(s,a,l){const f={name:s,width:a,height:l},o=this.getUIMetadata(s);if(o)for(const d of o.controls)f[d.name]=d.defaultValue;return f}}const bn=new rr,wn=new rr,Sn=new rr,Li=new rr;let vo=0;function Ks(){return vo++}const{abs:sn,cos:ri,sin:Fi,acos:_o,atan2:an,sqrt:di,pow:Ht}=Math;function on(u){return u<0?-Ht(-u,1/3):Ht(u,1/3)}const Ys=Math.PI,Bn=2*Ys,pi=Ys/2,yo=1e-6,_r=Number.MAX_SAFE_INTEGER||9007199254740991,yr=Number.MIN_SAFE_INTEGER||-9007199254740991,xo={x:0,y:0,z:0},Te={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(u,s){const a=s(u);let l=a.x*a.x+a.y*a.y;return typeof a.z<"u"&&(l+=a.z*a.z),di(l)},compute:function(u,s,a){if(u===0)return s[0].t=0,s[0];const l=s.length-1;if(u===1)return s[l].t=1,s[l];const f=1-u;let o=s;if(l===0)return s[0].t=u,s[0];if(l===1){const _={x:f*o[0].x+u*o[1].x,y:f*o[0].y+u*o[1].y,t:u};return a&&(_.z=f*o[0].z+u*o[1].z),_}if(l<4){let _=f*f,b=u*u,S,z,M,H=0;l===2?(o=[o[0],o[1],o[2],xo],S=_,z=f*u*2,M=b):l===3&&(S=_*f,z=_*u*3,M=f*b*3,H=u*b);const L={x:S*o[0].x+z*o[1].x+M*o[2].x+H*o[3].x,y:S*o[0].y+z*o[1].y+M*o[2].y+H*o[3].y,t:u};return a&&(L.z=S*o[0].z+z*o[1].z+M*o[2].z+H*o[3].z),L}const d=JSON.parse(JSON.stringify(s));for(;d.length>1;){for(let _=0;_<d.length-1;_++)d[_]={x:d[_].x+(d[_+1].x-d[_].x)*u,y:d[_].y+(d[_+1].y-d[_].y)*u},typeof d[_].z<"u"&&(d[_].z=d[_].z+(d[_+1].z-d[_].z)*u);d.splice(d.length-1,1)}return d[0].t=u,d[0]},computeWithRatios:function(u,s,a,l){const f=1-u,o=a,d=s;let _=o[0],b=o[1],S=o[2],z=o[3],M;if(_*=f,b*=u,d.length===2)return M=_+b,{x:(_*d[0].x+b*d[1].x)/M,y:(_*d[0].y+b*d[1].y)/M,z:l?(_*d[0].z+b*d[1].z)/M:!1,t:u};if(_*=f,b*=2*f,S*=u*u,d.length===3)return M=_+b+S,{x:(_*d[0].x+b*d[1].x+S*d[2].x)/M,y:(_*d[0].y+b*d[1].y+S*d[2].y)/M,z:l?(_*d[0].z+b*d[1].z+S*d[2].z)/M:!1,t:u};if(_*=f,b*=1.5*f,S*=3*f,z*=u*u*u,d.length===4)return M=_+b+S+z,{x:(_*d[0].x+b*d[1].x+S*d[2].x+z*d[3].x)/M,y:(_*d[0].y+b*d[1].y+S*d[2].y+z*d[3].y)/M,z:l?(_*d[0].z+b*d[1].z+S*d[2].z+z*d[3].z)/M:!1,t:u}},derive:function(u,s){const a=[];for(let l=u,f=l.length,o=f-1;f>1;f--,o--){const d=[];for(let _=0,b;_<o;_++)b={x:o*(l[_+1].x-l[_].x),y:o*(l[_+1].y-l[_].y)},s&&(b.z=o*(l[_+1].z-l[_].z)),d.push(b);a.push(d),l=d}return a},between:function(u,s,a){return s<=u&&u<=a||Te.approximately(u,s)||Te.approximately(u,a)},approximately:function(u,s,a){return sn(u-s)<=(a||yo)},length:function(u){const a=Te.Tvalues.length;let l=0;for(let f=0,o;f<a;f++)o=.5*Te.Tvalues[f]+.5,l+=Te.Cvalues[f]*Te.arcfn(o,u);return .5*l},map:function(u,s,a,l,f){const o=a-s,d=f-l,_=u-s,b=_/o;return l+d*b},lerp:function(u,s,a){const l={x:s.x+u*(a.x-s.x),y:s.y+u*(a.y-s.y)};return s.z!==void 0&&a.z!==void 0&&(l.z=s.z+u*(a.z-s.z)),l},pointToString:function(u){let s=u.x+"/"+u.y;return typeof u.z<"u"&&(s+="/"+u.z),s},pointsToString:function(u){return"["+u.map(Te.pointToString).join(", ")+"]"},copy:function(u){return JSON.parse(JSON.stringify(u))},angle:function(u,s,a){const l=s.x-u.x,f=s.y-u.y,o=a.x-u.x,d=a.y-u.y,_=l*d-f*o,b=l*o+f*d;return an(_,b)},round:function(u,s){const a=""+u,l=a.indexOf(".");return parseFloat(a.substring(0,l+1+s))},dist:function(u,s){const a=u.x-s.x,l=u.y-s.y;return di(a*a+l*l)},closest:function(u,s){let a=Ht(2,63),l,f;return u.forEach(function(o,d){f=Te.dist(s,o),f<a&&(a=f,l=d)}),{mdist:a,mpos:l}},abcratio:function(u,s){if(s!==2&&s!==3)return!1;if(typeof u>"u")u=.5;else if(u===0||u===1)return u;const a=Ht(u,s)+Ht(1-u,s),l=a-1;return sn(l/a)},projectionratio:function(u,s){if(s!==2&&s!==3)return!1;if(typeof u>"u")u=.5;else if(u===0||u===1)return u;const a=Ht(1-u,s),l=Ht(u,s)+a;return a/l},lli8:function(u,s,a,l,f,o,d,_){const b=(u*l-s*a)*(f-d)-(u-a)*(f*_-o*d),S=(u*l-s*a)*(o-_)-(s-l)*(f*_-o*d),z=(u-a)*(o-_)-(s-l)*(f-d);return z==0?!1:{x:b/z,y:S/z}},lli4:function(u,s,a,l){const f=u.x,o=u.y,d=s.x,_=s.y,b=a.x,S=a.y,z=l.x,M=l.y;return Te.lli8(f,o,d,_,b,S,z,M)},lli:function(u,s){return Te.lli4(u,u.c,s,s.c)},makeline:function(u,s){return new ft(u.x,u.y,(u.x+s.x)/2,(u.y+s.y)/2,s.x,s.y)},findbbox:function(u){let s=_r,a=_r,l=yr,f=yr;return u.forEach(function(o){const d=o.bbox();s>d.x.min&&(s=d.x.min),a>d.y.min&&(a=d.y.min),l<d.x.max&&(l=d.x.max),f<d.y.max&&(f=d.y.max)}),{x:{min:s,mid:(s+l)/2,max:l,size:l-s},y:{min:a,mid:(a+f)/2,max:f,size:f-a}}},shapeintersections:function(u,s,a,l,f){if(!Te.bboxoverlap(s,l))return[];const o=[],d=[u.startcap,u.forward,u.back,u.endcap],_=[a.startcap,a.forward,a.back,a.endcap];return d.forEach(function(b){b.virtual||_.forEach(function(S){if(S.virtual)return;const z=b.intersects(S,f);z.length>0&&(z.c1=b,z.c2=S,z.s1=u,z.s2=a,o.push(z))})}),o},makeshape:function(u,s,a){const l=s.points.length,f=u.points.length,o=Te.makeline(s.points[l-1],u.points[0]),d=Te.makeline(u.points[f-1],s.points[0]),_={startcap:o,forward:u,back:s,endcap:d,bbox:Te.findbbox([o,u,s,d])};return _.intersections=function(b){return Te.shapeintersections(_,_.bbox,b,b.bbox,a)},_},getminmax:function(u,s,a){if(!a)return{min:0,max:0};let l=_r,f=yr,o,d;a.indexOf(0)===-1&&(a=[0].concat(a)),a.indexOf(1)===-1&&a.push(1);for(let _=0,b=a.length;_<b;_++)o=a[_],d=u.get(o),d[s]<l&&(l=d[s]),d[s]>f&&(f=d[s]);return{min:l,mid:(l+f)/2,max:f,size:f-l}},align:function(u,s){const a=s.p1.x,l=s.p1.y,f=-an(s.p2.y-l,s.p2.x-a),o=function(d){return{x:(d.x-a)*ri(f)-(d.y-l)*Fi(f),y:(d.x-a)*Fi(f)+(d.y-l)*ri(f)}};return u.map(o)},roots:function(u,s){s=s||{p1:{x:0,y:0},p2:{x:1,y:0}};const a=u.length-1,l=Te.align(u,s),f=function(ve){return 0<=ve&&ve<=1};if(a===2){const ve=l[0].y,xe=l[1].y,de=l[2].y,Se=ve-2*xe+de;if(Se!==0){const Ie=-di(xe*xe-ve*de),Ce=-ve+xe,ze=-(Ie+Ce)/Se,Pe=-(-Ie+Ce)/Se;return[ze,Pe].filter(f)}else if(xe!==de&&Se===0)return[(2*xe-de)/(2*xe-2*de)].filter(f);return[]}const o=l[0].y,d=l[1].y,_=l[2].y,b=l[3].y;let S=-o+3*d-3*_+b,z=3*o-6*d+3*_,M=-3*o+3*d,H=o;if(Te.approximately(S,0)){if(Te.approximately(z,0))return Te.approximately(M,0)?[]:[-H/M].filter(f);const ve=di(M*M-4*z*H),xe=2*z;return[(ve-M)/xe,(-M-ve)/xe].filter(f)}z/=S,M/=S,H/=S;const L=(3*M-z*z)/3,Q=L/3,X=(2*z*z*z-9*z*M+27*H)/27,te=X/2,$=te*te+Q*Q*Q;let pe,re,_e,he,T;if($<0){const ve=-L/3,xe=ve*ve*ve,de=di(xe),Se=-X/(2*de),Ie=Se<-1?-1:Se>1?1:Se,Ce=_o(Ie),ze=on(de),Pe=2*ze;return _e=Pe*ri(Ce/3)-z/3,he=Pe*ri((Ce+Bn)/3)-z/3,T=Pe*ri((Ce+2*Bn)/3)-z/3,[_e,he,T].filter(f)}else{if($===0)return pe=te<0?on(-te):-on(te),_e=2*pe-z/3,he=-pe-z/3,[_e,he].filter(f);{const ve=di($);return pe=on(-te+ve),re=on(te+ve),[pe-re-z/3].filter(f)}}},droots:function(u){if(u.length===3){const s=u[0],a=u[1],l=u[2],f=s-2*a+l;if(f!==0){const o=-di(a*a-s*l),d=-s+a,_=-(o+d)/f,b=-(-o+d)/f;return[_,b]}else if(a!==l&&f===0)return[(2*a-l)/(2*(a-l))];return[]}if(u.length===2){const s=u[0],a=u[1];return s!==a?[s/(s-a)]:[]}return[]},curvature:function(u,s,a,l,f){let o,d,_,b,S=0,z=0;const M=Te.compute(u,s),H=Te.compute(u,a),L=M.x*M.x+M.y*M.y;if(l?(o=di(Ht(M.y*H.z-H.y*M.z,2)+Ht(M.z*H.x-H.z*M.x,2)+Ht(M.x*H.y-H.x*M.y,2)),d=Ht(L+M.z*M.z,3/2)):(o=M.x*H.y-M.y*H.x,d=Ht(L,3/2)),o===0||d===0)return{k:0,r:0};if(S=o/d,z=d/o,!f){const Q=Te.curvature(u-.001,s,a,l,!0).k,X=Te.curvature(u+.001,s,a,l,!0).k;b=(X-S+(S-Q))/2,_=(sn(X-S)+sn(S-Q))/2}return{k:S,r:z,dk:b,adk:_}},inflections:function(u){if(u.length<4)return[];const s=Te.align(u,{p1:u[0],p2:u.slice(-1)[0]}),a=s[2].x*s[1].y,l=s[3].x*s[1].y,f=s[1].x*s[2].y,o=s[3].x*s[2].y,d=18*(-3*a+2*l+3*f-o),_=18*(3*a-l-3*f),b=18*(f-a);if(Te.approximately(d,0)){if(!Te.approximately(_,0)){let H=-b/_;if(0<=H&&H<=1)return[H]}return[]}const S=2*d;if(Te.approximately(S,0))return[];const z=_*_-4*d*b;if(z<0)return[];const M=Math.sqrt(z);return[(M-_)/S,-(_+M)/S].filter(function(H){return 0<=H&&H<=1})},bboxoverlap:function(u,s){const a=["x","y"],l=a.length;for(let f=0,o,d,_,b;f<l;f++)if(o=a[f],d=u[o].mid,_=s[o].mid,b=(u[o].size+s[o].size)/2,sn(d-_)>=b)return!1;return!0},expandbox:function(u,s){s.x.min<u.x.min&&(u.x.min=s.x.min),s.y.min<u.y.min&&(u.y.min=s.y.min),s.z&&s.z.min<u.z.min&&(u.z.min=s.z.min),s.x.max>u.x.max&&(u.x.max=s.x.max),s.y.max>u.y.max&&(u.y.max=s.y.max),s.z&&s.z.max>u.z.max&&(u.z.max=s.z.max),u.x.mid=(u.x.min+u.x.max)/2,u.y.mid=(u.y.min+u.y.max)/2,u.z&&(u.z.mid=(u.z.min+u.z.max)/2),u.x.size=u.x.max-u.x.min,u.y.size=u.y.max-u.y.min,u.z&&(u.z.size=u.z.max-u.z.min)},pairiteration:function(u,s,a){const l=u.bbox(),f=s.bbox(),o=1e5,d=a||.5;if(l.x.size+l.y.size<d&&f.x.size+f.y.size<d)return[(o*(u._t1+u._t2)/2|0)/o+"/"+(o*(s._t1+s._t2)/2|0)/o];let _=u.split(.5),b=s.split(.5),S=[{left:_.left,right:b.left},{left:_.left,right:b.right},{left:_.right,right:b.right},{left:_.right,right:b.left}];S=S.filter(function(M){return Te.bboxoverlap(M.left.bbox(),M.right.bbox())});let z=[];return S.length===0||(S.forEach(function(M){z=z.concat(Te.pairiteration(M.left,M.right,d))}),z=z.filter(function(M,H){return z.indexOf(M)===H})),z},getccenter:function(u,s,a){const l=s.x-u.x,f=s.y-u.y,o=a.x-s.x,d=a.y-s.y,_=l*ri(pi)-f*Fi(pi),b=l*Fi(pi)+f*ri(pi),S=o*ri(pi)-d*Fi(pi),z=o*Fi(pi)+d*ri(pi),M=(u.x+s.x)/2,H=(u.y+s.y)/2,L=(s.x+a.x)/2,Q=(s.y+a.y)/2,X=M+_,te=H+b,$=L+S,pe=Q+z,re=Te.lli8(M,H,X,te,L,Q,$,pe),_e=Te.dist(re,u);let he=an(u.y-re.y,u.x-re.x),T=an(s.y-re.y,s.x-re.x),ve=an(a.y-re.y,a.x-re.x),xe;return he<ve?((he>T||T>ve)&&(he+=Bn),he>ve&&(xe=ve,ve=he,he=xe)):ve<T&&T<he?(xe=ve,ve=he,he=xe):ve+=Bn,re.s=he,re.e=ve,re.r=_e,re},numberSort:function(u,s){return u-s}};class dn{constructor(s){this.curves=[],this._3d=!1,s&&(this.curves=s,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(s){return Te.pointsToString(s.points)}).join(", ")+"]"}addCurve(s){this.curves.push(s),this._3d=this._3d||s._3d}length(){return this.curves.map(function(s){return s.length()}).reduce(function(s,a){return s+a})}curve(s){return this.curves[s]}bbox(){const s=this.curves;for(var a=s[0].bbox(),l=1;l<s.length;l++)Te.expandbox(a,s[l].bbox());return a}offset(s){const a=[];return this.curves.forEach(function(l){a.push(...l.offset(s))}),new dn(a)}}const{abs:un,min:ms,max:vs,cos:bo,sin:wo,acos:So,sqrt:hn}=Math,Co=Math.PI;class ft{constructor(s){let a=s&&s.forEach?s:Array.from(arguments).slice(),l=!1;if(typeof a[0]=="object"){l=a.length;const L=[];a.forEach(function(Q){["x","y","z"].forEach(function(X){typeof Q[X]<"u"&&L.push(Q[X])})}),a=L}let f=!1;const o=a.length;if(l){if(l>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");f=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const d=this._3d=!f&&(o===9||o===12)||s&&s[0]&&typeof s[0].z<"u",_=this.points=[];for(let L=0,Q=d?3:2;L<o;L+=Q){var b={x:a[L],y:a[L+1]};d&&(b.z=a[L+2]),_.push(b)}const S=this.order=_.length-1,z=this.dims=["x","y"];d&&z.push("z"),this.dimlen=z.length;const M=Te.align(_,{p1:_[0],p2:_[S]}),H=Te.dist(_[0],_[S]);this._linear=M.reduce((L,Q)=>L+un(Q.y),0)<H/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(s,a,l,f){if(typeof f>"u"&&(f=.5),f===0)return new ft(a,a,l);if(f===1)return new ft(s,a,a);const o=ft.getABC(2,s,a,l,f);return new ft(s,o.A,l)}static cubicFromPoints(s,a,l,f,o){typeof f>"u"&&(f=.5);const d=ft.getABC(3,s,a,l,f);typeof o>"u"&&(o=Te.dist(a,d.C));const _=o*(1-f)/f,b=Te.dist(s,l),S=(l.x-s.x)/b,z=(l.y-s.y)/b,M=o*S,H=o*z,L=_*S,Q=_*z,X={x:a.x-M,y:a.y-H},te={x:a.x+L,y:a.y+Q},$=d.A,pe={x:$.x+(X.x-$.x)/(1-f),y:$.y+(X.y-$.y)/(1-f)},re={x:$.x+(te.x-$.x)/f,y:$.y+(te.y-$.y)/f},_e={x:s.x+(pe.x-s.x)/f,y:s.y+(pe.y-s.y)/f},he={x:l.x+(re.x-l.x)/(1-f),y:l.y+(re.y-l.y)/(1-f)};return new ft(s,_e,he,l)}static getUtils(){return Te}getUtils(){return ft.getUtils()}static get PolyBezier(){return dn}valueOf(){return this.toString()}toString(){return Te.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const s=this.points,a=s[0].x,l=s[0].y,f=["M",a,l,this.order===2?"Q":"C"];for(let o=1,d=s.length;o<d;o++)f.push(s[o].x),f.push(s[o].y);return f.join(" ")}setRatios(s){if(s.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=s,this._lut=[]}verify(){const s=this.coordDigest();s!==this._print&&(this._print=s,this.update())}coordDigest(){return this.points.map(function(s,a){return""+a+s.x+s.y+(s.z?s.z:0)}).join("")}update(){this._lut=[],this.dpoints=Te.derive(this.points,this._3d),this.computedirection()}computedirection(){const s=this.points,a=Te.angle(s[0],s[this.order],s[1]);this.clockwise=a>0}length(){return Te.length(this.derivative.bind(this))}static getABC(s=2,a,l,f,o=.5){const d=Te.projectionratio(o,s),_=1-d,b={x:d*a.x+_*f.x,y:d*a.y+_*f.y},S=Te.abcratio(o,s);return{A:{x:l.x+(l.x-b.x)/S,y:l.y+(l.y-b.y)/S},B:l,C:b,S:a,E:f}}getABC(s,a){a=a||this.get(s);let l=this.points[0],f=this.points[this.order];return ft.getABC(this.order,l,a,f,s)}getLUT(s){if(this.verify(),s=s||100,this._lut.length===s+1)return this._lut;this._lut=[],s++,this._lut=[];for(let a=0,l,f;a<s;a++)f=a/(s-1),l=this.compute(f),l.t=f,this._lut.push(l);return this._lut}on(s,a){a=a||5;const l=this.getLUT(),f=[];for(let o=0,d,_=0;o<l.length;o++)d=l[o],Te.dist(d,s)<a&&(f.push(d),_+=o/l.length);return f.length?t/=f.length:!1}project(s){const a=this.getLUT(),l=a.length-1,f=Te.closest(a,s),o=f.mpos,d=(o-1)/l,_=(o+1)/l,b=.1/l;let S=f.mdist,z=d,M=z,H;S+=1;for(let L;z<_+b;z+=b)H=this.compute(z),L=Te.dist(s,H),L<S&&(S=L,M=z);return M=M<0?0:M>1?1:M,H=this.compute(M),H.t=M,H.d=S,H}get(s){return this.compute(s)}point(s){return this.points[s]}compute(s){return this.ratios?Te.computeWithRatios(s,this.points,this.ratios,this._3d):Te.compute(s,this.points,this._3d,this.ratios)}raise(){const s=this.points,a=[s[0]],l=s.length;for(let f=1,o,d;f<l;f++)o=s[f],d=s[f-1],a[f]={x:(l-f)/l*o.x+f/l*d.x,y:(l-f)/l*o.y+f/l*d.y};return a[l]=s[l-1],new ft(a)}derivative(s){return Te.compute(s,this.dpoints[0],this._3d)}dderivative(s){return Te.compute(s,this.dpoints[1],this._3d)}align(){let s=this.points;return new ft(Te.align(s,{p1:s[0],p2:s[s.length-1]}))}curvature(s){return Te.curvature(s,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return Te.inflections(this.points)}normal(s){return this._3d?this.__normal3(s):this.__normal2(s)}__normal2(s){const a=this.derivative(s),l=hn(a.x*a.x+a.y*a.y);return{t:s,x:-a.y/l,y:a.x/l}}__normal3(s){const a=this.derivative(s),l=this.derivative(s+.01),f=hn(a.x*a.x+a.y*a.y+a.z*a.z),o=hn(l.x*l.x+l.y*l.y+l.z*l.z);a.x/=f,a.y/=f,a.z/=f,l.x/=o,l.y/=o,l.z/=o;const d={x:l.y*a.z-l.z*a.y,y:l.z*a.x-l.x*a.z,z:l.x*a.y-l.y*a.x},_=hn(d.x*d.x+d.y*d.y+d.z*d.z);d.x/=_,d.y/=_,d.z/=_;const b=[d.x*d.x,d.x*d.y-d.z,d.x*d.z+d.y,d.x*d.y+d.z,d.y*d.y,d.y*d.z-d.x,d.x*d.z-d.y,d.y*d.z+d.x,d.z*d.z];return{t:s,x:b[0]*a.x+b[1]*a.y+b[2]*a.z,y:b[3]*a.x+b[4]*a.y+b[5]*a.z,z:b[6]*a.x+b[7]*a.y+b[8]*a.z}}hull(s){let a=this.points,l=[],f=[],o=0;for(f[o++]=a[0],f[o++]=a[1],f[o++]=a[2],this.order===3&&(f[o++]=a[3]);a.length>1;){l=[];for(let d=0,_,b=a.length-1;d<b;d++)_=Te.lerp(s,a[d],a[d+1]),f[o++]=_,l.push(_);a=l}return f}split(s,a){if(s===0&&a)return this.split(a).left;if(a===1)return this.split(s).right;const l=this.hull(s),f={left:this.order===2?new ft([l[0],l[3],l[5]]):new ft([l[0],l[4],l[7],l[9]]),right:this.order===2?new ft([l[5],l[4],l[2]]):new ft([l[9],l[8],l[6],l[3]]),span:l};return f.left._t1=Te.map(0,0,1,this._t1,this._t2),f.left._t2=Te.map(s,0,1,this._t1,this._t2),f.right._t1=Te.map(s,0,1,this._t1,this._t2),f.right._t2=Te.map(1,0,1,this._t1,this._t2),a?(a=Te.map(a,s,1,0,1),f.right.split(a).left):f}extrema(){const s={};let a=[];return this.dims.forEach((function(l){let f=function(d){return d[l]},o=this.dpoints[0].map(f);s[l]=Te.droots(o),this.order===3&&(o=this.dpoints[1].map(f),s[l]=s[l].concat(Te.droots(o))),s[l]=s[l].filter(function(d){return d>=0&&d<=1}),a=a.concat(s[l].sort(Te.numberSort))}).bind(this)),s.values=a.sort(Te.numberSort).filter(function(l,f){return a.indexOf(l)===f}),s}bbox(){const s=this.extrema(),a={};return this.dims.forEach((function(l){a[l]=Te.getminmax(this,l,s[l])}).bind(this)),a}overlaps(s){const a=this.bbox(),l=s.bbox();return Te.bboxoverlap(a,l)}offset(s,a){if(typeof a<"u"){const l=this.get(s),f=this.normal(s),o={c:l,n:f,x:l.x+f.x*a,y:l.y+f.y*a};return this._3d&&(o.z=l.z+f.z*a),o}if(this._linear){const l=this.normal(0),f=this.points.map(function(o){const d={x:o.x+s*l.x,y:o.y+s*l.y};return o.z&&l.z&&(d.z=o.z+s*l.z),d});return[new ft(f)]}return this.reduce().map(function(l){return l._linear?l.offset(s)[0]:l.scale(s)})}simple(){if(this.order===3){const f=Te.angle(this.points[0],this.points[3],this.points[1]),o=Te.angle(this.points[0],this.points[3],this.points[2]);if(f>0&&o<0||f<0&&o>0)return!1}const s=this.normal(0),a=this.normal(1);let l=s.x*a.x+s.y*a.y;return this._3d&&(l+=s.z*a.z),un(So(l))<Co/3}reduce(){let s,a=0,l=0,f=.01,o,d=[],_=[],b=this.extrema().values;for(b.indexOf(0)===-1&&(b=[0].concat(b)),b.indexOf(1)===-1&&b.push(1),a=b[0],s=1;s<b.length;s++)l=b[s],o=this.split(a,l),o._t1=a,o._t2=l,d.push(o),a=l;return d.forEach(function(S){for(a=0,l=0;l<=1;)for(l=a+f;l<=1+f;l+=f)if(o=S.split(a,l),!o.simple()){if(l-=f,un(a-l)<f)return[];o=S.split(a,l),o._t1=Te.map(a,0,1,S._t1,S._t2),o._t2=Te.map(l,0,1,S._t1,S._t2),_.push(o),a=l;break}a<1&&(o=S.split(a,1),o._t1=Te.map(a,0,1,S._t1,S._t2),o._t2=S._t2,_.push(o))}),_}translate(s,a,l){l=typeof l=="number"?l:a;const f=this.order;let o=this.points.map((d,_)=>(1-_/f)*a+_/f*l);return new ft(this.points.map((d,_)=>({x:d.x+s.x*o[_],y:d.y+s.y*o[_]})))}scale(s){const a=this.order;let l=!1;if(typeof s=="function"&&(l=s),l&&a===2)return this.raise().scale(l);const f=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),l?l(0):s,l?l(1):s);const d=l?l(0):s,_=l?l(1):s,b=[this.offset(0,10),this.offset(1,10)],S=[],z=Te.lli4(b[0],b[0].c,b[1],b[1].c);if(!z)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(M){const H=S[M*a]=Te.copy(o[M*a]);H.x+=(M?_:d)*b[M].n.x,H.y+=(M?_:d)*b[M].n.y}),l?([0,1].forEach(function(M){if(!(a===2&&M)){var H=o[M+1],L={x:H.x-z.x,y:H.y-z.y},Q=l?l((M+1)/a):s;l&&!f&&(Q=-Q);var X=hn(L.x*L.x+L.y*L.y);L.x/=X,L.y/=X,S[M+1]={x:H.x+Q*L.x,y:H.y+Q*L.y}}}),new ft(S)):([0,1].forEach(M=>{if(a===2&&M)return;const H=S[M*a],L=this.derivative(M),Q={x:H.x+L.x,y:H.y+L.y};S[M+1]=Te.lli4(H,Q,z,o[M+1])}),new ft(S))}outline(s,a,l,f){if(a=a===void 0?s:a,this._linear){const he=this.normal(0),T=this.points[0],ve=this.points[this.points.length-1];let xe,de,Se;l===void 0&&(l=s,f=a),xe={x:T.x+he.x*s,y:T.y+he.y*s},Se={x:ve.x+he.x*l,y:ve.y+he.y*l},de={x:(xe.x+Se.x)/2,y:(xe.y+Se.y)/2};const Ie=[xe,de,Se];xe={x:T.x-he.x*a,y:T.y-he.y*a},Se={x:ve.x-he.x*f,y:ve.y-he.y*f},de={x:(xe.x+Se.x)/2,y:(xe.y+Se.y)/2};const Ce=[Se,de,xe],ze=Te.makeline(Ce[2],Ie[0]),Pe=Te.makeline(Ie[2],Ce[0]),et=[ze,new ft(Ie),Pe,new ft(Ce)];return new dn(et)}const o=this.reduce(),d=o.length,_=[];let b=[],S,z=0,M=this.length();const H=typeof l<"u"&&typeof f<"u";function L(he,T,ve,xe,de){return function(Se){const Ie=xe/ve,Ce=(xe+de)/ve,ze=T-he;return Te.map(Se,0,1,he+Ie*ze,he+Ce*ze)}}o.forEach(function(he){const T=he.length();H?(_.push(he.scale(L(s,l,M,z,T))),b.push(he.scale(L(-a,-f,M,z,T)))):(_.push(he.scale(s)),b.push(he.scale(-a))),z+=T}),b=b.map(function(he){return S=he.points,S[3]?he.points=[S[3],S[2],S[1],S[0]]:he.points=[S[2],S[1],S[0]],he}).reverse();const Q=_[0].points[0],X=_[d-1].points[_[d-1].points.length-1],te=b[d-1].points[b[d-1].points.length-1],$=b[0].points[0],pe=Te.makeline(te,Q),re=Te.makeline(X,$),_e=[pe].concat(_).concat([re]).concat(b);return new dn(_e)}outlineshapes(s,a,l){a=a||s;const f=this.outline(s,a).curves,o=[];for(let d=1,_=f.length;d<_/2;d++){const b=Te.makeshape(f[d],f[_-d],l);b.startcap.virtual=d>1,b.endcap.virtual=d<_/2-1,o.push(b)}return o}intersects(s,a){return s?s.p1&&s.p2?this.lineIntersects(s):(s instanceof ft&&(s=s.reduce()),this.curveintersects(this.reduce(),s,a)):this.selfintersects(a)}lineIntersects(s){const a=ms(s.p1.x,s.p2.x),l=ms(s.p1.y,s.p2.y),f=vs(s.p1.x,s.p2.x),o=vs(s.p1.y,s.p2.y);return Te.roots(this.points,s).filter(d=>{var _=this.get(d);return Te.between(_.x,a,f)&&Te.between(_.y,l,o)})}selfintersects(s){const a=this.reduce(),l=a.length-2,f=[];for(let o=0,d,_,b;o<l;o++)_=a.slice(o,o+1),b=a.slice(o+2),d=this.curveintersects(_,b,s),f.push(...d);return f}curveintersects(s,a,l){const f=[];s.forEach(function(d){a.forEach(function(_){d.overlaps(_)&&f.push({left:d,right:_})})});let o=[];return f.forEach(function(d){const _=Te.pairiteration(d.left,d.right,l);_.length>0&&(o=o.concat(_))}),o}arcs(s){return s=s||.5,this._iterate(s,[])}_error(s,a,l,f){const o=(f-l)/4,d=this.get(l+o),_=this.get(f-o),b=Te.dist(s,a),S=Te.dist(s,d),z=Te.dist(s,_);return un(S-b)+un(z-b)}_iterate(s,a){let l=0,f=1,o;do{o=0,f=1;let d=this.get(l),_,b,S,z,M=!1,H=!1,L,Q=f,X=1;do if(H=M,z=S,Q=(l+f)/2,_=this.get(Q),b=this.get(f),S=Te.getccenter(d,_,b),S.interval={start:l,end:f},M=this._error(S,d,l,f)<=s,L=H&&!M,L||(X=f),M){if(f>=1){if(S.interval.end=X=1,z=S,f>1){let $={x:S.x+S.r*bo(S.e),y:S.y+S.r*wo(S.e)};S.e+=Te.angle({x:S.x,y:S.y},$,this.get(1))}break}f=f+(f-l)/2}else f=Q;while(!L&&o++<100);if(o>=100)break;z=z||S,a.push(z),l=X}while(f<1);return a}}var Po=(function(){function u(s,a){var l=[],f=!0,o=!1,d=void 0;try{for(var _=s[Symbol.iterator](),b;!(f=(b=_.next()).done)&&(l.push(b.value),!(a&&l.length===a));f=!0);}catch(S){o=!0,d=S}finally{try{!f&&_.return&&_.return()}finally{if(o)throw d}}return l}return function(s,a){if(Array.isArray(s))return s;if(Symbol.iterator in Object(s))return u(s,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),pn=Math.PI*2,xr=function(s,a,l,f,o,d,_){var b=s.x,S=s.y;b*=a,S*=l;var z=f*b-o*S,M=o*b+f*S;return{x:z+d,y:M+_}},Io=function(s,a){var l=a===1.5707963267948966?.551915024494:a===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(a/4),f=Math.cos(s),o=Math.sin(s),d=Math.cos(s+a),_=Math.sin(s+a);return[{x:f-o*l,y:o+f*l},{x:d+_*l,y:_-d*l},{x:d,y:_}]},_s=function(s,a,l,f){var o=s*f-a*l<0?-1:1,d=s*l+a*f;return d>1&&(d=1),d<-1&&(d=-1),o*Math.acos(d)},ko=function(s,a,l,f,o,d,_,b,S,z,M,H){var L=Math.pow(o,2),Q=Math.pow(d,2),X=Math.pow(M,2),te=Math.pow(H,2),$=L*Q-L*te-Q*X;$<0&&($=0),$/=L*te+Q*X,$=Math.sqrt($)*(_===b?-1:1);var pe=$*o/d*H,re=$*-d/o*M,_e=z*pe-S*re+(s+l)/2,he=S*pe+z*re+(a+f)/2,T=(M-pe)/o,ve=(H-re)/d,xe=(-M-pe)/o,de=(-H-re)/d,Se=_s(1,0,T,ve),Ie=_s(T,ve,xe,de);return b===0&&Ie>0&&(Ie-=pn),b===1&&Ie<0&&(Ie+=pn),[_e,he,Se,Ie]},Eo=function(s){var a=s.px,l=s.py,f=s.cx,o=s.cy,d=s.rx,_=s.ry,b=s.xAxisRotation,S=b===void 0?0:b,z=s.largeArcFlag,M=z===void 0?0:z,H=s.sweepFlag,L=H===void 0?0:H,Q=[];if(d===0||_===0)return[];var X=Math.sin(S*pn/360),te=Math.cos(S*pn/360),$=te*(a-f)/2+X*(l-o)/2,pe=-X*(a-f)/2+te*(l-o)/2;if($===0&&pe===0)return[];d=Math.abs(d),_=Math.abs(_);var re=Math.pow($,2)/Math.pow(d,2)+Math.pow(pe,2)/Math.pow(_,2);re>1&&(d*=Math.sqrt(re),_*=Math.sqrt(re));var _e=ko(a,l,f,o,d,_,M,L,X,te,$,pe),he=Po(_e,4),T=he[0],ve=he[1],xe=he[2],de=he[3],Se=Math.abs(de)/(pn/4);Math.abs(1-Se)<1e-7&&(Se=1);var Ie=Math.max(Math.ceil(Se),1);de/=Ie;for(var Ce=0;Ce<Ie;Ce++)Q.push(Io(xe,de)),xe+=de;return Q.map(function(ze){var Pe=xr(ze[0],d,_,te,X,T,ve),et=Pe.x,ge=Pe.y,Ye=xr(ze[1],d,_,te,X,T,ve),st=Ye.x,Fe=Ye.y,it=xr(ze[2],d,_,te,X,T,ve),Kt=it.x,Bt=it.y;return{x1:et,y1:ge,x2:st,y2:Fe,x:Kt,y:Bt}})};function Ao(u,s){return u>s?1:u<s?-1:0}class jr{constructor(s=Ao,a=!1){this._compare=s,this._root=null,this._size=0,this._noDuplicates=!!a}rotateLeft(s){var a=s.right;a&&(s.right=a.left,a.left&&(a.left.parent=s),a.parent=s.parent),s.parent?s===s.parent.left?s.parent.left=a:s.parent.right=a:this._root=a,a&&(a.left=s),s.parent=a}rotateRight(s){var a=s.left;a&&(s.left=a.right,a.right&&(a.right.parent=s),a.parent=s.parent),s.parent?s===s.parent.left?s.parent.left=a:s.parent.right=a:this._root=a,a&&(a.right=s),s.parent=a}_splay(s){for(;s.parent;){var a=s.parent;a.parent?a.left===s&&a.parent.left===a?(this.rotateRight(a.parent),this.rotateRight(a)):a.right===s&&a.parent.right===a?(this.rotateLeft(a.parent),this.rotateLeft(a)):a.left===s&&a.parent.right===a?(this.rotateRight(a),this.rotateLeft(a)):(this.rotateLeft(a),this.rotateRight(a)):a.left===s?this.rotateRight(a):this.rotateLeft(a)}}splay(s){for(var a,l,f,o,d;s.parent;)a=s.parent,l=a.parent,l&&l.parent?(f=l.parent,f.left===l?f.left=s:f.right=s,s.parent=f):(s.parent=null,this._root=s),o=s.left,d=s.right,s===a.left?(l&&(l.left===a?(a.right?(l.left=a.right,l.left.parent=l):l.left=null,a.right=l,l.parent=a):(o?(l.right=o,o.parent=l):l.right=null,s.left=l,l.parent=s)),d?(a.left=d,d.parent=a):a.left=null,s.right=a,a.parent=s):(l&&(l.right===a?(a.left?(l.right=a.left,l.right.parent=l):l.right=null,a.left=l,l.parent=a):(d?(l.left=d,d.parent=l):l.left=null,s.right=l,l.parent=s)),o?(a.right=o,o.parent=a):a.right=null,s.left=a,a.parent=s)}replace(s,a){s.parent?s===s.parent.left?s.parent.left=a:s.parent.right=a:this._root=a,a&&(a.parent=s.parent)}minNode(s=this._root){if(s)for(;s.left;)s=s.left;return s}maxNode(s=this._root){if(s)for(;s.right;)s=s.right;return s}insert(s,a){var l=this._root,f=null,o=this._compare,d;if(this._noDuplicates)for(;l;){if(f=l,d=o(l.key,s),d===0)return;o(l.key,s)<0?l=l.right:l=l.left}else for(;l;)f=l,o(l.key,s)<0?l=l.right:l=l.left;return l={key:s,data:a,left:null,right:null,parent:f},f?o(f.key,l.key)<0?f.right=l:f.left=l:this._root=l,this.splay(l),this._size++,l}find(s){for(var a=this._root,l=this._compare;a;){var f=l(a.key,s);if(f<0)a=a.right;else if(f>0)a=a.left;else return a}return null}contains(s){for(var a=this._root,l=this._compare;a;){var f=l(s,a.key);if(f===0)return!0;f<0?a=a.left:a=a.right}return!1}remove(s){var a=this.find(s);if(!a)return!1;if(this.splay(a),!a.left)this.replace(a,a.right);else if(!a.right)this.replace(a,a.left);else{var l=this.minNode(a.right);l.parent!==a&&(this.replace(l,l.right),l.right=a.right,l.right.parent=l),this.replace(a,l),l.left=a.left,l.left.parent=l}return this._size--,!0}removeNode(s){if(!s)return!1;if(this.splay(s),!s.left)this.replace(s,s.right);else if(!s.right)this.replace(s,s.left);else{var a=this.minNode(s.right);a.parent!==s&&(this.replace(a,a.right),a.right=s.right,a.right.parent=a),this.replace(s,a),a.left=s.left,a.left.parent=a}return this._size--,!0}erase(s){var a=this.find(s);if(a){this.splay(a);var l=a.left,f=a.right,o=null;l&&(l.parent=null,o=this.maxNode(l),this.splay(o),this._root=o),f&&(l?o.right=f:this._root=f,f.parent=o),this._size--}}pop(){var s=this._root,a=null;if(s){for(;s.left;)s=s.left;a={key:s.key,data:s.data},this.remove(s.key)}return a}next(s){var a=s;if(a)if(a.right)for(a=a.right;a&&a.left;)a=a.left;else for(a=s.parent;a&&a.right===s;)s=a,a=a.parent;return a}prev(s){var a=s;if(a)if(a.left)for(a=a.left;a&&a.right;)a=a.right;else for(a=s.parent;a&&a.left===s;)s=a,a=a.parent;return a}forEach(s){for(var a=this._root,l=[],f=!1,o=0;!f;)a?(l.push(a),a=a.left):l.length>0?(a=l.pop(),s(a,o++),a=a.right):f=!0;return this}range(s,a,l,f){const o=[],d=this._compare;let _=this._root,b;for(;o.length!==0||_;)if(_)o.push(_),_=_.left;else{if(_=o.pop(),b=d(_.key,a),b>0)break;if(d(_.key,s)>=0&&l.call(f,_))return this;_=_.right}return this}keys(){for(var s=this._root,a=[],l=[],f=!1;!f;)s?(a.push(s),s=s.left):a.length>0?(s=a.pop(),l.push(s.key),s=s.right):f=!0;return l}values(){for(var s=this._root,a=[],l=[],f=!1;!f;)s?(a.push(s),s=s.left):a.length>0?(s=a.pop(),l.push(s.data),s=s.right):f=!0;return l}at(s){for(var a=this._root,l=[],f=!1,o=0;!f;)if(a)l.push(a),a=a.left;else if(l.length>0){if(a=l.pop(),o===s)return a;o++,a=a.right}else f=!0;return null}load(s=[],a=[],l=!1){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const f=s.length;return l&&Dr(s,a,0,f-1,this._compare),this._root=Rr(null,s,a,0,f),this._size=f,this}min(){var s=this.minNode(this._root);return s?s.key:null}max(){var s=this.maxNode(this._root);return s?s.key:null}isEmpty(){return this._root===null}get size(){return this._size}static createTree(s,a,l,f,o){return new jr(l,o).load(s,a,f)}}function Rr(u,s,a,l,f){const o=f-l;if(o>0){const d=l+Math.floor(o/2),_=s[d],b=a[d],S={key:_,data:b,parent:u};return S.left=Rr(S,s,a,l,d),S.right=Rr(S,s,a,d+1,f),S}return null}function Dr(u,s,a,l,f){if(a>=l)return;const o=u[a+l>>1];let d=a-1,_=l+1;for(;;){do d++;while(f(u[d],o)<0);do _--;while(f(u[_],o)>0);if(d>=_)break;let b=u[d];u[d]=u[_],u[_]=b,b=s[d],s[d]=s[_],s[_]=b}Dr(u,s,a,_,f),Dr(u,s,_+1,l,f)}const Qs=0,$s=1,Js=2,ea=3,Yn=0,Vr=1,Qn=2,ta=3;function ln(u,s,a){s===null?(u.inOut=!1,u.otherInOut=!0):(u.isSubject===s.isSubject?(u.inOut=!s.inOut,u.otherInOut=s.otherInOut):(u.inOut=!s.otherInOut,u.otherInOut=s.isVertical()?!s.inOut:s.inOut),s&&(u.prevInResult=!ys(s,a)||s.isVertical()?s.prevInResult:s)),ys(u,a)?u.resultTransition=To(u,a):u.resultTransition=0}function ys(u,s){switch(u.type){case Qs:switch(s){case Yn:return!u.otherInOut;case Vr:return u.otherInOut;case Qn:return u.isSubject&&u.otherInOut||!u.isSubject&&!u.otherInOut;case ta:return!0}break;case Js:return s===Yn||s===Vr;case ea:return s===Qn;case $s:return!1}return!1}function To(u,s){let a=!u.inOut,l=!u.otherInOut,f;switch(s){case Yn:f=a&&l;break;case Vr:f=a||l;break;case ta:f=a^l;break;case Qn:u.isSubject?f=a&&!l:f=l&&!a;break}return f?1:-1}class ji{constructor(s,a,l,f,o){this.left=a,this.point=s,this.otherEvent=l,this.isSubject=f,this.type=o||Qs,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0}isBelow(s){const a=this.point,l=this.otherEvent.point;return this.left?(a[0]-s[0])*(l[1]-s[1])-(l[0]-s[0])*(a[1]-s[1])>0:(l[0]-s[0])*(a[1]-s[1])-(a[0]-s[0])*(l[1]-s[1])>0}isAbove(s){return!this.isBelow(s)}isVertical(){return this.point[0]===this.otherEvent.point[0]}get inResult(){return this.resultTransition!==0}clone(){const s=new ji(this.point,this.left,this.otherEvent,this.isSubject,this.type);return s.contourId=this.contourId,s.resultTransition=this.resultTransition,s.prevInResult=this.prevInResult,s.isExteriorRing=this.isExteriorRing,s.inOut=this.inOut,s.otherInOut=this.otherInOut,s}}function $t(u,s){return u[0]===s[0]?u[1]===s[1]:!1}const si=11102230246251565e-32,Tt=134217729,Mo=(3+8*si)*si;function br(u,s,a,l,f){let o,d,_,b,S=s[0],z=l[0],M=0,H=0;z>S==z>-S?(o=S,S=s[++M]):(o=z,z=l[++H]);let L=0;if(M<u&&H<a)for(z>S==z>-S?(d=S+o,_=o-(d-S),S=s[++M]):(d=z+o,_=o-(d-z),z=l[++H]),o=d,_!==0&&(f[L++]=_);M<u&&H<a;)z>S==z>-S?(d=o+S,b=d-o,_=o-(d-b)+(S-b),S=s[++M]):(d=o+z,b=d-o,_=o-(d-b)+(z-b),z=l[++H]),o=d,_!==0&&(f[L++]=_);for(;M<u;)d=o+S,b=d-o,_=o-(d-b)+(S-b),S=s[++M],o=d,_!==0&&(f[L++]=_);for(;H<a;)d=o+z,b=d-o,_=o-(d-b)+(z-b),z=l[++H],o=d,_!==0&&(f[L++]=_);return(o!==0||L===0)&&(f[L++]=o),L}function Lo(u,s){let a=s[0];for(let l=1;l<u;l++)a+=s[l];return a}function Cn(u){return new Float64Array(u)}const Oo=(3+16*si)*si,zo=(2+12*si)*si,No=(9+64*si)*si*si,Bi=Cn(4),xs=Cn(8),bs=Cn(12),ws=Cn(16),Ot=Cn(4);function Ro(u,s,a,l,f,o,d){let _,b,S,z,M,H,L,Q,X,te,$,pe,re,_e,he,T,ve,xe;const de=u-f,Se=a-f,Ie=s-o,Ce=l-o;_e=de*Ce,H=Tt*de,L=H-(H-de),Q=de-L,H=Tt*Ce,X=H-(H-Ce),te=Ce-X,he=Q*te-(_e-L*X-Q*X-L*te),T=Ie*Se,H=Tt*Ie,L=H-(H-Ie),Q=Ie-L,H=Tt*Se,X=H-(H-Se),te=Se-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,Bi[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,Bi[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,Bi[2]=pe-(xe-M)+($-M),Bi[3]=xe;let ze=Lo(4,Bi),Pe=zo*d;if(ze>=Pe||-ze>=Pe||(M=u-de,_=u-(de+M)+(M-f),M=a-Se,S=a-(Se+M)+(M-f),M=s-Ie,b=s-(Ie+M)+(M-o),M=l-Ce,z=l-(Ce+M)+(M-o),_===0&&b===0&&S===0&&z===0)||(Pe=No*d+Mo*Math.abs(ze),ze+=de*z+Ce*_-(Ie*S+Se*b),ze>=Pe||-ze>=Pe))return ze;_e=_*Ce,H=Tt*_,L=H-(H-_),Q=_-L,H=Tt*Ce,X=H-(H-Ce),te=Ce-X,he=Q*te-(_e-L*X-Q*X-L*te),T=b*Se,H=Tt*b,L=H-(H-b),Q=b-L,H=Tt*Se,X=H-(H-Se),te=Se-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,Ot[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,Ot[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,Ot[2]=pe-(xe-M)+($-M),Ot[3]=xe;const et=br(4,Bi,4,Ot,xs);_e=de*z,H=Tt*de,L=H-(H-de),Q=de-L,H=Tt*z,X=H-(H-z),te=z-X,he=Q*te-(_e-L*X-Q*X-L*te),T=Ie*S,H=Tt*Ie,L=H-(H-Ie),Q=Ie-L,H=Tt*S,X=H-(H-S),te=S-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,Ot[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,Ot[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,Ot[2]=pe-(xe-M)+($-M),Ot[3]=xe;const ge=br(et,xs,4,Ot,bs);_e=_*z,H=Tt*_,L=H-(H-_),Q=_-L,H=Tt*z,X=H-(H-z),te=z-X,he=Q*te-(_e-L*X-Q*X-L*te),T=b*S,H=Tt*b,L=H-(H-b),Q=b-L,H=Tt*S,X=H-(H-S),te=S-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,Ot[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,Ot[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,Ot[2]=pe-(xe-M)+($-M),Ot[3]=xe;const Ye=br(ge,bs,4,Ot,ws);return ws[Ye-1]}function Do(u,s,a,l,f,o){const d=(s-o)*(a-f),_=(u-f)*(l-o),b=d-_;if(d===0||_===0||d>0!=_>0)return b;const S=Math.abs(d+_);return Math.abs(b)>=Oo*S?b:-Ro(u,s,a,l,f,o,S)}function Fr(u,s,a){const l=Do(u[0],u[1],s[0],s[1],a[0],a[1]);return l>0?-1:l<0?1:0}function mi(u,s){const a=u.point,l=s.point;return a[0]>l[0]?1:a[0]<l[0]?-1:a[1]!==l[1]?a[1]>l[1]?1:-1:Vo(u,s,a)}function Vo(u,s,a,l){return u.left!==s.left?u.left?1:-1:Fr(a,u.otherEvent.point,s.otherEvent.point)!==0?u.isBelow(s.otherEvent.point)?-1:1:!u.isSubject&&s.isSubject?1:-1}function gi(u,s,a){const l=new ji(s,!1,u,u.isSubject),f=new ji(s,!0,u.otherEvent,u.isSubject);return $t(u.point,u.otherEvent.point)&&console.warn("what is that, a collapsed segment?",u),l.contourId=f.contourId=u.contourId,mi(f,u.otherEvent)>0&&(u.otherEvent.left=!0,f.left=!1),u.otherEvent.otherEvent=f,u.otherEvent=l,a.push(f),a.push(l),a}function Un(u,s){return u[0]*s[1]-u[1]*s[0]}function wr(u,s){return u[0]*s[0]+u[1]*s[1]}function Fo(u,s,a,l,f){const o=[s[0]-u[0],s[1]-u[1]],d=[l[0]-a[0],l[1]-a[1]];function _(te,$,pe){return[te[0]+$*pe[0],te[1]+$*pe[1]]}const b=[a[0]-u[0],a[1]-u[1]];let S=Un(o,d),z=S*S;const M=wr(o,o);if(z>0){const te=Un(b,d)/S;if(te<0||te>1)return null;const $=Un(b,o)/S;return $<0||$>1?null:te===0||te===1?[_(u,te,o)]:$===0||$===1?[_(a,$,d)]:[_(u,te,o)]}if(S=Un(b,o),z=S*S,z>0)return null;const H=wr(o,b)/M,L=H+wr(o,d)/M,Q=Math.min(H,L),X=Math.max(H,L);return Q<=1&&X>=0?Q===1?[_(u,Q>0?Q:0,o)]:X===0?[_(u,X<1?X:1,o)]:[_(u,Q>0?Q:0,o),_(u,X<1?X:1,o)]:null}function Sr(u,s,a){const l=Fo(u.point,u.otherEvent.point,s.point,s.otherEvent.point),f=l?l.length:0;if(f===0||f===1&&($t(u.point,s.point)||$t(u.otherEvent.point,s.otherEvent.point))||f===2&&u.isSubject===s.isSubject)return 0;if(f===1)return!$t(u.point,l[0])&&!$t(u.otherEvent.point,l[0])&&gi(u,l[0],a),!$t(s.point,l[0])&&!$t(s.otherEvent.point,l[0])&&gi(s,l[0],a),1;const o=[];let d=!1,_=!1;return $t(u.point,s.point)?d=!0:mi(u,s)===1?o.push(s,u):o.push(u,s),$t(u.otherEvent.point,s.otherEvent.point)?_=!0:mi(u.otherEvent,s.otherEvent)===1?o.push(s.otherEvent,u.otherEvent):o.push(u.otherEvent,s.otherEvent),d&&_||d?(s.type=$s,u.type=s.inOut===u.inOut?Js:ea,d&&!_&&gi(o[1].otherEvent,o[0].point,a),2):_?(gi(o[0],o[1].point,a),3):o[0]!==o[3].otherEvent?(gi(o[0],o[1].point,a),gi(o[1],o[2].point,a),3):(gi(o[0],o[1].point,a),gi(o[3].otherEvent,o[2].point,a),3)}function Bo(u,s){if(u===s)return 0;if(Fr(u.point,u.otherEvent.point,s.point)!==0||Fr(u.point,u.otherEvent.point,s.otherEvent.point)!==0)return $t(u.point,s.point)?u.isBelow(s.otherEvent.point)?-1:1:u.point[0]===s.point[0]?u.point[1]<s.point[1]?-1:1:mi(u,s)===1?s.isAbove(u.point)?-1:1:u.isBelow(s.point)?-1:1;if(u.isSubject===s.isSubject){let a=u.point,l=s.point;if(a[0]===l[0]&&a[1]===l[1])return a=u.otherEvent.point,l=s.otherEvent.point,a[0]===l[0]&&a[1]===l[1]?0:u.contourId>s.contourId?1:-1}else return u.isSubject?-1:1;return mi(u,s)===1?1:-1}function Uo(u,s,a,l,f,o){const d=new jr(Bo),_=[],b=Math.min(l[2],f[2]);let S,z,M;for(;u.length!==0;){let H=u.pop();if(_.push(H),H.point[0]>b||o===Qn)break;if(H.left){z=S=d.insert(H),M=d.minNode(),S!==M?S=d.prev(S):S=null,z=d.next(z);const L=S?S.key:null;let Q;if(ln(H,L,o),z&&Sr(H,z.key,u)===2&&(ln(H,L,o),ln(z.key,H,o)),S&&Sr(S.key,H,u)===2){let X=S;X!==M?X=d.prev(X):X=null,Q=X?X.key:null,ln(L,Q,o),ln(H,L,o)}}else H=H.otherEvent,z=S=d.find(H),S&&z&&(S!==M?S=d.prev(S):S=null,z=d.next(z),d.remove(H),z&&S&&Sr(S.key,z.key,u))}return _}class qo{constructor(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null}isExterior(){return this.holeOf==null}}function Ho(u){let s,a,l,f;const o=[];for(a=0,l=u.length;a<l;a++)s=u[a],(s.left&&s.inResult||!s.left&&s.otherEvent.inResult)&&o.push(s);let d=!1;for(;!d;)for(d=!0,a=0,l=o.length;a<l;a++)a+1<l&&mi(o[a],o[a+1])===1&&(f=o[a],o[a]=o[a+1],o[a+1]=f,d=!1);for(a=0,l=o.length;a<l;a++)s=o[a],s.otherPos=a;for(a=0,l=o.length;a<l;a++)s=o[a],s.left||(f=s.otherPos,s.otherPos=s.otherEvent.otherPos,s.otherEvent.otherPos=f);return o}function Go(u,s,a,l){let f=u+1,o=s[u].point,d;const _=s.length;for(f<_&&(d=s[f].point);f<_&&d[0]===o[0]&&d[1]===o[1];){if(a[f])f++;else return f;f<_&&(d=s[f].point)}for(f=u-1;a[f]&&f>l;)f--;return f}function jo(u,s,a){const l=new qo;if(u.prevInResult!=null){const f=u.prevInResult,o=f.outputContourId;if(f.resultTransition>0){const _=s[o];if(_.holeOf!=null){const b=_.holeOf;s[b].holeIds.push(a),l.holeOf=b,l.depth=s[o].depth}else s[o].holeIds.push(a),l.holeOf=o,l.depth=s[o].depth+1}else l.holeOf=null,l.depth=s[o].depth}else l.holeOf=null,l.depth=0;return l}function Wo(u){let s,a;const l=Ho(u),f={},o=[];for(s=0,a=l.length;s<a;s++){if(f[s])continue;const d=o.length,_=jo(l[s],o,d),b=H=>{f[H]=!0,H<l.length&&l[H]&&(l[H].outputContourId=d)};let S=s,z=s;const M=l[s].point;for(_.points.push(M);b(S),S=l[S].otherPos,b(S),_.points.push(l[S].point),S=Go(S,l,f,z),!(S==z||S>=l.length||!l[S]););o.push(_)}return o}var qn={exports:{}},Ss;function Zo(){if(Ss)return qn.exports;Ss=1,qn.exports=u,qn.exports.default=u;function u(a,l){if(!(this instanceof u))return new u(a,l);if(this.data=a||[],this.length=this.data.length,this.compare=l||s,this.length>0)for(var f=(this.length>>1)-1;f>=0;f--)this._down(f)}function s(a,l){return a<l?-1:a>l?1:0}return u.prototype={push:function(a){this.data.push(a),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var a=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),a}},peek:function(){return this.data[0]},_up:function(a){for(var l=this.data,f=this.compare,o=l[a];a>0;){var d=a-1>>1,_=l[d];if(f(o,_)>=0)break;l[a]=_,a=d}l[a]=o},_down:function(a){for(var l=this.data,f=this.compare,o=this.length>>1,d=l[a];a<o;){var _=(a<<1)+1,b=_+1,S=l[_];if(b<this.length&&f(l[b],S)<0&&(_=b,S=l[b]),f(S,d)>=0)break;l[a]=S,a=_}l[a]=d}},qn.exports}var Xo=Zo();const Ko=Gr(Xo),Cs=Math.max,Ps=Math.min;let Hn=0;function Is(u,s,a,l,f,o){let d,_,b,S,z,M;for(d=0,_=u.length-1;d<_;d++){if(b=u[d],S=u[d+1],z=new ji(b,!1,void 0,s),M=new ji(S,!1,z,s),z.otherEvent=M,b[0]===S[0]&&b[1]===S[1])continue;z.contourId=M.contourId=a,o||(z.isExteriorRing=!1,M.isExteriorRing=!1),mi(z,M)>0?M.left=!0:z.left=!0;const H=b[0],L=b[1];f[0]=Ps(f[0],H),f[1]=Ps(f[1],L),f[2]=Cs(f[2],H),f[3]=Cs(f[3],L),l.push(z),l.push(M)}}function Yo(u,s,a,l,f){const o=new Ko(null,mi);let d,_,b,S,z,M;for(b=0,S=u.length;b<S;b++)for(d=u[b],z=0,M=d.length;z<M;z++)_=z===0,_&&Hn++,Is(d[z],!0,Hn,o,a,_);for(b=0,S=s.length;b<S;b++)for(d=s[b],z=0,M=d.length;z<M;z++)_=z===0,_&&Hn++,Is(d[z],!1,Hn,o,l,_);return o}const $n=[];function Qo(u,s,a){let l=null;return u.length*s.length===0&&(l=$n),l}function $o(u,s,a,l,f){let o=null;return(a[0]>l[2]||l[0]>a[2]||a[1]>l[3]||l[1]>a[3])&&(o=$n),o}function Jo(u,s,a){typeof u[0][0][0]=="number"&&(u=[u]),typeof s[0][0][0]=="number"&&(s=[s]);let l=Qo(u,s);if(l)return l===$n?null:l;const f=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],d=Yo(u,s,f,o);if(l=$o(u,s,f,o),l)return l===$n?null:l;const _=Uo(d,u,s,f,o,a),b=Wo(_),S=[];for(let z=0;z<b.length;z++){let M=b[z];if(M.isExterior()){let H=[M.points];for(let L=0;L<M.holeIds.length;L++){let Q=M.holeIds[L];H.push(b[Q].points)}S.push(H)}}return S}function eu(u,s){return Jo(u,s,Yn)}function tu(u,s){const a=u[0]-s[0],l=u[1]-s[1];return a*a+l*l}function iu(u){return{vertices:u.vertices,pieces:Array.from(u.pieces.entries()),edges:Array.from(u.edges.entries()),halfEdges:Array.from(u.halfEdges.entries()),boundary:u.boundary,borderPath:u.borderPath}}function ia(u,s){let[a,l]=u,[f,o]=u;const d=_=>{a=Math.min(a,_[0]),l=Math.min(l,_[1]),f=Math.max(f,_[0]),o=Math.max(o,_[1])};for(const _ of s)_.type==="line"?d(_.p):(d(_.p1),d(_.p2),d(_.p3));return[a,l,f,o]}function na(u,s){let a=1/0,l=1/0,f=-1/0,o=-1/0;const d=u.halfEdge;let _=s.halfEdges.get(d);if(!_)return u.bounds;const b=S=>{a=Math.min(a,S[0]),l=Math.min(l,S[1]),f=Math.max(f,S[0]),o=Math.max(o,S[1])};do{if(b(_.origin),_.segments){const S=ia(_.origin,_.segments);b([S[0],S[1]]),b([S[2],S[3]])}_=s.halfEdges.get(_.next)}while(_&&_.id!==d);return[a,l,f,o]}function Br(u){if(u.length===0)return[0,0,0,0];let s=u[0][0],a=u[0][1],l=s,f=a;for(let o=1;o<u.length;o++){const d=u[o];s=Math.min(s,d[0]),a=Math.min(a,d[1]),l=Math.max(l,d[0]),f=Math.max(f,d[1])}return[s,a,l,f]}function nu(u,s){return Math.abs(u[0]-s[0])<1e-6&&Math.abs(u[1]-s[1])<1e-6}function ra(u,s,a,l){if(!u.tabs)return;const f=s.halfEdges.get(u.heLeft),o=s.halfEdges.get(u.heRight),d=f.origin,_=o.origin,b=[];let S=d;u.tabs.sort((z,M)=>z.position-M.position);for(const z of u.tabs){const M=z.position-z.size/2,H=[d[0]+(_[0]-d[0])*M,d[1]+(_[1]-d[1])*M];Math.hypot(H[0]-S[0],H[1]-S[1])>1e-6&&b.push({type:"line",p:H});const L=[d[0]+(_[0]-d[0])*(M+z.size),d[1]+(_[1]-d[1])*(M+z.size)],Q=a.createTabSegments(H,L,z,l);b.push(...Q),S=L}Math.hypot(_[0]-S[0],_[1]-S[1])>1e-6&&b.push({type:"line",p:_}),f.segments=b,o.segments=ru(b,d),u.bounds=ia(d,b)}function ru(u,s){const a=[];for(let l=u.length-1;l>=0;l--){const f=u[l];let o=s;if(l>0){const d=u[l-1];o=d.type==="line"?d.p:d.p3}f.type==="line"?a.push({type:"line",p:o}):a.push({type:"bezier",p1:f.p2,p2:f.p1,p3:o})}return a}function su(u,s){const{p:a,radii:l,rotation:f,largeArc:o,sweep:d}=s,[_,b]=u,[S,z]=a,[M,H]=l;return Eo({px:_,py:b,cx:S,cy:z,rx:M,ry:H,xAxisRotation:f,largeArcFlag:o?1:0,sweepFlag:d?1:0}).map(X=>({type:"bezier",p1:[X.x1,X.y1],p2:[X.x2,X.y2],p3:[X.x,X.y]}))}function sa(u){const s=[];let a=[];if(u.length===0||u[0].type!=="move")return[];let l=[0,0];for(const f of u)switch(f.type){case"move":a.length>0&&s.push(a),l=f.p,a=[l];break;case"line":a.push(f.p),l=f.p;break;case"bezier":{const{p1:o,p2:d,p3:_}=f,S=new ft([...l,...o,...d,..._]).getLUT(100);a.push(...S.slice(1).map(z=>[z.x,z.y])),l=_;break}case"arc":{const o=su(l,f);let d=l;for(const _ of o){const S=new ft([...d,..._.p1,..._.p2,..._.p3]).getLUT(100);a.push(...S.slice(1).map(z=>[z.x,z.y])),d=_.p3}l=f.p;break}}return a.length>0&&s.push(a),s}function Wr(u,s,a){if(s.length>0&&s[0].type!=="move")throw new Error("Boundary path must start with a 'move' command.");const l=sa(s);let f=0;for(const o of l)uu(u,o)&&f++;return f%2===1}function au(u){return Array.isArray(u[0])&&Array.isArray(u[0][0])&&typeof u[0][0][0]=="number"}function ou(u,s){const a=[u.map(o=>[o[0],o[1]])],l=[s.map(o=>[o[0],o[1]])],f=eu(a,l);return!f||f.length===0?null:au(f)?f:f.map(o=>o[0].map(d=>[d[0],d[1]]))}function uu(u,s){const[a,l]=u;let f=!1;for(let o=0,d=s.length-1;o<s.length;d=o++){const[_,b]=s[o],[S,z]=s[d];b>l!=z>l&&a<(S-_)*(l-b)/(z-b)+_&&(f=!f)}return f}function hu(u,s,a){const l=[];for(const o of u)a.vertices.find(d=>nu(d,o))||a.vertices.push(o);for(const o of u){const d={id:Ks(),origin:o,twin:-1,next:-1,prev:-1,piece:s};l.push(d)}const f=l.length;for(let o=0;o<f;o++){const d=(o+1)%f,_=(o+f-1)%f;l[o].next=l[d].id,l[o].prev=l[_].id}return l.forEach(o=>a.halfEdges.set(o.id,o)),l}function aa(u,s,a,l){const f=(d,_)=>`${d[0]},${d[1]}-${_[0]},${_[1]}`,o=u.length;for(let d=0;d<o;d++){const _=u[d],b=_.origin,S=s.halfEdges.get(_.next).origin,z=f(S,b),M=a.get(z),H=Ks();let L;if(M!==void 0){const Q=s.halfEdges.get(M);_.twin=Q.id,Q.twin=_.id,L={id:H,heLeft:Q.id,heRight:_.id,bounds:Br([b,S])},a.delete(z)}else{const Q=f(b,S);if(a.set(Q,_.id),l(b,S))L={id:H,heLeft:_.id,heRight:-1,bounds:Br([b,S])},s.boundary.push(H);else continue}s.edges.set(H,L)}}function oa(u){return function(){let s=u+=1831565813;return s=Math.imul(s^s>>>15,s|1),s^=s+Math.imul(s^s>>>7,s|61),((s^s>>>14)>>>0)/4294967296}}async function Jn(u){return co("Puzzle Generation",()=>{const{bounds:s,pieceSize:a,border:l}=u,{pointConfig:f,pieceConfig:o,placementConfig:d,tabConfig:_}=u;console.log(`rebuilding puzzle with dimensions ${s.width}x${s.height}, piece size ${a}`);const b=bn.create(l,s,f),S=wn.create(l,s,o),z=Sn.create(l,s,d),M=Li.create(l,s,_),H=u.seed??new Date().getTime(),L=oa(H),Q=u.seedPoints??b.generatePoints({width:s.width,height:s.height,pieceSize:a,random:L,border:l});console.log(`${u.seedPoints?"Using":"Generated"} ${Q.length} points`);const X=S.generatePieces(Q,{random:L,pieceSize:a,border:l,bounds:s});if(console.log(`Generated ${X.pieces.size} pieces`),!u.skipTabs){z.placeTabs({topology:X,random:L});for(const $ of X.edges.values())$.heRight!==-1&&$.tabs&&$.tabs.length>0&&ra($,X,M,L)}const te={created:new Date().toISOString(),seed:H,width:s.width,height:s.height,pieceSize:a,pointConfig:f,pieceConfig:o,placementConfig:d,tabConfig:_,seedPoints:Q,vertices:X.vertices,boundary:X.boundary,borderPath:X.borderPath,pieces:X.pieces,edges:X.edges,halfEdges:X.halfEdges};return Promise.resolve(te)})}async function lu(u,s,a){const l=[...u.seedPoints];let f=0;for(const o of u.pieces.values()){if(o.id===s){l[f]=a;break}f++}return Jn({bounds:{width:u.width,height:u.height},border:u.borderPath,pieceSize:u.pieceSize,pointConfig:u.pointConfig,pieceConfig:u.pieceConfig,placementConfig:u.placementConfig,tabConfig:u.tabConfig,seed:u.seed,seedPoints:l,skipTabs:!1})}function Ur(u,s){return[{type:"move",p:[0,0]},{type:"line",p:[u,0]},{type:"line",p:[u,s]},{type:"line",p:[0,s]},{type:"line",p:[0,0]}]}function cu(u){const s=u/2,a=s;return[{type:"move",p:[0,a]},{type:"arc",p:[u,a],radii:[s,s],rotation:0,largeArc:!1,sweep:!0},{type:"arc",p:[0,a],radii:[s,s],rotation:0,largeArc:!1,sweep:!0}]}function fu(u,s){const a=u/2,l=s/2;return[{type:"move",p:[0,l]},{type:"arc",p:[u,l],radii:[a,l],rotation:0,largeArc:!1,sweep:!0},{type:"arc",p:[0,l],radii:[a,l],rotation:0,largeArc:!1,sweep:!0}]}function du(u,s,a){const l=Math.min(u,s)/2,f=Math.min(a,l);return[{type:"move",p:[f,0]},{type:"line",p:[u-f,0]},{type:"arc",p:[u,f],radii:[f,f],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[u,s-f]},{type:"arc",p:[u-f,s],radii:[f,f],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[f,s]},{type:"arc",p:[0,s-f],radii:[f,f],rotation:0,largeArc:!1,sweep:!0},{type:"line",p:[0,f]},{type:"arc",p:[f,0],radii:[f,f],rotation:0,largeArc:!1,sweep:!0}]}function pu(u,s,a){if(s<0||s>=u.vertices.length){console.warn("moveVertex called with invalid vertex index:",s);return}const l=u.vertices[s];u.vertices[s]=a;const f=[];for(const _ of u.halfEdges.values())_.origin[0]===l[0]&&_.origin[1]===l[1]&&f.push(_);const o=new Set,d=[a[0]-l[0],a[1]-l[1]];for(const _ of f){_.origin=a,o.add(_.piece);const b=u.halfEdges.get(_.prev);if(b?.segments){const S=b.segments[b.segments.length-1];S.type==="line"?S.p=a:(S.p3=a,S.p1=[S.p1[0]+d[0],S.p1[1]+d[1]],S.p2=[S.p2[0]+d[0],S.p2[1]+d[1]]),o.add(b.piece)}}gu(u,s);for(const _ of o){const b=u.pieces.get(_);b&&(b.bounds=na(b,u))}}function gu(u,s){const{seed:a,width:l,height:f,placementConfig:o,tabConfig:d}=u,_=oa(a),b=Ur(l,f),S={width:l,height:f},z=Sn.create(b,S,o),M=Li.create(b,S,d),H=new Set,L=u.vertices[s],Q=new Map;for(const te of u.edges.values())Q.set(te.heLeft,te),te.heRight!==-1&&Q.set(te.heRight,te);for(const te of u.halfEdges.values()){const $=u.halfEdges.get(te.next)?.origin;if(te.origin===L||$===L){const _e=Q.get(te.id);_e&&H.add(_e)}}z.updateTabPlacements(Array.from(H),{topology:u,random:_});const X=new Set;for(const te of H)if(te.heRight!==-1){const pe=u.halfEdges.get(te.heLeft);pe&&(pe.segments=void 0,X.add(u.pieces.get(pe.piece)));const re=u.halfEdges.get(te.heRight);re&&(re.segments=void 0,X.add(u.pieces.get(re.piece))),ra(te,u,M,_)}for(const te of X)te.bounds=na(te,u)}function Zn(u,s){for(const a of u.children)if(a.data.vertexId===s)return a;return null}function sr(u,s){const a=s.getBoundingClientRect();let l,f;if(u instanceof TouchEvent){if(u.changedTouches.length===0)return null;const d=u.changedTouches[0];l=d.clientX,f=d.clientY}else l=u.clientX,f=u.clientY;const o=new Ve.Point(l-a.left,f-a.top);return Ve.view.viewToProject(o)}function er(u){return[u.x,u.y]}function ks(u,s,a,l){const f=[...u.puzzle.seedPoints];let o=0;for(const d of u.puzzle.pieces.values()){if(d.id===a){f[o]=l;break}o++}Jn({bounds:{width:u.puzzle.width,height:u.puzzle.height},border:u.puzzle.borderPath,pieceSize:u.puzzle.pieceSize,pointConfig:u.puzzle.pointConfig,pieceConfig:u.puzzle.pieceConfig,placementConfig:u.puzzle.placementConfig,tabConfig:u.puzzle.tabConfig,seed:u.puzzle.seed,seedPoints:f,skipTabs:!0}).then(d=>{s.draggedSeedPointId===a&&Kn(s,d,u.color,u.pointColor)}).catch(d=>{console.error("Failed to regenerate preview:",d)})}function mu(u,s,a){if(u.redraw=!1,a.isDragging||!a.canvas)return;const l=sr(u,a.canvas);if(!l)return;let f=!1;const o=er(l);if(a.vertexItems){let d=-1,_=Xa;const b=Xs(s.puzzle);for(let S=0;S<s.puzzle.vertices.length;S++){if(b.has(S))continue;const z=tu(s.puzzle.vertices[S],o);z<_&&(_=z,d=S)}if(d>=0){if(a.hoveredVertexId!==d){if(a.hoveredVertexId>=0){const z=Zn(a.vertexItems,a.hoveredVertexId);z&&(z.visible=!1)}const S=Zn(a.vertexItems,d);S&&(S.visible=!0,a.hoveredVertexId=d)}f=!0}else if(a.hoveredVertexId>=0){const S=Zn(a.vertexItems,a.hoveredVertexId);S&&(S.visible=!1,a.hoveredVertexId=-1)}}s.pointColor&&a.seedPointItems&&a.seedPointItems.hitTest(l,{fill:!0,tolerance:5})&&(f=!0),a.canvas.style.cursor=f?"grab":"default"}function Es(u,s,a){if(u.redraw=!1,!a.canvas)return;if(u instanceof TouchEvent&&u.touches.length>1){a.isDragging=!1,a.draggedVertexId=-1,a.draggedSeedPointId=-1;return}if(u instanceof MouseEvent&&u.button!==0)return;const l=sr(u,a.canvas);if(l){if(s.pointColor&&a.seedPointItems){const f=a.seedPointItems.hitTest(l,{fill:!0,tolerance:5});if(f?.item.data.pieceId!==void 0){a.draggedSeedPointId=f.item.data.pieceId,a.isDragging=!1,u instanceof MouseEvent&&(a.documentMouseMove=o=>{const d=o;d.redraw=!1,tr(d,s,a)},a.documentMouseUp=o=>{const d=o;d.redraw=!1,gn(d,s,a)},document.addEventListener("mousemove",a.documentMouseMove),document.addEventListener("mouseup",a.documentMouseUp));return}}if(a.vertexItems){const f=a.vertexItems.hitTest(l,{fill:!0,tolerance:8});if(f?.item.data.vertexId!==void 0){a.draggedVertexId=f.item.data.vertexId,a.isDragging=!1,u instanceof MouseEvent&&(a.documentMouseMove=o=>{const d=o;d.redraw=!1,tr(d,s,a)},a.documentMouseUp=o=>{const d=o;d.redraw=!1,gn(d,s,a)},document.addEventListener("mousemove",a.documentMouseMove),document.addEventListener("mouseup",a.documentMouseUp));return}}}}function tr(u,s,a){if(u.redraw=!1,!a.canvas)return;const l=sr(u,a.canvas);if(l){if(a.draggedVertexId>=0){a.isDragging=!0,u.preventDefault(),a.canvas.style.cursor="grabbing";const f=er(l);if(pu(s.puzzle,a.draggedVertexId,f),a.vertexItems){const o=Zn(a.vertexItems,a.draggedVertexId);o&&(o.position=l)}Kn(a,s.puzzle,s.color,s.pointColor);return}if(a.draggedSeedPointId>=0){a.isDragging=!0,u.preventDefault(),a.canvas.style.cursor="grabbing";const f=er(l),o=performance.now();if(o-a.lastRegenerationTime<cs){a.pendingRegeneration&&clearTimeout(a.pendingRegeneration),a.pendingRegeneration=window.setTimeout(()=>{ks(s,a,a.draggedSeedPointId,f)},cs);return}a.lastRegenerationTime=o,ks(s,a,a.draggedSeedPointId,f)}}}function gn(u,s,a){if(u.redraw=!1,!a.canvas)return;a.pendingRegeneration&&(clearTimeout(a.pendingRegeneration),a.pendingRegeneration=null);const l=a.draggedVertexId>=0&&a.isDragging,f=a.draggedSeedPointId>=0&&a.isDragging;if(l&&(u.preventDefault(),s.onPuzzleChanged(s.puzzle)),f){u.preventDefault();const o=a.draggedSeedPointId,d=sr(u,a.canvas);if(d&&s.onSeedPointMoved){const _=er(d);s.onSeedPointMoved(o,_)}}a.documentMouseMove&&(document.removeEventListener("mousemove",a.documentMouseMove),a.documentMouseMove=null),a.documentMouseUp&&(document.removeEventListener("mouseup",a.documentMouseUp),a.documentMouseUp=null),a.isDragging=!1,a.draggedVertexId=-1,a.draggedSeedPointId=-1,a.canvas.style.cursor="default"}const vu=()=>{const u={canvas:null,isDragging:!1,draggedVertexId:-1,draggedSeedPointId:-1,lastRegenerationTime:0,pendingRegeneration:null,documentMouseMove:null,documentMouseUp:null,paperPath:null,seedPointItems:null,problemItems:null,vertexItems:null,hoveredVertexId:-1};return{oncreate:({dom:s,attrs:a})=>{if(u.canvas=s.querySelector("canvas.puzzle-renderer"),!u.canvas){console.error("PuzzleRenderer: couldn't get canvas element");return}fo(u.canvas,a.width,a.height),po(u),a.isDirty||Kn(u,a.puzzle,a.color,a.pointColor)},onupdate:({attrs:s})=>{if(!u.canvas){console.error("PuzzleRenderer: couldn't get canvas element");return}s.isDirty||Kn(u,s.puzzle,s.color,s.pointColor)},onremove:()=>{u.documentMouseMove&&(document.removeEventListener("mousemove",u.documentMouseMove),u.documentMouseMove=null),u.documentMouseUp&&(document.removeEventListener("mouseup",u.documentMouseUp),u.documentMouseUp=null),mo(u)},view:({attrs:s})=>oe(".puzzle-renderer-stack",[oe("img.background",{width:s.width,height:s.height,src:s.imageUrl??Ka}),oe("canvas.puzzle-renderer",{width:s.width,height:s.height,style:{width:`${s.width}px`,height:`${s.height}px`,touchAction:"manipulation"},onmousedown:a=>Es(a,s,u),onmousemove:a=>{mu(a,s,u),tr(a,s,u)},onmouseup:a=>gn(a,s,u),ontouchstart:a=>Es(a,s,u),ontouchmove:a=>tr(a,s,u),ontouchend:a=>gn(a,s,u),ontouchcancel:a=>gn(a,s,u)})])}};function _u(u,s,a,l="black"){const o=[];for(const b of u.edges.values()){const S=u.halfEdges.get(b.heLeft);if(S)if(o.push(`M ${S.origin[0].toFixed(3)} ${S.origin[1].toFixed(3)}`),S.segments)for(const z of S.segments)switch(z.type){case"bezier":o.push(`C ${z.p1[0].toFixed(3)} ${z.p1[1].toFixed(3)}, ${z.p2[0].toFixed(3)} ${z.p2[1].toFixed(3)}, ${z.p3[0].toFixed(3)} ${z.p3[1].toFixed(3)}`);break;case"line":o.push(`L ${z.p[0].toFixed(3)} ${z.p[1].toFixed(3)}`);break}else{let z;S.twin!==-1?z=u.halfEdges.get(S.twin).origin:z=u.halfEdges.get(S.next).origin,o.push(`L ${z[0].toFixed(3)} ${z[1].toFixed(3)}`)}}const d=o.join(" ");return`
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg
  width="${s}"
  height="${a}"
  viewBox="0 0 ${s} ${a}"
  xmlns="http://www.w3.org/2000/svg"
  version="1.1"
>
  <path
    d="${d}"
    fill="none"
    stroke="${l}"
    stroke-width="1"
    vector-effect="non-scaling-stroke"
  />
</svg>`.trim().replace(/\r\n/g,`
`)}function yu(u,s="puzzle.svg"){const a=new Blob([u],{type:"image/svg+xml"}),l=URL.createObjectURL(a),f=document.createElement("a");f.href=l,f.download=s,f.hidden=!0,document.body.appendChild(f),f.click(),document.body.removeChild(f),setTimeout(()=>URL.revokeObjectURL(l),100)}const xu={view:({attrs:u})=>oe("wa-button.download-svg",{size:"small",onclick:()=>{const s=_u(u.puzzle,u.width,u.height,u.color);yu(s,u.filename??"puzzle.svg")}},"Download SVG")},bu={view:({attrs:u})=>{const s=u.progressPercent!==void 0&&u.progressPercent<100,a=!s&&u.problems!==void 0&&u.problems==0,l=!s&&u.problems!==void 0&&u.problems>0;return oe(".geometry-check-indicator",[oe(".label","Geometry Check:"),oe("wa-tooltip",{for:"check-geometry-now"},"Check geometry now"),oe("wa-button#check-geometry-now",{variant:"neutral",appearance:"plain",size:"small",disabled:s,onclick:f=>{f.redraw=!1,u.onCheckRequested?.()}},oe("wa-icon",{library:"material",name:"editor_choice",label:"Check geometry now"})),oe("wa-tooltip",{for:"auto-check-geometry"},"Check geometry after every change"),oe("wa-checkbox#auto-check-geometry",{checked:u.autoCheck,disabled:s,size:"small",onchange:f=>{f.redraw=!1;const o=f.target;u.onAutocheckChanged?.(o.checked)}},"auto check"),s&&oe("wa-progress-bar",{label:"Geometry check progress",value:u.progressPercent??0}),a&&oe("wa-badge",{variant:"success",pill:!0},"OK"),l&&oe("wa-badge",{variant:"danger",pill:!0},`${u.problems} issue${u.problems===1?"":"s"}`)])}};function wu(u,s,a=800){if(u<=a)return{width:u,height:s};const l=s/u;return{width:a,height:Math.round(a*l)}}const Su=()=>{const u={inputElement:void 0,imageLoaded:!1,imageName:""};return{view:({attrs:s})=>[oe("wa-button.upload-button",{size:"small",disabled:s.disabled===!0,onclick:()=>{u.inputElement&&u.inputElement.click()}},s.label??"Upload Image"),oe("input[type=file]",{style:{display:"none"},accept:"image/*",oncreate:({dom:a})=>{u.inputElement=a},onchange:a=>{if(a.redraw=!1,u.inputElement){const l=u.inputElement.files?.[0];l?.type.startsWith("image/")&&createImageBitmap(l).then(f=>{const{width:o,height:d}=wu(f.width,f.height),_=URL.createObjectURL(l);f.close(),u.imageName=l.name,s.onUpload(_,l.name,o,d),u.imageLoaded=!0}).catch(f=>{console.error("could not create a bitmap image: ",f)})}}}),oe("span.background-image-label",u.imageName),u.imageLoaded&&oe("wa-icon.clear-button",{library:"material",name:"close",label:"Clear background image",onclick:a=>{a.redraw=!1,!s.disabled&&(u.imageName="",u.imageLoaded=!1,s.onClear())}},"Clear")]}},ua=()=>({view:({attrs:u})=>oe("wa-checkbox.boolean-input",{hint:u.config.helpText,disabled:u.disabled,checked:u.value,onchange:s=>{const l=s.target.checked;u.onChange(l)}},u.config.label)}),Xn=()=>({view:({attrs:u})=>oe("wa-input.number-input",{label:u.config.label,hint:u.config.helpText,type:"number",inputmode:"numeric",size:"small",disabled:u.disabled,value:u.value,min:u.config.min,max:u.config.max,onchange:s=>{const a=s.target,l=parseFloat(a.value??"");u.onChange(isNaN(l)?void 0:l)}})}),Cu=()=>({view:({attrs:u})=>oe("wa-slider.range-input",{label:u.config.label,hint:u.config.helpText,disabled:u.disabled,value:u.value,min:u.config.min,max:u.config.max,step:u.config.step,"with-tooltip":!0,onchange:s=>{const l=s.target.value;u.onChange(isNaN(l)?void 0:l)}})}),Pu=()=>({view:({attrs:u})=>oe("wa-input.string-input",{label:u.config.label,hint:u.config.helpText,type:"text",inputmode:"text",size:"small",disabled:u.disabled,value:u.value,onchange:s=>{const l=s.target.value??"";u.onChange(l.length>0?l:void 0)}})}),Iu=()=>({view:({attrs:u})=>{const s=u.registry.getAvailableGenerators();return oe(".generator-picker",oe("wa-tab-group",{active:u.generator,"onwa-tab-show":a=>{const l=a.detail.name;u.generator!==l&&u.onGeneratorChange(l)}},[...s.map(a=>{const l=u.registry.getUIMetadata(a.name),f=oe("wa-tab",{panel:a.name},a.displayName),o=oe("wa-tab-panel",{name:a.name},oe(".controls",[l?.description?oe("p",l.description):null,...l?.controls.map(d=>{switch(d.type){case"range":return oe(Cu,{config:d,value:u.config?.[d.name]??d.defaultValue,onChange:_=>{u.onConfigChange(d.name,_)}});case"boolean":return oe(ua,{config:d,value:(u.config?.[d.name]??d.defaultValue)===!0,onChange:_=>{u.onConfigChange(d.name,_)}});case"number":return oe(Xn,{config:d,value:u.config?.[d.name]??d.defaultValue,onChange:_=>{u.onConfigChange(d.name,_)}});case"string":return oe(Pu,{config:d,value:u.config?.[d.name]??d.defaultValue,onChange:_=>{u.onConfigChange(d.name,_)}})}})??[],!l?.description&&l?.controls.length==0?oe("p","No controls for this strategy."):null]));return[f,o]})]))}}),As=[["Square","1:1",1],["Classic Photo","5:4",5/4],["Standard Photo","4:3",4/3],["35mm/DSLR","3:2",3/2],["Widescreen","16:9",16/9],["UltraWide","21:9",21/9],["Panorama","2:1",2/1],["Instagram Portrait","4:5",4/5],["Classic Portrait","3:4",3/4],["DSLR Portrait","2:3",2/3],["Phone Portrait","9:16",9/16],["Tall Poster","9:21",9/21],["Tall Panorama","1:2",1/2]],ku={view:({attrs:u})=>{const s=!As.some(([,,l])=>l===u.ratio),a=As.map(([l,f,o])=>oe("wa-option",{value:String(o)},`${l} [${f}]`));return s&&a.unshift(oe("wa-option",{value:"custom"},"Custom")),oe(".aspect-ratio-picker",[oe("wa-select",{label:"Aspect Ratio",size:"small",disabled:u.disabled,value:s?"custom":String(u.ratio),onchange:l=>{l.redraw=!1;const o=l.target.value;o&&o!=="custom"&&u.onChange(Number(o))}},a),oe("wa-slider",{min:.25,max:4,step:.01,"with-tooltip":!0,size:"small",disabled:u.disabled,value:u.ratio,onchange:l=>{l.redraw=!1;const f=l.target;u.onChange(f.value)}})])}},Ts={view:({attrs:u})=>oe("wa-color-picker",{label:u.label,value:u.color,size:u.size??"medium",format:"rgb",onchange:s=>{s.redraw=!1;const a=s.target;u.onUpdate(a.value??"")}})},Eu=[["rectangle","Rectangle"],["circle","Circle"],["ellipse","Ellipse"],["rounded-rect","Rounded Rectangle"]],Au={view:({attrs:u})=>{const s=Eu.map(([a,l])=>oe("wa-option",{value:a},l));return oe("wa-select",{label:"Border Shape",size:"small",disabled:u.disabled,value:u.shape,onchange:a=>{a.redraw=!1;const f=a.target.value;f&&u.onChange(f)}},s)}};var Cr,Ms;function ha(){if(Ms)return Cr;Ms=1;function u(a){var l=a.length,f=1,o=new Array(l),d;for(d=l;d>0;d--)o[d-1]=f,f=f*a[d-1];return{stride:o,data:new Uint32Array(f)}}function s(a){var l=a.length,f=1,o=new Array(l),d=[],_,b;for(_=l;_>0;_--)o[_-1]=f,f=f*a[_-1];for(b=0;b<f;b++)d.push([]);return{stride:o,data:d}}return Cr={integer:u,array:s},Cr}var Pr,Ls;function la(){if(Ls)return Pr;Ls=1,Pr=u;function u(s,a){var l=new Array(s),f=Math.floor(s/2)<<1,o=0,d,_,b,S,z;for(z=0;z<f;z+=2)d=-2*Math.log(a()),_=Math.sqrt(d),b=2*Math.PI*a(),o+=d,l[z]=_*Math.cos(b),l[z+1]=_*Math.sin(b);if(s%2){var M=Math.sqrt(-2*Math.log(a()))*Math.cos(2*Math.PI*a());l[s-1]=M,o+=Math.pow(M,2)}for(S=1/Math.sqrt(o),z=0;z<s;++z)l[z]*=S;return l}return Pr}var Ir,Os;function Tu(){return Os||(Os=1,Ir=function(s,a){s=s||1,a=a||2;for(var l=s*2+1,f=Math.pow(l,a)-1,o=new Array(f),d=0;d<f;d++)for(var _=o[d]=new Array(a),b=d<f/2?d:d+1,S=1;S<=a;S++){var z=b%Math.pow(l,S);_[S-1]=z/Math.pow(l,S-1)-s,b-=z}return o}),Ir}var kr,zs;function ca(){if(zs)return kr;zs=1;var u=Tu();function s(f){var o=u(2,f),d=[],_;for(o=o.filter(function(b){for(var S=0,z=0;z<f;z++)S+=Math.pow(Math.max(0,Math.abs(b[z])-1),2);return S<f}),_=0;_<f;_++)d.push(0);return o.push(d),o.sort(function(b,S){var z=0,M=0,H;for(H=0;H<f;H++)z+=Math.pow(b[H],2),M+=Math.pow(S[H],2);return z<M?-1:z>M?1:0}),o}var a={};function l(f){return a[f]||(a[f]=s(f)),a[f]}return kr=l,kr}var Er,Ns;function Mu(){if(Ns)return Er;Ns=1;var u=ha().integer,s=la(),a=ca();function l(o,d){for(var _=0,b=0;b<o.length;b++)_+=Math.pow(o[b]-d[b],2);return _}function f(o,d){if(typeof o.distanceFunction=="function")throw new Error("PoissonDiskSampling: Tried to instantiate the fixed density implementation with a distanceFunction");this.shape=o.shape,this.minDistance=o.minDistance,this.maxDistance=o.maxDistance||o.minDistance*2,this.maxTries=Math.ceil(Math.max(1,o.tries||30)),this.rng=d||Math.random;for(var _=0,b=0;b<this.shape.length;b++)_=Math.max(_,this.shape[b]);var S=Math.max(1,_/128|0),z=1e-14*S;this.dimension=this.shape.length,this.squaredMinDistance=this.minDistance*this.minDistance,this.minDistancePlusEpsilon=this.minDistance+z,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.minDistance/Math.sqrt(this.dimension),this.neighbourhood=a(this.dimension),this.currentPoint=null,this.processList=[],this.samplePoints=[],this.gridShape=[];for(var b=0;b<this.dimension;b++)this.gridShape.push(Math.ceil(this.shape[b]/this.cellSize));this.grid=u(this.gridShape)}return f.prototype.shape=null,f.prototype.dimension=null,f.prototype.minDistance=null,f.prototype.maxDistance=null,f.prototype.minDistancePlusEpsilon=null,f.prototype.squaredMinDistance=null,f.prototype.deltaDistance=null,f.prototype.cellSize=null,f.prototype.maxTries=null,f.prototype.rng=null,f.prototype.neighbourhood=null,f.prototype.currentPoint=null,f.prototype.processList=null,f.prototype.samplePoints=null,f.prototype.gridShape=null,f.prototype.grid=null,f.prototype.addRandomPoint=function(){for(var o=new Array(this.dimension),d=0;d<this.dimension;d++)o[d]=this.rng()*this.shape[d];return this.directAddPoint(o)},f.prototype.addPoint=function(o){var d,_=!0;if(o.length===this.dimension)for(d=0;d<this.dimension&&_;d++)_=o[d]>=0&&o[d]<this.shape[d];else _=!1;return _?this.directAddPoint(o):null},f.prototype.directAddPoint=function(o){var d=0,_=this.grid.stride,b;for(this.processList.push(o),this.samplePoints.push(o),b=0;b<this.dimension;b++)d+=(o[b]/this.cellSize|0)*_[b];return this.grid.data[d]=this.samplePoints.length,o},f.prototype.inNeighbourhood=function(o){var d=this.dimension,_=this.grid.stride,b,S,z,M,H;for(b=0;b<this.neighbourhood.length;b++){for(S=0,z=0;z<d;z++){if(M=(o[z]/this.cellSize|0)+this.neighbourhood[b][z],M<0||M>=this.gridShape[z]){S=-1;break}S+=M*_[z]}if(S!==-1&&this.grid.data[S]!==0&&(H=this.samplePoints[this.grid.data[S]-1],l(o,H)<this.squaredMinDistance))return!0}return!1},f.prototype.next=function(){for(var o,d,_,b,S,z,M;this.processList.length>0;){for(this.currentPoint===null&&(this.currentPoint=this.processList.shift()),b=this.currentPoint,o=0;o<this.maxTries;o++){for(z=!0,_=this.minDistancePlusEpsilon+this.deltaDistance*this.rng(),this.dimension===2?(d=this.rng()*Math.PI*2,S=[Math.cos(d),Math.sin(d)]):S=s(this.dimension,this.rng),M=0;z&&M<this.dimension;M++)S[M]=b[M]+S[M]*_,z=S[M]>=0&&S[M]<this.shape[M];if(z&&!this.inNeighbourhood(S))return this.directAddPoint(S)}o===this.maxTries&&(this.currentPoint=null)}return null},f.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},f.prototype.getAllPoints=function(){return this.samplePoints},f.prototype.getAllPointsWithDistance=function(){throw new Error("PoissonDiskSampling: getAllPointsWithDistance() is not available in fixed-density implementation")},f.prototype.reset=function(){var o=this.grid.data,d=0;for(d=0;d<o.length;d++)o[d]=0;this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Er=f,Er}var Ar,Rs;function Lu(){if(Rs)return Ar;Rs=1;var u=ha().array,s=la(),a=ca();function l(o,d){for(var _=0,b=0;b<o.length;b++)_+=Math.pow(o[b]-d[b],2);return Math.sqrt(_)}function f(o,d){if(typeof o.distanceFunction!="function")throw new Error("PoissonDiskSampling: Tried to instantiate the variable density implementation without a distanceFunction");this.shape=o.shape,this.minDistance=o.minDistance,this.maxDistance=o.maxDistance||o.minDistance*2,this.maxTries=Math.ceil(Math.max(1,o.tries||30)),this.distanceFunction=o.distanceFunction,this.bias=Math.max(0,Math.min(1,o.bias||0)),this.rng=d||Math.random;for(var _=0,b=0;b<this.shape.length;b++)_=Math.max(_,this.shape[b]);var S=Math.max(1,_/128|0),z=1e-14*S;this.dimension=this.shape.length,this.minDistancePlusEpsilon=this.minDistance+z,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.maxDistance/Math.sqrt(this.dimension),this.neighbourhood=a(this.dimension),this.currentPoint=null,this.currentDistance=0,this.processList=[],this.samplePoints=[],this.sampleDistance=[],this.gridShape=[];for(var b=0;b<this.dimension;b++)this.gridShape.push(Math.ceil(this.shape[b]/this.cellSize));this.grid=u(this.gridShape)}return f.prototype.shape=null,f.prototype.dimension=null,f.prototype.minDistance=null,f.prototype.maxDistance=null,f.prototype.minDistancePlusEpsilon=null,f.prototype.deltaDistance=null,f.prototype.cellSize=null,f.prototype.maxTries=null,f.prototype.distanceFunction=null,f.prototype.bias=null,f.prototype.rng=null,f.prototype.neighbourhood=null,f.prototype.currentPoint=null,f.prototype.currentDistance=null,f.prototype.processList=null,f.prototype.samplePoints=null,f.prototype.sampleDistance=null,f.prototype.gridShape=null,f.prototype.grid=null,f.prototype.addRandomPoint=function(){for(var o=new Array(this.dimension),d=0;d<this.dimension;d++)o[d]=this.rng()*this.shape[d];return this.directAddPoint(o)},f.prototype.addPoint=function(o){var d,_=!0;if(o.length===this.dimension)for(d=0;d<this.dimension&&_;d++)_=o[d]>=0&&o[d]<this.shape[d];else _=!1;return _?this.directAddPoint(o):null},f.prototype.directAddPoint=function(o){var d=0,_=this.grid.stride,b=this.samplePoints.length,S;for(this.processList.push(b),this.samplePoints.push(o),this.sampleDistance.push(this.distanceFunction(o)),S=0;S<this.dimension;S++)d+=(o[S]/this.cellSize|0)*_[S];return this.grid.data[d].push(b),o},f.prototype.inNeighbourhood=function(o){var d=this.dimension,_=this.grid.stride,b,S,z,M,H,L,Q=this.distanceFunction(o);for(b=0;b<this.neighbourhood.length;b++){for(S=0,z=0;z<d;z++){if(M=(o[z]/this.cellSize|0)+this.neighbourhood[b][z],M<0||M>=this.gridShape[z]){S=-1;break}S+=M*_[z]}if(S!==-1&&this.grid.data[S].length>0)for(var X=0;X<this.grid.data[S].length;X++){H=this.samplePoints[this.grid.data[S][X]],L=this.sampleDistance[this.grid.data[S][X]];var te=Math.min(L,Q),$=Math.max(L,Q),pe=te+($-te)*this.bias;if(l(o,H)<this.minDistance+this.deltaDistance*pe)return!0}}return!1},f.prototype.next=function(){for(var o,d,_,b,S,z,M,H;this.processList.length>0;){if(this.currentPoint===null){var L=this.processList.shift();this.currentPoint=this.samplePoints[L],this.currentDistance=this.sampleDistance[L]}for(b=this.currentPoint,S=this.currentDistance,o=0;o<this.maxTries;o++){for(M=!0,_=this.minDistancePlusEpsilon+this.deltaDistance*(S+(1-S)*this.bias),this.dimension===2?(d=this.rng()*Math.PI*2,z=[Math.cos(d),Math.sin(d)]):z=s(this.dimension,this.rng),H=0;M&&H<this.dimension;H++)z[H]=b[H]+z[H]*_,M=z[H]>=0&&z[H]<this.shape[H];if(M&&!this.inNeighbourhood(z))return this.directAddPoint(z)}o===this.maxTries&&(this.currentPoint=null)}return null},f.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},f.prototype.getAllPoints=function(){return this.samplePoints},f.prototype.getAllPointsWithDistance=function(){var o=new Array(this.samplePoints.length),d=0,_=0,b;for(d=0;d<this.samplePoints.length;d++){for(b=new Array(this.dimension+1),_=0;_<this.dimension;_++)b[_]=this.samplePoints[d][_];b[this.dimension]=this.sampleDistance[d],o[d]=b}return o},f.prototype.reset=function(){var o=this.grid.data,d=0;for(d=0;d<o.length;d++)o[d]=[];this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Ar=f,Ar}var Tr,Ds;function Ou(){if(Ds)return Tr;Ds=1;var u=Mu(),s=Lu();function a(l,f){this.shape=l.shape,typeof l.distanceFunction=="function"?this.implementation=new s(l,f):this.implementation=new u(l,f)}return a.prototype.implementation=null,a.prototype.addRandomPoint=function(){return this.implementation.addRandomPoint()},a.prototype.addPoint=function(l){return this.implementation.addPoint(l)},a.prototype.next=function(){return this.implementation.next()},a.prototype.fill=function(){return this.implementation.fill()},a.prototype.getAllPoints=function(){return this.implementation.getAllPoints()},a.prototype.getAllPointsWithDistance=function(){return this.implementation.getAllPointsWithDistance()},a.prototype.reset=function(){this.implementation.reset()},Tr=a,Tr}var zu=Ou();const Nu=Gr(zu),Zr="PoissonPointGenerator",Ru={name:Zr,displayName:"Poisson",description:"Generate seed points using Poisson disk sampling. The algorithm produces points that are tightly-packed, but no closer to each other than a specified minimum distance (the piece size), resulting in a natural, organic look.",sortHint:1,controls:[]},Du=(u,s,a)=>({generatePoints(f){const{width:o,height:d,pieceSize:_,random:b,border:S}=f;return new Nu({shape:[o,d],minDistance:_,tries:20},b).fill().filter(L=>Wr(L,S))}});bn.register(Zr,Du,Ru);const ai=11102230246251565e-32,Mt=134217729,Vu=(3+8*ai)*ai;function Mr(u,s,a,l,f){let o,d,_,b,S=s[0],z=l[0],M=0,H=0;z>S==z>-S?(o=S,S=s[++M]):(o=z,z=l[++H]);let L=0;if(M<u&&H<a)for(z>S==z>-S?(d=S+o,_=o-(d-S),S=s[++M]):(d=z+o,_=o-(d-z),z=l[++H]),o=d,_!==0&&(f[L++]=_);M<u&&H<a;)z>S==z>-S?(d=o+S,b=d-o,_=o-(d-b)+(S-b),S=s[++M]):(d=o+z,b=d-o,_=o-(d-b)+(z-b),z=l[++H]),o=d,_!==0&&(f[L++]=_);for(;M<u;)d=o+S,b=d-o,_=o-(d-b)+(S-b),S=s[++M],o=d,_!==0&&(f[L++]=_);for(;H<a;)d=o+z,b=d-o,_=o-(d-b)+(z-b),z=l[++H],o=d,_!==0&&(f[L++]=_);return(o!==0||L===0)&&(f[L++]=o),L}function Fu(u,s){let a=s[0];for(let l=1;l<u;l++)a+=s[l];return a}function Pn(u){return new Float64Array(u)}const Bu=(3+16*ai)*ai,Uu=(2+12*ai)*ai,qu=(9+64*ai)*ai*ai,Ui=Pn(4),Vs=Pn(8),Fs=Pn(12),Bs=Pn(16),zt=Pn(4);function Hu(u,s,a,l,f,o,d){let _,b,S,z,M,H,L,Q,X,te,$,pe,re,_e,he,T,ve,xe;const de=u-f,Se=a-f,Ie=s-o,Ce=l-o;_e=de*Ce,H=Mt*de,L=H-(H-de),Q=de-L,H=Mt*Ce,X=H-(H-Ce),te=Ce-X,he=Q*te-(_e-L*X-Q*X-L*te),T=Ie*Se,H=Mt*Ie,L=H-(H-Ie),Q=Ie-L,H=Mt*Se,X=H-(H-Se),te=Se-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,Ui[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,Ui[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,Ui[2]=pe-(xe-M)+($-M),Ui[3]=xe;let ze=Fu(4,Ui),Pe=Uu*d;if(ze>=Pe||-ze>=Pe||(M=u-de,_=u-(de+M)+(M-f),M=a-Se,S=a-(Se+M)+(M-f),M=s-Ie,b=s-(Ie+M)+(M-o),M=l-Ce,z=l-(Ce+M)+(M-o),_===0&&b===0&&S===0&&z===0)||(Pe=qu*d+Vu*Math.abs(ze),ze+=de*z+Ce*_-(Ie*S+Se*b),ze>=Pe||-ze>=Pe))return ze;_e=_*Ce,H=Mt*_,L=H-(H-_),Q=_-L,H=Mt*Ce,X=H-(H-Ce),te=Ce-X,he=Q*te-(_e-L*X-Q*X-L*te),T=b*Se,H=Mt*b,L=H-(H-b),Q=b-L,H=Mt*Se,X=H-(H-Se),te=Se-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,zt[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,zt[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,zt[2]=pe-(xe-M)+($-M),zt[3]=xe;const et=Mr(4,Ui,4,zt,Vs);_e=de*z,H=Mt*de,L=H-(H-de),Q=de-L,H=Mt*z,X=H-(H-z),te=z-X,he=Q*te-(_e-L*X-Q*X-L*te),T=Ie*S,H=Mt*Ie,L=H-(H-Ie),Q=Ie-L,H=Mt*S,X=H-(H-S),te=S-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,zt[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,zt[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,zt[2]=pe-(xe-M)+($-M),zt[3]=xe;const ge=Mr(et,Vs,4,zt,Fs);_e=_*z,H=Mt*_,L=H-(H-_),Q=_-L,H=Mt*z,X=H-(H-z),te=z-X,he=Q*te-(_e-L*X-Q*X-L*te),T=b*S,H=Mt*b,L=H-(H-b),Q=b-L,H=Mt*S,X=H-(H-S),te=S-X,ve=Q*te-(T-L*X-Q*X-L*te),$=he-ve,M=he-$,zt[0]=he-($+M)+(M-ve),pe=_e+$,M=pe-_e,re=_e-(pe-M)+($-M),$=re-T,M=re-$,zt[1]=re-($+M)+(M-T),xe=pe+$,M=xe-pe,zt[2]=pe-(xe-M)+($-M),zt[3]=xe;const Ye=Mr(ge,Fs,4,zt,Bs);return Bs[Ye-1]}function Gn(u,s,a,l,f,o){const d=(s-o)*(a-f),_=(u-f)*(l-o),b=d-_,S=Math.abs(d+_);return Math.abs(b)>=Bu*S?b:-Hu(u,s,a,l,f,o,S)}const Us=Math.pow(2,-52),jn=new Uint32Array(512);class ir{static from(s,a=Xu,l=Ku){const f=s.length,o=new Float64Array(f*2);for(let d=0;d<f;d++){const _=s[d];o[2*d]=a(_),o[2*d+1]=l(_)}return new ir(o)}constructor(s){const a=s.length>>1;if(a>0&&typeof s[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=s;const l=Math.max(2*a-5,0);this._triangles=new Uint32Array(l*3),this._halfedges=new Int32Array(l*3),this._hashSize=Math.ceil(Math.sqrt(a)),this._hullPrev=new Uint32Array(a),this._hullNext=new Uint32Array(a),this._hullTri=new Uint32Array(a),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(a),this._dists=new Float64Array(a),this.update()}update(){const{coords:s,_hullPrev:a,_hullNext:l,_hullTri:f,_hullHash:o}=this,d=s.length>>1;let _=1/0,b=1/0,S=-1/0,z=-1/0;for(let de=0;de<d;de++){const Se=s[2*de],Ie=s[2*de+1];Se<_&&(_=Se),Ie<b&&(b=Ie),Se>S&&(S=Se),Ie>z&&(z=Ie),this._ids[de]=de}const M=(_+S)/2,H=(b+z)/2;let L,Q,X;for(let de=0,Se=1/0;de<d;de++){const Ie=Lr(M,H,s[2*de],s[2*de+1]);Ie<Se&&(L=de,Se=Ie)}const te=s[2*L],$=s[2*L+1];for(let de=0,Se=1/0;de<d;de++){if(de===L)continue;const Ie=Lr(te,$,s[2*de],s[2*de+1]);Ie<Se&&Ie>0&&(Q=de,Se=Ie)}let pe=s[2*Q],re=s[2*Q+1],_e=1/0;for(let de=0;de<d;de++){if(de===L||de===Q)continue;const Se=Wu(te,$,pe,re,s[2*de],s[2*de+1]);Se<_e&&(X=de,_e=Se)}let he=s[2*X],T=s[2*X+1];if(_e===1/0){for(let Ie=0;Ie<d;Ie++)this._dists[Ie]=s[2*Ie]-s[0]||s[2*Ie+1]-s[1];Hi(this._ids,this._dists,0,d-1);const de=new Uint32Array(d);let Se=0;for(let Ie=0,Ce=-1/0;Ie<d;Ie++){const ze=this._ids[Ie],Pe=this._dists[ze];Pe>Ce&&(de[Se++]=ze,Ce=Pe)}this.hull=de.subarray(0,Se),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Gn(te,$,pe,re,he,T)<0){const de=Q,Se=pe,Ie=re;Q=X,pe=he,re=T,X=de,he=Se,T=Ie}const ve=Zu(te,$,pe,re,he,T);this._cx=ve.x,this._cy=ve.y;for(let de=0;de<d;de++)this._dists[de]=Lr(s[2*de],s[2*de+1],ve.x,ve.y);Hi(this._ids,this._dists,0,d-1),this._hullStart=L;let xe=3;l[L]=a[X]=Q,l[Q]=a[L]=X,l[X]=a[Q]=L,f[L]=0,f[Q]=1,f[X]=2,o.fill(-1),o[this._hashKey(te,$)]=L,o[this._hashKey(pe,re)]=Q,o[this._hashKey(he,T)]=X,this.trianglesLen=0,this._addTriangle(L,Q,X,-1,-1,-1);for(let de=0,Se,Ie;de<this._ids.length;de++){const Ce=this._ids[de],ze=s[2*Ce],Pe=s[2*Ce+1];if(de>0&&Math.abs(ze-Se)<=Us&&Math.abs(Pe-Ie)<=Us||(Se=ze,Ie=Pe,Ce===L||Ce===Q||Ce===X))continue;let et=0;for(let it=0,Kt=this._hashKey(ze,Pe);it<this._hashSize&&(et=o[(Kt+it)%this._hashSize],!(et!==-1&&et!==l[et]));it++);et=a[et];let ge=et,Ye;for(;Ye=l[ge],Gn(ze,Pe,s[2*ge],s[2*ge+1],s[2*Ye],s[2*Ye+1])>=0;)if(ge=Ye,ge===et){ge=-1;break}if(ge===-1)continue;let st=this._addTriangle(ge,Ce,l[ge],-1,-1,f[ge]);f[Ce]=this._legalize(st+2),f[ge]=st,xe++;let Fe=l[ge];for(;Ye=l[Fe],Gn(ze,Pe,s[2*Fe],s[2*Fe+1],s[2*Ye],s[2*Ye+1])<0;)st=this._addTriangle(Fe,Ce,Ye,f[Ce],-1,f[Fe]),f[Ce]=this._legalize(st+2),l[Fe]=Fe,xe--,Fe=Ye;if(ge===et)for(;Ye=a[ge],Gn(ze,Pe,s[2*Ye],s[2*Ye+1],s[2*ge],s[2*ge+1])<0;)st=this._addTriangle(Ye,Ce,ge,-1,f[ge],f[Ye]),this._legalize(st+2),f[Ye]=st,l[ge]=ge,xe--,ge=Ye;this._hullStart=a[Ce]=ge,l[ge]=a[Fe]=Ce,l[Ce]=Fe,o[this._hashKey(ze,Pe)]=Ce,o[this._hashKey(s[2*ge],s[2*ge+1])]=ge}this.hull=new Uint32Array(xe);for(let de=0,Se=this._hullStart;de<xe;de++)this.hull[de]=Se,Se=l[Se];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(s,a){return Math.floor(Gu(s-this._cx,a-this._cy)*this._hashSize)%this._hashSize}_legalize(s){const{_triangles:a,_halfedges:l,coords:f}=this;let o=0,d=0;for(;;){const _=l[s],b=s-s%3;if(d=b+(s+2)%3,_===-1){if(o===0)break;s=jn[--o];continue}const S=_-_%3,z=b+(s+1)%3,M=S+(_+2)%3,H=a[d],L=a[s],Q=a[z],X=a[M];if(ju(f[2*H],f[2*H+1],f[2*L],f[2*L+1],f[2*Q],f[2*Q+1],f[2*X],f[2*X+1])){a[s]=X,a[_]=H;const $=l[M];if($===-1){let re=this._hullStart;do{if(this._hullTri[re]===M){this._hullTri[re]=s;break}re=this._hullPrev[re]}while(re!==this._hullStart)}this._link(s,$),this._link(_,l[d]),this._link(d,M);const pe=S+(_+1)%3;o<jn.length&&(jn[o++]=pe)}else{if(o===0)break;s=jn[--o]}}return d}_link(s,a){this._halfedges[s]=a,a!==-1&&(this._halfedges[a]=s)}_addTriangle(s,a,l,f,o,d){const _=this.trianglesLen;return this._triangles[_]=s,this._triangles[_+1]=a,this._triangles[_+2]=l,this._link(_,f),this._link(_+1,o),this._link(_+2,d),this.trianglesLen+=3,_}}function Gu(u,s){const a=u/(Math.abs(u)+Math.abs(s));return(s>0?3-a:1+a)/4}function Lr(u,s,a,l){const f=u-a,o=s-l;return f*f+o*o}function ju(u,s,a,l,f,o,d,_){const b=u-d,S=s-_,z=a-d,M=l-_,H=f-d,L=o-_,Q=b*b+S*S,X=z*z+M*M,te=H*H+L*L;return b*(M*te-X*L)-S*(z*te-X*H)+Q*(z*L-M*H)<0}function Wu(u,s,a,l,f,o){const d=a-u,_=l-s,b=f-u,S=o-s,z=d*d+_*_,M=b*b+S*S,H=.5/(d*S-_*b),L=(S*z-_*M)*H,Q=(d*M-b*z)*H;return L*L+Q*Q}function Zu(u,s,a,l,f,o){const d=a-u,_=l-s,b=f-u,S=o-s,z=d*d+_*_,M=b*b+S*S,H=.5/(d*S-_*b),L=u+(S*z-_*M)*H,Q=s+(d*M-b*z)*H;return{x:L,y:Q}}function Hi(u,s,a,l){if(l-a<=20)for(let f=a+1;f<=l;f++){const o=u[f],d=s[o];let _=f-1;for(;_>=a&&s[u[_]]>d;)u[_+1]=u[_--];u[_+1]=o}else{const f=a+l>>1;let o=a+1,d=l;cn(u,f,o),s[u[a]]>s[u[l]]&&cn(u,a,l),s[u[o]]>s[u[l]]&&cn(u,o,l),s[u[a]]>s[u[o]]&&cn(u,a,o);const _=u[o],b=s[_];for(;;){do o++;while(s[u[o]]<b);do d--;while(s[u[d]]>b);if(d<o)break;cn(u,o,d)}u[a+1]=u[d],u[d]=_,l-o+1>=d-a?(Hi(u,s,o,l),Hi(u,s,a,d-1)):(Hi(u,s,a,d-1),Hi(u,s,o,l))}}function cn(u,s,a){const l=u[s];u[s]=u[a],u[a]=l}function Xu(u){return u[0]}function Ku(u){return u[1]}const qs=1e-6;class Ai{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(s,a){this._+=`M${this._x0=this._x1=+s},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(s,a){this._+=`L${this._x1=+s},${this._y1=+a}`}arc(s,a,l){s=+s,a=+a,l=+l;const f=s+l,o=a;if(l<0)throw new Error("negative radius");this._x1===null?this._+=`M${f},${o}`:(Math.abs(this._x1-f)>qs||Math.abs(this._y1-o)>qs)&&(this._+="L"+f+","+o),l&&(this._+=`A${l},${l},0,1,1,${s-l},${a}A${l},${l},0,1,1,${this._x1=f},${this._y1=o}`)}rect(s,a,l,f){this._+=`M${this._x0=this._x1=+s},${this._y0=this._y1=+a}h${+l}v${+f}h${-l}Z`}value(){return this._||null}}class qr{constructor(){this._=[]}moveTo(s,a){this._.push([s,a])}closePath(){this._.push(this._[0].slice())}lineTo(s,a){this._.push([s,a])}value(){return this._.length?this._:null}}class Yu{constructor(s,[a,l,f,o]=[0,0,960,500]){if(!((f=+f)>=(a=+a))||!((o=+o)>=(l=+l)))throw new Error("invalid bounds");this.delaunay=s,this._circumcenters=new Float64Array(s.points.length*2),this.vectors=new Float64Array(s.points.length*2),this.xmax=f,this.xmin=a,this.ymax=o,this.ymin=l,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:s,hull:a,triangles:l},vectors:f}=this;let o,d;const _=this.circumcenters=this._circumcenters.subarray(0,l.length/3*2);for(let X=0,te=0,$=l.length,pe,re;X<$;X+=3,te+=2){const _e=l[X]*2,he=l[X+1]*2,T=l[X+2]*2,ve=s[_e],xe=s[_e+1],de=s[he],Se=s[he+1],Ie=s[T],Ce=s[T+1],ze=de-ve,Pe=Se-xe,et=Ie-ve,ge=Ce-xe,Ye=(ze*ge-Pe*et)*2;if(Math.abs(Ye)<1e-9){if(o===void 0){o=d=0;for(const Fe of a)o+=s[Fe*2],d+=s[Fe*2+1];o/=a.length,d/=a.length}const st=1e9*Math.sign((o-ve)*ge-(d-xe)*et);pe=(ve+Ie)/2-st*ge,re=(xe+Ce)/2+st*et}else{const st=1/Ye,Fe=ze*ze+Pe*Pe,it=et*et+ge*ge;pe=ve+(ge*Fe-Pe*it)*st,re=xe+(ze*it-et*Fe)*st}_[te]=pe,_[te+1]=re}let b=a[a.length-1],S,z=b*4,M,H=s[2*b],L,Q=s[2*b+1];f.fill(0);for(let X=0;X<a.length;++X)b=a[X],S=z,M=H,L=Q,z=b*4,H=s[2*b],Q=s[2*b+1],f[S+2]=f[z]=L-Q,f[S+3]=f[z+1]=H-M}render(s){const a=s==null?s=new Ai:void 0,{delaunay:{halfedges:l,inedges:f,hull:o},circumcenters:d,vectors:_}=this;if(o.length<=1)return null;for(let z=0,M=l.length;z<M;++z){const H=l[z];if(H<z)continue;const L=Math.floor(z/3)*2,Q=Math.floor(H/3)*2,X=d[L],te=d[L+1],$=d[Q],pe=d[Q+1];this._renderSegment(X,te,$,pe,s)}let b,S=o[o.length-1];for(let z=0;z<o.length;++z){b=S,S=o[z];const M=Math.floor(f[S]/3)*2,H=d[M],L=d[M+1],Q=b*4,X=this._project(H,L,_[Q+2],_[Q+3]);X&&this._renderSegment(H,L,X[0],X[1],s)}return a&&a.value()}renderBounds(s){const a=s==null?s=new Ai:void 0;return s.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),a&&a.value()}renderCell(s,a){const l=a==null?a=new Ai:void 0,f=this._clip(s);if(f===null||!f.length)return;a.moveTo(f[0],f[1]);let o=f.length;for(;f[0]===f[o-2]&&f[1]===f[o-1]&&o>1;)o-=2;for(let d=2;d<o;d+=2)(f[d]!==f[d-2]||f[d+1]!==f[d-1])&&a.lineTo(f[d],f[d+1]);return a.closePath(),l&&l.value()}*cellPolygons(){const{delaunay:{points:s}}=this;for(let a=0,l=s.length/2;a<l;++a){const f=this.cellPolygon(a);f&&(f.index=a,yield f)}}cellPolygon(s){const a=new qr;return this.renderCell(s,a),a.value()}_renderSegment(s,a,l,f,o){let d;const _=this._regioncode(s,a),b=this._regioncode(l,f);_===0&&b===0?(o.moveTo(s,a),o.lineTo(l,f)):(d=this._clipSegment(s,a,l,f,_,b))&&(o.moveTo(d[0],d[1]),o.lineTo(d[2],d[3]))}contains(s,a,l){return a=+a,a!==a||(l=+l,l!==l)?!1:this.delaunay._step(s,a,l)===s}*neighbors(s){const a=this._clip(s);if(a)for(const l of this.delaunay.neighbors(s)){const f=this._clip(l);if(f){e:for(let o=0,d=a.length;o<d;o+=2)for(let _=0,b=f.length;_<b;_+=2)if(a[o]===f[_]&&a[o+1]===f[_+1]&&a[(o+2)%d]===f[(_+b-2)%b]&&a[(o+3)%d]===f[(_+b-1)%b]){yield l;break e}}}}_cell(s){const{circumcenters:a,delaunay:{inedges:l,halfedges:f,triangles:o}}=this,d=l[s];if(d===-1)return null;const _=[];let b=d;do{const S=Math.floor(b/3);if(_.push(a[S*2],a[S*2+1]),b=b%3===2?b-2:b+1,o[b]!==s)break;b=f[b]}while(b!==d&&b!==-1);return _}_clip(s){if(s===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const a=this._cell(s);if(a===null)return null;const{vectors:l}=this,f=s*4;return this._simplify(l[f]||l[f+1]?this._clipInfinite(s,a,l[f],l[f+1],l[f+2],l[f+3]):this._clipFinite(s,a))}_clipFinite(s,a){const l=a.length;let f=null,o,d,_=a[l-2],b=a[l-1],S,z=this._regioncode(_,b),M,H=0;for(let L=0;L<l;L+=2)if(o=_,d=b,_=a[L],b=a[L+1],S=z,z=this._regioncode(_,b),S===0&&z===0)M=H,H=0,f?f.push(_,b):f=[_,b];else{let Q,X,te,$,pe;if(S===0){if((Q=this._clipSegment(o,d,_,b,S,z))===null)continue;[X,te,$,pe]=Q}else{if((Q=this._clipSegment(_,b,o,d,z,S))===null)continue;[$,pe,X,te]=Q,M=H,H=this._edgecode(X,te),M&&H&&this._edge(s,M,H,f,f.length),f?f.push(X,te):f=[X,te]}M=H,H=this._edgecode($,pe),M&&H&&this._edge(s,M,H,f,f.length),f?f.push($,pe):f=[$,pe]}if(f)M=H,H=this._edgecode(f[0],f[1]),M&&H&&this._edge(s,M,H,f,f.length);else if(this.contains(s,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return f}_clipSegment(s,a,l,f,o,d){const _=o<d;for(_&&([s,a,l,f,o,d]=[l,f,s,a,d,o]);;){if(o===0&&d===0)return _?[l,f,s,a]:[s,a,l,f];if(o&d)return null;let b,S,z=o||d;z&8?(b=s+(l-s)*(this.ymax-a)/(f-a),S=this.ymax):z&4?(b=s+(l-s)*(this.ymin-a)/(f-a),S=this.ymin):z&2?(S=a+(f-a)*(this.xmax-s)/(l-s),b=this.xmax):(S=a+(f-a)*(this.xmin-s)/(l-s),b=this.xmin),o?(s=b,a=S,o=this._regioncode(s,a)):(l=b,f=S,d=this._regioncode(l,f))}}_clipInfinite(s,a,l,f,o,d){let _=Array.from(a),b;if((b=this._project(_[0],_[1],l,f))&&_.unshift(b[0],b[1]),(b=this._project(_[_.length-2],_[_.length-1],o,d))&&_.push(b[0],b[1]),_=this._clipFinite(s,_))for(let S=0,z=_.length,M,H=this._edgecode(_[z-2],_[z-1]);S<z;S+=2)M=H,H=this._edgecode(_[S],_[S+1]),M&&H&&(S=this._edge(s,M,H,_,S),z=_.length);else this.contains(s,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(_=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return _}_edge(s,a,l,f,o){for(;a!==l;){let d,_;switch(a){case 5:a=4;continue;case 4:a=6,d=this.xmax,_=this.ymin;break;case 6:a=2;continue;case 2:a=10,d=this.xmax,_=this.ymax;break;case 10:a=8;continue;case 8:a=9,d=this.xmin,_=this.ymax;break;case 9:a=1;continue;case 1:a=5,d=this.xmin,_=this.ymin;break}(f[o]!==d||f[o+1]!==_)&&this.contains(s,d,_)&&(f.splice(o,0,d,_),o+=2)}return o}_project(s,a,l,f){let o=1/0,d,_,b;if(f<0){if(a<=this.ymin)return null;(d=(this.ymin-a)/f)<o&&(b=this.ymin,_=s+(o=d)*l)}else if(f>0){if(a>=this.ymax)return null;(d=(this.ymax-a)/f)<o&&(b=this.ymax,_=s+(o=d)*l)}if(l>0){if(s>=this.xmax)return null;(d=(this.xmax-s)/l)<o&&(_=this.xmax,b=a+(o=d)*f)}else if(l<0){if(s<=this.xmin)return null;(d=(this.xmin-s)/l)<o&&(_=this.xmin,b=a+(o=d)*f)}return[_,b]}_edgecode(s,a){return(s===this.xmin?1:s===this.xmax?2:0)|(a===this.ymin?4:a===this.ymax?8:0)}_regioncode(s,a){return(s<this.xmin?1:s>this.xmax?2:0)|(a<this.ymin?4:a>this.ymax?8:0)}_simplify(s){if(s&&s.length>4){for(let a=0;a<s.length;a+=2){const l=(a+2)%s.length,f=(a+4)%s.length;(s[a]===s[l]&&s[l]===s[f]||s[a+1]===s[l+1]&&s[l+1]===s[f+1])&&(s.splice(l,2),a-=2)}s.length||(s=null)}return s}}const Qu=2*Math.PI,qi=Math.pow;function $u(u){return u[0]}function Ju(u){return u[1]}function eh(u){const{triangles:s,coords:a}=u;for(let l=0;l<s.length;l+=3){const f=2*s[l],o=2*s[l+1],d=2*s[l+2];if((a[d]-a[f])*(a[o+1]-a[f+1])-(a[o]-a[f])*(a[d+1]-a[f+1])>1e-10)return!1}return!0}function th(u,s,a){return[u+Math.sin(u+s)*a,s+Math.cos(u-s)*a]}class Xr{static from(s,a=$u,l=Ju,f){return new Xr("length"in s?ih(s,a,l,f):Float64Array.from(nh(s,a,l,f)))}constructor(s){this._delaunator=new ir(s),this.inedges=new Int32Array(s.length/2),this._hullIndex=new Int32Array(s.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const s=this._delaunator,a=this.points;if(s.hull&&s.hull.length>2&&eh(s)){this.collinear=Int32Array.from({length:a.length/2},(H,L)=>L).sort((H,L)=>a[2*H]-a[2*L]||a[2*H+1]-a[2*L+1]);const b=this.collinear[0],S=this.collinear[this.collinear.length-1],z=[a[2*b],a[2*b+1],a[2*S],a[2*S+1]],M=1e-8*Math.hypot(z[3]-z[1],z[2]-z[0]);for(let H=0,L=a.length/2;H<L;++H){const Q=th(a[2*H],a[2*H+1],M);a[2*H]=Q[0],a[2*H+1]=Q[1]}this._delaunator=new ir(a)}else delete this.collinear;const l=this.halfedges=this._delaunator.halfedges,f=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),_=this._hullIndex.fill(-1);for(let b=0,S=l.length;b<S;++b){const z=o[b%3===2?b-2:b+1];(l[b]===-1||d[z]===-1)&&(d[z]=b)}for(let b=0,S=f.length;b<S;++b)_[f[b]]=b;f.length<=2&&f.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=f[0],d[f[0]]=1,f.length===2&&(d[f[1]]=0,this.triangles[1]=f[1],this.triangles[2]=f[1]))}voronoi(s){return new Yu(this,s)}*neighbors(s){const{inedges:a,hull:l,_hullIndex:f,halfedges:o,triangles:d,collinear:_}=this;if(_){const M=_.indexOf(s);M>0&&(yield _[M-1]),M<_.length-1&&(yield _[M+1]);return}const b=a[s];if(b===-1)return;let S=b,z=-1;do{if(yield z=d[S],S=S%3===2?S-2:S+1,d[S]!==s)return;if(S=o[S],S===-1){const M=l[(f[s]+1)%l.length];M!==z&&(yield M);return}}while(S!==b)}find(s,a,l=0){if(s=+s,s!==s||(a=+a,a!==a))return-1;const f=l;let o;for(;(o=this._step(l,s,a))>=0&&o!==l&&o!==f;)l=o;return o}_step(s,a,l){const{inedges:f,hull:o,_hullIndex:d,halfedges:_,triangles:b,points:S}=this;if(f[s]===-1||!S.length)return(s+1)%(S.length>>1);let z=s,M=qi(a-S[s*2],2)+qi(l-S[s*2+1],2);const H=f[s];let L=H;do{let Q=b[L];const X=qi(a-S[Q*2],2)+qi(l-S[Q*2+1],2);if(X<M&&(M=X,z=Q),L=L%3===2?L-2:L+1,b[L]!==s)break;if(L=_[L],L===-1){if(L=o[(d[s]+1)%o.length],L!==Q&&qi(a-S[L*2],2)+qi(l-S[L*2+1],2)<M)return L;break}}while(L!==H);return z}render(s){const a=s==null?s=new Ai:void 0,{points:l,halfedges:f,triangles:o}=this;for(let d=0,_=f.length;d<_;++d){const b=f[d];if(b<d)continue;const S=o[d]*2,z=o[b]*2;s.moveTo(l[S],l[S+1]),s.lineTo(l[z],l[z+1])}return this.renderHull(s),a&&a.value()}renderPoints(s,a){a===void 0&&(!s||typeof s.moveTo!="function")&&(a=s,s=null),a=a==null?2:+a;const l=s==null?s=new Ai:void 0,{points:f}=this;for(let o=0,d=f.length;o<d;o+=2){const _=f[o],b=f[o+1];s.moveTo(_+a,b),s.arc(_,b,a,0,Qu)}return l&&l.value()}renderHull(s){const a=s==null?s=new Ai:void 0,{hull:l,points:f}=this,o=l[0]*2,d=l.length;s.moveTo(f[o],f[o+1]);for(let _=1;_<d;++_){const b=2*l[_];s.lineTo(f[b],f[b+1])}return s.closePath(),a&&a.value()}hullPolygon(){const s=new qr;return this.renderHull(s),s.value()}renderTriangle(s,a){const l=a==null?a=new Ai:void 0,{points:f,triangles:o}=this,d=o[s*=3]*2,_=o[s+1]*2,b=o[s+2]*2;return a.moveTo(f[d],f[d+1]),a.lineTo(f[_],f[_+1]),a.lineTo(f[b],f[b+1]),a.closePath(),l&&l.value()}*trianglePolygons(){const{triangles:s}=this;for(let a=0,l=s.length/3;a<l;++a)yield this.trianglePolygon(a)}trianglePolygon(s){const a=new qr;return this.renderTriangle(s,a),a.value()}}function ih(u,s,a,l){const f=u.length,o=new Float64Array(f*2);for(let d=0;d<f;++d){const _=u[d];o[d*2]=s.call(l,_,d,u),o[d*2+1]=a.call(l,_,d,u)}return o}function*nh(u,s,a,l){let f=0;for(const o of u)yield s.call(l,o,f,u),yield a.call(l,o,f,u),++f}function fa(u){return{originalBorder:u,flattenedPolygon:sa(u)[0]}}function rh(u){if(u.length===0)return[0,0];const s=u.reduce((a,l)=>[a[0]+l[0],a[1]+l[1]],[0,0]);return[s[0]/u.length,s[1]/u.length]}function da(u,s,a){const l={id:u,site:rh(s),halfEdge:-1,bounds:Br(s)},f=hu(s,u,a);return f.length>0&&(l.halfEdge=f[0].id),l}function pa(u,s){const l=u.map(o=>Wr(o,s.originalBorder)).filter(Boolean).length;return l===0?null:l===u.length?u:ou(u,s.flattenedPolygon)?.[0]??null}const Kr="VoronoiPieceGenerator",sh={name:Kr,displayName:"Voronoi",description:"Construct pieces by building a Voronoi diagram from the seed points. Each piece consists of all area of the plane closer to its seed point than any other seed point. In practice, this creates irregular polygons with 3-8 sides.",sortHint:1,controls:[]};function ah(u){return`${u[0].toPrecision(7)},${u[1].toPrecision(7)}`}function Hs(u,s){const l=s.flattenedPolygon;for(let f=0;f<l.length;f++){const o=l[f],d=l[(f+1)%l.length];if(oh(u,o,d)<.001)return!0}return!1}function oh(u,s,a){const[l,f]=u,[o,d]=s,[_,b]=a,S=_-o,z=b-d,M=S*S+z*z;if(M===0)return Math.hypot(l-o,f-d);let H=((l-o)*S+(f-d)*z)/M;H=Math.max(0,Math.min(1,H));const L=o+H*S,Q=d+H*z;return Math.hypot(l-L,f-Q)}const uh=(u,s,a)=>{const{width:l,height:f}=s,o=fa(u);return{generatePieces(_,b){const{border:S}=b;console.log(`VoronoiPieceGenerator using dimensions ${l}x${f}`);const M=Xr.from(_).voronoi([0,0,l,f]),H={vertices:[],pieces:new Map,edges:new Map,halfEdges:new Map,boundary:[],borderPath:S},L=new Map;let Q=0;for(let te=0;te<_.length;te++){const $=_[te],pe=M.cellPolygon(te);if(!pe)continue;const re=pa(pe,o);if(!re)continue;const _e=Q++,he=da(_e,re,H);he.site=$,H.pieces.set(_e,he);const T=[];let ve=he.halfEdge;if(ve!==-1){const xe=ve;do{const de=H.halfEdges.get(ve);T.push(de),ve=de.next}while(ve!==xe)}aa(T,H,L,(xe,de)=>Hs(xe,o)&&Hs(de,o))}const X=new Map;for(const te of H.halfEdges.values()){const $=ah(te.origin);X.has($)||X.set($,te.origin)}return H.vertices=Array.from(X.values()),H}}};wn.register(Kr,uh,sh);const nr="SimpleTabPlacementStrategy",hh={name:nr,displayName:"Simple",description:"Creates a single tab in the center of each edge with a random orientation.",sortHint:1,controls:[{type:"range",name:"tabSize",label:"Tab Size",optional:!0,min:.01,max:1,step:.01,defaultValue:.5,helpText:"The width of the tab as a fraction of the edge length"},{type:"number",name:"minEdgeLength",label:"Minimum Edge Length",optional:!0,defaultValue:15,helpText:"Edges shorter than this value will not have a tab"},{type:"number",name:"maxTabSize",label:"Maximum Tab Size",helpText:"Maximum width of a generated tab"}]};function Gs(u,s,a,l){if(u.tabs=void 0,!(u.heRight!==-1))return;const o=s.halfEdges.get(u.heLeft),d=s.halfEdges.get(u.heRight);if(!o||!d)return;const _=o.origin,b=d.origin,S=Math.hypot(b[0]-_[0],b[1]-_[1]);if(S>=a.minEdgeLength){let z=a.tabSize;a.maxTabSize&&S*z>a.maxTabSize&&(z=a.maxTabSize/S);const M={position:.5,size:z,convex:l()>.5};u.tabs=[M]}}const lh=(u,s,a)=>{const{tabSize:l=.5,minEdgeLength:f=0,maxTabSize:o}=a,d={tabSize:l,minEdgeLength:f,maxTabSize:o};return{placeTabs(_){const{topology:b,random:S}=_;for(const z of b.edges.values())Gs(z,b,d,S)},updateTabPlacements(_,b){const{topology:S,random:z}=b;for(const M of _)Gs(M,S,d,z)}}};Sn.register(nr,lh,hh);const Yr="TraditionalTabGenerator",ch={name:Yr,displayName:"Traditional",description:"Creates a traditional rounded tab for each (internal) piece edge.",sortHint:1,controls:[{type:"range",name:"jitter",label:"Randomness",defaultValue:8,min:0,max:100,step:1,helpText:"Adds randomness to the tab shape. 0 means completely uniform tabs"},{type:"range",name:"heightToWidthRatio",label:"Tab Height",defaultValue:50,min:5,max:100,step:5,helpText:"The height of the tab as a percent of its width"}]};function fh(u,s,a,l,f,o=!1){const d=s[0]-u[0],_=s[1]-u[1],b=Math.hypot(d,_);if(b===0)return console.warn("Edge has zero length"),[];const S=[d/b,_/b],z=[-S[1],S[0]],M=(Ce,ze)=>[u[0]+(S[0]*Ce+z[0]*ze)*b,u[1]+(S[1]*Ce+z[1]*ze)*b],H=a/100,L=()=>(f()*2-1)*H,Q=L(),X=L(),te=L(),$=L(),pe=L(),re=.1625,_e=o?-1:1,he=l,T=he/3,xe=[[0,0],[.2,Q*T],[.5+X+$,_e*(-T+te*he)],[.5-re+X,_e*(T+te*he)],[.5-2*re+X-$,_e*(he+te*he)],[.5+2*re+X-$,_e*(he+te*he)],[.5+re+X,_e*(T+te*he)],[.5+X+$,_e*(-T+te*he)],[.8,pe*T],[1,0]].map(([Ce,ze])=>M(Ce,ze)),de={type:"bezier",p1:xe[1],p2:xe[2],p3:xe[3]},Se={type:"bezier",p1:xe[4],p2:xe[5],p3:xe[6]},Ie={type:"bezier",p1:xe[7],p2:xe[8],p3:xe[9]};return[de,Se,Ie]}const dh=(u,s,a)=>{const{jitter:l=8,heightToWidthRatio:f=50}=a;return{createTabSegments(d,_,b,S){const z=!b.convex;return fh(d,_,l,f/100,S,z)}}};Li.register(Yr,dh,ch);function ph(u){return new Worker("/puzzle-generator/assets/CheckGeometryWorker-B-2izMXZ.js",{name:u?.name})}function gh(u,s){return new Promise((a,l)=>{const f=new ph;f.onmessage=d=>{const _=d.data;switch(_.type){case"progress":s?.(_.processed,_.total);break;case"done":a(_.results),f.terminate();break;case"error":l(new Error(_.message)),f.terminate();break}},f.onerror=d=>{l(new Error(d.message)),f.terminate()};const o={topology:iu(u)};f.postMessage(o)})}const ga="GridJitterPointGenerator",mh={name:ga,displayName:"Grid",description:"Generate seed points using a grid with optional random jitter. Has a uniform, regular look, especially with low randomness values.",sortHint:2,controls:[{type:"range",name:"jitter",label:"Randomness",min:0,max:100,step:5,defaultValue:50,helpText:"Amount of jitter to apply to each grid point (0 to 100%)"}]},vh=(u,s,a)=>{const{jitter:l=50}=a;return{generatePoints(o){const{width:d,height:_,pieceSize:b,random:S,border:z}=o,M=[];for(let H=0;H<d;H+=b)for(let L=0;L<_;L+=b){const Q=[H+b/2,L+b/2];l>0&&(Q[0]+=(S()-.5)*(l/100)*b,Q[1]+=(S()-.5)*(l/100)*b),Wr(Q,z)&&M.push(Q)}return M}}};bn.register(ga,vh,mh);const ma="RectangularPieceGenerator",_h={name:ma,displayName:"Rectangular",description:"Construct pieces from a regular grid. All pieces have 4 sides and are the same size (except when the border is irregular). This generator ignores seed points.",sortHint:2,controls:[]},yh=(u,s,a)=>{const{width:l,height:f}=s,o=fa(u);return{generatePieces(_,b){const{pieceSize:S,border:z}=b,M={vertices:[],pieces:new Map,edges:new Map,halfEdges:new Map,boundary:[],borderPath:z},H=Math.ceil(l/S),L=Math.ceil(f/S),Q=Math.round(l/H),X=Math.round(f/L),te=[];for(let pe=0;pe<=L;pe++){const re=[];for(let _e=0;_e<=H;_e++){const he=_e*Q,T=pe*X;re.push([he,T])}te.push(re)}M.vertices=te.flat();const $=new Map;for(let pe=0;pe<L;pe++)for(let re=0;re<H;re++){const _e=pe*H+re,he=te[pe][re],T=te[pe][re+1],ve=te[pe+1][re],xe=te[pe+1][re+1],Se=pa([he,T,xe,ve],o);if(!Se)continue;const Ie=da(_e,Se,M);M.pieces.set(_e,Ie);const Ce=[];let ze=Ie.halfEdge;if(ze!==-1){const Pe=ze;do{const et=M.halfEdges.get(ze);Ce.push(et),ze=et.next}while(ze!==Pe)}aa(Ce,M,$,(Pe,et)=>{const ge=(Kt,Bt)=>Math.abs(Kt-Bt)<1e-6,Ye=ge(Pe[1],he[1])&&ge(et[1],he[1]),st=ge(Pe[0],T[0])&&ge(et[0],T[0]),Fe=ge(Pe[1],ve[1])&&ge(et[1],ve[1]),it=ge(Pe[0],he[0])&&ge(et[0],he[0]);return!(Ye||st||Fe||it)})}return M}}};wn.register(ma,yh,_h);const va="NullTabGenerator",xh={name:va,displayName:"None",description:"Do not generate tabs. All pieces have straight edges.",sortHint:3,controls:[]},bh=(u,s,a)=>({createTabSegments(f,o,d,_){return[]}});Li.register(va,bh,xh);const _a="TriangleTabGenerator",wh={name:_a,displayName:"Triangle",description:"Creates a simple triangle between each (internal) piece edge.",sortHint:2,controls:[]},Sh=(u,s,a)=>({createTabSegments(f,o,d,_){const b=[o[0]-f[0],o[1]-f[1]],S=Math.hypot(b[0],b[1]);if(S<1e-6)return[];const z=[b[0]/S,b[1]/S],M=[-z[1],z[0]],H=[f[0]+b[0]/2,f[1]+b[1]/2],L=d.convex?1:-1,Q=S*d.size*L,X=[H[0]+M[0]*Q,H[1]+M[1]*Q],te=[];return te.push({type:"line",p:f}),te.push({type:"line",p:X}),te.push({type:"line",p:o}),te}});Li.register(_a,Sh,wh);let Hr=!1;const Ch=window.matchMedia("(prefers-color-scheme: dark)");Ch.matches&&(Hr=!0);const Ph=()=>{const a=Zr,l=Kr,f=Yr,o={seed:new Date().getTime()%10240,canvasWidth:800,canvasHeight:600,aspectRatio:800/600,distance:40,color:Hr?"#DDDDDD":"#333333",drawPoints:!1,pointColor:Hr?"#FF0000":"#0000FF",borderShape:"rectangle",borderCornerRadius:50,geometryProblems:{autoCheck:!1,problems:void 0,progress:void 0},dirty:!0,generators:{point:{label:"Seed Points",registry:bn,name:a,config:bn.getDefaultConfig(a,800,600)},piece:{label:"Piece Generation",registry:wn,name:l,config:wn.getDefaultConfig(l,800,600)},placement:{label:"Tab Placement",registry:Sn,name:nr,config:Sn.getDefaultConfig(nr,800,600)},tab:{label:"Tabs",registry:Li,name:f,config:Li.getDefaultConfig(f,800,600)}},puzzle:void 0,backgroundImageUrl:void 0,backgroundImageName:""};function d(){const{canvasWidth:b,canvasHeight:S,borderShape:z,borderCornerRadius:M}=o;switch(z){case"rectangle":return Ur(b,S);case"circle":return cu(Math.min(b,S));case"ellipse":return fu(b,S);case"rounded-rect":return du(b,S,M);default:return Ur(b,S)}}function _(){o.puzzle&&(o.geometryProblems.progress=0,oe.redraw(),gh(o.puzzle,(b,S)=>{o.geometryProblems.progress=b/S*100,oe.redraw()}).then(b=>{o.geometryProblems.problems=b.length,o.geometryProblems.progress=void 0,o.puzzle&&(o.puzzle.problems=b),oe.redraw()}).catch(b=>{o.geometryProblems.progress=void 0,console.error(b),oe.redraw()}))}return{oncreate:()=>{Jn({bounds:{width:o.canvasWidth,height:o.canvasHeight},border:d(),pieceSize:o.distance,pointConfig:o.generators.point.config,pieceConfig:o.generators.piece.config,placementConfig:o.generators.placement.config,tabConfig:o.generators.tab.config,seed:o.seed}).then(b=>{o.puzzle=b,oe.redraw(),o.geometryProblems.autoCheck&&_()}).catch(b=>{console.error(b)})},onupdate:()=>{o.dirty&&(o.dirty=!1,Jn({bounds:{width:o.canvasWidth,height:o.canvasHeight},border:d(),pieceSize:o.distance,pointConfig:o.generators.point.config,pieceConfig:o.generators.piece.config,placementConfig:o.generators.placement.config,tabConfig:o.generators.tab.config,seed:o.seed}).then(b=>{o.geometryProblems.problems=void 0,o.geometryProblems.progress=void 0,o.puzzle=b,oe.redraw(),o.geometryProblems.autoCheck&&_()}).catch(b=>{console.error(b)}))},onremove:()=>{o.backgroundImageUrl&&(URL.revokeObjectURL(o.backgroundImageUrl),o.backgroundImageUrl=void 0)},view:()=>oe(".page",[oe("h1","Puzzle Generator"),oe(".container",[o.puzzle&&oe(".puzzle-stack",[oe(vu,{width:o.canvasWidth,height:o.canvasHeight,color:o.color,imageUrl:o.backgroundImageUrl,puzzle:o.puzzle,isDirty:o.dirty,pointColor:o.drawPoints?o.pointColor:void 0,onPuzzleChanged:b=>{o.puzzle=b,oe.redraw()},onSeedPointMoved:(b,S)=>{o.dirty=!1,o.puzzle&&lu(o.puzzle,b,S).then(z=>{o.geometryProblems.problems=void 0,o.geometryProblems.progress=void 0,o.puzzle=z,oe.redraw(),o.geometryProblems.autoCheck&&_()}).catch(z=>{console.error("Failed to rebuild puzzle with updated seed point:",z)})}}),oe(".actions",[oe(xu,{puzzle:o.puzzle,width:o.canvasWidth,height:o.canvasHeight,color:o.color}),oe(bu,{autoCheck:o.geometryProblems.autoCheck,problems:o.geometryProblems.problems,progressPercent:o.geometryProblems.progress,onCheckRequested:()=>{o.dirty||_(),oe.redraw()},onAutocheckChanged:b=>{b!==o.geometryProblems.autoCheck&&(o.geometryProblems.autoCheck=b,oe.redraw())}})])]),oe(".controls",[oe(".background-image",[oe(Su,{label:"Background Image",onUpload:(b,S,z,M)=>{o.backgroundImageUrl&&URL.revokeObjectURL(o.backgroundImageUrl),o.canvasWidth=z,o.canvasHeight=M,o.aspectRatio=z/M,o.backgroundImageUrl=b,o.backgroundImageName=S,o.dirty=!0,oe.redraw()},onClear:()=>{o.backgroundImageUrl&&URL.revokeObjectURL(o.backgroundImageUrl),o.backgroundImageUrl=void 0,o.backgroundImageName="",o.dirty=!0,oe.redraw()}})]),oe(ku,{ratio:o.aspectRatio,disabled:o.backgroundImageUrl!==void 0,onChange:b=>{o.aspectRatio=b,o.canvasWidth=o.canvasHeight*b,o.dirty=!0,oe.redraw()}}),oe(Au,{shape:o.borderShape,disabled:o.backgroundImageUrl!==void 0,onChange:b=>{o.borderShape=b,o.dirty=!0,oe.redraw()}}),o.borderShape==="rounded-rect"&&oe(Xn,{config:{name:"cornerRadius",label:"Corner Radius",type:"number"},value:o.borderCornerRadius,onChange:b=>{o.borderCornerRadius=b??50,o.dirty=!0,oe.redraw()}}),oe(Xn,{config:{name:"seed",label:"Seed",type:"number"},value:o.seed,onChange:b=>{o.seed=b??0,o.dirty=!0,oe.redraw()}}),oe(Xn,{config:{name:"pieceSize",label:"Piece size",type:"number"},value:o.distance,onChange:b=>{o.distance=b??0,o.dirty=!0,oe.redraw()}}),oe(Ts,{label:"Piece color",color:o.color,size:"small",onUpdate:b=>{o.color=b,oe.redraw()}}),oe(".draw-points",[oe(ua,{config:{name:"drawPoints",label:"Draw seed points",type:"boolean"},value:o.drawPoints,onChange:b=>{o.drawPoints=b,oe.redraw()}}),o.drawPoints&&oe(Ts,{label:"Seed points color",color:o.pointColor,size:"small",onUpdate:b=>{o.pointColor=b,oe.redraw()}})]),...Object.entries(o.generators).map(([b,S])=>oe("label",[S.label+":",oe(Iu,{generator:S.name,registry:S.registry,config:S.config,onGeneratorChange:z=>{z!=S.name&&(console.log(`${b} generator changed to ${z}`),S.name=z,o.generators[b].config=S.registry.getDefaultConfig(z,o.canvasWidth,o.canvasHeight),o.dirty=!0,oe.redraw())},onConfigChange:(z,M)=>{console.log(`${b} generator config "${z}" changed to ${String(M)}`),S.config[z]=M,o.dirty=!0,oe.redraw()}})]))])])])}},Ti=10,Or="#2196F3",js=2,Ih="#999999",kh=1,Eh=[4,4],Ws=.5,Ah=15,Th=10,Mh="#4CAF50",Lh=2,Oh=.1,zh=10,zr=1,Nh=.025,Rh=[.25,.5,1,2,4],Dh=["25%","50%","100%","200%","400%"];let mn=null,vn=null,_n=null,yn=null,xn=null,Mi=null,Gi=!1,Ei=null;function Vh(u,s,a){const l=new Ve.Tool;return mn=f=>{f.code==="Space"&&!u.isSpacebarPressed?(u.isSpacebarPressed=!0,Xt(u),f.preventDefault()):f.key==="Shift"&&!u.isShiftPressed?(u.isShiftPressed=!0,Xt(u)):(f.code==="Delete"||f.code==="Backspace")&&(u.mode==="edit"&&u.selectedSegment&&u.path&&u.path.segments.length>2&&(u.selectedSegment.remove(),u.selectedSegment=null,u.selectedHandle=null,s()),f.preventDefault())},vn=f=>{f.code==="Space"?(u.isSpacebarPressed=!1,Xt(u),f.preventDefault()):f.key==="Shift"&&(u.isShiftPressed=!1,Xt(u))},_n=f=>{f.preventDefault();const o=-Math.sign(f.deltaY)*Nh,d=Math.max(Oh,Math.min(zh,u.zoom+o));if(d!==u.zoom){const _=new Ve.Point(f.offsetX,f.offsetY),b=Ve.view.viewToProject(_),S=d/u.zoom;Ve.view.scale(S,b),u.zoom=d,a()}},yn=f=>{u.isSpacebarPressed&&(Gi=!0,Ei={x:f.clientX,y:f.clientY},Xt(u),f.preventDefault())},xn=f=>{if(Gi&&Ei){const o=f.clientX-Ei.x,d=f.clientY-Ei.y;Ve.view.translate(new Ve.Point(o,d)),Ei={x:f.clientX,y:f.clientY},f.preventDefault()}},Mi=()=>{Gi&&(Gi=!1,Ei=null,Xt(u))},window.addEventListener("keydown",mn),window.addEventListener("keyup",vn),u.canvas&&(u.canvas.addEventListener("wheel",_n,{passive:!1}),u.canvas.addEventListener("mousedown",yn),u.canvas.addEventListener("mousemove",xn),u.canvas.addEventListener("mouseup",Mi),u.canvas.addEventListener("mouseleave",Mi)),l.onMouseDown=f=>{u.isSpacebarPressed||(u.mode==="draw"?Bh(u,f):qh(u,f))},l.onMouseDrag=f=>{u.isSpacebarPressed||(u.mode==="draw"?Uh(u,f):Hh(u,f))},l.onMouseUp=()=>{if(!u.isSpacebarPressed)if(u.mode==="draw"){if(u.pendingPoint&&u.path){if(u.isDraggingCurve&&u.previewPath&&u.previewPath.segments.length>0){const f=u.previewPath.lastSegment,o=new Ve.Segment(u.pendingPoint,f.handleIn,f.handleOut);if(u.path.add(o),u.path.segments.length>1&&u.previewPath.segments.length>1){const d=u.path.segments[u.path.segments.length-2],_=u.previewPath.segments[0];d.handleOut=_.handleOut}}else u.path.add(u.pendingPoint);u.pendingPoint=null,u.isDraggingCurve=!1,u.previewPath&&(u.previewPath.removeSegments(),u.previewPath.visible=!1)}s(),Xt(u)}else s()},l.onMouseMove=f=>{u.isSpacebarPressed||(u.mode==="draw"?ya(u,f.point):u.mode==="edit"&&Xt(u,f.point))},l.activate(),l}function Fh(u){mn&&(window.removeEventListener("keydown",mn),mn=null),vn&&(window.removeEventListener("keyup",vn),vn=null),u&&(_n&&(u.removeEventListener("wheel",_n),_n=null),yn&&(u.removeEventListener("mousedown",yn),yn=null),xn&&(u.removeEventListener("mousemove",xn),xn=null),Mi&&(u.removeEventListener("mouseup",Mi),u.removeEventListener("mouseleave",Mi),Mi=null)),Gi=!1,Ei=null}function Xt(u,s){if(u.canvas){if(u.isSpacebarPressed){u.canvas.style.cursor=Gi?"grabbing":"grab";return}if(u.mode==="draw"){u.isNearFirstPoint?u.canvas.style.cursor="copy":u.canvas.style.cursor="crosshair";return}if(u.mode==="edit"){if(u.isShiftPressed){u.canvas.style.cursor="crosshair";return}if(s&&u.path){if(u.selectedSegment!==null||u.path.fullySelected){const o=u.path.hitTest(s,{handles:!0,tolerance:Ti});if(o?.type==="handle-in"||o?.type==="handle-out"){u.canvas.style.cursor="pointer";return}}if(u.path.hitTest(s,{segments:!0,tolerance:Ti})?.segment){u.canvas.style.cursor="move";return}if(u.path.hitTest(s,{stroke:!0,tolerance:Ti})){u.canvas.style.cursor="pointer";return}}}u.canvas.style.cursor="default"}}function Bh(u,s){if(u.path){if(u.isNearFirstPoint&&u.path.segments.length>=2){u.path.closed=!0,u.snapIndicator&&(u.snapIndicator.visible=!1),u.mode="edit",u.isNearFirstPoint=!1,u.previewPath&&(u.previewPath.removeSegments(),u.previewPath.visible=!1);return}if(u.path.segments.length>0){const a=u.path.lastSegment;a.handleOut&&a.handleOut.length>0&&(a.handleOut=new Ve.Point(0,0))}u.pendingPoint=s.point.clone(),u.isDraggingCurve=!1,ya(u,s.point)}}function Uh(u,s){if(!u.path||!u.previewPath||!u.pendingPoint)return;u.isDraggingCurve=!0;const a=u.pendingPoint,l=s.point.subtract(a),f=l.multiply(Ws),o=l.multiply(-Ws);let d=new Ve.Point(0,0);if(u.path.segments.length>0){const _=u.path.lastSegment,b=a.subtract(_.point);if(u.path.segments.length>1)if(_.handleIn&&_.handleIn.length>0){const H=_.handleIn.normalize(),L=b.length;d=H.multiply(-L)}else if(u.path.segments.length>1){const H=u.path.segments[u.path.segments.length-2];d=_.point.subtract(H.point).multiply(.33)}else d=b.multiply(.33);u.previewPath.removeSegments();const S=new Ve.Segment(_.point,new Ve.Point(0,0),d);u.previewPath.add(S);const z=new Ve.Segment(a,o,f);u.previewPath.add(z),u.previewPath.visible=!0}else{u.previewPath.removeSegments();const _=new Ve.Segment(a,o,f);u.previewPath.add(_),u.previewPath.visible=!0}}function ya(u,s){if(!(!u.previewPath||!u.path))if(u.previewPath.removeSegments(),u.isNearFirstPoint=!1,u.snapIndicator&&(u.snapIndicator.visible=!1),u.path.segments.length>0){const a=u.path.lastSegment.point;if(u.path.segments.length>=2){const l=u.path.firstSegment.point;if(s.getDistance(l)<Ah){u.isNearFirstPoint=!0,u.previewPath.moveTo(a),u.previewPath.lineTo(l),u.previewPath.visible=!0,u.snapIndicator?(u.snapIndicator.position=l,u.snapIndicator.visible=!0):u.snapIndicator=new Ve.Path.Circle({center:l,radius:Th,strokeColor:new Ve.Color(Mh),strokeWidth:Lh,fillColor:null}),Xt(u);return}}u.previewPath.moveTo(a),u.previewPath.lineTo(s),u.previewPath.visible=!0,Xt(u)}else u.previewPath.visible=!1,Xt(u)}function qh(u,s){if(!u.path)return;if(u.isShiftPressed){const o=u.path.hitTest(s.point,{stroke:!0,tolerance:Ti});if(o?.location){const d=o.location,_=u.path.insert(d.index+1,d.point);for(const b of u.path.segments)b.selected=!1;_.selected=!0,u.selectedSegment=_,u.selectedHandle=null,u.path.fullySelected=!1;return}return}if(u.selectedSegment!==null||u.path.fullySelected){const o=u.path.hitTest(s.point,{handles:!0,tolerance:Ti});if(o?.type==="handle-in"||o?.type==="handle-out"){u.selectedHandle={segment:o.segment,type:o.type==="handle-in"?"handleIn":"handleOut"},u.selectedSegment=null;return}}const l=u.path.hitTest(s.point,{segments:!0,tolerance:Ti});if(l?.segment){for(const o of u.path.segments)o.selected=!1;u.selectedSegment=l.segment,u.selectedSegment.selected=!0,u.selectedHandle=null;return}if(u.path.hitTest(s.point,{stroke:!0,tolerance:Ti})){u.path.fullySelected=!0,u.selectedSegment=null,u.selectedHandle=null;return}u.selectedSegment=null,u.selectedHandle=null,u.path.selected=!1,u.path.fullySelected=!1;for(const o of u.path.segments)o.selected=!1}function Hh(u,s){if(u.selectedSegment)u.selectedSegment.point=u.selectedSegment.point.add(s.delta);else if(u.selectedHandle){const{segment:a,type:l}=u.selectedHandle,f=s.point.subtract(a.point);l==="handleOut"?a.handleOut=f:a.handleIn=f}}const Gh=()=>{const u={canvas:null,path:null,previewPath:null,mode:"draw",selectedSegment:null,selectedHandle:null,zoom:zr,isSpacebarPressed:!1,isShiftPressed:!1,pendingPoint:null,isDraggingCurve:!1,isNearFirstPoint:!1,snapIndicator:null};let s=null,a;const l=(S,z)=>{Ve.setup(S),u.canvas=S,Ve.view.viewSize=new Ve.Size(z.width,z.height),Ve.settings.handleSize=8;const M=z.initialPath&&z.initialPath.length>0;if(u.mode=M?"edit":"draw",u.path=new Ve.Path,u.path.strokeColor=new Ve.Color(z.strokeColor??Or),u.path.strokeWidth=js,M&&z.initialPath){const H=Nr(z.initialPath);u.path.segments=H.segments,u.path.strokeColor=new Ve.Color(z.strokeColor??Or),u.path.strokeWidth=js}u.previewPath=new Ve.Path,u.previewPath.strokeColor=new Ve.Color(Ih),u.previewPath.strokeWidth=kh,u.previewPath.dashArray=Eh,u.previewPath.visible=!1,s=Vh(u,()=>{f(z)},()=>{oe.redraw()})},f=S=>{if(u.path){const z=ro(u.path);S.onPathChanged(z)}oe.redraw()},o=()=>{u.mode==="draw"&&(u.mode="edit",u.pendingPoint=null,u.isDraggingCurve=!1,u.isNearFirstPoint=!1,u.previewPath&&(u.previewPath.removeSegments(),u.previewPath.visible=!1),u.snapIndicator&&(u.snapIndicator.visible=!1),oe.redraw())},d=()=>{s&&(s.remove(),s=null),Fh(u.canvas),Ve.project&&Ve.project.remove(),u.canvas=null,u.path=null,u.previewPath=null,u.snapIndicator=null,u.selectedSegment=null,u.selectedHandle=null},_=S=>{if(S===u.zoom)return;const z=S/u.zoom;Ve.view.scale(z,Ve.view.center),u.zoom=S,oe.redraw()},b=()=>`${Math.round(u.zoom*100)}%`;return{oncreate:({dom:S,attrs:z})=>{const M=S.querySelector("canvas");M&&(l(M,z),a=z.initialPath)},onupdate:({attrs:S})=>{if(!u.path||(S.strokeColor&&(u.path.strokeColor=new Ve.Color(S.strokeColor)),S.initialPath===a))return;const z=a?.length??0,M=S.initialPath?.length??0;if(a=S.initialPath,!(z!==M)&&!(z===0&&M===0))return;if(!(S.initialPath&&S.initialPath.length>0))u.path.removeSegments(),u.mode="draw",u.selectedSegment=null,u.selectedHandle=null,u.pendingPoint=null,u.isDraggingCurve=!1,u.isNearFirstPoint=!1,u.snapIndicator&&(u.snapIndicator.visible=!1),oe.redraw();else if(S.initialPath){u.path.removeSegments();const X=Nr(S.initialPath);u.path.segments=X.segments,u.path.strokeColor=new Ve.Color(S.strokeColor??Or),u.mode="edit",u.selectedSegment=null,u.selectedHandle=null,u.pendingPoint=null,u.isDraggingCurve=!1,u.isNearFirstPoint=!1,u.snapIndicator&&(u.snapIndicator.visible=!1),oe.redraw()}},onremove:()=>{d()},view:({attrs:S})=>{const z=b();return oe(".path-editor",[oe("canvas",{style:`width: ${S.width}px; height: ${S.height}px;`}),oe(".path-editor-controls",[oe(".mode-indicator",`Mode: ${u.mode==="draw"?"Drawing":"Editing"}`),u.mode==="draw"&&oe("wa-button.end-drawing-button",{variant:"success",size:"small",onclick:o},"End Drawing"),oe("wa-dropdown.zoom-control",{"onwa-select":M=>{M.redraw=!1;const H=M.detail.item.value;if(H&&typeof H=="string"){const L=parseFloat(H);isNaN(L)||_(L)}}},[oe("wa-button",{slot:"trigger","with-caret":!0,size:"small",value:u.zoom},z),...Rh.map((M,H)=>oe("wa-dropdown-item",{type:"checkbox",checked:u.zoom==M?!0:void 0,value:M.toString()},Dh[H]))]),oe("wa-tooltip",{for:"recenter-button"},"Recenter view"),oe("wa-button#recenter-button",{appearance:"plain",size:"large",onclick:()=>{const M=zr/u.zoom;Ve.view.scale(M,Ve.view.center),u.zoom=zr,Ve.view.center=new Ve.Point(Ve.view.viewSize.width/2,Ve.view.viewSize.height/2)}},oe("wa-icon",{library:"material",name:"recenter",label:"Recenter view"}))])])}}};function jh(u){try{const a=new DOMParser().parseFromString(u,"image/svg+xml"),l=a.querySelector("parsererror");if(l)return console.error("[SVGParser] XML parsing error:",l.textContent),{commands:[],warning:"Failed to parse SVG"};const f=a.querySelector("path");if(!f)return console.error("[SVGParser] No path element found in SVG"),{commands:[],warning:"Failed to parse SVG: no path element"};const o=f.getAttribute("d");return o?Wh(o):(console.error("[SVGParser] Path element has no d attribute"),{commands:[],warning:"Failed to parse SVG: Path element has no d attribute"})}catch(s){return console.error("[SVGParser] Error parsing SVG:",s),{commands:[],warning:"Failed to parse SVG"}}}function Wh(u){const s=[];let a=!1;const f=u.replace(/([MmLlHhVvCcSsQqTtAaZz])/g," $1 ").replace(/(\d)-/g,"$1 -").replace(/,/g," ").replace(/\s+/g," ").trim().split(" ").filter(te=>te.length>0);let o=0,d=0,_=0,b=0,S=0,z=0,M=0,H="",L=!0;const Q=()=>{const te=parseFloat(f[o]);return o++,te};for(;o<f.length;){let te=f[o];isNaN(parseFloat(te))?o++:H==="M"?te="L":H==="m"?te="l":te=H;const $=te===te.toLowerCase();switch(te.toUpperCase()){case"M":{if(!L){a=!0,o=f.length;break}L=!1;const re=Q(),_e=Q();$?(d+=re,_+=_e):(d=re,_=_e),b=d,S=_,s.push({type:"move",p:[d,_]}),H=te;break}case"L":{const re=Q(),_e=Q();$?(d+=re,_+=_e):(d=re,_=_e),s.push({type:"line",p:[d,_]}),z=d,M=_,H=te;break}case"H":{const re=Q();$?d+=re:d=re,s.push({type:"line",p:[d,_]}),z=d,M=_,H=te;break}case"V":{const re=Q();$?_+=re:_=re,s.push({type:"line",p:[d,_]}),z=d,M=_,H=te;break}case"C":{const re=Q(),_e=Q(),he=Q(),T=Q(),ve=Q(),xe=Q();let de=re,Se=_e,Ie=he,Ce=T,ze=ve,Pe=xe;$&&(de+=d,Se+=_,Ie+=d,Ce+=_,ze+=d,Pe+=_),s.push({type:"bezier",p1:[de,Se],p2:[Ie,Ce],p3:[ze,Pe]}),z=Ie,M=Ce,d=ze,_=Pe,H=te;break}case"S":{const re=Q(),_e=Q(),he=Q(),T=Q(),ve=2*d-z,xe=2*_-M;let de=re,Se=_e,Ie=he,Ce=T;$&&(de+=d,Se+=_,Ie+=d,Ce+=_),s.push({type:"bezier",p1:[ve,xe],p2:[de,Se],p3:[Ie,Ce]}),z=de,M=Se,d=Ie,_=Ce,H=te;break}case"Q":{const re=Q(),_e=Q(),he=Q(),T=Q();let ve=re,xe=_e,de=he,Se=T;$&&(ve+=d,xe+=_,de+=d,Se+=_);const Ie=d+2/3*(ve-d),Ce=_+2/3*(xe-_),ze=de+2/3*(ve-de),Pe=Se+2/3*(xe-Se);s.push({type:"bezier",p1:[Ie,Ce],p2:[ze,Pe],p3:[de,Se]}),z=ve,M=xe,d=de,_=Se,H=te;break}case"T":{const re=Q(),_e=Q(),he=2*d-z,T=2*_-M;let ve=re,xe=_e;$&&(ve+=d,xe+=_);const de=d+2/3*(he-d),Se=_+2/3*(T-_),Ie=ve+2/3*(he-ve),Ce=xe+2/3*(T-xe);s.push({type:"bezier",p1:[de,Se],p2:[Ie,Ce],p3:[ve,xe]}),z=he,M=T,d=ve,_=xe,H=te;break}case"A":{Q(),Q(),Q(),Q(),Q();const re=Q(),_e=Q();let he=re,T=_e;$&&(he+=d,T+=_),s.push({type:"line",p:[he,T]}),d=he,_=T,z=he,M=T,H=te;break}case"Z":{(d!==b||_!==S)&&(s.push({type:"line",p:[b,S]}),d=b,_=S),H=te;break}}}const X={commands:s};return a&&(X.warning="This SVG contains a compound path. Only the first subpath was imported."),X}function Zh(u,s,a,l=20){if(u.length===0)return u;let f=1/0,o=1/0,d=-1/0,_=-1/0;const b=(re,_e)=>{f=Math.min(f,re),o=Math.min(o,_e),d=Math.max(d,re),_=Math.max(_,_e)};for(const re of u)re.type==="move"||re.type==="line"?b(re.p[0],re.p[1]):re.type==="bezier"&&(b(re.p1[0],re.p1[1]),b(re.p2[0],re.p2[1]),b(re.p3[0],re.p3[1]));const S=d-f,z=_-o,M=s-2*l,H=a-2*l,L=Math.min(M/S,H/z),Q=S*L,X=z*L,te=l+(M-Q)/2-f*L,$=l+(H-X)/2-o*L,pe=[];for(const re of u)re.type==="move"||re.type==="line"?pe.push({...re,p:[re.p[0]*L+te,re.p[1]*L+$]}):re.type==="bezier"&&pe.push({type:"bezier",p1:[re.p1[0]*L+te,re.p1[1]*L+$],p2:[re.p2[0]*L+te,re.p2[1]*L+$],p3:[re.p3[0]*L+te,re.p3[1]*L+$]});return pe}const Xh=()=>{const u={initialPathToLoad:[],pathCommands:[],pathDataDisplay:"No path data yet",svgInputElement:void 0,importStatus:""},s=o=>{u.pathCommands=o,u.pathDataDisplay=JSON.stringify(o,null,2)},a=()=>{u.initialPathToLoad=[],u.pathCommands=[],u.pathDataDisplay="No path data yet",oe.redraw()},l=()=>{const o=[{type:"move",p:[469.48276150227287,198.61914195331622]},{type:"line",p:[147.27539529214673,525.2460501911088]},{type:"bezier",p1:[119.6268609401618,551.2189519643504],p2:[149.62606858643616,580],p3:[178.36644877954177,551.7150560673149]},{type:"line",p:[206.99671887066515,523.5384839302747]},{type:"line",p:[241.34793037003863,560.4031774534698]},{type:"line",p:[264.8072838080452,537.7816545144234]},{type:"line",p:[232.96958275167054,503.43044775157955]},{type:"line",p:[252.23977895834645,484.99810098998205]},{type:"line",p:[268.15862475000426,500.91691362593315]},{type:"line",p:[287.4288209566801,483.32241157288445]},{type:"line",p:[273.1856361629428,466.5657068630892]},{type:"line",p:[296.07185058171,443.34292886551395]},{type:"line",p:[330.2814730038454,480.0802571096493]},{type:"line",p:[357.19242550437104,453.43183149484946]},{type:"line",p:[323.7943979441297,416.6172978193763]},{type:"line",p:[501.07659759926975,235.32345658662825]},{type:"bezier",p1:[501.07659759926975,235.32345658662825],p2:[558.04932730116,263.8097503896305],p3:[597.4275549500016,248.7287824622282]},{type:"bezier",p1:[636.805782598843,233.64776716953054],p2:[670.3190972878429,209.35060217868192],p3:[675.3461181738405,165.78319835239148]},{type:"bezier",p1:[680.3731390598382,122.21579452610115],p2:[659.4273055378894,78.6484143824585],p3:[625.9138961182989,49.324204822964475]},{type:"bezier",p1:[592.4005340640038,20],p2:[537.9412437571693,20.837830498960273],p3:[499.4008608168767,39.27018673361687]},{type:"bezier",p1:[460.8604778765839,57.70254770480301],p2:[438.239021248951,92.89158496660718],p3:[437.40117180387267,127.24280120251018]},{type:"bezier",p1:[436.5633223587943,161.59402217494272],p2:[469.4827615022728,198.61914195331644],p3:[469.4827615022728,198.61914195331644]},{type:"line",p:[469.48276150227287,198.61914195331622]}];u.initialPathToLoad=o,u.pathCommands=o,u.pathDataDisplay=JSON.stringify(o,null,2),oe.redraw()},f=o=>{if(o.redraw=!1,!u.svgInputElement)return;const d=u.svgInputElement.files?.[0];if(!d)return;if(d.type!=="image/svg+xml"&&!d.name.endsWith(".svg")){u.importStatus="Error: Please select an SVG file",oe.redraw();return}const _=new FileReader;_.onload=b=>{const S=b.target?.result;if(!S){u.importStatus="Error: Could not read file",oe.redraw();return}const z=jh(S);if(!z){u.importStatus="Error: Could not parse SVG path",oe.redraw();return}const M=Zh(z.commands,800,600);u.initialPathToLoad=M,u.pathCommands=M,u.pathDataDisplay=JSON.stringify(M,null,2),z.warning?u.importStatus=`Warning: ${z.warning}`:u.importStatus=`Imported: ${d.name}`,oe.redraw()},_.onerror=()=>{u.importStatus="Error: Failed to read file",oe.redraw()},_.readAsText(d),u.svgInputElement.value=""};return{view:()=>oe(".page",[oe("h1","Path Editor"),oe("p","Testing the PathEditor component."),oe(".test-page",[oe(".test-area",[oe(Gh,{width:800,height:600,initialPath:u.initialPathToLoad,onPathChanged:s,strokeColor:"#000000ff"})]),oe(".controls",[oe("h2","Controls"),oe(".button-group",[oe("button",{onclick:a,style:"background: #f44336;"},"Clear Canvas"),oe("button",{onclick:l,style:"background: #4CAF50;"},"Load Sample Path"),oe("button",{onclick:()=>{u.svgInputElement&&u.svgInputElement.click()},style:"background: #2196F3;"},"Import SVG"),oe("input[type=file]",{style:{display:"none"},accept:".svg,image/svg+xml",oncreate:({dom:o})=>{u.svgInputElement=o},onchange:f})]),u.importStatus&&oe("p",{style:`margin-top: 0.5rem; color: ${u.importStatus.startsWith("Error")?"#f44336":u.importStatus.startsWith("Warning")?"#FF9800":"#4CAF50"};`},u.importStatus),oe(".instructions",[oe("h3",{style:"margin-top: 1rem;"},"Instructions:"),oe("p","The editor has two modes:"),oe("ul",{style:"margin: 0.5rem 0;"},[oe("li",oe("strong","Drawing Mode"),": Click to add points (straight lines), or click-drag to add points with smooth bezier curves"),oe("ul",{style:"margin-left: 1rem;"},[oe("li","Move near the first point to see a green circle indicator - click to close the path"),oe("li","Closing the path automatically switches to Edit mode"),oe("li","Or click ",oe("strong","End Drawing")," to finish without closing")]),oe("li",oe("strong","Editing Mode"),":"),oe("ul",{style:"margin-left: 1rem;"},[oe("li","Click anywhere on the path to select it and show all vertices"),oe("li","Click a specific vertex to select it (turns blue), then drag to move it"),oe("li","Drag curve handles to adjust curve shape"),oe("li","Hold ",oe("strong","Shift")," and click on the path to insert a new point"),oe("li","Select a vertex and press ",oe("strong","Delete")," or ",oe("strong","Backspace")," to remove it"),oe("li","Click empty space to deselect")]),oe("li","The mode indicator below the canvas shows the current mode")]),oe("h3",{style:"margin-top: 1rem;"},"Pan and Zoom:"),oe("ul",{style:"margin: 0.5rem 0;"},[oe("li","Hold ",oe("strong","Spacebar")," and drag to pan the canvas"),oe("li","Use ",oe("strong","mouse wheel")," to zoom in/out (zooms toward cursor position)"),oe("li","Use the ",oe("strong","Zoom dropdown")," to select preset zoom levels (25%, 50%, 100%, 200%, 400%)"),oe("li","Click the ",oe("strong","Recenter button")," to reset view to 100% zoom and center position")])])]),oe(".data-display",[oe("h2","Path Data"),oe("h3","PathCommand[] Format:"),oe("textarea",{readonly:!0,value:u.pathDataDisplay,rows:15,style:"font-family: monospace; font-size: 12px; width: 100%;"})])])])}};function Kh(){const u=window.matchMedia("(prefers-color-scheme: dark)");function s(){u.matches?document.documentElement.classList.add("wa-dark"):document.documentElement.classList.remove("wa-dark")}s(),u.addEventListener("change",s)}Kh();const Zs={view:u=>[oe(Wa,{link:"https://github.com/weevilgenius/puzzle-generator"}),oe(Za),u.children]};ja("material",{resolver:u=>{const s=u.match(/^(.*?)(_(rounded|sharp))?$/);return s?`https://cdn.jsdelivr.net/npm/@material-symbols/svg-400@0.32.0/${s[3]??"outlined"}/${s[1]}.svg`:""},mutator:u=>u.setAttribute("fill","currentColor")});oe.route(document.body,"/puzzle",{"/puzzle":{render:()=>oe(Zs,oe(Ph))},"/test":{render:()=>oe(Zs,oe(Xh))}});
//# sourceMappingURL=index-CIg_CpQL.js.map
